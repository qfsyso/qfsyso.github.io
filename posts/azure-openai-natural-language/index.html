<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Azure OpenAI Natural Language | MLOG</title>
<meta name=keywords content=".net,Azure,OpenAI"><meta name=description content="简介 Azure OpenAI 为开发人员提供了一个平台，用于在 Python 和 C# SDK 以及 REST API 的帮助下向其应用程序添加人工智能功能。 该平台提供了各种 AI 模型，每个模型都专用于不同的任务，这些任务可通过 Azure OpenAI 服务进行部署。
本模块指导你了解如何将 Azure OpenAI 构建到自己的应用程序中，为你提供一个使用生成式 AI 开发解决方案的起点。
将 Azure OpenAI 集成到应用中 Azure OpenAI 提供 C# 和 Python SDK 以及 REST API，开发人员可以用来向其应用程序添加 AI 功能。 Azure OpenAI 中的生成式 AI 功能通过模型提供。 Azure OpenAI 服务中可用的模型属于不同的系列，每个系列都有自己的重点。 若要使用这些模型之一，需要通过 Azure OpenAI 服务进行部署。
重要
Azure OpenAI 已发布，但支持负责任地使用该服务的访问权限有限。 用户需要先申请访问权限并获得批准，然后才能创建 Azure OpenAI 资源。
创建 Azure OpenAI 资源 可以通过 Azure 命令行接口 (CLI) 和 Azure 门户部署 Azure OpenAI 资源。 通过 Azure 门户创建 Azure OpenAI 资源类似于部署单个 Azure AI 服务资源，并且是 Azure AI 服务的一部分。"><meta name=author content="dwd"><link rel=canonical href=https://qfsyso.github.io/posts/azure-openai-natural-language/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://qfsyso.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://qfsyso.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://qfsyso.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://qfsyso.github.io/apple-touch-icon.png><link rel=mask-icon href=https://qfsyso.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://qfsyso.github.io/posts/azure-openai-natural-language/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://qfsyso.github.io/posts/azure-openai-natural-language/"><meta property="og:site_name" content="MLOG"><meta property="og:title" content="Azure OpenAI Natural Language"><meta property="og:description" content="简介 Azure OpenAI 为开发人员提供了一个平台，用于在 Python 和 C# SDK 以及 REST API 的帮助下向其应用程序添加人工智能功能。 该平台提供了各种 AI 模型，每个模型都专用于不同的任务，这些任务可通过 Azure OpenAI 服务进行部署。
本模块指导你了解如何将 Azure OpenAI 构建到自己的应用程序中，为你提供一个使用生成式 AI 开发解决方案的起点。
将 Azure OpenAI 集成到应用中 Azure OpenAI 提供 C# 和 Python SDK 以及 REST API，开发人员可以用来向其应用程序添加 AI 功能。 Azure OpenAI 中的生成式 AI 功能通过模型提供。 Azure OpenAI 服务中可用的模型属于不同的系列，每个系列都有自己的重点。 若要使用这些模型之一，需要通过 Azure OpenAI 服务进行部署。
重要
Azure OpenAI 已发布，但支持负责任地使用该服务的访问权限有限。 用户需要先申请访问权限并获得批准，然后才能创建 Azure OpenAI 资源。
创建 Azure OpenAI 资源 可以通过 Azure 命令行接口 (CLI) 和 Azure 门户部署 Azure OpenAI 资源。 通过 Azure 门户创建 Azure OpenAI 资源类似于部署单个 Azure AI 服务资源，并且是 Azure AI 服务的一部分。"><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-04T23:02:14+00:00"><meta property="article:modified_time" content="2024-06-04T23:02:14+00:00"><meta property="article:tag" content=".NET"><meta property="article:tag" content="Azure"><meta property="article:tag" content="OpenAI"><meta name=twitter:card content="summary"><meta name=twitter:title content="Azure OpenAI Natural Language"><meta name=twitter:description content="简介 Azure OpenAI 为开发人员提供了一个平台，用于在 Python 和 C# SDK 以及 REST API 的帮助下向其应用程序添加人工智能功能。 该平台提供了各种 AI 模型，每个模型都专用于不同的任务，这些任务可通过 Azure OpenAI 服务进行部署。
本模块指导你了解如何将 Azure OpenAI 构建到自己的应用程序中，为你提供一个使用生成式 AI 开发解决方案的起点。
将 Azure OpenAI 集成到应用中 Azure OpenAI 提供 C# 和 Python SDK 以及 REST API，开发人员可以用来向其应用程序添加 AI 功能。 Azure OpenAI 中的生成式 AI 功能通过模型提供。 Azure OpenAI 服务中可用的模型属于不同的系列，每个系列都有自己的重点。 若要使用这些模型之一，需要通过 Azure OpenAI 服务进行部署。
重要
Azure OpenAI 已发布，但支持负责任地使用该服务的访问权限有限。 用户需要先申请访问权限并获得批准，然后才能创建 Azure OpenAI 资源。
创建 Azure OpenAI 资源 可以通过 Azure 命令行接口 (CLI) 和 Azure 门户部署 Azure OpenAI 资源。 通过 Azure 门户创建 Azure OpenAI 资源类似于部署单个 Azure AI 服务资源，并且是 Azure AI 服务的一部分。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://qfsyso.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Azure OpenAI Natural Language","item":"https://qfsyso.github.io/posts/azure-openai-natural-language/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Azure OpenAI Natural Language","name":"Azure OpenAI Natural Language","description":"简介 Azure OpenAI 为开发人员提供了一个平台，用于在 Python 和 C# SDK 以及 REST API 的帮助下向其应用程序添加人工智能功能。 该平台提供了各种 AI 模型，每个模型都专用于不同的任务，这些任务可通过 Azure OpenAI 服务进行部署。\n本模块指导你了解如何将 Azure OpenAI 构建到自己的应用程序中，为你提供一个使用生成式 AI 开发解决方案的起点。\n将 Azure OpenAI 集成到应用中 Azure OpenAI 提供 C# 和 Python SDK 以及 REST API，开发人员可以用来向其应用程序添加 AI 功能。 Azure OpenAI 中的生成式 AI 功能通过模型提供。 Azure OpenAI 服务中可用的模型属于不同的系列，每个系列都有自己的重点。 若要使用这些模型之一，需要通过 Azure OpenAI 服务进行部署。\n重要\nAzure OpenAI 已发布，但支持负责任地使用该服务的访问权限有限。 用户需要先申请访问权限并获得批准，然后才能创建 Azure OpenAI 资源。\n创建 Azure OpenAI 资源 可以通过 Azure 命令行接口 (CLI) 和 Azure 门户部署 Azure OpenAI 资源。 通过 Azure 门户创建 Azure OpenAI 资源类似于部署单个 Azure AI 服务资源，并且是 Azure AI 服务的一部分。","keywords":[".net","Azure","OpenAI"],"articleBody":"简介 Azure OpenAI 为开发人员提供了一个平台，用于在 Python 和 C# SDK 以及 REST API 的帮助下向其应用程序添加人工智能功能。 该平台提供了各种 AI 模型，每个模型都专用于不同的任务，这些任务可通过 Azure OpenAI 服务进行部署。\n本模块指导你了解如何将 Azure OpenAI 构建到自己的应用程序中，为你提供一个使用生成式 AI 开发解决方案的起点。\n将 Azure OpenAI 集成到应用中 Azure OpenAI 提供 C# 和 Python SDK 以及 REST API，开发人员可以用来向其应用程序添加 AI 功能。 Azure OpenAI 中的生成式 AI 功能通过模型提供。 Azure OpenAI 服务中可用的模型属于不同的系列，每个系列都有自己的重点。 若要使用这些模型之一，需要通过 Azure OpenAI 服务进行部署。\n重要\nAzure OpenAI 已发布，但支持负责任地使用该服务的访问权限有限。 用户需要先申请访问权限并获得批准，然后才能创建 Azure OpenAI 资源。\n创建 Azure OpenAI 资源 可以通过 Azure 命令行接口 (CLI) 和 Azure 门户部署 Azure OpenAI 资源。 通过 Azure 门户创建 Azure OpenAI 资源类似于部署单个 Azure AI 服务资源，并且是 Azure AI 服务的一部分。\n导航到 Azure 门户 搜索 Azure OpenAI，将其选中，然后单击“创建” 为空字段输入适当的值，然后创建资源。 目前 Azure OpenAI 可能部署的区域有限。 选择距离所在物理位置最近的区域。\n创建资源后，你将获得可在应用中使用的密钥和终结点。\n选择和部署模型 每个模型系列擅长不同的任务，并且每个系列中模型具有不同的功能。 模型系列分为三个主要系列：\n生成式预训练转换器 (GPT) - 能够理解和生成自然语言和某些代码的模型。 这些模型最适合常规任务、对话和聊天格式。 代码（gpt-3 及更早版本） - 代码模型基于 GPT 模型构建，并通过数百万行代码进行训练。 这些模型可以理解和生成代码，包括解释注释或自然语言以生成代码。 gpt-35-turbo 和更高版本的模型包含此代码功能，而无需单独的代码模型。 嵌入 - 这些模型可以理解和使用嵌入，这是机器学习模型和算法可以使用的特殊数据格式。 本模块重点介绍常规 GPT 模型，其他模块将介绍其他模型。\n对于较旧的模型，模型系列和功能会在基础模型的名称中有所体现：如 text-davinci-003，该名称指定它是一个文本模型，具有 davinci 级别的功能，并带有标识符 3。 有关模型、功能级别和命名约定的详细信息，请参阅 Azure OpenAI 模型文档页。\n较新的模型会指定第几代 gpt，以及它们是否为 turbo 版本，例如 gpt-35-turbo 表示 GPT 3.5 Turbo 模型。\n若要部署模型供你使用，请导航到 Azure OpenAI Studio 并转到“部署”页。 本模块后面的实验室详细介绍了如何执行此操作。\n已部署模型的身份验证和规范 在 Azure OpenAI 中部署模型时，选择一个部署名称来指定它。 配置应用时，需要指定资源终结点、密钥和部署名称，以指定要向其发送请求的部署模型。 这使你能够在同一资源中部署各种模型，并根据任务向相应的模型发出请求。\n提示设计 输入提示的写入方式在 AI 模型的响应方式中起着很大的作用。 例如，如果出现简单请求（如“什么是 Azure OpenAI”）的提示，通常会获得类似于使用搜索引擎的通用答案。\n但是，如果在你的答复中提供有关所需内容的详细信息，则会获得更具体的答案。 例如，假定出现以下提示：\nClassify the following news headline into 1 of the following categories: Business, Tech, Politics, Sport, Entertainment Headline 1: Donna Steffensen Is Cooking Up a New Kind of Perfection. The Internet’s most beloved cooking guru has a buzzy new book and a fresh new perspective Category: Entertainment Headline 2: Major Retailer Announces Plans to Close Over 100 Stores Category: 你可能会在标题下看到“类别:”，其中填写了“业务”。\n可以在 Azure OpenAI Studio Playground 中的“示例”下拉列表中找到与此类似的几个示例。 尽可能详细描述来自模型的响应中所需的内容，你可能会惊讶于它是多么有见地！\n注意\n无法大胆地假设来自 AI 模型的答案是事实或正确。 负责开发和部署 AI 系统的团队或个人应努力识别、衡量和减轻危害。 你有责任验证来自 AI 模型的任何响应，并负责任地使用 AI。 有关如何负责任地使用 Azure OpenAI 模型的进一步指南，请查看 Microsoft 关于 Azure OpenAI 的透明度说明。\n可在提示工程文档页中找到更多详细信息。\n可用的终结点 可以通过 REST API 或当前可用于 Python 和 C# 的 SDK 访问 Azure OpenAI。 可用于与已部署模型交互的终结点的使用方式不同，并且某些终结点只能使用某些模型。 可用的终结点包括：\n完成 - 模型接受一个输入提示，并生成一个或多个预测的完成。 你将在 studio 中看到此操场，但在本模块中不会深入讨论。 ChatCompletion - 模型接受聊天对话形式的输入（其中角色使用他们发送的消息指定），然后生成下一个聊天完成。 嵌入 - 模型接受输入并返回该输入的矢量表示形式。 例如，ChatCompletion 的输入是每条消息都有明确定义角色的会话：\n{\"role\": \"system\", \"content\": \"You are a helpful assistant, teaching people about AI.\"}, {\"role\": \"user\", \"content\": \"Does Azure OpenAI support multiple languages?\"}, {\"role\": \"assistant\", \"content\": \"Yes, Azure OpenAI supports several languages, and can translate between them.\"}, {\"role\": \"user\", \"content\": \"Do other Azure AI Services support translation too?\"} 当你为 AI 模型提供一个真实的对话时，它可以生成具有更准确的语气、措辞和上下文的更好响应。 ChatCompletion 终结点通过发送与下一个用户消息的聊天历史记录，使 ChatGPT 模型能够进行更真实的对话。\nChatCompletion 还支持非聊天场景，例如摘要或实体提取。 可通过提供简短对话、指定系统信息和所需内容，并让用户输入信息来实现此操作。 例如，如果要生成工作描述，请向 ChatCompletion 提供类似于以下对话输入的内容。\n{\"role\": \"system\", \"content\": \"You are an assistant designed to write intriguing job descriptions. \"}, {\"role\": \"user\", \"content\": \"Write a job description for the following job title: 'Business Intelligence Analyst'. It should include responsibilities, required qualifications, and highlight benefits like time off and flexible hours.\"} 注意\nCompletion 适用于所有 gpt-3 生成模型，而 ChatCompletion 是 gpt-4 模型唯一支持的选项，并且是使用 gpt-35-turbo 模型时的首选终结点。 本模块中的实验将 gpt-35-turbo 与 ChatCompletion 终结点结合使用。\n使用 Azure OpenAI REST API Azure OpenAI 提供了一个 REST API 用于交互和生成响应，开发人员可以使用它将 AI 功能添加到其应用程序。 本单元介绍 API 的示例用法、输入和输出。\n注意\n在与 API 交互之前，必须在 Azure 门户中创建 Azure OpenAI 资源，在该资源中部署模型，并检索终结点和密钥。 请查看 Azure OpenAI 服务入门，了解如何执行此操作。\n每次调用 REST API 时，都需要 Azure OpenAI 资源的终结点和密钥，以及为部署的模型提供的名称。 在以下示例中，使用以下占位符：\n| 占位符名称 | 值 | | +++ | +++ | | YOUR_ENDPOINT_NAME | 此基本终结点位于 Azure 门户的“密钥和终结点”部分。 它是资源的基本终结点，例如 https://sample.openai.azure.com/。 | | YOUR_API_KEY | 密钥位于 Azure 门户的“密钥和终结点”部分。 可以在资源中使用任一密钥。 | | YOUR_DEPLOYMENT_NAME | 此部署名称是在 Azure OpenAI Studio 中部署模型时提供的名称。 |\n聊天完成 在 Azure OpenAI 资源中部署模型后，可以使用 POST 请求向服务发送提示。\ncurl https://YOUR_ENDPOINT_NAME.openai.azure.com/openai/deployments/YOUR_DEPLOYMENT_NAME/chat/completions?api-version=2023-03-15-preview \\ -H \"Content-Type: application/json\" \\ -H \"api-key: YOUR_API_KEY\" \\ -d '{\"messages\":[{\"role\": \"system\", \"content\": \"You are a helpful assistant, teaching people about AI.\"}, {\"role\": \"user\", \"content\": \"Does Azure OpenAI support multiple languages?\"}, {\"role\": \"assistant\", \"content\": \"Yes, Azure OpenAI supports several languages, and can translate between them.\"}, {\"role\": \"user\", \"content\": \"Do other Azure AI Services support translation too?\"}]}' 来自 API 的响应将类似于以下 JSON：\n{ \"id\": \"chatcmpl-6v7mkQj980V1yBec6ETrKPRqFjNw9\", \"object\": \"chat.completion\", \"created\": 1679001781, \"model\": \"gpt-35-turbo\", \"usage\": { \"prompt_tokens\": 95, \"completion_tokens\": 84, \"total_tokens\": 179 }, \"choices\": [ { \"message\": { \"role\": \"assistant\", \"content\": \"Yes, other Azure AI Services also support translation. Azure AI Services offer translation between multiple languages for text, documents, or custom translation through Azure AI Services Translator.\" }, \"finish_reason\": \"stop\", \"index\": 0 } ] } REST 终结点允许指定其他可选输入参数，如 temperature 和 max_tokens 等。 如果要在请求中包含任何这些参数，请根据请求将它们添加到输入数据中。\n嵌入 嵌入对机器学习模型轻松使用的特定格式很有帮助。 若要从输入文本生成嵌入，请向 embeddings 终结点发出 POST 请求。\ncurl https://YOUR_ENDPOINT_NAME.openai.azure.com/openai/deployments/YOUR_DEPLOYMENT_NAME/embeddings?api-version=2022-12-01 \\ -H \"Content-Type: application/json\" \\ -H \"api-key: YOUR_API_KEY\" \\ -d \"{\\\"input\\\": \\\"The food was delicious and the waiter...\\\"}\" 生成嵌入时，请确保在 Azure OpenAI 中使用用于嵌入的模型。 这些模型以 text-embedding 或 text-similarity 开头，具体取决于你要查找的功能。\n来自 API 的响应将类似于以下 JSON：\n{ \"object\": \"list\", \"data\": [ { \"object\": \"embedding\", \"embedding\": [ 0.0172990688066482523, -0.0291879814639389515, .... 0.0134544348834753042, ], \"index\": 0 } ], \"model\": \"text-embedding-ada:002\" } 使用 Azure OpenAI SDK 除了上一单元中介绍的 REST API 外，用户还可以通过 C# 和 Python SDK 访问 Azure OpenAI 模型。 通过 REST 和这些 SDK 提供相同的功能。\n注意\n在使用任一 SDK 与 API 交互之前，必须在 Azure 门户中创建 Azure OpenAI 资源，在该资源中部署模型，并检索终结点和密钥。 请查看 Azure OpenAI 服务入门，了解如何执行此操作。\n对于本单元中介绍的 SDK，需要 Azure OpenAI 资源的终结点和密钥，以及为部署的模型提供的名称。 在以下代码片段中，使用以下占位符：\n| 占位符名称 | 值 | | +++ | +++ | | YOUR_ENDPOINT_NAME | 此基本终结点位于 Azure 门户的“密钥和终结点”部分。 它是资源的基本终结点，例如 https://sample.openai.azure.com/。 | | YOUR_API_KEY | 密钥位于 Azure 门户的“密钥和终结点”部分。 可以在资源中使用任一密钥。 | | YOUR_DEPLOYMENT_NAME | 此部署名称是在 Azure OpenAI Studio 中部署模型时提供的名称。 |\n安装库 首先，安装首选语言的客户端库。 C# SDK 是 REST API 的 .NET 适应，专为 Azure OpenAI 而构建，但它可用于连接到 Azure OpenAI 资源或非 Azure OpenAI 终结点。 Python SDK 由 OpenAI 生成和维护。\ndotnet add package Azure.AI.OpenAI --prerelease 配置应用以访问 Azure OpenAI 资源 每种语言的配置略有不同，但两种语言都需要设置相同的参数。 必需的参数是 endpoint、key 和部署的名称，当向模型发送提示时，部署的名称被称为 engine。\n将库添加到应用，并为客户端设置所需的参数。\n// Add OpenAI library using Azure.AI.OpenAI; // Define parameters and initialize the client string endpoint = \"\"; string key = \"\"; string deploymentName = \"\"; OpenAIClient client = new OpenAIClient(new Uri(endpoint), new AzureKeyCredential(key)); # Add OpenAI library from openai import AzureOpenAI deployment_name = '' # Initialize the Azure OpenAI client client = AzureOpenAI( azure_endpoint = '', api_key='', api_version=\"20xx-xx-xx\" # Target version of the API, such as 2024-02-15-preview ) 调用 Azure OpenAI 资源 配置与 Azure OpenAI 的连接后，将提示发送给模型。\n// Build completion options object ChatCompletionsOptions chatCompletionsOptions = new ChatCompletionsOptions() { Messages = { new ChatRequestSystemMessage(\"You are a helpful AI bot.\"), new ChatRequestUserMessage(\"What is Azure OpenAI?\"), }, DeploymentName = deploymentName }; // Send request to Azure OpenAI model ChatCompletions response = client.GetChatCompletions(chatCompletionsOptions); // Print the response string completion = response.Choices[0].Message.Content; Console.WriteLine(\"Response: \" + completion + \"\\n\"); response = client.chat.completions.create( model=deployment_name, messages=[ {\"role\": \"system\", \"content\": \"You are a helpful assistant.\"}, {\"role\": \"user\", \"content\": \"What is Azure OpenAI?\"} ] ) generated_text = response.choices[0].message.content # Print the response print(\"Response: \" + generated_text + \"\\n\") 响应对象包含多个值，例如 total_tokens 和 finish_reason。 响应对象的完成类似于以下完成：\n\"Azure OpenAI is a cloud-based artificial intelligence (AI) service that offers a range of tools and services for developing and deploying AI applications. Azure OpenAI provides a variety of services for training and deploying machine learning models, including a managed service for training and deploying deep learning models, a managed service for deploying machine learning models, and a managed service for managing and deploying machine learning models.\" 在 C# 和 Python 中，调用可以包含可选参数，其中包括 temperature 和 max_tokens。 本模块的实验室中包含了使用这些参数的示例。\n向 Azure OpenAI 资源发出请求需要哪些资源值？ 密钥、终结点和部署名称 哪三个终结点可用于与已部署的 Azure OpenAI 模型交互？ Completion、ChatCompletion 和 Embeddings 哪一个是 Azure OpenAI 中为会话的下一个 Completion 建模的最佳可用终结点？ ChatCompletion\n来自\nhttps://learn.microsoft.com/zh-cn/collections/e6kjarx0q38?WT.mc_id=cloudskillschallenge_0bc0dea3-e83b-44f1-99a1-f91a1c041817\n","wordCount":"1056","inLanguage":"en","datePublished":"2024-06-04T23:02:14Z","dateModified":"2024-06-04T23:02:14Z","author":{"@type":"Person","name":"dwd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://qfsyso.github.io/posts/azure-openai-natural-language/"},"publisher":{"@type":"Organization","name":"MLOG","logo":{"@type":"ImageObject","url":"https://qfsyso.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://qfsyso.github.io/ accesskey=h title="MLOG (Alt + H)">MLOG</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://qfsyso.github.io/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://qfsyso.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://qfsyso.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Azure OpenAI Natural Language</h1><div class=post-meta><span title='2024-06-04 23:02:14 +0000 UTC'>June 4, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;dwd</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%ae%80%e4%bb%8b aria-label=简介>简介</a></li><li><a href=#%e5%b0%86-azure-openai-%e9%9b%86%e6%88%90%e5%88%b0%e5%ba%94%e7%94%a8%e4%b8%ad aria-label="将 Azure OpenAI 集成到应用中">将 Azure OpenAI 集成到应用中</a></li><li><a href=#%e5%88%9b%e5%bb%ba-azure-openai-%e8%b5%84%e6%ba%90 aria-label="创建 Azure OpenAI 资源">创建 Azure OpenAI 资源</a></li><li><a href=#%e9%80%89%e6%8b%a9%e5%92%8c%e9%83%a8%e7%bd%b2%e6%a8%a1%e5%9e%8b aria-label=选择和部署模型>选择和部署模型</a></li><li><a href=#%e5%b7%b2%e9%83%a8%e7%bd%b2%e6%a8%a1%e5%9e%8b%e7%9a%84%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81%e5%92%8c%e8%a7%84%e8%8c%83 aria-label=已部署模型的身份验证和规范>已部署模型的身份验证和规范</a></li><li><a href=#%e6%8f%90%e7%a4%ba%e8%ae%be%e8%ae%a1 aria-label=提示设计>提示设计</a></li><li><a href=#%e5%8f%af%e7%94%a8%e7%9a%84%e7%bb%88%e7%bb%93%e7%82%b9 aria-label=可用的终结点>可用的终结点</a></li><li><a href=#%e4%bd%bf%e7%94%a8-azure-openai-rest-api aria-label="使用 Azure OpenAI REST API">使用 Azure OpenAI REST API</a></li><li><a href=#%e8%81%8a%e5%a4%a9%e5%ae%8c%e6%88%90 aria-label=聊天完成>聊天完成</a></li><li><a href=#%e5%b5%8c%e5%85%a5 aria-label=嵌入>嵌入</a></li><li><a href=#%e4%bd%bf%e7%94%a8-azure-openai-sdk aria-label="使用 Azure OpenAI SDK">使用 Azure OpenAI SDK</a></li><li><a href=#%e5%ae%89%e8%a3%85%e5%ba%93 aria-label=安装库>安装库</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e5%ba%94%e7%94%a8%e4%bb%a5%e8%ae%bf%e9%97%ae-azure-openai-%e8%b5%84%e6%ba%90 aria-label="配置应用以访问 Azure OpenAI 资源">配置应用以访问 Azure OpenAI 资源</a></li><li><a href=#%e8%b0%83%e7%94%a8-azure-openai-%e8%b5%84%e6%ba%90 aria-label="调用 Azure OpenAI 资源">调用 Azure OpenAI 资源</a></li></ul></div></details></div><div class=post-content><h2 id=简介>简介<a hidden class=anchor aria-hidden=true href=#简介>#</a></h2><p>Azure OpenAI 为开发人员提供了一个平台，用于在 Python 和 C# SDK 以及 REST API 的帮助下向其应用程序添加人工智能功能。 该平台提供了各种 AI 模型，每个模型都专用于不同的任务，这些任务可通过 Azure OpenAI 服务进行部署。</p><p>本模块指导你了解如何将 Azure OpenAI 构建到自己的应用程序中，为你提供一个使用生成式 AI 开发解决方案的起点。</p><h2 id=将-azure-openai-集成到应用中>将 Azure OpenAI 集成到应用中<a hidden class=anchor aria-hidden=true href=#将-azure-openai-集成到应用中>#</a></h2><p>Azure OpenAI 提供 C# 和 Python SDK 以及 REST API，开发人员可以用来向其应用程序添加 AI 功能。 Azure OpenAI 中的生成式 AI 功能通过模型提供。 Azure OpenAI 服务中可用的模型属于不同的系列，每个系列都有自己的重点。 若要使用这些模型之一，需要通过 Azure OpenAI 服务进行部署。</p><p>重要</p><p>Azure OpenAI 已发布，但支持负责任地使用该服务的访问权限有限。 用户需要先<a href="https://learn.microsoft.com/zh-cn/azure/cognitive-services/openai/overview#how-do-i-get-access-to-azure-openai?azure-portal=true">申请访问权限</a>并获得批准，然后才能创建 Azure OpenAI 资源。</p><h2 id=创建-azure-openai-资源>创建 Azure OpenAI 资源<a hidden class=anchor aria-hidden=true href=#创建-azure-openai-资源>#</a></h2><p>可以通过 Azure 命令行接口 (CLI) 和 Azure 门户部署 Azure OpenAI 资源。 通过 Azure 门户创建 Azure OpenAI 资源类似于部署单个 Azure AI 服务资源，并且是 Azure AI 服务的一部分。</p><ol><li>导航到 <a href="https://portal.azure.com/?azure-portal=true">Azure 门户</a></li><li>搜索 Azure OpenAI，将其选中，然后单击“创建”</li><li>为空字段输入适当的值，然后创建资源。</li></ol><p>目前 Azure OpenAI 可能部署的区域有限。 选择距离所在物理位置最近的区域。</p><p>创建资源后，你将获得可在应用中使用的密钥和终结点。</p><h2 id=选择和部署模型>选择和部署模型<a hidden class=anchor aria-hidden=true href=#选择和部署模型>#</a></h2><p>每个模型系列擅长不同的任务，并且每个系列中模型具有不同的功能。 模型系列分为三个主要系列：</p><ul><li><strong>生成式预训练转换器 (GPT)</strong> - 能够理解和生成自然语言和某些代码的模型。 这些模型最适合常规任务、对话和聊天格式。</li><li><strong>代码</strong>（<code>gpt-3</code> 及更早版本） - 代码模型基于 GPT 模型构建，并通过数百万行代码进行训练。 这些模型可以理解和生成代码，包括解释注释或自然语言以生成代码。 <code>gpt-35-turbo</code> 和更高版本的模型包含此代码功能，而无需单独的代码模型。</li><li>嵌入 - 这些模型可以理解和使用嵌入，这是机器学习模型和算法可以使用的特殊数据格式。</li></ul><p>本模块重点介绍常规 GPT 模型，其他模块将介绍其他模型。</p><p>对于较旧的模型，模型系列和功能会在基础模型的名称中有所体现：如 <code>text-davinci-003</code>，该名称指定它是一个文本模型，具有 <code>davinci</code> 级别的功能，并带有标识符 <code>3</code>。 有关模型、功能级别和命名约定的详细信息，请参阅 <a href="https://learn.microsoft.com/zh-cn/azure/ai-services/openai/concepts/models?azure-portal=true">Azure OpenAI 模型文档</a>页。</p><p>较新的模型会指定第几代 <code>gpt</code>，以及它们是否为 <code>turbo</code> 版本，例如 <code>gpt-35-turbo</code> 表示 GPT 3.5 Turbo 模型。</p><p>若要部署模型供你使用，请导航到 <a href="https://oai.azure.com/?azure-portal=true">Azure OpenAI Studio</a> 并转到“部署”页。 本模块后面的实验室详细介绍了如何执行此操作。</p><h2 id=已部署模型的身份验证和规范>已部署模型的身份验证和规范<a hidden class=anchor aria-hidden=true href=#已部署模型的身份验证和规范>#</a></h2><p>在 Azure OpenAI 中部署模型时，选择一个部署名称来指定它。 配置应用时，需要指定资源终结点、密钥和部署名称，以指定要向其发送请求的部署模型。 这使你能够在同一资源中部署各种模型，并根据任务向相应的模型发出请求。</p><h2 id=提示设计>提示设计<a hidden class=anchor aria-hidden=true href=#提示设计>#</a></h2><p>输入提示的写入方式在 AI 模型的响应方式中起着很大的作用。 例如，如果出现简单请求（如“什么是 Azure OpenAI”）的提示，通常会获得类似于使用搜索引擎的通用答案。</p><p>但是，如果在你的答复中提供有关所需内容的详细信息，则会获得更具体的答案。 例如，假定出现以下提示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Classify the following news headline into 1 of the following categories: Business, Tech, Politics, Sport, Entertainment
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Headline 1: Donna Steffensen Is Cooking Up a New Kind of Perfection. The Internet’s most beloved cooking guru has a buzzy new book and a fresh new perspective
</span></span><span style=display:flex><span>Category: Entertainment
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Headline 2: Major Retailer Announces Plans to Close Over 100 Stores
</span></span><span style=display:flex><span>Category:
</span></span></code></pre></div><p>你可能会在标题下看到“类别:”，其中填写了“业务”。</p><p>可以在 Azure OpenAI Studio Playground 中的“示例”下拉列表中找到与此类似的几个示例。 尽可能详细描述来自模型的响应中所需的内容，你可能会惊讶于它是多么有见地！</p><p>注意</p><p>无法大胆地假设来自 AI 模型的答案是事实或正确。 负责开发和部署 AI 系统的团队或个人应努力识别、衡量和减轻危害。 你有责任验证来自 AI 模型的任何响应，并负责任地使用 AI。 有关如何负责任地使用 Azure OpenAI 模型的进一步指南，请查看 <a href="https://learn.microsoft.com/zh-cn/legal/cognitive-services/openai/transparency-note?azure-portal=true">Microsoft 关于 Azure OpenAI 的透明度说明</a>。</p><p>可在<a href="https://learn.microsoft.com/zh-cn/azure/cognitive-services/openai/concepts/prompt-engineering?azure-portal=true">提示工程</a>文档页中找到更多详细信息。</p><h2 id=可用的终结点>可用的终结点<a hidden class=anchor aria-hidden=true href=#可用的终结点>#</a></h2><p>可以通过 REST API 或当前可用于 Python 和 C# 的 SDK 访问 Azure OpenAI。 可用于与已部署模型交互的终结点的使用方式不同，并且某些终结点只能使用某些模型。 可用的终结点包括：</p><ul><li><strong>完成</strong> - 模型接受一个输入提示，并生成一个或多个预测的完成。 你将在 studio 中看到此操场，但在本模块中不会深入讨论。</li><li><strong>ChatCompletion</strong> - 模型接受聊天对话形式的输入（其中角色使用他们发送的消息指定），然后生成下一个聊天完成。</li><li><strong>嵌入</strong> - 模型接受输入并返回该输入的矢量表示形式。</li></ul><p>例如，<code>ChatCompletion</code> 的输入是每条消息都有明确定义角色的会话：</p><pre tabindex=0><code class=language-auto data-lang=auto>{&#34;role&#34;: &#34;system&#34;, &#34;content&#34;: &#34;You are a helpful assistant, teaching people about AI.&#34;},
{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Does Azure OpenAI support multiple languages?&#34;},
{&#34;role&#34;: &#34;assistant&#34;, &#34;content&#34;: &#34;Yes, Azure OpenAI supports several languages, and can translate between them.&#34;},
{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Do other Azure AI Services support translation too?&#34;}
</code></pre><p>当你为 AI 模型提供一个真实的对话时，它可以生成具有更准确的语气、措辞和上下文的更好响应。 <code>ChatCompletion</code> 终结点通过发送与下一个用户消息的聊天历史记录，使 ChatGPT 模型能够进行更真实的对话。</p><p><code>ChatCompletion</code> 还支持非聊天场景，例如摘要或实体提取。 可通过提供简短对话、指定系统信息和所需内容，并让用户输入信息来实现此操作。 例如，如果要生成工作描述，请向 <code>ChatCompletion</code> 提供类似于以下对话输入的内容。</p><pre tabindex=0><code class=language-auto data-lang=auto>{&#34;role&#34;: &#34;system&#34;, &#34;content&#34;: &#34;You are an assistant designed to write intriguing job descriptions. &#34;},
{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Write a job description for the following job title: &#39;Business Intelligence Analyst&#39;. It should include responsibilities, required qualifications, and highlight benefits like time off and flexible hours.&#34;}
</code></pre><p>注意</p><p><code>Completion</code> 适用于所有 <code>gpt-3</code> 生成模型，而 <code>ChatCompletion</code> 是 <code>gpt-4</code> 模型唯一支持的选项，并且是使用 <code>gpt-35-turbo</code> 模型时的首选终结点。 本模块中的实验将 <code>gpt-35-turbo</code> 与 <code>ChatCompletion</code> 终结点结合使用。</p><h2 id=使用-azure-openai-rest-api>使用 Azure OpenAI REST API<a hidden class=anchor aria-hidden=true href=#使用-azure-openai-rest-api>#</a></h2><p>Azure OpenAI 提供了一个 REST API 用于交互和生成响应，开发人员可以使用它将 AI 功能添加到其应用程序。 本单元介绍 API 的示例用法、输入和输出。</p><p>注意</p><p>在与 API 交互之前，必须在 Azure 门户中创建 Azure OpenAI 资源，在该资源中部署模型，并检索终结点和密钥。 请查看 <a href=https://learn.microsoft.com/zh-cn/training/modules/get-started-openai/>Azure OpenAI 服务入门</a>，了解如何执行此操作。</p><p>每次调用 REST API 时，都需要 Azure OpenAI 资源的终结点和密钥，以及为部署的模型提供的名称。 在以下示例中，使用以下占位符：</p><p>| 占位符名称 | 值 |
| +++ | +++ |
| <code>YOUR_ENDPOINT_NAME</code> | 此基本终结点位于 Azure 门户的“密钥和终结点”部分。 它是资源的基本终结点，例如 <code>https://sample.openai.azure.com/</code>。 |
| <code>YOUR_API_KEY</code> | 密钥位于 Azure 门户的“密钥和终结点”部分。 可以在资源中使用任一密钥。 |
| <code>YOUR_DEPLOYMENT_NAME</code> | 此部署名称是在 Azure OpenAI Studio 中部署模型时提供的名称。 |</p><h2 id=聊天完成>聊天完成<a hidden class=anchor aria-hidden=true href=#聊天完成>#</a></h2><p>在 Azure OpenAI 资源中部署模型后，可以使用 <code>POST</code> 请求向服务发送提示。</p><pre tabindex=0><code class=language-auto data-lang=auto>curl https://YOUR_ENDPOINT_NAME.openai.azure.com/openai/deployments/YOUR_DEPLOYMENT_NAME/chat/completions?api-version=2023-03-15-preview \
  -H &#34;Content-Type: application/json&#34; \
  -H &#34;api-key: YOUR_API_KEY&#34; \
  -d &#39;{&#34;messages&#34;:[{&#34;role&#34;: &#34;system&#34;, &#34;content&#34;: &#34;You are a helpful assistant, teaching people about AI.&#34;},
{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Does Azure OpenAI support multiple languages?&#34;},
{&#34;role&#34;: &#34;assistant&#34;, &#34;content&#34;: &#34;Yes, Azure OpenAI supports several languages, and can translate between them.&#34;},
{&#34;role&#34;: &#34;user&#34;, &#34;content&#34;: &#34;Do other Azure AI Services support translation too?&#34;}]}&#39;
</code></pre><p>来自 API 的响应将类似于以下 JSON：</p><pre tabindex=0><code class=language-auto data-lang=auto>{
    &#34;id&#34;: &#34;chatcmpl-6v7mkQj980V1yBec6ETrKPRqFjNw9&#34;,
    &#34;object&#34;: &#34;chat.completion&#34;,
    &#34;created&#34;: 1679001781,
    &#34;model&#34;: &#34;gpt-35-turbo&#34;,
    &#34;usage&#34;: {
        &#34;prompt_tokens&#34;: 95,
        &#34;completion_tokens&#34;: 84,
        &#34;total_tokens&#34;: 179
    },
    &#34;choices&#34;: [
        {
            &#34;message&#34;:
                {
                    &#34;role&#34;: &#34;assistant&#34;,
                    &#34;content&#34;: &#34;Yes, other Azure AI Services also support translation. Azure AI Services offer translation between multiple languages for text, documents, or custom translation through Azure AI Services Translator.&#34;
                },
            &#34;finish_reason&#34;: &#34;stop&#34;,
            &#34;index&#34;: 0
        }
    ]
}
</code></pre><p>REST 终结点允许指定其他可选输入参数，如 <code>temperature</code> 和 <code>max_tokens</code> 等。 如果要在请求中包含任何这些参数，请根据请求将它们添加到输入数据中。</p><h2 id=嵌入>嵌入<a hidden class=anchor aria-hidden=true href=#嵌入>#</a></h2><p>嵌入对机器学习模型轻松使用的特定格式很有帮助。 若要从输入文本生成嵌入，请向 <code>embeddings</code> 终结点发出 <code>POST</code> 请求。</p><pre tabindex=0><code class=language-auto data-lang=auto>curl https://YOUR_ENDPOINT_NAME.openai.azure.com/openai/deployments/YOUR_DEPLOYMENT_NAME/embeddings?api-version=2022-12-01 \
  -H &#34;Content-Type: application/json&#34; \
  -H &#34;api-key: YOUR_API_KEY&#34; \
  -d &#34;{\&#34;input\&#34;: \&#34;The food was delicious and the waiter...\&#34;}&#34;
</code></pre><p>生成嵌入时，请确保在 Azure OpenAI 中使用用于嵌入的模型。 这些模型以 <code>text-embedding</code> 或 <code>text-similarity</code> 开头，具体取决于你要查找的功能。</p><p>来自 API 的响应将类似于以下 JSON：</p><pre tabindex=0><code class=language-auto data-lang=auto>{
  &#34;object&#34;: &#34;list&#34;,
  &#34;data&#34;: [
    {
      &#34;object&#34;: &#34;embedding&#34;,
      &#34;embedding&#34;: [
        0.0172990688066482523,
        -0.0291879814639389515,
        ....
        0.0134544348834753042,
      ],
      &#34;index&#34;: 0
    }
  ],
  &#34;model&#34;: &#34;text-embedding-ada:002&#34;
}
</code></pre><h2 id=使用-azure-openai-sdk>使用 Azure OpenAI SDK<a hidden class=anchor aria-hidden=true href=#使用-azure-openai-sdk>#</a></h2><p>除了上一单元中介绍的 REST API 外，用户还可以通过 C# 和 Python SDK 访问 Azure OpenAI 模型。 通过 REST 和这些 SDK 提供相同的功能。</p><p>注意</p><p>在使用任一 SDK 与 API 交互之前，必须在 Azure 门户中创建 Azure OpenAI 资源，在该资源中部署模型，并检索终结点和密钥。 请查看 <a href=https://learn.microsoft.com/zh-cn/training/modules/get-started-openai/>Azure OpenAI 服务入门</a>，了解如何执行此操作。</p><p>对于本单元中介绍的 SDK，需要 Azure OpenAI 资源的终结点和密钥，以及为部署的模型提供的名称。 在以下代码片段中，使用以下占位符：</p><p>| 占位符名称 | 值 |
| +++ | +++ |
| <code>YOUR_ENDPOINT_NAME</code> | 此基本终结点位于 Azure 门户的“密钥和终结点”部分。 它是资源的基本终结点，例如 <code>https://sample.openai.azure.com/</code>。 |
| <code>YOUR_API_KEY</code> | 密钥位于 Azure 门户的“密钥和终结点”部分。 可以在资源中使用任一密钥。 |
| <code>YOUR_DEPLOYMENT_NAME</code> | 此部署名称是在 Azure OpenAI Studio 中部署模型时提供的名称。 |</p><h2 id=安装库>安装库<a hidden class=anchor aria-hidden=true href=#安装库>#</a></h2><p>首先，安装首选语言的客户端库。 C# SDK 是 REST API 的 .NET 适应，专为 Azure OpenAI 而构建，但它可用于连接到 Azure OpenAI 资源或非 Azure OpenAI 终结点。 Python SDK 由 OpenAI 生成和维护。</p><pre tabindex=0><code class=language-auto data-lang=auto>dotnet add package Azure.AI.OpenAI --prerelease
</code></pre><h2 id=配置应用以访问-azure-openai-资源>配置应用以访问 Azure OpenAI 资源<a hidden class=anchor aria-hidden=true href=#配置应用以访问-azure-openai-资源>#</a></h2><p>每种语言的配置略有不同，但两种语言都需要设置相同的参数。 必需的参数是 <code>endpoint</code>、<code>key</code> 和部署的名称，当向模型发送提示时，部署的名称被称为 <code>engine</code>。</p><p>将库添加到应用，并为客户端设置所需的参数。</p><pre tabindex=0><code class=language-auto data-lang=auto>// Add OpenAI library
using Azure.AI.OpenAI;

// Define parameters and initialize the client
string endpoint = &#34;&lt;YOUR_ENDPOINT_NAME&gt;&#34;;
string key = &#34;&lt;YOUR_API_KEY&gt;&#34;;
string deploymentName = &#34;&lt;YOUR_DEPLOYMENT_NAME&gt;&#34;; 

OpenAIClient client = new OpenAIClient(new Uri(endpoint), new AzureKeyCredential(key));
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Add OpenAI library</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> openai <span style=color:#f92672>import</span> AzureOpenAI
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>deployment_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;YOUR_DEPLOYMENT_NAME&gt;&#39;</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Initialize the Azure OpenAI client</span>
</span></span><span style=display:flex><span>client <span style=color:#f92672>=</span> AzureOpenAI(
</span></span><span style=display:flex><span>        azure_endpoint <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&lt;YOUR_ENDPOINT_NAME&gt;&#39;</span>, 
</span></span><span style=display:flex><span>        api_key<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;&lt;YOUR_API_KEY&gt;&#39;</span>,  
</span></span><span style=display:flex><span>        api_version<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;20xx-xx-xx&#34;</span> <span style=color:#75715e>#  Target version of the API, such as 2024-02-15-preview</span>
</span></span><span style=display:flex><span>        )
</span></span></code></pre></div><h2 id=调用-azure-openai-资源>调用 Azure OpenAI 资源<a hidden class=anchor aria-hidden=true href=#调用-azure-openai-资源>#</a></h2><p>配置与 Azure OpenAI 的连接后，将提示发送给模型。</p><pre tabindex=0><code class=language-auto data-lang=auto>// Build completion options object
ChatCompletionsOptions chatCompletionsOptions = new ChatCompletionsOptions()
{
    Messages =
    {
        new ChatRequestSystemMessage(&#34;You are a helpful AI bot.&#34;),
        new ChatRequestUserMessage(&#34;What is Azure OpenAI?&#34;),
    },
    DeploymentName = deploymentName
};

// Send request to Azure OpenAI model
ChatCompletions response = client.GetChatCompletions(chatCompletionsOptions);

// Print the response
string completion = response.Choices[0].Message.Content;
Console.WriteLine(&#34;Response: &#34; + completion + &#34;\n&#34;);
</code></pre><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>response <span style=color:#f92672>=</span> client<span style=color:#f92672>.</span>chat<span style=color:#f92672>.</span>completions<span style=color:#f92672>.</span>create(
</span></span><span style=display:flex><span>    model<span style=color:#f92672>=</span>deployment_name,
</span></span><span style=display:flex><span>    messages<span style=color:#f92672>=</span>[
</span></span><span style=display:flex><span>        {<span style=color:#e6db74>&#34;role&#34;</span>: <span style=color:#e6db74>&#34;system&#34;</span>, <span style=color:#e6db74>&#34;content&#34;</span>: <span style=color:#e6db74>&#34;You are a helpful assistant.&#34;</span>},
</span></span><span style=display:flex><span>        {<span style=color:#e6db74>&#34;role&#34;</span>: <span style=color:#e6db74>&#34;user&#34;</span>, <span style=color:#e6db74>&#34;content&#34;</span>: <span style=color:#e6db74>&#34;What is Azure OpenAI?&#34;</span>}
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>generated_text <span style=color:#f92672>=</span> response<span style=color:#f92672>.</span>choices[<span style=color:#ae81ff>0</span>]<span style=color:#f92672>.</span>message<span style=color:#f92672>.</span>content
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Print the response</span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Response: &#34;</span> <span style=color:#f92672>+</span> generated_text <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></div><p>响应对象包含多个值，例如 <code>total_tokens</code> 和 <code>finish_reason</code>。 响应对象的完成类似于以下完成：</p><pre tabindex=0><code class=language-auto data-lang=auto>&#34;Azure OpenAI is a cloud-based artificial intelligence (AI) service that offers a range of tools and services for developing and deploying AI applications. Azure OpenAI provides a variety of services for training and deploying machine learning models, including a managed service for training and deploying deep learning models, a managed service for deploying machine learning models, and a managed service for managing and deploying machine learning models.&#34;
</code></pre><p>在 C# 和 Python 中，调用可以包含可选参数，其中包括 <code>temperature</code> 和 <code>max_tokens</code>。 本模块的实验室中包含了使用这些参数的示例。</p><p>向 Azure OpenAI 资源发出请求需要哪些资源值？ 密钥、终结点和部署名称
哪三个终结点可用于与已部署的 Azure OpenAI 模型交互？
Completion、ChatCompletion 和 Embeddings
哪一个是 Azure OpenAI 中为会话的下一个 Completion 建模的最佳可用终结点？
ChatCompletion</p><p>来自</p><p><a href="https://learn.microsoft.com/zh-cn/collections/e6kjarx0q38?WT.mc_id=cloudskillschallenge_0bc0dea3-e83b-44f1-99a1-f91a1c041817">https://learn.microsoft.com/zh-cn/collections/e6kjarx0q38?WT.mc_id=cloudskillschallenge_0bc0dea3-e83b-44f1-99a1-f91a1c041817</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://qfsyso.github.io/tags/.net/>.NET</a></li><li><a href=https://qfsyso.github.io/tags/azure/>Azure</a></li><li><a href=https://qfsyso.github.io/tags/openai/>OpenAI</a></li></ul><nav class=paginav><a class=prev href=https://qfsyso.github.io/posts/azure-openai-language/><span class=title>« Prev</span><br><span>Azure OpenAI Language</span>
</a><a class=next href=https://qfsyso.github.io/posts/harmonyos-tabs-component/><span class=title>Next »</span><br><span>HarmonyOS Tabs Component</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Azure OpenAI Natural Language on x" href="https://x.com/intent/tweet/?text=Azure%20OpenAI%20Natural%20Language&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f&amp;hashtags=.net%2cAzure%2cOpenAI"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Azure OpenAI Natural Language on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f&amp;title=Azure%20OpenAI%20Natural%20Language&amp;summary=Azure%20OpenAI%20Natural%20Language&amp;source=https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Azure OpenAI Natural Language on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f&title=Azure%20OpenAI%20Natural%20Language"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Azure OpenAI Natural Language on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Azure OpenAI Natural Language on whatsapp" href="https://api.whatsapp.com/send?text=Azure%20OpenAI%20Natural%20Language%20-%20https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Azure OpenAI Natural Language on telegram" href="https://telegram.me/share/url?text=Azure%20OpenAI%20Natural%20Language&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Azure OpenAI Natural Language on ycombinator" href="https://news.ycombinator.com/submitlink?t=Azure%20OpenAI%20Natural%20Language&u=https%3a%2f%2fqfsyso.github.io%2fposts%2fazure-openai-natural-language%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><div class=wtime><div class=wtime2>CST<span id=beijingTime></span> GMT <span id=londonTime></span> EST <span id=newYorkTime></span> PST<span id=losAngelesTime></span></div><div class=wtime2 style=display:none>东京<span id=tokyoTime></span></div><div class=wtime2 style=display:none>欧洲-巴黎<span id=parisTime></span></div><div class=wtime2 style=display:none>UTC<span id=utcTime></span></div></div><span>&copy; 2025 <a href=https://qfsyso.github.io/>MLOG</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script type=text/javascript>const timeZoneOffsets={beijing:8,tokyo:9,paris:[1,2],london:[0,1],newYork:[-5,-4],losAngeles:[-8,-7]};function padZero(e){return e<10?"0"+e:e}function formatTime(e){const t=e.getFullYear(),n=padZero(e.getMonth()+1),s=padZero(e.getDate()),o=padZero(e.getHours()),i=padZero(e.getMinutes()),a=padZero(e.getSeconds());return`${t}-${n}-${s} ${o}:${i}:${a}`}function isDaylightSavingTime(e,t){const o=e.getMonth(),n=new Date(e.getFullYear(),3,8,2,0,0),s=new Date(e.getFullYear(),10,1,2,0,0);return(t==="paris"||t==="london"||t==="newYork"||t==="losAngeles")&&e>=n&&e<s}function updateTime(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),n=formatTime(t);document.getElementById("utcTime").innerHTML=n;for(const n in timeZoneOffsets){const e=timeZoneOffsets[n];let s;Array.isArray(e)?s=isDaylightSavingTime(t,n)?e[1]:e[0]:s=e;const o=new Date(t.getTime()+s*60*60*1e3);document.getElementById(n+"Time").innerHTML=formatTime(o)}setTimeout(updateTime,1e3)}window.onload=function(){updateTime()};function notfound(e){var n=e.src,t=n.split("/"),s=t[t.length-1];e.src="https://47.115.223.75:8080/group1/v2/"+s+"?timestamp="+Date.now(),e.onerror=null}</script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>