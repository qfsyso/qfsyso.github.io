<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Caddy | MLOG</title>
<meta name=keywords content="Caddy,Debian"><meta name=description content="Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å— æœ¬æ–‡æ¡£æä¾›äº†åœ¨ Debian ç³»ç»Ÿä¸Šå®‰è£…å’Œé…ç½® Caddy Web æœåŠ¡å™¨çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å¤šç§å®‰è£…æ–¹æ³•ã€æœåŠ¡ç®¡ç†ã€HTTPS é…ç½®ã€é«˜çº§åŠŸèƒ½ä»¥åŠæ³¨æ„äº‹é¡¹ã€‚æ­¤å¤–ï¼Œè¿˜å¯¹æ¯”äº† Caddy ä¸ Nginx çš„ä¸»è¦ä¼˜åŠ¿ï¼Œå¹¶ä»‹ç»äº† Caddy çš„ä¸€äº›é«˜çº§ç‰¹æ€§ã€‚
ä¸€ã€å®‰è£…æ–¹æ³• APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰ æ›´æ–°ç³»ç»Ÿï¼š
sudo apt update && sudo apt upgrade -y æ·»åŠ å¯†é’¥å’Œå­˜å‚¨åº“ï¼š
sudo apt install -y debian-archive-keyring apt-transport-https curl curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list å®‰è£… Caddyï¼š
sudo apt update && sudo apt install caddy å¿«é€Ÿè„šæœ¬å®‰è£… curl https://getcaddy.com | bash -s personal http."><meta name=author content="dwd"><link rel=canonical href=https://qfsyso.github.io/posts/caddy/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://qfsyso.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://qfsyso.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://qfsyso.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://qfsyso.github.io/apple-touch-icon.png><link rel=mask-icon href=https://qfsyso.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://qfsyso.github.io/posts/caddy/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://qfsyso.github.io/posts/caddy/"><meta property="og:site_name" content="MLOG"><meta property="og:title" content="Caddy"><meta property="og:description" content="Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å— æœ¬æ–‡æ¡£æä¾›äº†åœ¨ Debian ç³»ç»Ÿä¸Šå®‰è£…å’Œé…ç½® Caddy Web æœåŠ¡å™¨çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å¤šç§å®‰è£…æ–¹æ³•ã€æœåŠ¡ç®¡ç†ã€HTTPS é…ç½®ã€é«˜çº§åŠŸèƒ½ä»¥åŠæ³¨æ„äº‹é¡¹ã€‚æ­¤å¤–ï¼Œè¿˜å¯¹æ¯”äº† Caddy ä¸ Nginx çš„ä¸»è¦ä¼˜åŠ¿ï¼Œå¹¶ä»‹ç»äº† Caddy çš„ä¸€äº›é«˜çº§ç‰¹æ€§ã€‚
ä¸€ã€å®‰è£…æ–¹æ³• APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰ æ›´æ–°ç³»ç»Ÿï¼š
sudo apt update && sudo apt upgrade -y æ·»åŠ å¯†é’¥å’Œå­˜å‚¨åº“ï¼š
sudo apt install -y debian-archive-keyring apt-transport-https curl curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list å®‰è£… Caddyï¼š
sudo apt update && sudo apt install caddy å¿«é€Ÿè„šæœ¬å®‰è£… curl https://getcaddy.com | bash -s personal http."><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-05-23T00:21:01+08:00"><meta property="article:modified_time" content="2025-05-23T00:21:01+08:00"><meta property="article:tag" content="Caddy"><meta property="article:tag" content="Debian"><meta name=twitter:card content="summary"><meta name=twitter:title content="Caddy"><meta name=twitter:description content="Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å— æœ¬æ–‡æ¡£æä¾›äº†åœ¨ Debian ç³»ç»Ÿä¸Šå®‰è£…å’Œé…ç½® Caddy Web æœåŠ¡å™¨çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å¤šç§å®‰è£…æ–¹æ³•ã€æœåŠ¡ç®¡ç†ã€HTTPS é…ç½®ã€é«˜çº§åŠŸèƒ½ä»¥åŠæ³¨æ„äº‹é¡¹ã€‚æ­¤å¤–ï¼Œè¿˜å¯¹æ¯”äº† Caddy ä¸ Nginx çš„ä¸»è¦ä¼˜åŠ¿ï¼Œå¹¶ä»‹ç»äº† Caddy çš„ä¸€äº›é«˜çº§ç‰¹æ€§ã€‚
ä¸€ã€å®‰è£…æ–¹æ³• APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰ æ›´æ–°ç³»ç»Ÿï¼š
sudo apt update && sudo apt upgrade -y æ·»åŠ å¯†é’¥å’Œå­˜å‚¨åº“ï¼š
sudo apt install -y debian-archive-keyring apt-transport-https curl curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list å®‰è£… Caddyï¼š
sudo apt update && sudo apt install caddy å¿«é€Ÿè„šæœ¬å®‰è£… curl https://getcaddy.com | bash -s personal http."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://qfsyso.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Caddy","item":"https://qfsyso.github.io/posts/caddy/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Caddy","name":"Caddy","description":"Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å— æœ¬æ–‡æ¡£æä¾›äº†åœ¨ Debian ç³»ç»Ÿä¸Šå®‰è£…å’Œé…ç½® Caddy Web æœåŠ¡å™¨çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å¤šç§å®‰è£…æ–¹æ³•ã€æœåŠ¡ç®¡ç†ã€HTTPS é…ç½®ã€é«˜çº§åŠŸèƒ½ä»¥åŠæ³¨æ„äº‹é¡¹ã€‚æ­¤å¤–ï¼Œè¿˜å¯¹æ¯”äº† Caddy ä¸ Nginx çš„ä¸»è¦ä¼˜åŠ¿ï¼Œå¹¶ä»‹ç»äº† Caddy çš„ä¸€äº›é«˜çº§ç‰¹æ€§ã€‚\nä¸€ã€å®‰è£…æ–¹æ³• APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰ æ›´æ–°ç³»ç»Ÿï¼š\nsudo apt update \u0026amp;\u0026amp; sudo apt upgrade -y æ·»åŠ å¯†é’¥å’Œå­˜å‚¨åº“ï¼š\nsudo apt install -y debian-archive-keyring apt-transport-https curl curl -1sLf \u0026#39;https://dl.cloudsmith.io/public/caddy/stable/gpg.key\u0026#39; | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg curl -1sLf \u0026#39;https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt\u0026#39; | sudo tee /etc/apt/sources.list.d/caddy-stable.list å®‰è£… Caddyï¼š\nsudo apt update \u0026amp;\u0026amp; sudo apt install caddy å¿«é€Ÿè„šæœ¬å®‰è£… curl https://getcaddy.com | bash -s personal http.","keywords":["Caddy","Debian"],"articleBody":"Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å— æœ¬æ–‡æ¡£æä¾›äº†åœ¨ Debian ç³»ç»Ÿä¸Šå®‰è£…å’Œé…ç½® Caddy Web æœåŠ¡å™¨çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å¤šç§å®‰è£…æ–¹æ³•ã€æœåŠ¡ç®¡ç†ã€HTTPS é…ç½®ã€é«˜çº§åŠŸèƒ½ä»¥åŠæ³¨æ„äº‹é¡¹ã€‚æ­¤å¤–ï¼Œè¿˜å¯¹æ¯”äº† Caddy ä¸ Nginx çš„ä¸»è¦ä¼˜åŠ¿ï¼Œå¹¶ä»‹ç»äº† Caddy çš„ä¸€äº›é«˜çº§ç‰¹æ€§ã€‚\nä¸€ã€å®‰è£…æ–¹æ³• APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰ æ›´æ–°ç³»ç»Ÿï¼š\nsudo apt update \u0026\u0026 sudo apt upgrade -y æ·»åŠ å¯†é’¥å’Œå­˜å‚¨åº“ï¼š\nsudo apt install -y debian-archive-keyring apt-transport-https curl curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/gpg.key' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg curl -1sLf 'https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt' | sudo tee /etc/apt/sources.list.d/caddy-stable.list å®‰è£… Caddyï¼š\nsudo apt update \u0026\u0026 sudo apt install caddy å¿«é€Ÿè„šæœ¬å®‰è£… curl https://getcaddy.com | bash -s personal http.filemanager -s å‚æ•°æ”¯æŒæ’ä»¶æ‰©å±•ï¼ˆå¦‚ http.filemanager æ–‡ä»¶ç®¡ç†æ’ä»¶ï¼‰ å•†ä¸šç”¨é€”éœ€è´­ä¹°è®¸å¯è¯ or\ncurl -fsSL https://get.caddyserver.com | bash -s personal éªŒè¯\ncaddy version äºŒã€æœåŠ¡ç®¡ç† å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯ï¼š\nsudo systemctl enable --now caddy å¸¸ç”¨å‘½ä»¤ï¼š\nsudo systemctl status caddy # æŸ¥çœ‹çŠ¶æ€ sudo journalctl -u caddy -f # æŸ¥çœ‹å®æ—¶æ—¥å¿— ä¸‰ã€é…ç½® HTTPS Caddy è‡ªåŠ¨å¯ç”¨ HTTPSï¼Œåªéœ€åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šåŸŸåï¼š\nç¼–è¾‘é…ç½®æ–‡ä»¶ï¼š\nsudo nano /etc/caddy/Caddyfile ç¤ºä¾‹é…ç½®ï¼š\nok.example.com { root * /var/www/html file_server tls your_email@example.com # è‡ªåŠ¨ç”³è¯· Let's Encrypt è¯ä¹¦ } é‡å¯æœåŠ¡ç”Ÿæ•ˆï¼š\nsudo systemctl restart caddy å››ã€é«˜çº§åŠŸèƒ½ åå‘ä»£ç† api.example.com { reverse_proxy localhost:8080 header_up X-Real-IP {remote_host} } æ€§èƒ½ä¼˜åŒ– æ·»åŠ  -quic å‚æ•°å¯ç”¨ HTTP/3ï¼ˆéœ€åœ¨ caddy.service ä¸­ä¿®æ”¹å¯åŠ¨å‚æ•°ï¼‰ å¼€æ”¾ UDP 443 ç«¯å£ äº”ã€æ³¨æ„äº‹é¡¹ é˜²ç«å¢™éœ€æ”¾è¡Œ 80/443 ç«¯å£ï¼š\nsudo ufw allow 80,443/tcp \u0026\u0026 sudo ufw reload è‹¥ä½¿ç”¨æœ¬åœ°æµ‹è¯•ï¼Œæµè§ˆå™¨å¯èƒ½æç¤ºè‡ªç­¾åè¯ä¹¦é£é™©ï¼Œéœ€æ‰‹åŠ¨ä¿¡ä»»\né…ç½®æ–‡ä»¶è¯­æ³•éªŒè¯ï¼š\nsudo caddy validate --config /etc/caddy/Caddyfile é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæ‚¨å¯ä»¥åœ¨ Debian ç³»ç»Ÿä¸Šå¿«é€Ÿéƒ¨ç½²æ”¯æŒè‡ªåŠ¨ HTTPSã€åå‘ä»£ç†ç­‰åŠŸèƒ½çš„ Caddy æœåŠ¡å™¨ã€‚\nCaddy å¯¹æ¯” Nginx çš„ä¸»è¦ä¼˜åŠ¿åˆ†æ ä¸€ã€é…ç½®ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½ Nginx ä¾èµ–çº¯æ–‡æœ¬é…ç½®æ–‡ä»¶ï¼ˆ.confï¼‰ï¼Œè¯­æ³•è§„åˆ™ä¸¥æ ¼ï¼Œéœ€æ‰‹åŠ¨ç¼–å†™åå‘ä»£ç†ã€SSL è¯ä¹¦é…ç½®ç­‰å¤æ‚é€»è¾‘ï¼Œå¯¹æ–°æ‰‹ä¸å¤Ÿå‹å¥½ã€‚ é…ç½® HTTPS éœ€æ‰‹åŠ¨ç”³è¯·è¯ä¹¦å¹¶ç»‘å®šè·¯å¾„ï¼Œè¿‡ç¨‹ç¹çã€‚ Caddy å£°æ˜å¼é…ç½®ï¼šä½¿ç”¨æ›´ç®€æ´çš„ Caddyfile è¯­æ³•ï¼Œå†…ç½®å¸¸ç”¨åŠŸèƒ½ï¼ˆå¦‚åå‘ä»£ç†ã€HTTPSï¼‰çš„é»˜è®¤è§„åˆ™ï¼Œä»£ç é‡å¯å‡å°‘ 50% ä»¥ä¸Šã€‚ ç¤ºä¾‹å¯¹æ¯”ï¼š Nginx é…ç½® HTTPS åå‘ä»£ç†ï¼š server { listen 443 ssl; server_name example.com; ssl_certificate /path/to/cert.pem; ssl_certificate_key /path/to/key.pem; location / { proxy_pass http://localhost:8080; } } Caddy åŒç­‰åŠŸèƒ½é…ç½®ï¼š example.com { reverse_proxy localhost:8080 } ï¼ˆCaddy ä¼šè‡ªåŠ¨ç”³è¯·å¹¶ç®¡ç† SSL è¯ä¹¦ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®è¯ä¹¦è·¯å¾„ï¼‰ è‡ªåŠ¨ HTTPSï¼šå†…ç½® ACME å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Letâ€™s Encrypt è¯ä¹¦è‡ªåŠ¨ç”³è¯·ã€ç»­ç­¾å’Œç®¡ç†ï¼Œæ— éœ€é¢å¤–å·¥å…·ï¼ˆå¦‚ Certbotï¼‰ã€‚ äºŒã€è‡ªåŠ¨åŒ–ä¸å†…ç½®åŠŸèƒ½ä¸°å¯Œ Nginx æ ¸å¿ƒåŠŸèƒ½ç®€æ´ï¼Œéœ€é€šè¿‡ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ˆå¦‚ ngx_http_ssl_moduleã€ngx_http_proxy_moduleï¼‰æ‰©å±•åŠŸèƒ½ï¼Œé…ç½®å¤æ‚ä¸”å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚ Caddy å†…ç½®åŠŸèƒ½å¼€ç®±å³ç”¨ï¼šè‡ªåŠ¨ HTTPSã€HTTP/2/3 æ”¯æŒã€åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€WebSocketsã€é™æ€æ–‡ä»¶æœåŠ¡ã€Gzip å‹ç¼©ã€æ—¥å¿—è®°å½•ç­‰åŠŸèƒ½å‡ä¸ºå†…ç½®ï¼Œæ— éœ€æ‰‹åŠ¨å¯ç”¨æ¨¡å—ã€‚ æ”¯æŒå®æ—¶é‡è½½é…ç½®ï¼ˆä¿®æ”¹ Caddyfile åè‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€æ‰‹åŠ¨æ‰§è¡Œ nginx -s reloadï¼‰ã€‚ ç”Ÿæ€æ’ä»¶çµæ´»ï¼šé€šè¿‡ Go è¯­è¨€æ’ä»¶æœºåˆ¶ï¼ˆå¦‚ caddy plugin å‘½ä»¤ï¼‰æˆ–ç›´æ¥åœ¨ Caddyfile ä¸­å£°æ˜ï¼ˆå¦‚ import æŒ‡ä»¤ï¼‰æ‰©å±•åŠŸèƒ½ï¼Œæ— éœ€ç¼–è¯‘æºç ã€‚ ä¸‰ã€ç°ä»£åŒ–åè®®ä¸æ€§èƒ½ä¼˜åŒ– Nginx å¯¹ HTTP/3ï¼ˆQUICï¼‰çš„æ”¯æŒéœ€ç¼–è¯‘æ—¶å¯ç”¨ ngx_http_v3_moduleï¼Œä¸”é…ç½®è¾ƒå¤æ‚ï¼›å¯¹ WebAssemblyï¼ˆWasmï¼‰ç­‰æ–°å…´æŠ€æœ¯æ”¯æŒæœ‰é™ã€‚ Caddy åŸç”Ÿæ”¯æŒ HTTP/3ï¼šé»˜è®¤å¯ç”¨å¯¹ QUIC åè®®çš„æ”¯æŒï¼Œæå‡ç§»åŠ¨ç«¯å’Œé«˜å»¶è¿Ÿç½‘ç»œçš„è®¿é—®é€Ÿåº¦ã€‚ Wasm æ’ä»¶ç”Ÿæ€ï¼šå¯é€šè¿‡ Wasm æ’ä»¶å®ç°è‡ªå®šä¹‰é€»è¾‘ï¼ˆå¦‚èº«ä»½éªŒè¯ã€æµé‡è¿‡æ»¤ï¼‰ï¼Œæ— éœ€ä¿®æ”¹ Caddy æ ¸å¿ƒä»£ç ï¼Œçµæ´»æ€§æ›´é«˜ã€‚ å†…å­˜å ç”¨ä¼˜åŒ–ï¼šåœ¨è½»é‡çº§åœºæ™¯ä¸‹ï¼ˆå¦‚å•æœåŠ¡å™¨ä»£ç†ï¼‰ï¼Œå†…å­˜æ¶ˆè€—å¯èƒ½ä½äº Nginxï¼ˆå…·ä½“å–å†³äºè´Ÿè½½å’Œé…ç½®ï¼‰ã€‚ å››ã€éƒ¨ç½²ä¸æ›´æ–°ä¾¿æ·æ€§ Nginx æ›´æ–°éœ€æ‰‹åŠ¨ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶æˆ–é€šè¿‡åŒ…ç®¡ç†å·¥å…·ï¼ˆå¦‚ apt/yumï¼‰ï¼Œå¯èƒ½æ¶‰åŠæœåŠ¡é‡å¯æˆ–é…ç½®æ–‡ä»¶è¿ç§»ã€‚ å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆå¦‚ Dockerï¼‰éœ€æ‰‹åŠ¨ç®¡ç†é…ç½®æ–‡ä»¶å’Œè¯ä¹¦æŒ‚è½½ã€‚ Caddy å•ä¸€äºŒè¿›åˆ¶æ–‡ä»¶ï¼šå®‰è£…åŒ…ä»…ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ”¯æŒè·¨å¹³å°ï¼ˆLinux/macOS/Windowsï¼‰ï¼Œéƒ¨ç½²ç®€å•ã€‚ è‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼šé€šè¿‡ caddy upgrade å‘½ä»¤å³å¯å®Œæˆç‰ˆæœ¬å‡çº§ï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰ã€‚ å®¹å™¨åŒ–å‹å¥½ï¼šå®˜æ–¹ Docker é•œåƒé»˜è®¤åŒ…å«å¸¸ç”¨é…ç½®ï¼Œå¯é€šè¿‡ç¯å¢ƒå˜é‡å¿«é€Ÿé…ç½®ï¼ˆå¦‚ CADDYFILE_CONTENT ç›´æ¥æ³¨å…¥ Caddyfile å†…å®¹ï¼‰ã€‚ äº”ã€é€‚ç”¨åœºæ™¯å¯¹æ¯” åœºæ™¯ Nginx Caddy å¤§å‹ç½‘ç«™ / é«˜å¹¶å‘è´Ÿè½½ æˆç†Ÿç¨³å®šï¼Œæ€§èƒ½ä¼˜åŒ–å·¥å…·é“¾å®Œå–„ï¼ˆå¦‚ nginx -t æ£€æµ‹é…ç½®ï¼‰ æ€§èƒ½æ¥è¿‘ Nginxï¼Œä½†ç”Ÿæ€å·¥å…·ï¼ˆå¦‚ç°åº¦å‘å¸ƒã€ç›‘æ§ï¼‰è¾ƒå°‘ ä¸­å°é¡¹ç›® / å¿«é€Ÿéƒ¨ç½² éœ€ç¼–å†™å¤æ‚é…ç½®ï¼Œé€‚åˆæœ‰ç»éªŒçš„å›¢é˜Ÿ é…ç½®ç®€å•ï¼Œé€‚åˆä¸ªäººå¼€å‘è€…æˆ– CI/CD è‡ªåŠ¨åŒ–æµç¨‹ ç°ä»£åŒ–åè®®ï¼ˆHTTP/3ï¼‰ éœ€æ‰‹åŠ¨ç¼–è¯‘æ¨¡å—ï¼Œé…ç½®é—¨æ§›é«˜ åŸç”Ÿæ”¯æŒï¼Œä¸€é”®å¯ç”¨ æ— çŠ¶æ€ä»£ç† / è¾¹ç¼˜è®¡ç®— è½»é‡çº§ä½†éœ€æ‰‹åŠ¨ä¼˜åŒ–é…ç½® å†…ç½®è‡ªåŠ¨ä¼˜åŒ–ï¼ˆå¦‚è¿æ¥æ± ã€ç¼“å­˜ï¼‰ï¼Œé€‚åˆè¾¹ç¼˜èŠ‚ç‚¹ å¼€å‘ç¯å¢ƒè°ƒè¯• é…ç½®ç¹çï¼Œä¿®æ”¹åéœ€é‡å¯æœåŠ¡ å®æ—¶é‡è½½ï¼Œæ”¯æŒåŠ¨æ€è°ƒæ•´é…ç½® æ€»ç»“ï¼šCaddy çš„æ ¸å¿ƒä¼˜åŠ¿ å¯¹æ–°æ‰‹å‹å¥½ï¼šæç®€é…ç½®å’Œè‡ªåŠ¨ HTTPS å¤§å¹…é™ä½å…¥é—¨é—¨æ§›ï¼Œé€‚åˆå¿«é€Ÿæ­å»ºä¸ªäººåšå®¢ã€API æœåŠ¡ç­‰è½»é‡çº§åœºæ™¯ã€‚ ç°ä»£åŒ–ç‰¹æ€§ï¼šåŸç”Ÿæ”¯æŒ HTTP/3ã€Wasm æ’ä»¶å’Œè‡ªåŠ¨æ›´æ–°ï¼Œé€‚åˆéœ€è¦å‰æ²¿æŠ€æœ¯çš„é¡¹ç›®ã€‚ è¿ç»´ææ•ˆï¼šå‡å°‘é…ç½®æ–‡ä»¶ç»´æŠ¤æˆæœ¬ï¼Œå°¤å…¶åœ¨å¤šç«™ç‚¹ç®¡ç†ã€è¯ä¹¦è‡ªåŠ¨åŒ–æ–¹é¢ä¼˜åŠ¿æ˜¾è‘—ã€‚ æ³¨æ„ï¼šNginx åœ¨ä¼ä¸šçº§åœºæ™¯ï¼ˆå¦‚é«˜å¹¶å‘åå‘ä»£ç†ã€å¾®æœåŠ¡ç½‘å…³ï¼‰ä¸­ä»å ä¸»å¯¼åœ°ä½ï¼Œå› å…¶ç”Ÿæ€æˆç†Ÿã€ç¤¾åŒºæ–‡æ¡£ä¸°å¯Œã€‚è‹¥é¡¹ç›®éœ€è¦æ·±åº¦å®šåˆ¶æˆ–å¤æ‚è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ŒNginx ä»æ˜¯æ›´ç¨³å¦¥çš„é€‰æ‹©ã€‚\nä¸€ã€åŠ¨æ€é…ç½®ä¸çƒ­æ›´æ–° å®æ—¶é…ç½®æ›´æ–° é€šè¿‡ REST API å¯åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹åŠ¨æ€è°ƒæ•´é…ç½®ï¼Œä¾‹å¦‚æ›´æ–°è·¯ç”±è§„åˆ™æˆ–è¯ä¹¦ï¼š\ncurl -X PUT \"http://localhost:2019/config\" -d @new_config.json æ”¯æŒ JSON å’Œ Caddyfile æ ¼å¼çš„åŠ¨æ€åŠ è½½ã€‚\nåŠ¨æ€ DNS é›†æˆ ç»“åˆ Cloudflareã€AWS ç­‰ DNS æœåŠ¡ï¼Œå®ç°åŸŸåä¸ IP çš„è‡ªåŠ¨åŒæ­¥ï¼š\n{ dynamic example.com { dial_timeout 10s update_interval 10m } } é€‚ç”¨äºåŠ¨æ€ IP ç¯å¢ƒä¸‹çš„æœåŠ¡éƒ¨ç½²ã€‚\näºŒã€åå‘ä»£ç†è¿›é˜¶é…ç½® è´Ÿè½½å‡è¡¡ä¸å¥åº·æ£€æŸ¥ æ”¯æŒè½®è¯¢ï¼ˆRound Robinï¼‰ã€æœ€å°‘è¿æ¥ï¼ˆLeast Connectionsï¼‰ç­‰ç­–ç•¥ï¼Œå¹¶è‡ªåŠ¨å‰”é™¤æ•…éšœèŠ‚ç‚¹ï¼š\nreverse_proxy backend1:8080 backend2:8080 { lb_policy round_robin health_check /health health_interval 15s } é€šè¿‡ health_check å‚æ•°ç›‘æ§åç«¯æœåŠ¡çŠ¶æ€ã€‚\nåè®®è½¬æ¢ä¸ WebSocket æ”¯æŒ è‡ªåŠ¨å¤„ç† HTTP/2 åˆ° HTTP/1.1 çš„åè®®è½¬æ¢ï¼Œå¹¶æ”¯æŒ WebSocket é•¿è¿æ¥ï¼š\nreverse_proxy /ws/* localhost:3000 { transport http { versions h2c 2 } } ç¡®ä¿å®æ—¶é€šä¿¡çš„ç¨³å®šæ€§ã€‚\nè¯·æ±‚å¤´ä¸è·¯å¾„é‡å†™ é€ä¼ å®¢æˆ·ç«¯çœŸå® IP æˆ–é‡å†™è¯·æ±‚è·¯å¾„ï¼š\nreverse_proxy { header_up X-Real-IP {remote_host} strip_prefix /api/v1 } å¸¸ç”¨äºå¾®æœåŠ¡ç½‘å…³åœºæ™¯ã€‚\nä¸‰ã€å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ– é«˜çº§ TLS é…ç½® è‡ªå®šä¹‰è¯ä¹¦æ¥æºæˆ–å¯ç”¨åŠ å¯†å®¢æˆ·ç«¯ Helloï¼ˆECHï¼‰ï¼š\nexample.com { tls { cert_file /path/to/cert.pem key_file /path/to/key.pem ech_enabled } } å¢å¼ºéšç§ä¿æŠ¤å’Œè¯ä¹¦ç®¡ç†çµæ´»æ€§ã€‚\né€Ÿç‡é™åˆ¶ä¸æµé‡æ§åˆ¶ åŸºäº IP æˆ–è¯·æ±‚è·¯å¾„é™åˆ¶è®¿é—®é¢‘ç‡ï¼š\nrate_limit { zone dynamic_zone { key {remote_host} events 10 window 10s } } é˜²æ­¢æ¶æ„è¯·æ±‚æˆ– DDoS æ”»å‡»ã€‚\nç¼“å†²ä¸å¹¶å‘ä¼˜åŒ– é€šè¿‡ç¼“å†²æå‡é«˜å»¶è¿Ÿé“¾è·¯çš„ä¼ è¾“æ•ˆç‡ï¼š\nreverse_proxy { buffer_requests buffer_responses max_buffer_size 4k flush_interval 1s } å‡å°‘åç«¯æœåŠ¡å› å®¢æˆ·ç«¯ç½‘ç»œæ³¢åŠ¨å¯¼è‡´çš„é˜»å¡ã€‚\nå››ã€æ’ä»¶ä¸ç”Ÿæ€æ‰©å±• æ’ä»¶åŒ–æ‰©å±• å®‰è£…ç¬¬ä¸‰æ–¹æ’ä»¶å®ç° JWT é‰´æƒã€Prometheus ç›‘æ§ç­‰åŠŸèƒ½ï¼š\ncaddy install --source github.com/caddy-dns/cloudflare æ”¯æŒè‡ªå®šä¹‰æ¨¡å—å¼€å‘ã€‚\næ—¥å¿—ä¸ç›‘æ§é›†æˆ è¾“å‡ºç»“æ„åŒ–æ—¥å¿—å¹¶é›†æˆ Prometheusï¼š\nlog { output file /var/log/caddy/access.log format json } prometheus { push { endpoint \"http://localhost:9090\" } } ä¾¿äºè¿ç»´åˆ†æä¸æŠ¥è­¦ã€‚\näº”ã€å®¹å™¨åŒ–ä¸è¾¹ç¼˜è®¡ç®— è½»é‡åŒ–å®¹å™¨éƒ¨ç½² é€šè¿‡ Docker å¿«é€Ÿéƒ¨ç½²å¹¶æŒ‚è½½é…ç½®ï¼š\ndocker run -p 80:80 -v ./Caddyfile:/etc/caddy/Caddyfile caddy é€‚ç”¨äºäº‘åŸç”Ÿå’Œè¾¹ç¼˜è®¡ç®—åœºæ™¯ã€‚\nå¤šå®ä¾‹é›†ç¾¤ç®¡ç† åˆ©ç”¨ API åè°ƒå¤šä¸ª Caddy å®ä¾‹ï¼Œå®ç°è¯ä¹¦é›†ä¸­ç®¡ç†å’Œé…ç½®åŒæ­¥ã€‚\né€šè¿‡ä¸Šè¿°é«˜çº§åŠŸèƒ½ï¼ŒCaddy å¯æ»¡è¶³ä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒä¸­å¯¹å®‰å…¨æ€§ã€æ€§èƒ½åŠçµæ´»æ€§çš„å¤æ‚éœ€æ±‚ã€‚\ncaddy ç»‘å®šç›®å½• Caddy æŠŠå¤–ç½‘åŸŸå w1.a.com å’Œ w2.a.com åå‘ä»£ç†åˆ°åŒä¸€ä¸ªå†…ç½‘æœåŠ¡ å†…ç½‘1:999ï¼Œ å¹¶ä¸” w2.a.com è¦ä»£ç†åˆ° å†…ç½‘1:999/com1 ï¼ˆä¹Ÿå°±æ˜¯åŒä¸€ä¸ªåç«¯æœåŠ¡ä¸‹çš„ /com1 è·¯å¾„ï¼‰ã€‚\nCaddyfile\n# é…ç½® w1.a.com -\u003e http://å†…ç½‘1:999 w1.a.com { reverse_proxy å†…ç½‘1:999 } # é…ç½® w2.a.com -\u003e http://å†…ç½‘1:999/com1 w2.a.com { handle_path /* { uri strip_prefix / reverse_proxy å†…ç½‘1:999/com1 } } reverse_proxy å†…ç½‘1:999 æŠŠè¯·æ±‚ç›´æ¥è½¬å‘åˆ°å†…ç½‘æœåŠ¡çš„ 999 ç«¯å£ã€‚\nhandle_path + uri strip_prefix / æ˜¯ä¸ºäº†ç¡®ä¿ç”¨æˆ·è®¿é—® http://w2.a.com/xxx æ—¶ï¼Œè½¬å‘åˆ° http://å†…ç½‘1:999/com1/xxxã€‚ strip_prefix å»æ‰åŸŸååçš„å‰ç¼€ /ï¼Œå†æ‹¼åˆ°åç«¯è·¯å¾„ã€‚\nâš ï¸ æ³¨æ„ç‚¹ âœ… å¦‚æœåç«¯æ˜¯ HTTPï¼Œè¯·å†™ http://å†…ç½‘1:999ï¼Œ âœ… å¦‚æœåç«¯æ˜¯ HTTPSï¼Œè¦ç”¨ https:// å¹¶æ³¨æ„è¯ä¹¦æ˜¯å¦è‡ªç­¾åã€‚\nğŸš© å®Œæ•´ä¾‹å­ï¼ˆå¸¦åè®®ï¼‰ï¼š caddyfile\nw1.a.com { reverse_proxy http://192.168.1.100:999 } w2.a.com { handle_path /* { uri strip_prefix / reverse_proxy http://192.168.1.100:999/com1 } } ä½¿ç”¨ caddy reload çƒ­æ›´æ–° caddy reload --config /path/to/Caddyfile Authentication Caddy è‡ªå¸¦ Basic Authenticationï¼ˆåŸºæœ¬è®¤è¯ï¼‰ï¼Œé…ç½®éå¸¸ç®€å•ã€‚\n1. åˆ›å»ºå·¥ä½œç›®å½• mkdir caddy-test cd caddy-test 2. åˆ›å»º index.html æµ‹è¯•é¡µé¢ echo \"Hello Caddy!\" \u003e index.html 3. ç”Ÿæˆ Caddy å¯†ç å“ˆå¸Œ Caddy è¦æ±‚ BasicAuth ä½¿ç”¨ bcrypt å“ˆå¸Œã€‚\ndocker run --rm caddy caddy hash-password --plaintext \"123123\" å‡è®¾è¿”å›ç»“æœï¼š\n$2a$14$e5BY1Go8WI2jk/wv.jSUTunNdRRnZLc29y1VxpdMQK9prN16D/PVq\nè¿™ä¸ªå°±æ˜¯è¦å†™è¿›é…ç½®çš„å“ˆå¸Œå¯†ç ã€‚\n4. åˆ›å»º Caddyfile åœ¨ caddy-test ç›®å½•åˆ›å»º Caddyfileï¼š\n:80 { root * /srv file_server basicauth /* { # ç”¨æˆ·å adminï¼Œåé¢æ˜¯ä¸Šä¸€æ­¥ç”Ÿæˆçš„å“ˆå¸Œ admin $2a$14$e5BY1Go8WI2jk/wv.jSUTunNdRRnZLc29y1VxpdMQK9prN16D/PVq } } 5. è¿è¡Œ Caddy å®¹å™¨ docker run -d \\ --name caddy-test \\ -p 8080:80 \\ -v $(pwd)/Caddyfile:/etc/caddy/Caddyfile \\ -v $(pwd):/srv \\ caddy 6. æµ‹è¯•è®¿é—® æµè§ˆå™¨æ‰“å¼€ http://localhost:8080\nä¼šæç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼ˆä¸Šé¢é…ç½®çš„ admin + 123123ï¼‰ã€‚\n7. è¡¥å…… å¦‚æœè¦ç”¨ HTTPSï¼Œå¯ä»¥ç›´æ¥æ”¹æˆï¼š\nexample.com { root * /srv file_server basicauth /* { admin $2a$14$ABCxyz... } } ç„¶åè§£æåŸŸååˆ°æœåŠ¡å™¨ï¼ŒCaddy ä¼šè‡ªåŠ¨ç”³è¯· Letâ€™s Encrypt è¯ä¹¦ã€‚\n","wordCount":"762","inLanguage":"en","datePublished":"2025-05-23T00:21:01+08:00","dateModified":"2025-05-23T00:21:01+08:00","author":{"@type":"Person","name":"dwd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://qfsyso.github.io/posts/caddy/"},"publisher":{"@type":"Organization","name":"MLOG","logo":{"@type":"ImageObject","url":"https://qfsyso.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://qfsyso.github.io/ accesskey=h title="MLOG (Alt + H)">MLOG</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://qfsyso.github.io/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://qfsyso.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://qfsyso.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Caddy</h1><div class=post-meta><span title='2025-05-23 00:21:01 +0800 +0800'>May 23, 2025</span>&nbsp;Â·&nbsp;4 min&nbsp;Â·&nbsp;dwd</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#debian-%e7%b3%bb%e7%bb%9f%e9%83%a8%e7%bd%b2-caddy-web-%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%9a%84%e8%af%a6%e7%bb%86%e6%8c%87%e5%8d%97 aria-label="Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å—">Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å—</a><ul><li><a href=#%e4%b8%80%e5%ae%89%e8%a3%85%e6%96%b9%e6%b3%95 aria-label=ä¸€ã€å®‰è£…æ–¹æ³•>ä¸€ã€å®‰è£…æ–¹æ³•</a><ul><li><a href=#apt-%e5%ad%98%e5%82%a8%e5%ba%93%e5%ae%89%e8%a3%85%e6%8e%a8%e8%8d%90 aria-label="APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰">APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰</a></li><li><a href=#%e5%bf%ab%e9%80%9f%e8%84%9a%e6%9c%ac%e5%ae%89%e8%a3%85 aria-label=å¿«é€Ÿè„šæœ¬å®‰è£…>å¿«é€Ÿè„šæœ¬å®‰è£…</a></li></ul></li><li><a href=#%e4%ba%8c%e6%9c%8d%e5%8a%a1%e7%ae%a1%e7%90%86 aria-label=äºŒã€æœåŠ¡ç®¡ç†>äºŒã€æœåŠ¡ç®¡ç†</a></li><li><a href=#%e4%b8%89%e9%85%8d%e7%bd%ae-https aria-label="ä¸‰ã€é…ç½® HTTPS">ä¸‰ã€é…ç½® HTTPS</a></li><li><a href=#%e5%9b%9b%e9%ab%98%e7%ba%a7%e5%8a%9f%e8%83%bd aria-label=å››ã€é«˜çº§åŠŸèƒ½>å››ã€é«˜çº§åŠŸèƒ½</a><ul><li><a href=#%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86 aria-label=åå‘ä»£ç†>åå‘ä»£ç†</a></li><li><a href=#%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96 aria-label=æ€§èƒ½ä¼˜åŒ–>æ€§èƒ½ä¼˜åŒ–</a></li></ul></li><li><a href=#%e4%ba%94%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 aria-label=äº”ã€æ³¨æ„äº‹é¡¹>äº”ã€æ³¨æ„äº‹é¡¹</a></li><li><a href=#caddy-%e5%af%b9%e6%af%94-nginx-%e7%9a%84%e4%b8%bb%e8%a6%81%e4%bc%98%e5%8a%bf%e5%88%86%e6%9e%90 aria-label="Caddy å¯¹æ¯” Nginx çš„ä¸»è¦ä¼˜åŠ¿åˆ†æ">Caddy å¯¹æ¯” Nginx çš„ä¸»è¦ä¼˜åŠ¿åˆ†æ</a><ul><li><a href=#%e4%b8%80%e9%85%8d%e7%bd%ae%e7%ae%80%e5%8d%95%e5%ad%a6%e4%b9%a0%e6%88%90%e6%9c%ac%e4%bd%8e aria-label=ä¸€ã€é…ç½®ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½>ä¸€ã€é…ç½®ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½</a><ul><li><a href=#nginx aria-label=Nginx>Nginx</a></li><li><a href=#caddy aria-label=Caddy>Caddy</a></li></ul></li><li><a href=#%e4%ba%8c%e8%87%aa%e5%8a%a8%e5%8c%96%e4%b8%8e%e5%86%85%e7%bd%ae%e5%8a%9f%e8%83%bd%e4%b8%b0%e5%af%8c aria-label=äºŒã€è‡ªåŠ¨åŒ–ä¸å†…ç½®åŠŸèƒ½ä¸°å¯Œ>äºŒã€è‡ªåŠ¨åŒ–ä¸å†…ç½®åŠŸèƒ½ä¸°å¯Œ</a><ul><li><a href=#nginx-1 aria-label=Nginx>Nginx</a></li><li><a href=#caddy-1 aria-label=Caddy>Caddy</a></li></ul></li><li><a href=#%e4%b8%89%e7%8e%b0%e4%bb%a3%e5%8c%96%e5%8d%8f%e8%ae%ae%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96 aria-label=ä¸‰ã€ç°ä»£åŒ–åè®®ä¸æ€§èƒ½ä¼˜åŒ–>ä¸‰ã€ç°ä»£åŒ–åè®®ä¸æ€§èƒ½ä¼˜åŒ–</a><ul><li><a href=#nginx-2 aria-label=Nginx>Nginx</a></li><li><a href=#caddy-2 aria-label=Caddy>Caddy</a></li></ul></li><li><a href=#%e5%9b%9b%e9%83%a8%e7%bd%b2%e4%b8%8e%e6%9b%b4%e6%96%b0%e4%be%bf%e6%8d%b7%e6%80%a7 aria-label=å››ã€éƒ¨ç½²ä¸æ›´æ–°ä¾¿æ·æ€§>å››ã€éƒ¨ç½²ä¸æ›´æ–°ä¾¿æ·æ€§</a><ul><li><a href=#nginx-3 aria-label=Nginx>Nginx</a></li><li><a href=#caddy-3 aria-label=Caddy>Caddy</a></li></ul></li><li><a href=#%e4%ba%94%e9%80%82%e7%94%a8%e5%9c%ba%e6%99%af%e5%af%b9%e6%af%94 aria-label=äº”ã€é€‚ç”¨åœºæ™¯å¯¹æ¯”>äº”ã€é€‚ç”¨åœºæ™¯å¯¹æ¯”</a></li><li><a href=#%e6%80%bb%e7%bb%93caddy-%e7%9a%84%e6%a0%b8%e5%bf%83%e4%bc%98%e5%8a%bf aria-label="æ€»ç»“ï¼šCaddy çš„æ ¸å¿ƒä¼˜åŠ¿">æ€»ç»“ï¼šCaddy çš„æ ¸å¿ƒä¼˜åŠ¿</a></li></ul></li><li><a href=#%e4%b8%80%e5%8a%a8%e6%80%81%e9%85%8d%e7%bd%ae%e4%b8%8e%e7%83%ad%e6%9b%b4%e6%96%b0 aria-label=ä¸€ã€åŠ¨æ€é…ç½®ä¸çƒ­æ›´æ–°>ä¸€ã€åŠ¨æ€é…ç½®ä¸çƒ­æ›´æ–°</a><ul><li><a href=#%e5%ae%9e%e6%97%b6%e9%85%8d%e7%bd%ae%e6%9b%b4%e6%96%b0 aria-label=å®æ—¶é…ç½®æ›´æ–°>å®æ—¶é…ç½®æ›´æ–°</a></li><li><a href=#%e5%8a%a8%e6%80%81-dns-%e9%9b%86%e6%88%90 aria-label="åŠ¨æ€ DNS é›†æˆ">åŠ¨æ€ DNS é›†æˆ</a></li></ul></li><li><a href=#%e4%ba%8c%e5%8f%8d%e5%90%91%e4%bb%a3%e7%90%86%e8%bf%9b%e9%98%b6%e9%85%8d%e7%bd%ae aria-label=äºŒã€åå‘ä»£ç†è¿›é˜¶é…ç½®>äºŒã€åå‘ä»£ç†è¿›é˜¶é…ç½®</a><ul><li><a href=#%e8%b4%9f%e8%bd%bd%e5%9d%87%e8%a1%a1%e4%b8%8e%e5%81%a5%e5%ba%b7%e6%a3%80%e6%9f%a5 aria-label=è´Ÿè½½å‡è¡¡ä¸å¥åº·æ£€æŸ¥>è´Ÿè½½å‡è¡¡ä¸å¥åº·æ£€æŸ¥</a></li><li><a href=#%e5%8d%8f%e8%ae%ae%e8%bd%ac%e6%8d%a2%e4%b8%8e-websocket-%e6%94%af%e6%8c%81 aria-label="åè®®è½¬æ¢ä¸ WebSocket æ”¯æŒ">åè®®è½¬æ¢ä¸ WebSocket æ”¯æŒ</a></li><li><a href=#%e8%af%b7%e6%b1%82%e5%a4%b4%e4%b8%8e%e8%b7%af%e5%be%84%e9%87%8d%e5%86%99 aria-label=è¯·æ±‚å¤´ä¸è·¯å¾„é‡å†™>è¯·æ±‚å¤´ä¸è·¯å¾„é‡å†™</a></li></ul></li><li><a href=#%e4%b8%89%e5%ae%89%e5%85%a8%e4%b8%8e%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96 aria-label=ä¸‰ã€å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–>ä¸‰ã€å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–</a><ul><li><a href=#%e9%ab%98%e7%ba%a7-tls-%e9%85%8d%e7%bd%ae aria-label="é«˜çº§ TLS é…ç½®">é«˜çº§ TLS é…ç½®</a></li><li><a href=#%e9%80%9f%e7%8e%87%e9%99%90%e5%88%b6%e4%b8%8e%e6%b5%81%e9%87%8f%e6%8e%a7%e5%88%b6 aria-label=é€Ÿç‡é™åˆ¶ä¸æµé‡æ§åˆ¶>é€Ÿç‡é™åˆ¶ä¸æµé‡æ§åˆ¶</a></li><li><a href=#%e7%bc%93%e5%86%b2%e4%b8%8e%e5%b9%b6%e5%8f%91%e4%bc%98%e5%8c%96 aria-label=ç¼“å†²ä¸å¹¶å‘ä¼˜åŒ–>ç¼“å†²ä¸å¹¶å‘ä¼˜åŒ–</a></li></ul></li><li><a href=#%e5%9b%9b%e6%8f%92%e4%bb%b6%e4%b8%8e%e7%94%9f%e6%80%81%e6%89%a9%e5%b1%95 aria-label=å››ã€æ’ä»¶ä¸ç”Ÿæ€æ‰©å±•>å››ã€æ’ä»¶ä¸ç”Ÿæ€æ‰©å±•</a><ul><li><a href=#%e6%8f%92%e4%bb%b6%e5%8c%96%e6%89%a9%e5%b1%95 aria-label=æ’ä»¶åŒ–æ‰©å±•>æ’ä»¶åŒ–æ‰©å±•</a></li><li><a href=#%e6%97%a5%e5%bf%97%e4%b8%8e%e7%9b%91%e6%8e%a7%e9%9b%86%e6%88%90 aria-label=æ—¥å¿—ä¸ç›‘æ§é›†æˆ>æ—¥å¿—ä¸ç›‘æ§é›†æˆ</a></li></ul></li><li><a href=#%e4%ba%94%e5%ae%b9%e5%99%a8%e5%8c%96%e4%b8%8e%e8%be%b9%e7%bc%98%e8%ae%a1%e7%ae%97 aria-label=äº”ã€å®¹å™¨åŒ–ä¸è¾¹ç¼˜è®¡ç®—>äº”ã€å®¹å™¨åŒ–ä¸è¾¹ç¼˜è®¡ç®—</a><ul><li><a href=#%e8%bd%bb%e9%87%8f%e5%8c%96%e5%ae%b9%e5%99%a8%e9%83%a8%e7%bd%b2 aria-label=è½»é‡åŒ–å®¹å™¨éƒ¨ç½²>è½»é‡åŒ–å®¹å™¨éƒ¨ç½²</a></li><li><a href=#%e5%a4%9a%e5%ae%9e%e4%be%8b%e9%9b%86%e7%be%a4%e7%ae%a1%e7%90%86 aria-label=å¤šå®ä¾‹é›†ç¾¤ç®¡ç†>å¤šå®ä¾‹é›†ç¾¤ç®¡ç†</a></li></ul></li><li><a href=#caddy-%e7%bb%91%e5%ae%9a%e7%9b%ae%e5%bd%95 aria-label="caddy ç»‘å®šç›®å½•">caddy ç»‘å®šç›®å½•</a><ul><li><a href=#%e4%bd%bf%e7%94%a8-caddy-reload-%e7%83%ad%e6%9b%b4%e6%96%b0 aria-label="ä½¿ç”¨ caddy reload çƒ­æ›´æ–°">ä½¿ç”¨ caddy reload çƒ­æ›´æ–°</a></li></ul></li></ul></li><li><a href=#authentication aria-label=Authentication>Authentication</a><ul><li><a href=#1-%e5%88%9b%e5%bb%ba%e5%b7%a5%e4%bd%9c%e7%9b%ae%e5%bd%95 aria-label="1. åˆ›å»ºå·¥ä½œç›®å½•">1. åˆ›å»ºå·¥ä½œç›®å½•</a></li><li><a href=#2-%e5%88%9b%e5%bb%ba-indexhtml-%e6%b5%8b%e8%af%95%e9%a1%b5%e9%9d%a2 aria-label="2. åˆ›å»º index.html æµ‹è¯•é¡µé¢">2. åˆ›å»º index.html æµ‹è¯•é¡µé¢</a></li><li><a href=#3-%e7%94%9f%e6%88%90-caddy-%e5%af%86%e7%a0%81%e5%93%88%e5%b8%8c aria-label="3. ç”Ÿæˆ Caddy å¯†ç å“ˆå¸Œ">3. ç”Ÿæˆ Caddy å¯†ç å“ˆå¸Œ</a></li><li><a href=#4-%e5%88%9b%e5%bb%ba-caddyfile aria-label="4. åˆ›å»º Caddyfile">4. åˆ›å»º Caddyfile</a></li><li><a href=#5-%e8%bf%90%e8%a1%8c-caddy-%e5%ae%b9%e5%99%a8 aria-label="5. è¿è¡Œ Caddy å®¹å™¨">5. è¿è¡Œ Caddy å®¹å™¨</a></li><li><a href=#6-%e6%b5%8b%e8%af%95%e8%ae%bf%e9%97%ae aria-label="6. æµ‹è¯•è®¿é—®">6. æµ‹è¯•è®¿é—®</a></li><li><a href=#7-%e8%a1%a5%e5%85%85 aria-label="7. è¡¥å……">7. è¡¥å……</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=debian-ç³»ç»Ÿéƒ¨ç½²-caddy-web-æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å—>Debian ç³»ç»Ÿéƒ¨ç½² Caddy Web æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å—<a hidden class=anchor aria-hidden=true href=#debian-ç³»ç»Ÿéƒ¨ç½²-caddy-web-æœåŠ¡å™¨çš„è¯¦ç»†æŒ‡å—>#</a></h1><p>æœ¬æ–‡æ¡£æä¾›äº†åœ¨ Debian ç³»ç»Ÿä¸Šå®‰è£…å’Œé…ç½® Caddy Web æœåŠ¡å™¨çš„æ­¥éª¤ï¼ŒåŒ…æ‹¬å¤šç§å®‰è£…æ–¹æ³•ã€æœåŠ¡ç®¡ç†ã€HTTPS é…ç½®ã€é«˜çº§åŠŸèƒ½ä»¥åŠæ³¨æ„äº‹é¡¹ã€‚æ­¤å¤–ï¼Œè¿˜å¯¹æ¯”äº† Caddy ä¸ Nginx çš„ä¸»è¦ä¼˜åŠ¿ï¼Œå¹¶ä»‹ç»äº† Caddy çš„ä¸€äº›é«˜çº§ç‰¹æ€§ã€‚</p><h2 id=ä¸€å®‰è£…æ–¹æ³•>ä¸€ã€å®‰è£…æ–¹æ³•<a hidden class=anchor aria-hidden=true href=#ä¸€å®‰è£…æ–¹æ³•>#</a></h2><h3 id=apt-å­˜å‚¨åº“å®‰è£…æ¨è>APT å­˜å‚¨åº“å®‰è£…ï¼ˆæ¨èï¼‰<a hidden class=anchor aria-hidden=true href=#apt-å­˜å‚¨åº“å®‰è£…æ¨è>#</a></h3><ol><li><p><strong>æ›´æ–°ç³»ç»Ÿ</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt upgrade -y
</span></span></code></pre></div></li><li><p><strong>æ·»åŠ å¯†é’¥å’Œå­˜å‚¨åº“</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt install -y debian-archive-keyring apt-transport-https curl
</span></span><span style=display:flex><span>curl -1sLf <span style=color:#e6db74>&#39;https://dl.cloudsmith.io/public/caddy/stable/gpg.key&#39;</span> | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg
</span></span><span style=display:flex><span>curl -1sLf <span style=color:#e6db74>&#39;https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt&#39;</span> | sudo tee /etc/apt/sources.list.d/caddy-stable.list
</span></span></code></pre></div></li><li><p><strong>å®‰è£… Caddy</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt install caddy
</span></span></code></pre></div></li></ol><h3 id=å¿«é€Ÿè„šæœ¬å®‰è£…>å¿«é€Ÿè„šæœ¬å®‰è£…<a hidden class=anchor aria-hidden=true href=#å¿«é€Ÿè„šæœ¬å®‰è£…>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl https://getcaddy.com | bash -s personal http.filemanager
</span></span></code></pre></div><ul><li><code>-s</code> å‚æ•°æ”¯æŒæ’ä»¶æ‰©å±•ï¼ˆå¦‚ <code>http.filemanager</code> æ–‡ä»¶ç®¡ç†æ’ä»¶ï¼‰</li><li>å•†ä¸šç”¨é€”éœ€è´­ä¹°è®¸å¯è¯</li></ul><p>or</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -fsSL https://get.caddyserver.com | bash -s personal
</span></span></code></pre></div><p>éªŒè¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caddy version
</span></span></code></pre></div><h2 id=äºŒæœåŠ¡ç®¡ç†>äºŒã€æœåŠ¡ç®¡ç†<a hidden class=anchor aria-hidden=true href=#äºŒæœåŠ¡ç®¡ç†>#</a></h2><ol><li><p><strong>å¯åŠ¨å¹¶è®¾ç½®å¼€æœºè‡ªå¯</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl enable --now caddy
</span></span></code></pre></div></li><li><p><strong>å¸¸ç”¨å‘½ä»¤</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl status caddy    <span style=color:#75715e># æŸ¥çœ‹çŠ¶æ€</span>
</span></span><span style=display:flex><span>sudo journalctl -u caddy -f    <span style=color:#75715e># æŸ¥çœ‹å®æ—¶æ—¥å¿—</span>
</span></span></code></pre></div></li></ol><h2 id=ä¸‰é…ç½®-https>ä¸‰ã€é…ç½® HTTPS<a hidden class=anchor aria-hidden=true href=#ä¸‰é…ç½®-https>#</a></h2><p>Caddy è‡ªåŠ¨å¯ç”¨ HTTPSï¼Œåªéœ€åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šåŸŸåï¼š</p><ol><li><p><strong>ç¼–è¾‘é…ç½®æ–‡ä»¶</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo nano /etc/caddy/Caddyfile
</span></span></code></pre></div></li><li><p><strong>ç¤ºä¾‹é…ç½®</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>ok.example.com {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>root</span> <span style=color:#a6e22e>*</span> <span style=color:#e6db74>/var/www/html</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>file_server</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>tls</span> <span style=color:#e6db74>your_email@example.com</span><span style=color:#75715e>  # è‡ªåŠ¨ç”³è¯· Let&#39;s Encrypt è¯ä¹¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div></li><li><p><strong>é‡å¯æœåŠ¡ç”Ÿæ•ˆ</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo systemctl restart caddy
</span></span></code></pre></div></li></ol><h2 id=å››é«˜çº§åŠŸèƒ½>å››ã€é«˜çº§åŠŸèƒ½<a hidden class=anchor aria-hidden=true href=#å››é«˜çº§åŠŸèƒ½>#</a></h2><h3 id=åå‘ä»£ç†>åå‘ä»£ç†<a hidden class=anchor aria-hidden=true href=#åå‘ä»£ç†>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>api.example.com {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>reverse_proxy</span> localhost:<span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>header_up</span> <span style=color:#e6db74>X-Real-IP</span> <span style=color:#ae81ff>{remote_host}</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=æ€§èƒ½ä¼˜åŒ–>æ€§èƒ½ä¼˜åŒ–<a hidden class=anchor aria-hidden=true href=#æ€§èƒ½ä¼˜åŒ–>#</a></h3><ul><li>æ·»åŠ  <code>-quic</code> å‚æ•°å¯ç”¨ HTTP/3ï¼ˆéœ€åœ¨ <code>caddy.service</code> ä¸­ä¿®æ”¹å¯åŠ¨å‚æ•°ï¼‰</li><li>å¼€æ”¾ UDP 443 ç«¯å£</li></ul><h2 id=äº”æ³¨æ„äº‹é¡¹>äº”ã€æ³¨æ„äº‹é¡¹<a hidden class=anchor aria-hidden=true href=#äº”æ³¨æ„äº‹é¡¹>#</a></h2><ol><li><p><strong>é˜²ç«å¢™éœ€æ”¾è¡Œ 80/443 ç«¯å£</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo ufw allow 80,443/tcp <span style=color:#f92672>&amp;&amp;</span> sudo ufw reload
</span></span></code></pre></div></li><li><p><strong>è‹¥ä½¿ç”¨æœ¬åœ°æµ‹è¯•ï¼Œæµè§ˆå™¨å¯èƒ½æç¤ºè‡ªç­¾åè¯ä¹¦é£é™©ï¼Œéœ€æ‰‹åŠ¨ä¿¡ä»»</strong></p></li><li><p><strong>é…ç½®æ–‡ä»¶è¯­æ³•éªŒè¯</strong>ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo caddy validate --config /etc/caddy/Caddyfile
</span></span></code></pre></div></li></ol><p>é€šè¿‡ä¸Šè¿°æ­¥éª¤ï¼Œæ‚¨å¯ä»¥åœ¨ Debian ç³»ç»Ÿä¸Šå¿«é€Ÿéƒ¨ç½²æ”¯æŒè‡ªåŠ¨ HTTPSã€åå‘ä»£ç†ç­‰åŠŸèƒ½çš„ Caddy æœåŠ¡å™¨ã€‚</p><h2 id=caddy-å¯¹æ¯”-nginx-çš„ä¸»è¦ä¼˜åŠ¿åˆ†æ>Caddy å¯¹æ¯” Nginx çš„ä¸»è¦ä¼˜åŠ¿åˆ†æ<a hidden class=anchor aria-hidden=true href=#caddy-å¯¹æ¯”-nginx-çš„ä¸»è¦ä¼˜åŠ¿åˆ†æ>#</a></h2><h3 id=ä¸€é…ç½®ç®€å•å­¦ä¹ æˆæœ¬ä½>ä¸€ã€é…ç½®ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½<a hidden class=anchor aria-hidden=true href=#ä¸€é…ç½®ç®€å•å­¦ä¹ æˆæœ¬ä½>#</a></h3><h4 id=nginx>Nginx<a hidden class=anchor aria-hidden=true href=#nginx>#</a></h4><ul><li>ä¾èµ–çº¯æ–‡æœ¬é…ç½®æ–‡ä»¶ï¼ˆ.confï¼‰ï¼Œè¯­æ³•è§„åˆ™ä¸¥æ ¼ï¼Œéœ€æ‰‹åŠ¨ç¼–å†™åå‘ä»£ç†ã€SSL è¯ä¹¦é…ç½®ç­‰å¤æ‚é€»è¾‘ï¼Œå¯¹æ–°æ‰‹ä¸å¤Ÿå‹å¥½ã€‚</li><li>é…ç½® HTTPS éœ€æ‰‹åŠ¨ç”³è¯·è¯ä¹¦å¹¶ç»‘å®šè·¯å¾„ï¼Œè¿‡ç¨‹ç¹çã€‚</li></ul><h4 id=caddy>Caddy<a hidden class=anchor aria-hidden=true href=#caddy>#</a></h4><ul><li>å£°æ˜å¼é…ç½®ï¼šä½¿ç”¨æ›´ç®€æ´çš„ Caddyfile è¯­æ³•ï¼Œå†…ç½®å¸¸ç”¨åŠŸèƒ½ï¼ˆå¦‚åå‘ä»£ç†ã€HTTPSï¼‰çš„é»˜è®¤è§„åˆ™ï¼Œä»£ç é‡å¯å‡å°‘ 50% ä»¥ä¸Šã€‚</li><li>ç¤ºä¾‹å¯¹æ¯”ï¼š<ul><li><strong>Nginx é…ç½® HTTPS åå‘ä»£ç†</strong>ï¼š<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=display:flex><span><span style=color:#66d9ef>server</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>listen</span> <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>server_name</span> <span style=color:#e6db74>example.com</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate</span> <span style=color:#e6db74>/path/to/cert.pem</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>ssl_certificate_key</span> <span style=color:#e6db74>/path/to/key.pem</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
</span></span><span style=display:flex><span>        <span style=color:#f92672>proxy_pass</span> <span style=color:#e6db74>http://localhost:8080</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><strong>Caddy åŒç­‰åŠŸèƒ½é…ç½®</strong>ï¼š<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>example.com {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>reverse_proxy</span> localhost:<span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div>ï¼ˆCaddy ä¼šè‡ªåŠ¨ç”³è¯·å¹¶ç®¡ç† SSL è¯ä¹¦ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®è¯ä¹¦è·¯å¾„ï¼‰</li></ul></li><li>è‡ªåŠ¨ HTTPSï¼šå†…ç½® ACME å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Letâ€™s Encrypt è¯ä¹¦è‡ªåŠ¨ç”³è¯·ã€ç»­ç­¾å’Œç®¡ç†ï¼Œæ— éœ€é¢å¤–å·¥å…·ï¼ˆå¦‚ Certbotï¼‰ã€‚</li></ul><h3 id=äºŒè‡ªåŠ¨åŒ–ä¸å†…ç½®åŠŸèƒ½ä¸°å¯Œ>äºŒã€è‡ªåŠ¨åŒ–ä¸å†…ç½®åŠŸèƒ½ä¸°å¯Œ<a hidden class=anchor aria-hidden=true href=#äºŒè‡ªåŠ¨åŒ–ä¸å†…ç½®åŠŸèƒ½ä¸°å¯Œ>#</a></h3><h4 id=nginx-1>Nginx<a hidden class=anchor aria-hidden=true href=#nginx-1>#</a></h4><ul><li>æ ¸å¿ƒåŠŸèƒ½ç®€æ´ï¼Œéœ€é€šè¿‡ç¬¬ä¸‰æ–¹æ¨¡å—ï¼ˆå¦‚ ngx_http_ssl_moduleã€ngx_http_proxy_moduleï¼‰æ‰©å±•åŠŸèƒ½ï¼Œé…ç½®å¤æ‚ä¸”å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚</li></ul><h4 id=caddy-1>Caddy<a hidden class=anchor aria-hidden=true href=#caddy-1>#</a></h4><ul><li>å†…ç½®åŠŸèƒ½å¼€ç®±å³ç”¨ï¼šè‡ªåŠ¨ HTTPSã€HTTP/2/3 æ”¯æŒã€åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡ã€WebSocketsã€é™æ€æ–‡ä»¶æœåŠ¡ã€Gzip å‹ç¼©ã€æ—¥å¿—è®°å½•ç­‰åŠŸèƒ½å‡ä¸ºå†…ç½®ï¼Œæ— éœ€æ‰‹åŠ¨å¯ç”¨æ¨¡å—ã€‚</li><li>æ”¯æŒå®æ—¶é‡è½½é…ç½®ï¼ˆä¿®æ”¹ Caddyfile åè‡ªåŠ¨ç”Ÿæ•ˆï¼Œæ— éœ€æ‰‹åŠ¨æ‰§è¡Œ <code>nginx -s reload</code>ï¼‰ã€‚</li><li>ç”Ÿæ€æ’ä»¶çµæ´»ï¼šé€šè¿‡ Go è¯­è¨€æ’ä»¶æœºåˆ¶ï¼ˆå¦‚ <code>caddy plugin</code> å‘½ä»¤ï¼‰æˆ–ç›´æ¥åœ¨ Caddyfile ä¸­å£°æ˜ï¼ˆå¦‚ <code>import</code> æŒ‡ä»¤ï¼‰æ‰©å±•åŠŸèƒ½ï¼Œæ— éœ€ç¼–è¯‘æºç ã€‚</li></ul><h3 id=ä¸‰ç°ä»£åŒ–åè®®ä¸æ€§èƒ½ä¼˜åŒ–>ä¸‰ã€ç°ä»£åŒ–åè®®ä¸æ€§èƒ½ä¼˜åŒ–<a hidden class=anchor aria-hidden=true href=#ä¸‰ç°ä»£åŒ–åè®®ä¸æ€§èƒ½ä¼˜åŒ–>#</a></h3><h4 id=nginx-2>Nginx<a hidden class=anchor aria-hidden=true href=#nginx-2>#</a></h4><ul><li>å¯¹ HTTP/3ï¼ˆQUICï¼‰çš„æ”¯æŒéœ€ç¼–è¯‘æ—¶å¯ç”¨ <code>ngx_http_v3_module</code>ï¼Œä¸”é…ç½®è¾ƒå¤æ‚ï¼›å¯¹ WebAssemblyï¼ˆWasmï¼‰ç­‰æ–°å…´æŠ€æœ¯æ”¯æŒæœ‰é™ã€‚</li></ul><h4 id=caddy-2>Caddy<a hidden class=anchor aria-hidden=true href=#caddy-2>#</a></h4><ul><li>åŸç”Ÿæ”¯æŒ HTTP/3ï¼šé»˜è®¤å¯ç”¨å¯¹ QUIC åè®®çš„æ”¯æŒï¼Œæå‡ç§»åŠ¨ç«¯å’Œé«˜å»¶è¿Ÿç½‘ç»œçš„è®¿é—®é€Ÿåº¦ã€‚</li><li>Wasm æ’ä»¶ç”Ÿæ€ï¼šå¯é€šè¿‡ Wasm æ’ä»¶å®ç°è‡ªå®šä¹‰é€»è¾‘ï¼ˆå¦‚èº«ä»½éªŒè¯ã€æµé‡è¿‡æ»¤ï¼‰ï¼Œæ— éœ€ä¿®æ”¹ Caddy æ ¸å¿ƒä»£ç ï¼Œçµæ´»æ€§æ›´é«˜ã€‚</li><li>å†…å­˜å ç”¨ä¼˜åŒ–ï¼šåœ¨è½»é‡çº§åœºæ™¯ä¸‹ï¼ˆå¦‚å•æœåŠ¡å™¨ä»£ç†ï¼‰ï¼Œå†…å­˜æ¶ˆè€—å¯èƒ½ä½äº Nginxï¼ˆå…·ä½“å–å†³äºè´Ÿè½½å’Œé…ç½®ï¼‰ã€‚</li></ul><h3 id=å››éƒ¨ç½²ä¸æ›´æ–°ä¾¿æ·æ€§>å››ã€éƒ¨ç½²ä¸æ›´æ–°ä¾¿æ·æ€§<a hidden class=anchor aria-hidden=true href=#å››éƒ¨ç½²ä¸æ›´æ–°ä¾¿æ·æ€§>#</a></h3><h4 id=nginx-3>Nginx<a hidden class=anchor aria-hidden=true href=#nginx-3>#</a></h4><ul><li>æ›´æ–°éœ€æ‰‹åŠ¨ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶æˆ–é€šè¿‡åŒ…ç®¡ç†å·¥å…·ï¼ˆå¦‚ apt/yumï¼‰ï¼Œå¯èƒ½æ¶‰åŠæœåŠ¡é‡å¯æˆ–é…ç½®æ–‡ä»¶è¿ç§»ã€‚</li><li>å®¹å™¨åŒ–éƒ¨ç½²ï¼ˆå¦‚ Dockerï¼‰éœ€æ‰‹åŠ¨ç®¡ç†é…ç½®æ–‡ä»¶å’Œè¯ä¹¦æŒ‚è½½ã€‚</li></ul><h4 id=caddy-3>Caddy<a hidden class=anchor aria-hidden=true href=#caddy-3>#</a></h4><ul><li>å•ä¸€äºŒè¿›åˆ¶æ–‡ä»¶ï¼šå®‰è£…åŒ…ä»…ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ”¯æŒè·¨å¹³å°ï¼ˆLinux/macOS/Windowsï¼‰ï¼Œéƒ¨ç½²ç®€å•ã€‚</li><li>è‡ªåŠ¨æ›´æ–°æœºåˆ¶ï¼šé€šè¿‡ <code>caddy upgrade</code> å‘½ä»¤å³å¯å®Œæˆç‰ˆæœ¬å‡çº§ï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼ˆä¸ä¸­æ–­æœåŠ¡ï¼‰ã€‚</li><li>å®¹å™¨åŒ–å‹å¥½ï¼šå®˜æ–¹ Docker é•œåƒé»˜è®¤åŒ…å«å¸¸ç”¨é…ç½®ï¼Œå¯é€šè¿‡ç¯å¢ƒå˜é‡å¿«é€Ÿé…ç½®ï¼ˆå¦‚ <code>CADDYFILE_CONTENT</code> ç›´æ¥æ³¨å…¥ Caddyfile å†…å®¹ï¼‰ã€‚</li></ul><h3 id=äº”é€‚ç”¨åœºæ™¯å¯¹æ¯”>äº”ã€é€‚ç”¨åœºæ™¯å¯¹æ¯”<a hidden class=anchor aria-hidden=true href=#äº”é€‚ç”¨åœºæ™¯å¯¹æ¯”>#</a></h3><table><thead><tr><th>åœºæ™¯</th><th>Nginx</th><th>Caddy</th></tr></thead><tbody><tr><td>å¤§å‹ç½‘ç«™ / é«˜å¹¶å‘è´Ÿè½½</td><td>æˆç†Ÿç¨³å®šï¼Œæ€§èƒ½ä¼˜åŒ–å·¥å…·é“¾å®Œå–„ï¼ˆå¦‚ <code>nginx -t</code> æ£€æµ‹é…ç½®ï¼‰</td><td>æ€§èƒ½æ¥è¿‘ Nginxï¼Œä½†ç”Ÿæ€å·¥å…·ï¼ˆå¦‚ç°åº¦å‘å¸ƒã€ç›‘æ§ï¼‰è¾ƒå°‘</td></tr><tr><td>ä¸­å°é¡¹ç›® / å¿«é€Ÿéƒ¨ç½²</td><td>éœ€ç¼–å†™å¤æ‚é…ç½®ï¼Œé€‚åˆæœ‰ç»éªŒçš„å›¢é˜Ÿ</td><td>é…ç½®ç®€å•ï¼Œé€‚åˆä¸ªäººå¼€å‘è€…æˆ– CI/CD è‡ªåŠ¨åŒ–æµç¨‹</td></tr><tr><td>ç°ä»£åŒ–åè®®ï¼ˆHTTP/3ï¼‰</td><td>éœ€æ‰‹åŠ¨ç¼–è¯‘æ¨¡å—ï¼Œé…ç½®é—¨æ§›é«˜</td><td>åŸç”Ÿæ”¯æŒï¼Œä¸€é”®å¯ç”¨</td></tr><tr><td>æ— çŠ¶æ€ä»£ç† / è¾¹ç¼˜è®¡ç®—</td><td>è½»é‡çº§ä½†éœ€æ‰‹åŠ¨ä¼˜åŒ–é…ç½®</td><td>å†…ç½®è‡ªåŠ¨ä¼˜åŒ–ï¼ˆå¦‚è¿æ¥æ± ã€ç¼“å­˜ï¼‰ï¼Œé€‚åˆè¾¹ç¼˜èŠ‚ç‚¹</td></tr><tr><td>å¼€å‘ç¯å¢ƒè°ƒè¯•</td><td>é…ç½®ç¹çï¼Œä¿®æ”¹åéœ€é‡å¯æœåŠ¡</td><td>å®æ—¶é‡è½½ï¼Œæ”¯æŒåŠ¨æ€è°ƒæ•´é…ç½®</td></tr></tbody></table><h3 id=æ€»ç»“caddy-çš„æ ¸å¿ƒä¼˜åŠ¿>æ€»ç»“ï¼šCaddy çš„æ ¸å¿ƒä¼˜åŠ¿<a hidden class=anchor aria-hidden=true href=#æ€»ç»“caddy-çš„æ ¸å¿ƒä¼˜åŠ¿>#</a></h3><ul><li><strong>å¯¹æ–°æ‰‹å‹å¥½</strong>ï¼šæç®€é…ç½®å’Œè‡ªåŠ¨ HTTPS å¤§å¹…é™ä½å…¥é—¨é—¨æ§›ï¼Œé€‚åˆå¿«é€Ÿæ­å»ºä¸ªäººåšå®¢ã€API æœåŠ¡ç­‰è½»é‡çº§åœºæ™¯ã€‚</li><li><strong>ç°ä»£åŒ–ç‰¹æ€§</strong>ï¼šåŸç”Ÿæ”¯æŒ HTTP/3ã€Wasm æ’ä»¶å’Œè‡ªåŠ¨æ›´æ–°ï¼Œé€‚åˆéœ€è¦å‰æ²¿æŠ€æœ¯çš„é¡¹ç›®ã€‚</li><li><strong>è¿ç»´ææ•ˆ</strong>ï¼šå‡å°‘é…ç½®æ–‡ä»¶ç»´æŠ¤æˆæœ¬ï¼Œå°¤å…¶åœ¨å¤šç«™ç‚¹ç®¡ç†ã€è¯ä¹¦è‡ªåŠ¨åŒ–æ–¹é¢ä¼˜åŠ¿æ˜¾è‘—ã€‚</li></ul><p>æ³¨æ„ï¼šNginx åœ¨ä¼ä¸šçº§åœºæ™¯ï¼ˆå¦‚é«˜å¹¶å‘åå‘ä»£ç†ã€å¾®æœåŠ¡ç½‘å…³ï¼‰ä¸­ä»å ä¸»å¯¼åœ°ä½ï¼Œå› å…¶ç”Ÿæ€æˆç†Ÿã€ç¤¾åŒºæ–‡æ¡£ä¸°å¯Œã€‚è‹¥é¡¹ç›®éœ€è¦æ·±åº¦å®šåˆ¶æˆ–å¤æ‚è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ŒNginx ä»æ˜¯æ›´ç¨³å¦¥çš„é€‰æ‹©ã€‚</p><h2 id=ä¸€åŠ¨æ€é…ç½®ä¸çƒ­æ›´æ–°>ä¸€ã€åŠ¨æ€é…ç½®ä¸çƒ­æ›´æ–°<a hidden class=anchor aria-hidden=true href=#ä¸€åŠ¨æ€é…ç½®ä¸çƒ­æ›´æ–°>#</a></h2><h3 id=å®æ—¶é…ç½®æ›´æ–°>å®æ—¶é…ç½®æ›´æ–°<a hidden class=anchor aria-hidden=true href=#å®æ—¶é…ç½®æ›´æ–°>#</a></h3><p>é€šè¿‡ REST API å¯åœ¨ä¸é‡å¯æœåŠ¡çš„æƒ…å†µä¸‹åŠ¨æ€è°ƒæ•´é…ç½®ï¼Œä¾‹å¦‚æ›´æ–°è·¯ç”±è§„åˆ™æˆ–è¯ä¹¦ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -X PUT <span style=color:#e6db74>&#34;http://localhost:2019/config&#34;</span> -d @new_config.json
</span></span></code></pre></div><p>æ”¯æŒ JSON å’Œ Caddyfile æ ¼å¼çš„åŠ¨æ€åŠ è½½ã€‚</p><h3 id=åŠ¨æ€-dns-é›†æˆ>åŠ¨æ€ DNS é›†æˆ<a hidden class=anchor aria-hidden=true href=#åŠ¨æ€-dns-é›†æˆ>#</a></h3><p>ç»“åˆ Cloudflareã€AWS ç­‰ DNS æœåŠ¡ï¼Œå®ç°åŸŸåä¸ IP çš„è‡ªåŠ¨åŒæ­¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>dynamic</span> <span style=color:#e6db74>example.com</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>dial_timeout</span> <span style=color:#ae81ff>10s</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>update_interval</span> <span style=color:#ae81ff>10m</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>é€‚ç”¨äºåŠ¨æ€ IP ç¯å¢ƒä¸‹çš„æœåŠ¡éƒ¨ç½²ã€‚</p><h2 id=äºŒåå‘ä»£ç†è¿›é˜¶é…ç½®>äºŒã€åå‘ä»£ç†è¿›é˜¶é…ç½®<a hidden class=anchor aria-hidden=true href=#äºŒåå‘ä»£ç†è¿›é˜¶é…ç½®>#</a></h2><h3 id=è´Ÿè½½å‡è¡¡ä¸å¥åº·æ£€æŸ¥>è´Ÿè½½å‡è¡¡ä¸å¥åº·æ£€æŸ¥<a hidden class=anchor aria-hidden=true href=#è´Ÿè½½å‡è¡¡ä¸å¥åº·æ£€æŸ¥>#</a></h3><p>æ”¯æŒè½®è¯¢ï¼ˆRound Robinï¼‰ã€æœ€å°‘è¿æ¥ï¼ˆLeast Connectionsï¼‰ç­‰ç­–ç•¥ï¼Œå¹¶è‡ªåŠ¨å‰”é™¤æ•…éšœèŠ‚ç‚¹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>reverse_proxy backend1:8080 backend2:8080 {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>lb_policy</span> <span style=color:#e6db74>round_robin</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>health_check</span> <span style=color:#a6e22e>/health</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>health_interval</span> <span style=color:#ae81ff>15s</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>é€šè¿‡ <code>health_check</code> å‚æ•°ç›‘æ§åç«¯æœåŠ¡çŠ¶æ€ã€‚</p><h3 id=åè®®è½¬æ¢ä¸-websocket-æ”¯æŒ>åè®®è½¬æ¢ä¸ WebSocket æ”¯æŒ<a hidden class=anchor aria-hidden=true href=#åè®®è½¬æ¢ä¸-websocket-æ”¯æŒ>#</a></h3><p>è‡ªåŠ¨å¤„ç† HTTP/2 åˆ° HTTP/1.1 çš„åè®®è½¬æ¢ï¼Œå¹¶æ”¯æŒ WebSocket é•¿è¿æ¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>reverse_proxy /ws/* localhost:3000 {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>transport</span> <span style=color:#e6db74>http</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>versions</span> <span style=color:#e6db74>h2c</span> <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ç¡®ä¿å®æ—¶é€šä¿¡çš„ç¨³å®šæ€§ã€‚</p><h3 id=è¯·æ±‚å¤´ä¸è·¯å¾„é‡å†™>è¯·æ±‚å¤´ä¸è·¯å¾„é‡å†™<a hidden class=anchor aria-hidden=true href=#è¯·æ±‚å¤´ä¸è·¯å¾„é‡å†™>#</a></h3><p>é€ä¼ å®¢æˆ·ç«¯çœŸå® IP æˆ–é‡å†™è¯·æ±‚è·¯å¾„ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>reverse_proxy {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>header_up</span> <span style=color:#e6db74>X-Real-IP</span> <span style=color:#ae81ff>{remote_host}</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>strip_prefix</span> <span style=color:#a6e22e>/api/v1</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¸¸ç”¨äºå¾®æœåŠ¡ç½‘å…³åœºæ™¯ã€‚</p><h2 id=ä¸‰å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–>ä¸‰ã€å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–<a hidden class=anchor aria-hidden=true href=#ä¸‰å®‰å…¨ä¸æ€§èƒ½ä¼˜åŒ–>#</a></h2><h3 id=é«˜çº§-tls-é…ç½®>é«˜çº§ TLS é…ç½®<a hidden class=anchor aria-hidden=true href=#é«˜çº§-tls-é…ç½®>#</a></h3><p>è‡ªå®šä¹‰è¯ä¹¦æ¥æºæˆ–å¯ç”¨åŠ å¯†å®¢æˆ·ç«¯ Helloï¼ˆECHï¼‰ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>example.com {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>tls</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>cert_file</span> <span style=color:#e6db74>/path/to/cert.pem</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>key_file</span> <span style=color:#e6db74>/path/to/key.pem</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ech_enabled</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å¢å¼ºéšç§ä¿æŠ¤å’Œè¯ä¹¦ç®¡ç†çµæ´»æ€§ã€‚</p><h3 id=é€Ÿç‡é™åˆ¶ä¸æµé‡æ§åˆ¶>é€Ÿç‡é™åˆ¶ä¸æµé‡æ§åˆ¶<a hidden class=anchor aria-hidden=true href=#é€Ÿç‡é™åˆ¶ä¸æµé‡æ§åˆ¶>#</a></h3><p>åŸºäº IP æˆ–è¯·æ±‚è·¯å¾„é™åˆ¶è®¿é—®é¢‘ç‡ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>rate_limit {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>zone</span> <span style=color:#e6db74>dynamic_zone</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>key</span> <span style=color:#ae81ff>{remote_host}</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>events</span> <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>window</span> <span style=color:#ae81ff>10s</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>é˜²æ­¢æ¶æ„è¯·æ±‚æˆ– DDoS æ”»å‡»ã€‚</p><h3 id=ç¼“å†²ä¸å¹¶å‘ä¼˜åŒ–>ç¼“å†²ä¸å¹¶å‘ä¼˜åŒ–<a hidden class=anchor aria-hidden=true href=#ç¼“å†²ä¸å¹¶å‘ä¼˜åŒ–>#</a></h3><p>é€šè¿‡ç¼“å†²æå‡é«˜å»¶è¿Ÿé“¾è·¯çš„ä¼ è¾“æ•ˆç‡ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>reverse_proxy {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>buffer_requests</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>buffer_responses</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>max_buffer_size</span> <span style=color:#ae81ff>4k</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>flush_interval</span> <span style=color:#ae81ff>1s</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>å‡å°‘åç«¯æœåŠ¡å› å®¢æˆ·ç«¯ç½‘ç»œæ³¢åŠ¨å¯¼è‡´çš„é˜»å¡ã€‚</p><h2 id=å››æ’ä»¶ä¸ç”Ÿæ€æ‰©å±•>å››ã€æ’ä»¶ä¸ç”Ÿæ€æ‰©å±•<a hidden class=anchor aria-hidden=true href=#å››æ’ä»¶ä¸ç”Ÿæ€æ‰©å±•>#</a></h2><h3 id=æ’ä»¶åŒ–æ‰©å±•>æ’ä»¶åŒ–æ‰©å±•<a hidden class=anchor aria-hidden=true href=#æ’ä»¶åŒ–æ‰©å±•>#</a></h3><p>å®‰è£…ç¬¬ä¸‰æ–¹æ’ä»¶å®ç° JWT é‰´æƒã€Prometheus ç›‘æ§ç­‰åŠŸèƒ½ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caddy install --source github.com/caddy-dns/cloudflare
</span></span></code></pre></div><p>æ”¯æŒè‡ªå®šä¹‰æ¨¡å—å¼€å‘ã€‚</p><h3 id=æ—¥å¿—ä¸ç›‘æ§é›†æˆ>æ—¥å¿—ä¸ç›‘æ§é›†æˆ<a hidden class=anchor aria-hidden=true href=#æ—¥å¿—ä¸ç›‘æ§é›†æˆ>#</a></h3><p>è¾“å‡ºç»“æ„åŒ–æ—¥å¿—å¹¶é›†æˆ Prometheusï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-caddyfile data-lang=caddyfile><span style=display:flex><span>log {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>output</span> <span style=color:#e6db74>file</span> <span style=color:#a6e22e>/var/log/caddy/access.log</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>format</span> <span style=color:#e6db74>json</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>prometheus {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>push</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>endpoint</span> <span style=color:#e6db74>&#34;http://localhost:9090&#34;</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>ä¾¿äºè¿ç»´åˆ†æä¸æŠ¥è­¦ã€‚</p><h2 id=äº”å®¹å™¨åŒ–ä¸è¾¹ç¼˜è®¡ç®—>äº”ã€å®¹å™¨åŒ–ä¸è¾¹ç¼˜è®¡ç®—<a hidden class=anchor aria-hidden=true href=#äº”å®¹å™¨åŒ–ä¸è¾¹ç¼˜è®¡ç®—>#</a></h2><h3 id=è½»é‡åŒ–å®¹å™¨éƒ¨ç½²>è½»é‡åŒ–å®¹å™¨éƒ¨ç½²<a hidden class=anchor aria-hidden=true href=#è½»é‡åŒ–å®¹å™¨éƒ¨ç½²>#</a></h3><p>é€šè¿‡ Docker å¿«é€Ÿéƒ¨ç½²å¹¶æŒ‚è½½é…ç½®ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -p 80:80 -v ./Caddyfile:/etc/caddy/Caddyfile caddy
</span></span></code></pre></div><p>é€‚ç”¨äºäº‘åŸç”Ÿå’Œè¾¹ç¼˜è®¡ç®—åœºæ™¯ã€‚</p><h3 id=å¤šå®ä¾‹é›†ç¾¤ç®¡ç†>å¤šå®ä¾‹é›†ç¾¤ç®¡ç†<a hidden class=anchor aria-hidden=true href=#å¤šå®ä¾‹é›†ç¾¤ç®¡ç†>#</a></h3><p>åˆ©ç”¨ API åè°ƒå¤šä¸ª Caddy å®ä¾‹ï¼Œå®ç°è¯ä¹¦é›†ä¸­ç®¡ç†å’Œé…ç½®åŒæ­¥ã€‚</p><p>é€šè¿‡ä¸Šè¿°é«˜çº§åŠŸèƒ½ï¼ŒCaddy å¯æ»¡è¶³ä¼ä¸šçº§ç”Ÿäº§ç¯å¢ƒä¸­å¯¹å®‰å…¨æ€§ã€æ€§èƒ½åŠçµæ´»æ€§çš„å¤æ‚éœ€æ±‚ã€‚</p><h2 id=caddy-ç»‘å®šç›®å½•>caddy ç»‘å®šç›®å½•<a hidden class=anchor aria-hidden=true href=#caddy-ç»‘å®šç›®å½•>#</a></h2><p>Caddy æŠŠå¤–ç½‘åŸŸå w1.a.com å’Œ w2.a.com åå‘ä»£ç†åˆ°åŒä¸€ä¸ªå†…ç½‘æœåŠ¡ å†…ç½‘1:999ï¼Œ
å¹¶ä¸” w2.a.com è¦ä»£ç†åˆ° å†…ç½‘1:999/com1 ï¼ˆä¹Ÿå°±æ˜¯åŒä¸€ä¸ªåç«¯æœåŠ¡ä¸‹çš„ /com1 è·¯å¾„ï¼‰ã€‚</p><p>Caddyfile</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># é…ç½® w1.a.com -&gt; http://å†…ç½‘1:999</span>
</span></span><span style=display:flex><span>w1.a.com <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    reverse_proxy å†…ç½‘1:999
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># é…ç½® w2.a.com -&gt; http://å†…ç½‘1:999/com1</span>
</span></span><span style=display:flex><span>w2.a.com <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    handle_path /* <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        uri strip_prefix /
</span></span><span style=display:flex><span>        reverse_proxy å†…ç½‘1:999/com1
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>reverse_proxy å†…ç½‘1:999
æŠŠè¯·æ±‚ç›´æ¥è½¬å‘åˆ°å†…ç½‘æœåŠ¡çš„ 999 ç«¯å£ã€‚</p><p>handle_path + uri strip_prefix /
æ˜¯ä¸ºäº†ç¡®ä¿ç”¨æˆ·è®¿é—® <a href=http://w2.a.com/xxx>http://w2.a.com/xxx</a> æ—¶ï¼Œè½¬å‘åˆ° http://å†…ç½‘1:999/com1/xxxã€‚
strip_prefix å»æ‰åŸŸååçš„å‰ç¼€ /ï¼Œå†æ‹¼åˆ°åç«¯è·¯å¾„ã€‚</p><p>âš ï¸ æ³¨æ„ç‚¹
âœ… å¦‚æœåç«¯æ˜¯ HTTPï¼Œè¯·å†™ http://å†…ç½‘1:999ï¼Œ
âœ… å¦‚æœåç«¯æ˜¯ HTTPSï¼Œè¦ç”¨ https:// å¹¶æ³¨æ„è¯ä¹¦æ˜¯å¦è‡ªç­¾åã€‚</p><p>ğŸš© å®Œæ•´ä¾‹å­ï¼ˆå¸¦åè®®ï¼‰ï¼š
caddyfile</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>w1.a.com <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    reverse_proxy http://192.168.1.100:999
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>w2.a.com <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    handle_path /* <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        uri strip_prefix /
</span></span><span style=display:flex><span>        reverse_proxy http://192.168.1.100:999/com1
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h3 id=ä½¿ç”¨-caddy-reload-çƒ­æ›´æ–°>ä½¿ç”¨ caddy reload çƒ­æ›´æ–°<a hidden class=anchor aria-hidden=true href=#ä½¿ç”¨-caddy-reload-çƒ­æ›´æ–°>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>caddy reload --config /path/to/Caddyfile
</span></span></code></pre></div><h1 id=authentication>Authentication<a hidden class=anchor aria-hidden=true href=#authentication>#</a></h1><p>Caddy è‡ªå¸¦ Basic Authenticationï¼ˆåŸºæœ¬è®¤è¯ï¼‰ï¼Œé…ç½®éå¸¸ç®€å•ã€‚</p><h2 id=1-åˆ›å»ºå·¥ä½œç›®å½•>1. åˆ›å»ºå·¥ä½œç›®å½•<a hidden class=anchor aria-hidden=true href=#1-åˆ›å»ºå·¥ä½œç›®å½•>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir caddy-test
</span></span><span style=display:flex><span>cd caddy-test
</span></span></code></pre></div><h2 id=2-åˆ›å»º-indexhtml-æµ‹è¯•é¡µé¢>2. åˆ›å»º index.html æµ‹è¯•é¡µé¢<a hidden class=anchor aria-hidden=true href=#2-åˆ›å»º-indexhtml-æµ‹è¯•é¡µé¢>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;&lt;h1&gt;Hello Caddy!&lt;/h1&gt;&#34;</span> &gt; index.html
</span></span></code></pre></div><h2 id=3-ç”Ÿæˆ-caddy-å¯†ç å“ˆå¸Œ>3. ç”Ÿæˆ Caddy å¯†ç å“ˆå¸Œ<a hidden class=anchor aria-hidden=true href=#3-ç”Ÿæˆ-caddy-å¯†ç å“ˆå¸Œ>#</a></h2><p>Caddy è¦æ±‚ BasicAuth ä½¿ç”¨ bcrypt å“ˆå¸Œã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run --rm caddy caddy hash-password --plaintext <span style=color:#e6db74>&#34;123123&#34;</span>
</span></span></code></pre></div><p>å‡è®¾è¿”å›ç»“æœï¼š</p><p>$2a$14$e5BY1Go8WI2jk/wv.jSUTunNdRRnZLc29y1VxpdMQK9prN16D/PVq</p><p>è¿™ä¸ªå°±æ˜¯è¦å†™è¿›é…ç½®çš„å“ˆå¸Œå¯†ç ã€‚</p><h2 id=4-åˆ›å»º-caddyfile>4. åˆ›å»º Caddyfile<a hidden class=anchor aria-hidden=true href=#4-åˆ›å»º-caddyfile>#</a></h2><p>åœ¨ caddy-test ç›®å½•åˆ›å»º Caddyfileï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>:80 <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    root * /srv
</span></span><span style=display:flex><span>    file_server
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    basicauth /* <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>	<span style=color:#75715e># ç”¨æˆ·å adminï¼Œåé¢æ˜¯ä¸Šä¸€æ­¥ç”Ÿæˆçš„å“ˆå¸Œ</span>
</span></span><span style=display:flex><span>        admin $2a$14$e5BY1Go8WI2jk/wv.jSUTunNdRRnZLc29y1VxpdMQK9prN16D/PVq   
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><h2 id=5-è¿è¡Œ-caddy-å®¹å™¨>5. è¿è¡Œ Caddy å®¹å™¨<a hidden class=anchor aria-hidden=true href=#5-è¿è¡Œ-caddy-å®¹å™¨>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name caddy-test <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -p 8080:80 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>/Caddyfile:/etc/caddy/Caddyfile <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>:/srv <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  caddy
</span></span></code></pre></div><h2 id=6-æµ‹è¯•è®¿é—®>6. æµ‹è¯•è®¿é—®<a hidden class=anchor aria-hidden=true href=#6-æµ‹è¯•è®¿é—®>#</a></h2><p>æµè§ˆå™¨æ‰“å¼€
http://localhost:8080</p><p>ä¼šæç¤ºè¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼ˆä¸Šé¢é…ç½®çš„ admin + 123123ï¼‰ã€‚</p><h2 id=7-è¡¥å……>7. è¡¥å……<a hidden class=anchor aria-hidden=true href=#7-è¡¥å……>#</a></h2><p>å¦‚æœè¦ç”¨ HTTPSï¼Œå¯ä»¥ç›´æ¥æ”¹æˆï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>example.com <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    root * /srv
</span></span><span style=display:flex><span>    file_server
</span></span><span style=display:flex><span>    basicauth /* <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        admin $2a$14$ABCxyz...
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>ç„¶åè§£æåŸŸååˆ°æœåŠ¡å™¨ï¼ŒCaddy ä¼šè‡ªåŠ¨ç”³è¯· Letâ€™s Encrypt è¯ä¹¦ã€‚</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://qfsyso.github.io/tags/caddy/>Caddy</a></li><li><a href=https://qfsyso.github.io/tags/debian/>Debian</a></li></ul><nav class=paginav><a class=prev href=https://qfsyso.github.io/posts/snapdrop/><span class=title>Â« Prev</span><br><span>Snapdrop</span>
</a><a class=next href=https://qfsyso.github.io/posts/zhangzhou-planb/><span class=title>Next Â»</span><br><span>ZhangZhou PlanB</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Caddy on x" href="https://x.com/intent/tweet/?text=Caddy&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f&amp;hashtags=Caddy%2cDebian"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Caddy on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f&amp;title=Caddy&amp;summary=Caddy&amp;source=https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Caddy on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f&title=Caddy"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Caddy on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Caddy on whatsapp" href="https://api.whatsapp.com/send?text=Caddy%20-%20https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Caddy on telegram" href="https://telegram.me/share/url?text=Caddy&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Caddy on ycombinator" href="https://news.ycombinator.com/submitlink?t=Caddy&u=https%3a%2f%2fqfsyso.github.io%2fposts%2fcaddy%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><div class=wtime><div class=wtime2>CST<span id=beijingTime></span> GMT <span id=londonTime></span> EST <span id=newYorkTime></span> PST<span id=losAngelesTime></span></div><div class=wtime2 style=display:none>ä¸œäº¬<span id=tokyoTime></span></div><div class=wtime2 style=display:none>æ¬§æ´²-å·´é»<span id=parisTime></span></div><div class=wtime2 style=display:none>UTC<span id=utcTime></span></div></div><span>&copy; 2025 <a href=https://qfsyso.github.io/>MLOG</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script type=text/javascript>const timeZoneOffsets={beijing:8,tokyo:9,paris:[1,2],london:[0,1],newYork:[-5,-4],losAngeles:[-8,-7]};function padZero(e){return e<10?"0"+e:e}function formatTime(e){const t=e.getFullYear(),n=padZero(e.getMonth()+1),s=padZero(e.getDate()),o=padZero(e.getHours()),i=padZero(e.getMinutes()),a=padZero(e.getSeconds());return`${t}-${n}-${s} ${o}:${i}:${a}`}function isDaylightSavingTime(e,t){const o=e.getMonth(),n=new Date(e.getFullYear(),3,8,2,0,0),s=new Date(e.getFullYear(),10,1,2,0,0);return(t==="paris"||t==="london"||t==="newYork"||t==="losAngeles")&&e>=n&&e<s}function updateTime(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),n=formatTime(t);document.getElementById("utcTime").innerHTML=n;for(const n in timeZoneOffsets){const e=timeZoneOffsets[n];let s;Array.isArray(e)?s=isDaylightSavingTime(t,n)?e[1]:e[0]:s=e;const o=new Date(t.getTime()+s*60*60*1e3);document.getElementById(n+"Time").innerHTML=formatTime(o)}setTimeout(updateTime,1e3)}window.onload=function(){updateTime()};function notfound(e){var n=e.src,t=n.split("/"),s=t[t.length-1];e.src="https://47.115.223.75:8080/group1/v2/"+s+"?timestamp="+Date.now(),e.onerror=null}</script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>