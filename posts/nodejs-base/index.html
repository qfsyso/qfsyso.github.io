<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Nodejs base | MLOG</title>
<meta name=keywords content="Node,Helloworld,Buffer,Stream,C++,Router,MySQL,Socket"><meta name=description content="ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚
Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚
Node.js æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ I/O æœåŠ¡ç«¯ JavaScript ç¯å¢ƒï¼ŒåŸºäº Google çš„ V8 å¼•æ“ï¼ŒV8 å¼•æ“æ‰§è¡Œ Javascript çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚
ğŸ› Node.jså®‰è£… Node.jså®‰è£…åœ¨ä¸Šä¸€ç¯‡æ–‡ç« Debian Node.js HEXO æœ‰è®²åˆ°
æˆªè‡³ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯20.12.2
#æŸ¥çœ‹ç‰ˆæœ¬ node -v v20.12.2
winä¸‹å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£… https://nodejs.org/en/download
debian nodejs node 14ç‰ˆæœ¬
$ apt-get update $ curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash - #å¦‚æœæç¤ºsudo å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°ï¼Œä¸€å®šè¦ä¸‹è½½ï¼Œæ‰§è¡Œapt-get install sudo -y å³å¯ï¼Œç„¶åå†æ‰§è¡Œä¸Šè¿°å‘½ä»¤
$ apt-get install nodejs -y $ node --version //éªŒè¯ å½“ç„¶å¦‚æœéœ€è¦å®‰è£…node20ç‰ˆæœ¬ï¼Œåªéœ€å°†ä¸Šè¿°å‘½ä»¤æ›¿æ¢ä¸ºï¼š
$ curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash - ğŸ’¬helloworld hi."><meta name=author content="dwd"><link rel=canonical href=https://qfsyso.github.io/posts/nodejs-base/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://qfsyso.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://qfsyso.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://qfsyso.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://qfsyso.github.io/apple-touch-icon.png><link rel=mask-icon href=https://qfsyso.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://qfsyso.github.io/posts/nodejs-base/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://qfsyso.github.io/posts/nodejs-base/"><meta property="og:site_name" content="MLOG"><meta property="og:title" content="Nodejs base"><meta property="og:description" content="ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚
Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚
Node.js æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ I/O æœåŠ¡ç«¯ JavaScript ç¯å¢ƒï¼ŒåŸºäº Google çš„ V8 å¼•æ“ï¼ŒV8 å¼•æ“æ‰§è¡Œ Javascript çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚
ğŸ› Node.jså®‰è£… Node.jså®‰è£…åœ¨ä¸Šä¸€ç¯‡æ–‡ç« Debian Node.js HEXO æœ‰è®²åˆ°
æˆªè‡³ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯20.12.2
#æŸ¥çœ‹ç‰ˆæœ¬ node -v v20.12.2
winä¸‹å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£… https://nodejs.org/en/download
debian nodejs node 14ç‰ˆæœ¬
$ apt-get update $ curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash - #å¦‚æœæç¤ºsudo å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°ï¼Œä¸€å®šè¦ä¸‹è½½ï¼Œæ‰§è¡Œapt-get install sudo -y å³å¯ï¼Œç„¶åå†æ‰§è¡Œä¸Šè¿°å‘½ä»¤
$ apt-get install nodejs -y $ node --version //éªŒè¯ å½“ç„¶å¦‚æœéœ€è¦å®‰è£…node20ç‰ˆæœ¬ï¼Œåªéœ€å°†ä¸Šè¿°å‘½ä»¤æ›¿æ¢ä¸ºï¼š
$ curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash - ğŸ’¬helloworld hi."><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-17T19:00:03+00:00"><meta property="article:modified_time" content="2024-05-17T19:00:03+00:00"><meta property="article:tag" content="Node"><meta property="article:tag" content="Helloworld"><meta property="article:tag" content="Buffer"><meta property="article:tag" content="Stream"><meta property="article:tag" content="C++"><meta property="article:tag" content="Router"><meta name=twitter:card content="summary"><meta name=twitter:title content="Nodejs base"><meta name=twitter:description content="ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚
Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚
Node.js æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ I/O æœåŠ¡ç«¯ JavaScript ç¯å¢ƒï¼ŒåŸºäº Google çš„ V8 å¼•æ“ï¼ŒV8 å¼•æ“æ‰§è¡Œ Javascript çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚
ğŸ› Node.jså®‰è£… Node.jså®‰è£…åœ¨ä¸Šä¸€ç¯‡æ–‡ç« Debian Node.js HEXO æœ‰è®²åˆ°
æˆªè‡³ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯20.12.2
#æŸ¥çœ‹ç‰ˆæœ¬ node -v v20.12.2
winä¸‹å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£… https://nodejs.org/en/download
debian nodejs node 14ç‰ˆæœ¬
$ apt-get update $ curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash - #å¦‚æœæç¤ºsudo å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°ï¼Œä¸€å®šè¦ä¸‹è½½ï¼Œæ‰§è¡Œapt-get install sudo -y å³å¯ï¼Œç„¶åå†æ‰§è¡Œä¸Šè¿°å‘½ä»¤
$ apt-get install nodejs -y $ node --version //éªŒè¯ å½“ç„¶å¦‚æœéœ€è¦å®‰è£…node20ç‰ˆæœ¬ï¼Œåªéœ€å°†ä¸Šè¿°å‘½ä»¤æ›¿æ¢ä¸ºï¼š
$ curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash - ğŸ’¬helloworld hi."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://qfsyso.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Nodejs base","item":"https://qfsyso.github.io/posts/nodejs-base/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Nodejs base","name":"Nodejs base","description":"ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚\nNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚\nNode.js æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ I/O æœåŠ¡ç«¯ JavaScript ç¯å¢ƒï¼ŒåŸºäº Google çš„ V8 å¼•æ“ï¼ŒV8 å¼•æ“æ‰§è¡Œ Javascript çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚\nğŸ› Node.jså®‰è£… Node.jså®‰è£…åœ¨ä¸Šä¸€ç¯‡æ–‡ç« Debian Node.js HEXO æœ‰è®²åˆ°\næˆªè‡³ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯20.12.2\n#æŸ¥çœ‹ç‰ˆæœ¬ node -v v20.12.2\nwinä¸‹å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£… https://nodejs.org/en/download\ndebian nodejs node 14ç‰ˆæœ¬\n$ apt-get update $ curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash - #å¦‚æœæç¤ºsudo å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°ï¼Œä¸€å®šè¦ä¸‹è½½ï¼Œæ‰§è¡Œapt-get install sudo -y å³å¯ï¼Œç„¶åå†æ‰§è¡Œä¸Šè¿°å‘½ä»¤\n$ apt-get install nodejs -y $ node --version //éªŒè¯ å½“ç„¶å¦‚æœéœ€è¦å®‰è£…node20ç‰ˆæœ¬ï¼Œåªéœ€å°†ä¸Šè¿°å‘½ä»¤æ›¿æ¢ä¸ºï¼š\n$ curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash - ğŸ’¬helloworld hi.","keywords":["Node","Helloworld","Buffer","Stream","C++","Router","MySQL","Socket"],"articleBody":"ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚\nNode.js æ˜¯ä¸€ä¸ªåŸºäº Chrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚\nNode.js æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ I/O æœåŠ¡ç«¯ JavaScript ç¯å¢ƒï¼ŒåŸºäº Google çš„ V8 å¼•æ“ï¼ŒV8 å¼•æ“æ‰§è¡Œ Javascript çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚\nğŸ› Node.jså®‰è£… Node.jså®‰è£…åœ¨ä¸Šä¸€ç¯‡æ–‡ç« Debian Node.js HEXO æœ‰è®²åˆ°\næˆªè‡³ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯20.12.2\n#æŸ¥çœ‹ç‰ˆæœ¬ node -v v20.12.2\nwinä¸‹å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£… https://nodejs.org/en/download\ndebian nodejs node 14ç‰ˆæœ¬\n$ apt-get update $ curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash - #å¦‚æœæç¤ºsudo å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°ï¼Œä¸€å®šè¦ä¸‹è½½ï¼Œæ‰§è¡Œapt-get install sudo -y å³å¯ï¼Œç„¶åå†æ‰§è¡Œä¸Šè¿°å‘½ä»¤\n$ apt-get install nodejs -y $ node --version //éªŒè¯ å½“ç„¶å¦‚æœéœ€è¦å®‰è£…node20ç‰ˆæœ¬ï¼Œåªéœ€å°†ä¸Šè¿°å‘½ä»¤æ›¿æ¢ä¸ºï¼š\n$ curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash - ğŸ’¬helloworld hi.js\nconsole.log(\"hello world node.js \") // like javascript~ node hi.js [20240504n11]\nğŸ‘©â€ğŸ«Node.js åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨ require æŒ‡ä»¤ var http = require(\"http\"); åˆ›å»ºæœåŠ¡å™¨/æ¥æ”¶å“åº”è¯·æ±‚ var http = require('http'); http.createServer(function (request, response) { // å‘é€ HTTP å¤´éƒ¨ // HTTP çŠ¶æ€å€¼: 200 : OK // å†…å®¹ç±»å‹: text/plain response.writeHead(200, {'Content-Type': 'text/plain'}); // å‘é€å“åº”æ•°æ® \"Hello World\" response.end('Hello World\\n'); }).listen(8888); // ç»ˆç«¯æ‰“å°å¦‚ä¸‹ä¿¡æ¯ console.log('Server running at http://127.0.0.1:1200/'); ğŸš€npmä½¿ç”¨ npm æ˜¯åŒ…ç®¡ç†å·¥å…· å…è®¸ç”¨æˆ·ä»NPMæœåŠ¡å™¨ä¸‹è½½åˆ«äººç¼–å†™çš„ç¬¬ä¸‰æ–¹åŒ…åˆ°æœ¬åœ°ä½¿ç”¨ã€‚ å…è®¸ç”¨æˆ·ä»NPMæœåŠ¡å™¨ä¸‹è½½å¹¶å®‰è£…åˆ«äººç¼–å†™çš„å‘½ä»¤è¡Œç¨‹åºåˆ°æœ¬åœ°ä½¿ç”¨ã€‚ å…è®¸ç”¨æˆ·å°†è‡ªå·±ç¼–å†™çš„åŒ…æˆ–å‘½ä»¤è¡Œç¨‹åºä¸Šä¼ åˆ°NPMæœåŠ¡å™¨ä¾›åˆ«äººä½¿ç”¨ã€‚\nnpm -v\nå¦‚æœä½ å®‰è£…çš„æ˜¯æ—§ç‰ˆæœ¬çš„ npmï¼Œå¯ä»¥å¾ˆå®¹æ˜“å¾—é€šè¿‡ npm å‘½ä»¤æ¥å‡çº§ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š\n$ sudo npm install npm -g /usr/local/bin/npm -\u003e /usr/local/lib/node_modules/npm/bin/npm-cli.js npm@2.14.2 /usr/local/lib/node_modules/npm å¦‚æœæ˜¯ Window ç³»ç»Ÿä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š\nnpm install npm -g ä½¿ç”¨æ·˜å®é•œåƒçš„å‘½ä»¤ï¼š\nnpm install -g cnpm â€“registry=https://registry.npmmirror.com\nå…¨å±€å®‰è£…ä¸æœ¬åœ°å®‰è£… npm çš„åŒ…å®‰è£…åˆ†ä¸ºæœ¬åœ°å®‰è£…ï¼ˆlocalï¼‰ã€å…¨å±€å®‰è£…ï¼ˆglobalï¼‰ä¸¤ç§ï¼Œä»æ•²çš„å‘½ä»¤è¡Œæ¥çœ‹ï¼Œå·®åˆ«åªæ˜¯æœ‰æ²¡æœ‰-gè€Œå·²ï¼Œæ¯”å¦‚\nnpm install express # æœ¬åœ°å®‰è£… npm install express -g # å…¨å±€å®‰è£… å¦‚æœå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š\nnpm err! Error: connect ECONNREFUSED 127.0.0.1:8087 è§£å†³åŠæ³•ä¸ºï¼š\n$ npm config set proxy null\næŸ¥çœ‹å®‰è£…ä¿¡æ¯ npm list\nâ”€â”€ express@4.19.2\nnpm list -g\nä½¿ç”¨package.json -node_modules/express/package.json å†…å®¹ï¼š\nPackage.json å±æ€§è¯´æ˜\nname - åŒ…åã€‚\nversion - åŒ…çš„ç‰ˆæœ¬å·ã€‚\ndescription - åŒ…çš„æè¿°ã€‚\nhomepage - åŒ…çš„å®˜ç½‘ url ã€‚\nauthor - åŒ…çš„ä½œè€…å§“åã€‚\ncontributors - åŒ…çš„å…¶ä»–è´¡çŒ®è€…å§“åã€‚\ndependencies - ä¾èµ–åŒ…åˆ—è¡¨ã€‚å¦‚æœä¾èµ–åŒ…æ²¡æœ‰å®‰è£…ï¼Œnpm ä¼šè‡ªåŠ¨å°†ä¾èµ–åŒ…å®‰è£…åœ¨ node_module ç›®å½•ä¸‹ã€‚\nrepository - åŒ…ä»£ç å­˜æ”¾çš„åœ°æ–¹çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ git æˆ– svnï¼Œgit å¯åœ¨ Github ä¸Šã€‚\nmain - main å­—æ®µæŒ‡å®šäº†ç¨‹åºçš„ä¸»å…¥å£æ–‡ä»¶ï¼Œrequire(â€˜moduleNameâ€™) å°±ä¼šåŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªå­—æ®µçš„é»˜è®¤å€¼æ˜¯æ¨¡å—æ ¹ç›®å½•ä¸‹é¢çš„ index.jsã€‚\nkeywords - å…³é”®å­—\nå¸è½½\nnpm uninstall express npm ls æ›´æ–°\nnpm update express åˆ›å»º\nnpm init This utility will walk you through creating a package.json file. It only covers the most common items, and tries to guess sensible defaults.\nSee npm help json for definitive documentation on these fields and exactly what they do.\nUse npm install --save afterwards to install a package and save it as a dependency in the package.json file.\nPress ^C at any time to quit. name: (node_modules) runoob # æ¨¡å—å version: (1.0.0) description: Node.js æµ‹è¯•æ¨¡å—(www.runoob.com) # æè¿° entry point: (index.js) test command: make test git repository: https://github.com/runoob/runoob.git # Github åœ°å€\nauthor: license: (ISC) About to write to â€¦â€¦/node_modules/package.json: # ç”Ÿæˆåœ°å€\n{ â€œnameâ€: â€œrunoobâ€, â€œversionâ€: â€œ1.0.0â€, â€œdescriptionâ€: â€œNode.js æµ‹è¯•æ¨¡å—(www.runoob.com)â€, â€¦â€¦ }\nIs this ok? (yes) yes\nyesåä¼šç”Ÿæˆ package.json npm adduser Username: mcmohd Password: Email: (this IS public) mcmohd@gmail.com\nå‘å¸ƒ npm publish\nå°±å¯ä»¥è·Ÿå…¶ä»–æ¨¡å—ä¸€æ ·ä½¿ç”¨ npm æ¥å®‰è£…\nğŸ”­Node.js å›è°ƒå‡½æ•° Node.js å¼‚æ­¥ç¼–ç¨‹çš„ç›´æ¥ä½“ç°å°±æ˜¯å›è°ƒã€‚\nå¼‚æ­¥ç¼–ç¨‹ä¾æ‰˜äºå›è°ƒæ¥å®ç°ï¼Œä½†ä¸èƒ½è¯´ä½¿ç”¨äº†å›è°ƒåç¨‹åºå°±å¼‚æ­¥åŒ–äº†ã€‚\nå›è°ƒå‡½æ•°åœ¨å®Œæˆä»»åŠ¡åå°±ä¼šè¢«è°ƒç”¨ï¼ŒNode ä½¿ç”¨äº†å¤§é‡çš„å›è°ƒå‡½æ•°ï¼ŒNode æ‰€æœ‰ API éƒ½æ”¯æŒå›è°ƒå‡½æ•°ã€‚\nä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¾¹è¯»å–æ–‡ä»¶ï¼Œä¸€è¾¹æ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼Œåœ¨æ–‡ä»¶è¯»å–å®Œæˆåï¼Œæˆ‘ä»¬å°†æ–‡ä»¶å†…å®¹ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°è¿”å›ã€‚è¿™æ ·åœ¨æ‰§è¡Œä»£ç æ—¶å°±æ²¡æœ‰é˜»å¡æˆ–ç­‰å¾…æ–‡ä»¶ I/O æ“ä½œã€‚è¿™å°±å¤§å¤§æé«˜äº† Node.js çš„æ€§èƒ½ï¼Œå¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘è¯·æ±‚ã€‚\nå›è°ƒå‡½æ•°ä¸€èˆ¬ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°å‡ºç°ï¼š\nfunction foo1(name, age, callback) { } function foo2(value, callback1, callback2) { } é˜»å¡ä»£ç å®ä¾‹ åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ x.txt ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nhi hi hi\nåˆ›å»º main.js æ–‡ä»¶, ä»£ç å¦‚ä¸‹ï¼š\nvar fs = require(\"fs\"); var data = fs.readFileSync('x.txt'); console.log(data.toString()); console.log(\"ç¨‹åºæ‰§è¡Œç»“æŸ!\"); ä»¥ä¸Šä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\nnode main.js\nhi hi hi\nç¨‹åºæ‰§è¡Œç»“æŸ!\néé˜»å¡ä»£ç å®ä¾‹ åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ input.txt ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\nèœé¸Ÿæ•™ç¨‹å®˜ç½‘åœ°å€ï¼šwww.runoob.com åˆ›å»º main.js æ–‡ä»¶, ä»£ç å¦‚ä¸‹ï¼š\nvar fs = require(\"fs\"); fs.readFile('input.txt', function (err, data) { if (err) return console.error(err); console.log(data.toString()); }); console.log(\"ç¨‹åºæ‰§è¡Œç»“æŸ!\"); ä»¥ä¸Šä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\nnode main.js\nç¨‹åºæ‰§è¡Œç»“æŸ! hi hi hi ä»¥ä¸Šä¸¤ä¸ªå®ä¾‹æˆ‘ä»¬äº†è§£äº†é˜»å¡ä¸éé˜»å¡è°ƒç”¨çš„ä¸åŒã€‚ç¬¬ä¸€ä¸ªå®ä¾‹åœ¨æ–‡ä»¶è¯»å–å®Œåæ‰æ‰§è¡Œç¨‹åºã€‚ ç¬¬äºŒä¸ªå®ä¾‹æˆ‘ä»¬ä¸éœ€è¦ç­‰å¾…æ–‡ä»¶è¯»å–å®Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¯»å–æ–‡ä»¶æ—¶åŒæ—¶æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç ï¼Œå¤§å¤§æé«˜äº†ç¨‹åºçš„æ€§èƒ½ã€‚\nå› æ­¤ï¼Œé˜»å¡æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ï¼Œè€Œéé˜»å¡æ˜¯ä¸éœ€è¦æŒ‰é¡ºåºçš„ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å¤„ç†å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œæˆ‘ä»¬å°±éœ€è¦å†™åœ¨å›è°ƒå‡½æ•°å†…ã€‚\nğŸNode.js äº‹ä»¶å¾ªç¯ Node.js æ˜¯å•è¿›ç¨‹å•çº¿ç¨‹åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯å› ä¸º V8 å¼•æ“æä¾›çš„å¼‚æ­¥æ‰§è¡Œå›è°ƒæ¥å£ï¼Œé€šè¿‡è¿™äº›æ¥å£å¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘ï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸é«˜ã€‚\nNode.js å‡ ä¹æ¯ä¸€ä¸ª API éƒ½æ˜¯æ”¯æŒå›è°ƒå‡½æ•°çš„ã€‚\nNode.js åŸºæœ¬ä¸Šæ‰€æœ‰çš„äº‹ä»¶æœºåˆ¶éƒ½æ˜¯ç”¨è®¾è®¡æ¨¡å¼ä¸­è§‚å¯Ÿè€…æ¨¡å¼å®ç°ã€‚\nNode.js å•çº¿ç¨‹ç±»ä¼¼è¿›å…¥ä¸€ä¸ªwhile(true)çš„äº‹ä»¶å¾ªç¯ï¼Œç›´åˆ°æ²¡æœ‰äº‹ä»¶è§‚å¯Ÿè€…é€€å‡ºï¼Œæ¯ä¸ªå¼‚æ­¥äº‹ä»¶éƒ½ç”Ÿæˆä¸€ä¸ªäº‹ä»¶è§‚å¯Ÿè€…ï¼Œå¦‚æœæœ‰äº‹ä»¶å‘ç”Ÿå°±è°ƒç”¨è¯¥å›è°ƒå‡½æ•°.\näº‹ä»¶é©±åŠ¨ç¨‹åº Node.js ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œå½“web serveræ¥æ”¶åˆ°è¯·æ±‚ï¼Œå°±æŠŠå®ƒå…³é—­ç„¶åè¿›è¡Œå¤„ç†ï¼Œç„¶åå»æœåŠ¡ä¸‹ä¸€ä¸ªwebè¯·æ±‚ã€‚\nå½“è¿™ä¸ªè¯·æ±‚å®Œæˆï¼Œå®ƒè¢«æ”¾å›å¤„ç†é˜Ÿåˆ—ï¼Œå½“åˆ°è¾¾é˜Ÿåˆ—å¼€å¤´ï¼Œè¿™ä¸ªç»“æœè¢«è¿”å›ç»™ç”¨æˆ·ã€‚\nè¿™ä¸ªæ¨¡å‹éå¸¸é«˜æ•ˆå¯æ‰©å±•æ€§éå¸¸å¼ºï¼Œå› ä¸º webserver ä¸€ç›´æ¥å—è¯·æ±‚è€Œä¸ç­‰å¾…ä»»ä½•è¯»å†™æ“ä½œã€‚ï¼ˆè¿™ä¹Ÿç§°ä¹‹ä¸ºéé˜»å¡å¼IOæˆ–è€…äº‹ä»¶é©±åŠ¨IOï¼‰\nåœ¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ä¸­ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä¸»å¾ªç¯æ¥ç›‘å¬äº‹ä»¶ï¼Œå½“æ£€æµ‹åˆ°äº‹ä»¶æ—¶è§¦å‘å›è°ƒå‡½æ•°ã€‚\nEventEmitters -\u003e Events =\u003e\u003c= EventLoop -\u003e Event Handlers\næ•´ä¸ªäº‹ä»¶é©±åŠ¨çš„æµç¨‹å°±æ˜¯è¿™ä¹ˆå®ç°çš„ï¼Œéå¸¸ç®€æ´ã€‚æœ‰ç‚¹ç±»ä¼¼äºè§‚å¯Ÿè€…æ¨¡å¼ï¼Œäº‹ä»¶ç›¸å½“äºä¸€ä¸ªä¸»é¢˜(Subject)ï¼Œè€Œæ‰€æœ‰æ³¨å†Œåˆ°è¿™ä¸ªäº‹ä»¶ä¸Šçš„å¤„ç†å‡½æ•°ç›¸å½“äºè§‚å¯Ÿè€…(Observer)ã€‚\nNode.js æœ‰å¤šä¸ªå†…ç½®çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥ events æ¨¡å—ï¼Œå¹¶é€šè¿‡å®ä¾‹åŒ– EventEmitter ç±»æ¥ç»‘å®šå’Œç›‘å¬äº‹ä»¶ï¼Œå¦‚ä¸‹å®ä¾‹ï¼š\n// å¼•å…¥ events æ¨¡å— var events = require('events'); // åˆ›å»º eventEmitter å¯¹è±¡ var eventEmitter = new events.EventEmitter(); ä»¥ä¸‹ç¨‹åºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºï¼š\n// ç»‘å®šäº‹ä»¶åŠäº‹ä»¶çš„å¤„ç†ç¨‹åº eventEmitter.on('eventName', eventHandler); æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºè§¦å‘äº‹ä»¶ï¼š\n// è§¦å‘äº‹ä»¶ eventEmitter.emit('eventName'); main.js\n// å¼•å…¥ events æ¨¡å— var events = require('events'); // åˆ›å»º eventEmitter å¯¹è±¡ var eventEmitter = new events.EventEmitter(); // åˆ›å»ºäº‹ä»¶å¤„ç†ç¨‹åº var connectHandler = function connected() { console.log('è¿æ¥æˆåŠŸã€‚'); // è§¦å‘ data_received äº‹ä»¶ eventEmitter.emit('data_received'); } // ç»‘å®š connection äº‹ä»¶å¤„ç†ç¨‹åº eventEmitter.on('connection', connectHandler); // ä½¿ç”¨åŒ¿åå‡½æ•°ç»‘å®š data_received äº‹ä»¶ eventEmitter.on('data_received', function(){ console.log('æ•°æ®æ¥æ”¶æˆåŠŸã€‚'); }); // è§¦å‘ connection äº‹ä»¶ eventEmitter.emit('connection'); console.log(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\"); connection -\u003e connectHandler -\u003e data_received\nnode main.js è¿æ¥æˆåŠŸã€‚ æ•°æ®æ¥æ”¶æˆåŠŸã€‚ ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚ Node åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ åœ¨ Node åº”ç”¨ç¨‹åºä¸­ï¼Œæ‰§è¡Œå¼‚æ­¥æ“ä½œçš„å‡½æ•°å°†å›è°ƒå‡½æ•°ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ï¼Œ å›è°ƒå‡½æ•°æ¥æ”¶é”™è¯¯å¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚\næ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥é‡æ–°çœ‹ä¸‹å‰é¢çš„å®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ª x.txt ,æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n//main.js var fs = require(\"fs\"); fs.readFile('x.txt', function (err, data) { if (err){ console.log(err.stack); return; } console.log(data.toString()); }); console.log(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•\"); æ‰§è¡Œ åˆ™å¼‚æ­¥è¯»å–x.txtå†…å®¹ æŠŠè·¯åŠ²æ”¹æˆ x1.txtè¯»å–é”™è¯¯åˆ™log é”™è¯¯å†…å®¹\nğŸ“”Node.js EventEmitter Node.js æ‰€æœ‰çš„å¼‚æ­¥ I/O æ“ä½œåœ¨å®Œæˆæ—¶éƒ½ä¼šå‘é€ä¸€ä¸ªäº‹ä»¶åˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚\nNode.js é‡Œé¢çš„è®¸å¤šå¯¹è±¡éƒ½ä¼šåˆ†å‘äº‹ä»¶ï¼šä¸€ä¸ª net.Server å¯¹è±¡ä¼šåœ¨æ¯æ¬¡æœ‰æ–°è¿æ¥æ—¶è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œ ä¸€ä¸ª fs.readStream å¯¹è±¡ä¼šåœ¨æ–‡ä»¶è¢«æ‰“å¼€çš„æ—¶å€™è§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚ æ‰€æœ‰è¿™äº›äº§ç”Ÿäº‹ä»¶çš„å¯¹è±¡éƒ½æ˜¯ events.EventEmitter çš„å®ä¾‹ã€‚\n//main.js æ–‡ä»¶ var EventEmitter = require('events').EventEmitter; var event = new EventEmitter(); event.on('some_event', function() { console.log('some_event äº‹ä»¶è§¦å‘'); }); setTimeout(function() { event.emit('some_event'); }, 10000); 10såæ‰§è¡Œ some_event è¾“å‡º äº‹ä»¶è§¦å‘\nEventEmitter çš„æ¯ä¸ªäº‹ä»¶ç”±ä¸€ä¸ªäº‹ä»¶åå’Œè‹¥å¹²ä¸ªå‚æ•°ç»„æˆï¼Œäº‹ä»¶åæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸è¡¨è¾¾ä¸€å®šçš„è¯­ä¹‰ã€‚å¯¹äºæ¯ä¸ªäº‹ä»¶ï¼ŒEventEmitter æ”¯æŒ è‹¥å¹²ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚\nå½“äº‹ä»¶è§¦å‘æ—¶ï¼Œæ³¨å†Œåˆ°è¿™ä¸ªäº‹ä»¶çš„äº‹ä»¶ç›‘å¬å™¨è¢«ä¾æ¬¡è°ƒç”¨ï¼Œäº‹ä»¶å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°å‚æ•°ä¼ é€’ã€‚\n//main.js æ–‡ä»¶ var events = require('events'); var emitter = new events.EventEmitter(); emitter.on('someEvent', function(arg1, arg2) { console.log('listener1', arg1, arg2); }); emitter.on('someEvent', function(arg1, arg2) { console.log('listener2', arg1, arg2); }); emitter.emit('someEvent', 'arg1 å‚æ•°', 'arg2 å‚æ•°'); emitter ä¸ºäº‹ä»¶ someEvent æ³¨å†Œäº†ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç„¶åè§¦å‘äº† someEvent äº‹ä»¶ã€‚\nè¿è¡Œç»“æœä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨å›è°ƒå‡½æ•°è¢«å…ˆåè°ƒç”¨ã€‚ è¿™å°±æ˜¯EventEmitteræœ€ç®€å•çš„ç”¨æ³•ã€‚\nEventEmitter æä¾›äº†å¤šä¸ªå±æ€§ï¼Œå¦‚ on å’Œ emitã€‚on å‡½æ•°ç”¨äºç»‘å®šäº‹ä»¶å‡½æ•°ï¼Œemit å±æ€§ç”¨äºè§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å…·ä½“çœ‹ä¸‹ EventEmitter çš„å±æ€§ä»‹ç»ã€‚\n.once ç›‘å¬å™¨æœ€å¤šåªä¼šè§¦å‘ä¸€æ¬¡ï¼Œè§¦å‘åç«‹åˆ»è§£é™¤è¯¥ç›‘å¬å™¨\nvar events = require('events'); var eventEmitter = new events.EventEmitter(); // ç›‘å¬å™¨ #1 var listener1 = function listener1() { console.log('ç›‘å¬å™¨ listener1 æ‰§è¡Œã€‚'); } // ç›‘å¬å™¨ #2 var listener2 = function listener2() { console.log('ç›‘å¬å™¨ listener2 æ‰§è¡Œã€‚'); } // ç»‘å®š connection äº‹ä»¶ï¼Œå¤„ç†å‡½æ•°ä¸º listener1 eventEmitter.addListener('connection', listener1); // ç»‘å®š connection äº‹ä»¶ï¼Œå¤„ç†å‡½æ•°ä¸º listener2 eventEmitter.on('connection', listener2); var eventListeners = eventEmitter.listenerCount('connection'); console.log(eventListeners + \" ä¸ªç›‘å¬å™¨ç›‘å¬è¿æ¥äº‹ä»¶ã€‚\"); // å¤„ç† connection äº‹ä»¶ eventEmitter.emit('connection'); // ç§»é™¤ç›‘ç»‘å®šçš„ listener1 å‡½æ•° eventEmitter.removeListener('connection', listener1); console.log(\"listener1 ä¸å†å—ç›‘å¬ã€‚\"); // è§¦å‘è¿æ¥äº‹ä»¶ eventEmitter.emit('connection'); eventListeners = eventEmitter.listenerCount('connection'); console.log(eventListeners + \" ä¸ªç›‘å¬å™¨ç›‘å¬è¿æ¥äº‹ä»¶ã€‚\"); // ç»‘å®š connection äº‹ä»¶ï¼Œå¤„ç†å‡½æ•°ä¸º listener2 eventEmitter.on('connection', listener2); eventEmitter.emit('connection'); eventListeners = eventEmitter.listenerCount('connection'); console.log(eventListeners + \" ä¸ªç›‘å¬å™¨ç›‘å¬è¿æ¥äº‹ä»¶ã€‚\"); console.log(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\"); error äº‹ä»¶ EventEmitter å®šä¹‰äº†ä¸€ä¸ªç‰¹æ®Šçš„äº‹ä»¶ errorï¼Œå®ƒåŒ…å«äº†é”™è¯¯çš„è¯­ä¹‰ï¼Œæˆ‘ä»¬åœ¨é‡åˆ° å¼‚å¸¸çš„æ—¶å€™é€šå¸¸ä¼šè§¦å‘ error äº‹ä»¶ã€‚\nå½“ error è¢«è§¦å‘æ—¶ï¼ŒEventEmitter è§„å®šå¦‚æœæ²¡æœ‰å“ åº”çš„ç›‘å¬å™¨ï¼ŒNode.js ä¼šæŠŠå®ƒå½“ä½œå¼‚å¸¸ï¼Œé€€å‡ºç¨‹åºå¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚\næˆ‘ä»¬ä¸€èˆ¬è¦ä¸ºä¼šè§¦å‘ error äº‹ä»¶çš„å¯¹è±¡è®¾ç½®ç›‘å¬å™¨ï¼Œé¿å…é‡åˆ°é”™è¯¯åæ•´ä¸ªç¨‹åºå´©æºƒã€‚ä¾‹å¦‚ï¼š\nç»§æ‰¿ EventEmitter å¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬ä¸ä¼šç›´æ¥ä½¿ç”¨ EventEmitterï¼Œè€Œæ˜¯åœ¨å¯¹è±¡ä¸­ç»§æ‰¿å®ƒã€‚åŒ…æ‹¬ fsã€netã€ http åœ¨å†…çš„ï¼Œåªè¦æ˜¯æ”¯æŒäº‹ä»¶å“åº”çš„æ ¸å¿ƒæ¨¡å—éƒ½æ˜¯ EventEmitter çš„å­ç±»ã€‚\nä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼ŸåŸå› æœ‰ä¸¤ç‚¹ï¼š\né¦–å…ˆï¼Œå…·æœ‰æŸä¸ªå®ä½“åŠŸèƒ½çš„å¯¹è±¡å®ç°äº‹ä»¶ç¬¦åˆè¯­ä¹‰ï¼Œ äº‹ä»¶çš„ç›‘å¬å’Œå‘ç”Ÿåº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚\nå…¶æ¬¡ JavaScript çš„å¯¹è±¡æœºåˆ¶æ˜¯åŸºäºåŸå‹çš„ï¼Œæ”¯æŒ éƒ¨åˆ†å¤šé‡ç»§æ‰¿ï¼Œç»§æ‰¿ EventEmitter ä¸ä¼šæ‰“ä¹±å¯¹è±¡åŸæœ‰çš„ç»§æ‰¿å…³ç³»ã€‚\nâ› Node.js Buffer JavaScript è¯­è¨€è‡ªèº«åªæœ‰å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œæ²¡æœ‰äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚\nä½†åœ¨å¤„ç†åƒTCPæµæˆ–æ–‡ä»¶æµæ—¶ï¼Œå¿…é¡»ä½¿ç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚å› æ­¤åœ¨ Node.jsä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª Buffer ç±»ï¼Œè¯¥ç±»ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å­˜åŒºã€‚\nåœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯éš Node å†…æ ¸ä¸€èµ·å‘å¸ƒçš„æ ¸å¿ƒåº“ã€‚Buffer åº“ä¸º Node.js å¸¦æ¥äº†ä¸€ç§å­˜å‚¨åŸå§‹æ•°æ®çš„æ–¹æ³•ï¼Œå¯ä»¥è®© Node.js å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯å½“éœ€è¦åœ¨ Node.js ä¸­å¤„ç†I/Oæ“ä½œä¸­ç§»åŠ¨çš„æ•°æ®æ—¶ï¼Œå°±æœ‰å¯èƒ½ä½¿ç”¨ Buffer åº“ã€‚åŸå§‹æ•°æ®å­˜å‚¨åœ¨ Buffer ç±»çš„å®ä¾‹ä¸­ã€‚ä¸€ä¸ª Buffer ç±»ä¼¼äºä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œä½†å®ƒå¯¹åº”äº V8 å †å†…å­˜ä¹‹å¤–çš„ä¸€å—åŸå§‹å†…å­˜ã€‚\nBuffer ä¸å­—ç¬¦ç¼–ç \nBuffer å®ä¾‹ä¸€èˆ¬ç”¨äºè¡¨ç¤ºç¼–ç å­—ç¬¦çš„åºåˆ—ï¼Œæ¯”å¦‚ UTF-8 ã€ UCS2 ã€ Base64 ã€æˆ–åå…­è¿›åˆ¶ç¼–ç çš„æ•°æ®ã€‚ é€šè¿‡ä½¿ç”¨æ˜¾å¼çš„å­—ç¬¦ç¼–ç ï¼Œå°±å¯ä»¥åœ¨ Buffer å®ä¾‹ä¸æ™®é€šçš„ JavaScript å­—ç¬¦ä¸²ä¹‹é—´è¿›è¡Œç›¸äº’è½¬æ¢ã€‚\nBuffer.from() åˆ›å»ºå¯¹è±¡\nconst buf = Buffer.from('test', 'ascii'); // è¾“å‡º 72756e6f6f62 console.log(buf.toString('hex')); // è¾“å‡º cnVub29i console.log(buf.toString('base64')); //UTF-8 console.log(buf.toString('UTF-8')); //ascii console.log(buf.toString('ascii')); //utf16le console.log(buf.toString('utf16le')); //latin1 console.log(buf.toString('latin1')); Node.js ç›®å‰æ”¯æŒçš„å­—ç¬¦ç¼–ç åŒ…æ‹¬ï¼š\nascii - ä»…æ”¯æŒ 7 ä½ ASCII æ•°æ®ã€‚å¦‚æœè®¾ç½®å»æ‰é«˜ä½çš„è¯ï¼Œè¿™ç§ç¼–ç æ˜¯éå¸¸å¿«çš„ã€‚\nutf8 - å¤šå­—èŠ‚ç¼–ç çš„ Unicode å­—ç¬¦ã€‚è®¸å¤šç½‘é¡µå’Œå…¶ä»–æ–‡æ¡£æ ¼å¼éƒ½ä½¿ç”¨ UTF-8 ã€‚\nutf16le - 2 æˆ– 4 ä¸ªå­—èŠ‚ï¼Œå°å­—èŠ‚åºç¼–ç çš„ Unicode å­—ç¬¦ã€‚æ”¯æŒä»£ç†å¯¹ï¼ˆU+10000 è‡³ U+10FFFFï¼‰ã€‚\nucs2 - utf16le çš„åˆ«åã€‚\nbase64 - Base64 ç¼–ç ã€‚\nlatin1 - ä¸€ç§æŠŠ Buffer ç¼–ç æˆä¸€å­—èŠ‚ç¼–ç çš„å­—ç¬¦ä¸²çš„æ–¹å¼ã€‚\nbinary - latin1 çš„åˆ«åã€‚\nhex - å°†æ¯ä¸ªå­—èŠ‚ç¼–ç ä¸ºä¸¤ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ã€‚\nåˆ›å»º Buffer ç±» Buffer æä¾›äº†ä»¥ä¸‹ API æ¥åˆ›å»º Buffer ç±»ï¼š\nBuffer.alloc(size[, fill[, encoding]])ï¼š è¿”å›ä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Buffer å®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® fillï¼Œåˆ™é»˜è®¤å¡«æ»¡ 0 Buffer.allocUnsafe(size)ï¼š è¿”å›ä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Buffer å®ä¾‹ï¼Œä½†æ˜¯å®ƒä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œæ‰€ä»¥å®ƒå¯èƒ½åŒ…å«æ•æ„Ÿçš„æ•°æ® Buffer.allocUnsafeSlow(size) Buffer.from(array)ï¼š è¿”å›ä¸€ä¸ªè¢« array çš„å€¼åˆå§‹åŒ–çš„æ–°çš„ Buffer å®ä¾‹ï¼ˆä¼ å…¥çš„ array çš„å…ƒç´ åªèƒ½æ˜¯æ•°å­—ï¼Œä¸ç„¶å°±ä¼šè‡ªåŠ¨è¢« 0 è¦†ç›–ï¼‰ Buffer.from(arrayBuffer[, byteOffset[, length]])ï¼š è¿”å›ä¸€ä¸ªæ–°å»ºçš„ä¸ç»™å®šçš„ ArrayBuffer å…±äº«åŒä¸€å†…å­˜çš„ Bufferã€‚ Buffer.from(buffer)ï¼š å¤åˆ¶ä¼ å…¥çš„ Buffer å®ä¾‹çš„æ•°æ®ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹ Buffer.from(string[, encoding])ï¼š è¿”å›ä¸€ä¸ªè¢« string çš„å€¼åˆå§‹åŒ–çš„æ–°çš„ Buffer å®ä¾‹\nå†™å…¥ç¼“å†²åŒº è¯­æ³• å†™å…¥ Node ç¼“å†²åŒºçš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\nbuf.write(string[, offset[, length]][, encoding]) å‚æ•° å‚æ•°æè¿°å¦‚ä¸‹ï¼š\nstring - å†™å…¥ç¼“å†²åŒºçš„å­—ç¬¦ä¸²ã€‚\noffset - ç¼“å†²åŒºå¼€å§‹å†™å…¥çš„ç´¢å¼•å€¼ï¼Œé»˜è®¤ä¸º 0 ã€‚\nlength - å†™å…¥çš„å­—èŠ‚æ•°ï¼Œé»˜è®¤ä¸º buffer.length\nencoding - ä½¿ç”¨çš„ç¼–ç ã€‚é»˜è®¤ä¸º â€˜utf8â€™ ã€‚\næ ¹æ® encoding çš„å­—ç¬¦ç¼–ç å†™å…¥ string åˆ° buf ä¸­çš„ offset ä½ç½®ã€‚ length å‚æ•°æ˜¯å†™å…¥çš„å­—èŠ‚æ•°ã€‚ å¦‚æœ buf æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ä¿å­˜æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™åªä¼šå†™å…¥ string çš„ä¸€éƒ¨åˆ†ã€‚ åªéƒ¨åˆ†è§£ç çš„å­—ç¬¦ä¸ä¼šè¢«å†™å…¥ã€‚\nè¿”å›å€¼ è¿”å›å®é™…å†™å…¥çš„å¤§å°ã€‚å¦‚æœ buffer ç©ºé—´ä¸è¶³ï¼Œ åˆ™åªä¼šå†™å…¥éƒ¨åˆ†å­—ç¬¦ä¸²ã€‚\nå®ä¾‹\nbuf = Buffer.alloc(256); len = buf.write(\"123123\"); console.log(\"å†™å…¥å­—èŠ‚æ•° : \"+ len); ä»ç¼“å†²åŒºè¯»å–æ•°æ® è¯­æ³• è¯»å– Node ç¼“å†²åŒºæ•°æ®çš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\nbuf.toString([encoding[, start[, end]]]) å‚æ•° å‚æ•°æè¿°å¦‚ä¸‹ï¼š\nencoding - ä½¿ç”¨çš„ç¼–ç ã€‚é»˜è®¤ä¸º â€˜utf8â€™ ã€‚\nstart - æŒ‡å®šå¼€å§‹è¯»å–çš„ç´¢å¼•ä½ç½®ï¼Œé»˜è®¤ä¸º 0ã€‚\nend - ç»“æŸä½ç½®ï¼Œé»˜è®¤ä¸ºç¼“å†²åŒºçš„æœ«å°¾ã€‚\nè¿”å›å€¼ è§£ç ç¼“å†²åŒºæ•°æ®å¹¶ä½¿ç”¨æŒ‡å®šçš„ç¼–ç è¿”å›å­—ç¬¦ä¸²ã€‚\nå®ä¾‹\nbuf = Buffer.alloc(26); for (var i = 0 ; i \u003c 26 ; i++) { buf[i] = i + 97; } console.log( buf.toString('ascii')); // è¾“å‡º: abcdefghijklmnopqrstuvwxyz console.log( buf.toString('ascii',0,5)); //ä½¿ç”¨ 'ascii' ç¼–ç , å¹¶è¾“å‡º: abcde console.log( buf.toString('utf8',0,5)); // ä½¿ç”¨ 'utf8' ç¼–ç , å¹¶è¾“å‡º: abcde console.log( buf.toString(undefined,0,5)); // ä½¿ç”¨é»˜è®¤çš„ 'utf8' ç¼–ç , å¹¶è¾“å‡º: abcde å°† Buffer è½¬æ¢ä¸º JSON å¯¹è±¡ è¯­æ³• å°† Node Buffer è½¬æ¢ä¸º JSON å¯¹è±¡çš„å‡½æ•°è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š\nbuf.toJSON() const buf = Buffer.from([0x1, 0x2, 0x3, 0x4, 0x5]); const json = JSON.stringify(buf); // è¾“å‡º: {\"type\":\"Buffer\",\"data\":[1,2,3,4,5]} console.log(json); const copy = JSON.parse(json, (key, value) =\u003e { return value \u0026\u0026 value.type === 'Buffer' ? Buffer.from(value.data) : value; }); // è¾“å‡º: console.log(copy); ç¼“å†²åŒºåˆå¹¶ è¯­æ³• Node ç¼“å†²åŒºåˆå¹¶çš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\nBuffer.concat(list[, totalLength]) var buffer1 = Buffer.from(('123')); var buffer2 = Buffer.from(('test')); var buffer3 = Buffer.concat([buffer1,buffer2]); console.log(\"buffer3 å†…å®¹: \" + buffer3.toString()); ç¼“å†²åŒºæ¯”è¾ƒ è¯­æ³• Node Buffer æ¯”è¾ƒçš„å‡½æ•°è¯­æ³•å¦‚ä¸‹æ‰€ç¤º, è¯¥æ–¹æ³•åœ¨ Node.js v0.12.2 ç‰ˆæœ¬å¼•å…¥ï¼š\nbuf.compare(otherBuffer); var buffer1 = Buffer.from('ABC'); var buffer2 = Buffer.from('ABCD'); var result = buffer1.compare(buffer2); if(result \u003c 0) { console.log(buffer1 + \" åœ¨ \" + buffer2 + \"ä¹‹å‰\"); }else if(result == 0){ console.log(buffer1 + \" ä¸ \" + buffer2 + \"ç›¸åŒ\"); }else { console.log(buffer1 + \" åœ¨ \" + buffer2 + \"ä¹‹å\"); } æ‹·è´ç¼“å†²åŒº è¯­æ³• Node ç¼“å†²åŒºæ‹·è´è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\nbuf.copy(targetBuffer[, targetStart[, sourceStart[, sourceEnd]]]) var buf1 = Buffer.from('abcdefghijkl'); var buf2 = Buffer.from('123'); //å°† buf2 æ’å…¥åˆ° buf1 æŒ‡å®šä½ç½®ä¸Š buf2.copy(buf1, 2); console.log(buf1.toString()); ç¼“å†²åŒºè£å‰ª Node ç¼“å†²åŒºè£å‰ªè¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\nbuf.slice([start[, end]]) var buffer1 = Buffer.from('TEST123TEST'); // å‰ªåˆ‡ç¼“å†²åŒº var buffer2 = buffer1.slice(0,2); console.log(\"buffer2 content: \" + buffer2.toString()); ç¼“å†²åŒºé•¿åº¦ è¯­æ³• Node ç¼“å†²åŒºé•¿åº¦è®¡ç®—è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\nbuf.length; var buffer = Buffer.from('123123123'); // ç¼“å†²åŒºé•¿åº¦ console.log(\"buffer length: \" + buffer.length); ğŸ‘¨â€ğŸ’»Node.js Stream Node.js Stream(æµ)\nStream æ˜¯ä¸€ä¸ªæŠ½è±¡æ¥å£ï¼ŒNode ä¸­æœ‰å¾ˆå¤šå¯¹è±¡å®ç°äº†è¿™ä¸ªæ¥å£ã€‚ä¾‹å¦‚ï¼Œå¯¹http æœåŠ¡å™¨å‘èµ·è¯·æ±‚çš„request å¯¹è±¡å°±æ˜¯ä¸€ä¸ª Streamï¼Œè¿˜æœ‰stdoutï¼ˆæ ‡å‡†è¾“å‡ºï¼‰ã€‚\nNode.jsï¼ŒStream æœ‰å››ç§æµç±»å‹ï¼š\nReadable - å¯è¯»æ“ä½œã€‚\nWritable - å¯å†™æ“ä½œã€‚\nDuplex - å¯è¯»å¯å†™æ“ä½œ.\nTransform - æ“ä½œè¢«å†™å…¥æ•°æ®ï¼Œç„¶åè¯»å‡ºç»“æœã€‚\næ‰€æœ‰çš„ Stream å¯¹è±¡éƒ½æ˜¯ EventEmitter çš„å®ä¾‹ã€‚å¸¸ç”¨çš„äº‹ä»¶æœ‰ï¼š\ndata - å½“æœ‰æ•°æ®å¯è¯»æ—¶è§¦å‘ã€‚\nend - æ²¡æœ‰æ›´å¤šçš„æ•°æ®å¯è¯»æ—¶è§¦å‘ã€‚\nerror - åœ¨æ¥æ”¶å’Œå†™å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ã€‚\nfinish - æ‰€æœ‰æ•°æ®å·²è¢«å†™å…¥åˆ°åº•å±‚ç³»ç»Ÿæ—¶è§¦å‘ã€‚\nvar fs = require(\"fs\"); var data = ''; // åˆ›å»ºå¯è¯»æµ var readerStream = fs.createReadStream('x.txt'); // è®¾ç½®ç¼–ç ä¸º utf8ã€‚ readerStream.setEncoding('UTF8'); // å¤„ç†æµäº‹ä»¶ --\u003e data, end, and error readerStream.on('data', function(chunk) { data += chunk; }); readerStream.on('end',function(){ console.log(data); }); readerStream.on('error', function(err){ console.log(err.stack); }); console.log(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•\"); å†™å…¥æµ\nvar fs = require(\"fs\"); var data = ''; var dataw = 'w123w'; var ws = fs.createWriteStream('x.txt'); ws.write(dataw); ws.end(); console.log(\"æ•°æ®å†™å…¥æˆåŠŸï¼\"); ç®¡é“æµ ç®¡é“æä¾›äº†ä¸€ä¸ªè¾“å‡ºæµåˆ°è¾“å…¥æµçš„æœºåˆ¶ã€‚é€šå¸¸æˆ‘ä»¬ç”¨äºä»ä¸€ä¸ªæµä¸­è·å–æ•°æ®å¹¶å°†æ•°æ®ä¼ é€’åˆ°å¦å¤–ä¸€ä¸ªæµä¸­ã€‚\nvar fs = require(\"fs\"); // åˆ›å»ºä¸€ä¸ªå¯è¯»æµ var readerStream = fs.createReadStream('x.txt'); // åˆ›å»ºä¸€ä¸ªå¯å†™æµ var writerStream = fs.createWriteStream('output.txt'); // ç®¡é“è¯»å†™æ“ä½œ // è¯»å– input.txt æ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†å†…å®¹å†™å…¥åˆ° output.txt æ–‡ä»¶ä¸­ readerStream.pipe(writerStream); console.log(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•\"); é“¾å¼æµ é“¾å¼æ˜¯é€šè¿‡è¿æ¥è¾“å‡ºæµåˆ°å¦å¤–ä¸€ä¸ªæµå¹¶åˆ›å»ºå¤šä¸ªæµæ“ä½œé“¾çš„æœºåˆ¶ã€‚é“¾å¼æµä¸€èˆ¬ç”¨äºç®¡é“æ“ä½œã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯ç”¨ç®¡é“å’Œé“¾å¼æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚\nvar fs = require(\"fs\"); var zlib = require('zlib'); // å‹ç¼© input.txt æ–‡ä»¶ä¸º input.txt.gz fs.createReadStream('x.txt') .pipe(zlib.createGzip()) .pipe(fs.createWriteStream('input.txt.gz')); console.log(\"æ–‡ä»¶å‹ç¼©å®Œæˆã€‚\"); var fs = require(\"fs\"); var zlib = require('zlib'); // è§£å‹ input.txt.gz æ–‡ä»¶ä¸º input.txt fs.createReadStream('input.txt.gz') .pipe(zlib.createGunzip()) .pipe(fs.createWriteStream('input2.txt')); console.log(\"æ–‡ä»¶è§£å‹å®Œæˆã€‚\"); ğŸ“Node.js æ¨¡å—ç³»ç»Ÿ ~~\nä¸ºäº†è®©Node.jsçš„æ–‡ä»¶å¯ä»¥ç›¸äº’è°ƒç”¨ï¼ŒNode.jsæä¾›äº†ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿã€‚\næ¨¡å—æ˜¯Node.js åº”ç”¨ç¨‹åºçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼Œæ–‡ä»¶å’Œæ¨¡å—æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚æ¢è¨€ä¹‹ï¼Œä¸€ä¸ª Node.js æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªæ–‡ä»¶å¯èƒ½æ˜¯JavaScript ä»£ç ã€JSON æˆ–è€…ç¼–è¯‘è¿‡çš„C/C++ æ‰©å±•ã€‚\n//hello.js exports.world1 = function() { console.log(\"hello world node.js \") } //test.js var hello = require('./hello'); hello.world1(); hello.js é€šè¿‡ exports å¯¹è±¡æŠŠ world1 ä½œä¸ºæ¨¡å—çš„è®¿é—®æ¥å£ï¼Œåœ¨ main.js ä¸­é€šè¿‡ require(â€™./helloâ€™) åŠ è½½è¿™ä¸ªæ¨¡å—ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥è®¿ é—® hello.js ä¸­ exports å¯¹è±¡çš„æˆå‘˜å‡½æ•°äº†ã€‚\n//hello.js function Hello() { var name; this.setName = function(thyName) { name = thyName; }; this.sayHello = function() { console.log('Hello ' + name); }; }; module.exports = Hello; //test.js var Hello = require('./hello'); hello = new Hello(); hello.setName('vvv'); hello.sayHello(); æ¨¡å—æ¥å£çš„å”¯ä¸€å˜åŒ–æ˜¯ä½¿ç”¨ module.exports = Hello ä»£æ›¿äº†exports.world = function(){}ã€‚ åœ¨å¤–éƒ¨å¼•ç”¨è¯¥æ¨¡å—æ—¶ï¼Œå…¶æ¥å£å¯¹è±¡å°±æ˜¯è¦è¾“å‡ºçš„ Hello å¯¹è±¡æœ¬èº«ï¼Œè€Œä¸æ˜¯åŸå…ˆçš„ exportsã€‚\nexports å’Œ module.exports çš„ä½¿ç”¨\nå¦‚æœè¦å¯¹å¤–æš´éœ²å±æ€§æˆ–æ–¹æ³•ï¼Œå°±ç”¨ exports å°±è¡Œï¼Œè¦æš´éœ²å¯¹è±¡(ç±»ä¼¼classï¼ŒåŒ…å«äº†å¾ˆå¤šå±æ€§å’Œæ–¹æ³•)ï¼Œå°±ç”¨ module.exportsã€‚\nPS æ¨¡å—åŠ è½½ ä»æ–‡ä»¶æ¨¡å—ç¼“å­˜ä¸­åŠ è½½ å°½ç®¡åŸç”Ÿæ¨¡å—ä¸æ–‡ä»¶æ¨¡å—çš„ä¼˜å…ˆçº§ä¸åŒï¼Œä½†æ˜¯éƒ½ä¼šä¼˜å…ˆä»æ–‡ä»¶æ¨¡å—çš„ç¼“å­˜ä¸­åŠ è½½å·²ç»å­˜åœ¨çš„æ¨¡å—ã€‚\nä»åŸç”Ÿæ¨¡å—åŠ è½½ åŸç”Ÿæ¨¡å—çš„ä¼˜å…ˆçº§ä»…æ¬¡äºæ–‡ä»¶æ¨¡å—ç¼“å­˜çš„ä¼˜å…ˆçº§ã€‚require æ–¹æ³•åœ¨è§£ææ–‡ä»¶åä¹‹åï¼Œä¼˜å…ˆæ£€æŸ¥æ¨¡å—æ˜¯å¦åœ¨åŸç”Ÿæ¨¡å—åˆ—è¡¨ä¸­ã€‚ä»¥httpæ¨¡å—ä¸ºä¾‹ï¼Œå°½ç®¡åœ¨ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ª http/http.js/http.node/http.json æ–‡ä»¶ï¼Œrequire(â€œhttpâ€) éƒ½ä¸ä¼šä»è¿™äº›æ–‡ä»¶ä¸­åŠ è½½ï¼Œè€Œæ˜¯ä»åŸç”Ÿæ¨¡å—ä¸­åŠ è½½ã€‚\nåŸç”Ÿæ¨¡å—ä¹Ÿæœ‰ä¸€ä¸ªç¼“å­˜åŒºï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¼˜å…ˆä»ç¼“å­˜åŒºåŠ è½½ã€‚å¦‚æœç¼“å­˜åŒºæ²¡æœ‰è¢«åŠ è½½è¿‡ï¼Œåˆ™è°ƒç”¨åŸç”Ÿæ¨¡å—çš„åŠ è½½æ–¹å¼è¿›è¡ŒåŠ è½½å’Œæ‰§è¡Œã€‚\nä»æ–‡ä»¶åŠ è½½ å½“æ–‡ä»¶æ¨¡å—ç¼“å­˜ä¸­ä¸å­˜åœ¨ï¼Œè€Œä¸”ä¸æ˜¯åŸç”Ÿæ¨¡å—çš„æ—¶å€™ï¼ŒNode.js ä¼šè§£æ require æ–¹æ³•ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶ä»æ–‡ä»¶ç³»ç»Ÿä¸­åŠ è½½å®é™…çš„æ–‡ä»¶ï¼ŒåŠ è½½è¿‡ç¨‹ä¸­çš„åŒ…è£…å’Œç¼–è¯‘ç»†èŠ‚åœ¨å‰ä¸€èŠ‚ä¸­å·²ç»ä»‹ç»è¿‡ï¼Œè¿™é‡Œæˆ‘ä»¬å°†è¯¦ç»†æè¿°æŸ¥æ‰¾æ–‡ä»¶æ¨¡å—çš„è¿‡ç¨‹ï¼Œå…¶ä¸­ï¼Œä¹Ÿæœ‰ä¸€äº›ç»†èŠ‚å€¼å¾—çŸ¥æ™“ã€‚\nrequireæ–¹æ³•æ¥å—ä»¥ä¸‹å‡ ç§å‚æ•°çš„ä¼ é€’ï¼š\nhttpã€fsã€pathç­‰ï¼ŒåŸç”Ÿæ¨¡å—ã€‚ ./modæˆ–../modï¼Œç›¸å¯¹è·¯å¾„çš„æ–‡ä»¶æ¨¡å—ã€‚ /pathtomodule/modï¼Œç»å¯¹è·¯å¾„çš„æ–‡ä»¶æ¨¡å—ã€‚ modï¼ŒéåŸç”Ÿæ¨¡å—çš„æ–‡ä»¶æ¨¡å—ã€‚\nğŸ”„nodejs åŠ è½½c++ åœ¨Node.jsä¸­åŠ è½½C++ä»£ç ï¼Œé€šå¸¸æ˜¯é€šè¿‡ç¼–å†™ä¸€ä¸ªC++çš„æ‰©å±•æ¨¡å—ï¼Œç„¶åé€šè¿‡Node.jsçš„requireæ–¹æ³•åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚è¿™å¯ä»¥é€šè¿‡Node.jsçš„åŸç”Ÿæ‰©å±•æ¨¡å—APIå®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡N-APIå®ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸ºæ„å»ºå¯ä»¥åœ¨å¤šä¸ªNode.jsç‰ˆæœ¬ä¸Šå·¥ä½œçš„åŸç”Ÿæ‰©å±•æ¨¡å—è€Œè®¾è®¡çš„APIã€‚\nä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªC++æ‰©å±•æ¨¡å—å¹¶åœ¨Node.jsä¸­ä½¿ç”¨å®ƒã€‚\né¦–å…ˆï¼Œä½ éœ€è¦å®‰è£…ä¸€ä¸ªåä¸ºnode-gypçš„å·¥å…·ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥ç¼–è¯‘C++æ‰©å±•æ¨¡å—çš„å·¥å…·ï¼š\nnpm install -g node-gyp ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºbinding.gypçš„æ–‡ä»¶ï¼Œå®ƒæè¿°äº†å¦‚ä½•æ„å»ºæ‰©å±•æ¨¡å—ï¼š\n{ \"targets\": [ { \"target_name\": \"addon\", \"sources\": [ \"addon.cc\" ] } ] } æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªC++æºæ–‡ä»¶ï¼Œä¾‹å¦‚addon.ccï¼Œå®ƒåŒ…å«äº†ä½ çš„C++ä»£ç ï¼š\n#include namespace demo { using v8::FunctionCallbackInfo; using v8::Isolate; using v8::Local; using v8::NewStringType; using v8::Object; using v8::String; using v8::Value; void Method(const FunctionCallbackInfo\u003cValue\u003e\u0026 args) { Isolate* isolate = args.GetIsolate(); args.GetReturnValue().Set(String::NewFromUtf8(isolate, \"world\", NewStringType::kNormal).ToLocalChecked()); } void Initialize(Local\u003cObject\u003e exports) { NODE_SET_METHOD(exports, \"hello\", Method); } NODE_MODULE(NODE_GYP_MODULE_NAME, Initialize) } // namespace demo ç¡®ä¿åœ¨binding.gypæ–‡ä»¶çš„åŒä¸€ç›®å½•ä¸‹ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ„å»ºæ‰©å±•æ¨¡å—ï¼š\nnode-gyp configure build è¿™å°†ç”Ÿæˆä¸€ä¸ªç¼–è¯‘å¥½çš„æ‰©å±•æ¨¡å—ï¼Œä½ å¯ä»¥åœ¨Node.jsä¸­é€šè¿‡requireæ¥åŠ è½½å¹¶ä½¿ç”¨å®ƒï¼š\nconst addon = require('./build/Release/addon.node'); console.log(addon.hello()); // è¾“å‡º: world åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒC++æ¨¡å—å¯¼å‡ºäº†ä¸€ä¸ªåä¸ºhelloçš„æ–¹æ³•ï¼Œå½“åœ¨Node.jsä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒè¿”å›å­—ç¬¦ä¸²\"world\"ã€‚\nğŸ™‹â€â™€ï¸Node.js å‡½æ•° åœ¨ JavaScriptä¸­ï¼Œä¸€ä¸ªå‡½æ•°å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åä¼ é€’ï¼Œä¹Ÿå¯ä»¥åœ¨ä¼ é€’å‚æ•°çš„åœ°æ–¹ç›´æ¥å®šä¹‰å‡½æ•°ã€‚\nNode.js ä¸­å‡½æ•°çš„ä½¿ç”¨ä¸ JavaScript ç±»ä¼¼ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š\nfunction say(word) { console.log(word); } function execute(someFunction, value) { someFunction(value); } execute(say, \"Hello\"); ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠ say å‡½æ•°ä½œä¸º execute å‡½æ•°çš„ç¬¬ä¸€ä¸ªå˜é‡è¿›è¡Œäº†ä¼ é€’ã€‚è¿™é‡Œä¼ é€’çš„ä¸æ˜¯ say çš„è¿”å›å€¼ï¼Œè€Œæ˜¯ say æœ¬èº«ï¼\nè¿™æ ·ä¸€æ¥ï¼Œ say å°±å˜æˆäº†execute ä¸­çš„æœ¬åœ°å˜é‡ someFunction ï¼Œexecute å¯ä»¥é€šè¿‡è°ƒç”¨ someFunction() ï¼ˆå¸¦æ‹¬å·çš„å½¢å¼ï¼‰æ¥ä½¿ç”¨ say å‡½æ•°ã€‚\nå½“ç„¶ï¼Œå› ä¸º say æœ‰ä¸€ä¸ªå˜é‡ï¼Œ execute åœ¨è°ƒç”¨ someFunction æ—¶å¯ä»¥ä¼ é€’è¿™æ ·ä¸€ä¸ªå˜é‡ã€‚\nåŒ¿åå‡½æ•° function execute(someFunction, value) { someFunction(value); } execute(function(word){ console.log(word) }, \"Hello\"); ä¼ é€’\nvar http = require(\"http\"); function onRequest(request, response) { response.writeHead(200, {\"Content-Type\": \"text/plain\"}); response.write(\"Hello World\"); response.end(); } http.createServer(onRequest).listen(8888); ==\u003e\nvar http = require(\"http\"); http.createServer(function(request, response) { response.writeHead(200, {\"Content-Type\": \"text/plain\"}); response.write(\"Hello World\"); response.end(); }).listen(8888); ğŸ™‹â€â™‚Node.js ç®­å¤´å‡½æ•° åœ¨Node.jsä¸­ï¼Œç®­å¤´å‡½æ•°æ˜¯ä¸€ç§ç®€æ´å†™æ³•ï¼Œç”¨äºå£°æ˜åŒ¿åå‡½æ•°ã€‚å®ƒä»¬æœ€å¸¸ç”¨äºå›è°ƒå‡½æ•°å’Œäº‹ä»¶ç›‘å¬å™¨ç­‰åœºæ™¯ã€‚ç®­å¤´å‡½æ•°çš„è¯­æ³•å¾ˆç®€å•ï¼Œå®ƒçš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š\n(param1, param2, ...) =\u003e { // å‡½æ•°ä½“ return something; } const numbers = [1, 2, 3, 4, 5]; const doubled = numbers.map(number =\u003e number * 2); console.log(doubled); // è¾“å‡º: [2, 4, 6, 8, 10] setTimeout(() =\u003e { console.log('hihihi.'); }, 2000); ä»¥ä¸Šå†³ç­–å›¾çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘è®¤ä¸ºæœ‰ä¸‰ç‚¹æ¯”è¾ƒé‡è¦ï¼š\nç®­å¤´å‡½æ•°é€‚åˆäºæ— å¤æ‚é€»è¾‘æˆ–è€…æ— å‰¯ä½œç”¨çš„çº¯å‡½æ•°åœºæ™¯ä¸‹ï¼Œä¾‹å¦‚ç”¨åœ¨ map ã€ reduce ã€ filter çš„å›è°ƒå‡½æ•°å®šä¹‰ä¸­ï¼› ä¸è¦åœ¨æœ€å¤–å±‚å®šä¹‰ç®­å¤´å‡½æ•°ï¼Œå› ä¸ºåœ¨å‡½æ•°å†…éƒ¨æ“ä½œ this ä¼šå¾ˆå®¹æ˜“æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸã€‚æœ€èµ·ç åœ¨ç®­å¤´å‡½æ•°å¤–éƒ¨åŒ…ä¸€å±‚æ™®é€šå‡½æ•°ï¼Œå°† this æ§åˆ¶åœ¨å¯è§çš„èŒƒå›´å†…ï¼› å¦‚å¼€å¤´æ‰€è¿°ï¼Œç®­å¤´å‡½æ•°æœ€å¸å¼•äººçš„åœ°æ–¹æ˜¯ç®€æ´ã€‚åœ¨æœ‰å¤šå±‚å‡½æ•°åµŒå¥—çš„æƒ…å†µä¸‹ï¼Œç®­å¤´å‡½æ•°çš„ç®€æ´æ€§å¹¶æ²¡æœ‰å¾ˆå¤§çš„æå‡ï¼Œåè€Œå½±å“äº†å‡½æ•°çš„ä½œç”¨èŒƒå›´çš„è¯†åˆ«åº¦ï¼Œè¿™ç§æƒ…å†µä¸å»ºè®®ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚\nğŸ§ªNode.js è·¯ç”± åœ¨ Node.js ä¸­ï¼Œè·¯ç”±ï¼ˆRoutingï¼‰æ˜¯æŒ‡ç¡®å®šå¦‚ä½•å“åº”å¯¹ç‰¹å®šç«¯ç‚¹ï¼ˆURL è·¯å¾„ï¼‰çš„ HTTP è¯·æ±‚çš„è¿‡ç¨‹ã€‚\næˆ‘ä»¬è¦ä¸ºè·¯ç”±æä¾›è¯·æ±‚çš„ URL å’Œå…¶ä»–éœ€è¦çš„ GET åŠ POST å‚æ•°ï¼Œéšåè·¯ç”±éœ€è¦æ ¹æ®è¿™äº›æ•°æ®æ¥æ‰§è¡Œç›¸åº”çš„ä»£ç ã€‚\nå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹ HTTP è¯·æ±‚ï¼Œä»ä¸­æå–å‡ºè¯·æ±‚çš„ URL ä»¥åŠ GET/POST å‚æ•°ã€‚è¿™ä¸€åŠŸèƒ½åº”å½“å±äºè·¯ç”±è¿˜æ˜¯æœåŠ¡å™¨ï¼ˆç”šè‡³ä½œä¸ºä¸€ä¸ªæ¨¡å—è‡ªèº«çš„åŠŸèƒ½ï¼‰ç¡®å®å€¼å¾—æ¢è®¨ï¼Œä½†è¿™é‡Œæš‚å®šå…¶ä¸ºæˆ‘ä»¬çš„HTTPæœåŠ¡å™¨çš„åŠŸèƒ½ã€‚\næˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰æ•°æ®éƒ½ä¼šåŒ…å«åœ¨ request å¯¹è±¡ä¸­ï¼Œè¯¥å¯¹è±¡ä½œä¸º onRequest() å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ã€‚ä½†æ˜¯ä¸ºäº†è§£æè¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–çš„ Node.JS æ¨¡å—ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ url å’Œ querystring æ¨¡å—ã€‚\nurl.parse(string).query | url.parse(string).pathname | | | | | ++++++ ++++++++++++++++++- http://localhost:8888/start?foo=bar\u0026hello=world +++ +++â€“ | | | | querystring.parse(queryString)[â€œfooâ€] | | querystring.parse(queryString)[â€œhelloâ€] ç°åœ¨æˆ‘ä»¬æ¥ç»™ onRequest() å‡½æ•°åŠ ä¸Šä¸€äº›é€»è¾‘ï¼Œç”¨æ¥æ‰¾å‡ºæµè§ˆå™¨è¯·æ±‚çš„ URL è·¯å¾„ï¼š\nrouter.js\nfunction route(pathname) { console.log(\"About to route a request for \" + pathname); } exports.route = route; server.js\nvar http = require(\"http\"); var url = require(\"url\"); function start(route) { function onRequest(request, response) { var pathname = url.parse(request.url).pathname; console.log(\"Request for \" + pathname + \" received.\"); route(pathname); response.writeHead(200, {\"Content-Type\": \"text/plain\"}); response.write(\"Hello World\"); response.end(); } http.createServer(onRequest).listen(8888); console.log(\"Server has started.\"); } exports.start = start; //test.js var server = require(\"./server\"); var router = require(\"./router\"); server.start(router.route); node test.js ğŸ™Node.js å…¨å±€å¯¹è±¡ javaScript ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œç§°ä¸ºå…¨å±€å¯¹è±¡ï¼ˆGlobal Objectï¼‰ï¼Œå®ƒåŠå…¶æ‰€æœ‰å±æ€§éƒ½å¯ä»¥åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹è®¿é—®ï¼Œå³å…¨å±€å˜é‡ã€‚\nåœ¨æµè§ˆå™¨ JavaScript ä¸­ï¼Œé€šå¸¸ window æ˜¯å…¨å±€å¯¹è±¡ï¼Œ è€Œ Node.js ä¸­çš„å…¨å±€å¯¹è±¡æ˜¯ globalï¼Œæ‰€æœ‰å…¨å±€å˜é‡ï¼ˆé™¤äº† global æœ¬èº«ä»¥å¤–ï¼‰éƒ½æ˜¯ global å¯¹è±¡çš„å±æ€§ã€‚\nåœ¨ Node.js æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®åˆ° global çš„å±æ€§ï¼Œè€Œä¸éœ€è¦åœ¨åº”ç”¨ä¸­åŒ…å«å®ƒã€‚\nå…¨å±€å¯¹è±¡ä¸å…¨å±€å˜é‡ global æœ€æ ¹æœ¬çš„ä½œç”¨æ˜¯ä½œä¸ºå…¨å±€å˜é‡çš„å®¿ä¸»ã€‚æŒ‰ç…§ ECMAScript çš„å®šä¹‰ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ ä»¶çš„å˜é‡æ˜¯å…¨å±€å˜é‡ï¼š\nåœ¨æœ€å¤–å±‚å®šä¹‰çš„å˜é‡ï¼› å…¨å±€å¯¹è±¡çš„å±æ€§ï¼› éšå¼å®šä¹‰çš„å˜é‡ï¼ˆæœªå®šä¹‰ç›´æ¥èµ‹å€¼çš„å˜é‡ï¼‰ã€‚ å½“ä½ å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡æ—¶ï¼Œè¿™ä¸ªå˜é‡åŒæ—¶ä¹Ÿä¼šæˆä¸ºå…¨å±€å¯¹è±¡çš„å±æ€§ï¼Œåä¹‹äº¦ç„¶ã€‚éœ€è¦æ³¨ æ„çš„æ˜¯ï¼Œåœ¨ Node.js ä¸­ä½ ä¸å¯èƒ½åœ¨æœ€å¤–å±‚å®šä¹‰å˜é‡ï¼Œå› ä¸ºæ‰€æœ‰ç”¨æˆ·ä»£ç éƒ½æ˜¯å±äºå½“å‰æ¨¡å—çš„ï¼Œ è€Œæ¨¡å—æœ¬èº«ä¸æ˜¯æœ€å¤–å±‚ä¸Šä¸‹æ–‡ã€‚\næ³¨æ„ï¼š æœ€å¥½ä¸è¦ä½¿ç”¨ var å®šä¹‰å˜é‡ä»¥é¿å…å¼•å…¥å…¨å±€å˜é‡ï¼Œå› ä¸ºå…¨å±€å˜é‡ä¼šæ±¡æŸ“å‘½åç©ºé—´ï¼Œæé«˜ä»£ç çš„è€¦åˆé£é™©ã€‚\n__filename __filename è¡¨ç¤ºå½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„æ–‡ä»¶åã€‚å®ƒå°†è¾“å‡ºæ–‡ä»¶æ‰€åœ¨ä½ç½®çš„ç»å¯¹è·¯å¾„ï¼Œä¸”å’Œå‘½ä»¤è¡Œå‚æ•°æ‰€æŒ‡å®šçš„æ–‡ä»¶åä¸ä¸€å®šç›¸åŒã€‚ å¦‚æœåœ¨æ¨¡å—ä¸­ï¼Œè¿”å›çš„å€¼æ˜¯æ¨¡å—æ–‡ä»¶çš„è·¯å¾„ã€‚\n__dirname __dirname è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚\nsetTimeout(cb, ms) setTimeout(cb, ms) å…¨å±€å‡½æ•°åœ¨æŒ‡å®šçš„æ¯«ç§’(ms)æ•°åæ‰§è¡ŒæŒ‡å®šå‡½æ•°(cb)ã€‚ï¼šsetTimeout() åªæ‰§è¡Œä¸€æ¬¡æŒ‡å®šå‡½æ•°ã€‚\nclearTimeout(t) clearTimeout( t ) å…¨å±€å‡½æ•°ç”¨äºåœæ­¢ä¸€ä¸ªä¹‹å‰é€šè¿‡ setTimeout() åˆ›å»ºçš„å®šæ—¶å™¨ã€‚ å‚æ•° t æ˜¯é€šè¿‡ setTimeout() å‡½æ•°åˆ›å»ºçš„å®šæ—¶å™¨ã€‚\nfunction printHello(){ console.log( \"Hello, World!\"); } // ä¸¤ç§’åæ‰§è¡Œä»¥ä¸Šå‡½æ•° var t = setTimeout(printHello, 2000); // æ¸…é™¤å®šæ—¶å™¨ clearTimeout(t); æ‰§è¡Œ main.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º:\nsetInterval(cb, ms) setInterval(cb, ms) å…¨å±€å‡½æ•°åœ¨æŒ‡å®šçš„æ¯«ç§’(ms)æ•°åæ‰§è¡ŒæŒ‡å®šå‡½æ•°(cb)ã€‚\nè¿”å›ä¸€ä¸ªä»£è¡¨å®šæ—¶å™¨çš„å¥æŸ„å€¼ã€‚å¯ä»¥ä½¿ç”¨ clearInterval(t) å‡½æ•°æ¥æ¸…é™¤å®šæ—¶å™¨ã€‚\nsetInterval() æ–¹æ³•ä¼šä¸åœåœ°è°ƒç”¨å‡½æ•°ï¼Œç›´åˆ° clearInterval() è¢«è°ƒç”¨æˆ–çª—å£è¢«å…³é—­ã€‚\nfunction printHello(){ console.log( \"Hello, World!\"); } // ä¸¤ç§’åæ‰§è¡Œä»¥ä¸Šå‡½æ•° setInterval(printHello, 2000); console console ç”¨äºæä¾›æ§åˆ¶å°æ ‡å‡†è¾“å‡ºï¼Œå®ƒæ˜¯ç”± Internet Explorer çš„ JScript å¼•æ“æä¾›çš„è°ƒè¯•å·¥å…·ï¼Œåæ¥é€æ¸æˆä¸ºæµè§ˆå™¨çš„å®æ–½æ ‡å‡†ã€‚\nconsole.log console.info console.error console.warn console.time(label) è¾“å‡ºæ—¶é—´ï¼Œè¡¨ç¤ºè®¡æ—¶å¼€å§‹ã€‚ console.timeEnd(label) ç»“æŸæ—¶é—´ï¼Œè¡¨ç¤ºè®¡æ—¶ç»“æŸã€‚ console.trace\nconsole.info(\"ç¨‹åºå¼€å§‹æ‰§è¡Œï¼š\"); var counter = 10; console.log(\"è®¡æ•°: %d\", counter); console.time(\"è·å–æ•°æ®\"); // for(var i = 0; i \u003c 100000; i++ ) {} // console.timeEnd('è·å–æ•°æ®'); console.info(\"ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚\") process process æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå³ global å¯¹è±¡çš„å±æ€§ã€‚\nprocess.on('exit', function(code) { // ä»¥ä¸‹ä»£ç æ°¸è¿œä¸ä¼šæ‰§è¡Œ setTimeout(function() { console.log(\"è¯¥ä»£ç ä¸ä¼šæ‰§è¡Œ\"); }, 0); console.log('é€€å‡ºç ä¸º:', code); }); console.log(\"ç¨‹åºæ‰§è¡Œç»“æŸ\"); Process å±æ€§ Process æä¾›äº†å¾ˆå¤šæœ‰ç”¨çš„å±æ€§ï¼Œä¾¿äºæˆ‘ä»¬æ›´å¥½çš„æ§åˆ¶ç³»ç»Ÿçš„äº¤äº’\nstdout æ ‡å‡†è¾“å‡ºæµ stderr æ ‡å‡†é”™è¯¯æµã€‚ stdin æ ‡å‡†è¾“å…¥æµã€‚ argv argv å±æ€§è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç”±å‘½ä»¤è¡Œæ‰§è¡Œè„šæœ¬æ—¶çš„å„ä¸ªå‚æ•°ç»„æˆã€‚å®ƒçš„ç¬¬ä¸€ä¸ªæˆå‘˜æ€»æ˜¯nodeï¼Œç¬¬äºŒä¸ªæˆå‘˜æ˜¯è„šæœ¬æ–‡ä»¶åï¼Œå…¶ä½™æˆå‘˜æ˜¯è„šæœ¬æ–‡ä»¶çš„å‚æ•°ã€‚ execPath è¿”å›æ‰§è¡Œå½“å‰è„šæœ¬çš„ Node äºŒè¿›åˆ¶æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚ execArgv è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‘½ä»¤è¡Œä¸‹æ‰§è¡Œè„šæœ¬æ—¶ï¼Œåœ¨Nodeå¯æ‰§è¡Œæ–‡ä»¶ä¸è„šæœ¬æ–‡ä»¶ä¹‹é—´çš„å‘½ä»¤è¡Œå‚æ•°ã€‚ env è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæˆå‘˜ä¸ºå½“å‰ shell çš„ç¯å¢ƒå˜é‡ exitCode è¿›ç¨‹é€€å‡ºæ—¶çš„ä»£ç ï¼Œå¦‚æœè¿›ç¨‹ä¼˜é€šè¿‡ process.exit() é€€å‡ºï¼Œä¸éœ€è¦æŒ‡å®šé€€å‡ºç ã€‚ version Node çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚v0.10.18 config ä¸€ä¸ªåŒ…å«ç”¨æ¥ç¼–è¯‘å½“å‰ node æ‰§è¡Œæ–‡ä»¶çš„ javascript é…ç½®é€‰é¡¹çš„å¯¹è±¡ã€‚å®ƒä¸è¿è¡Œ ./configure è„šæœ¬ç”Ÿæˆçš„ â€œconfig.gypiâ€ æ–‡ä»¶ç›¸åŒã€‚ pid å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å·ã€‚ title è¿›ç¨‹åï¼Œé»˜è®¤å€¼ä¸º\"node\"ï¼Œå¯ä»¥è‡ªå®šä¹‰è¯¥å€¼ã€‚ platform è¿è¡Œç¨‹åºæ‰€åœ¨çš„å¹³å°ç³»ç»Ÿ â€˜darwinâ€™, â€˜freebsdâ€™, â€™linuxâ€™, â€˜sunosâ€™ æˆ– â€˜win32â€™ arch å½“å‰ CPU çš„æ¶æ„ï¼šâ€˜armâ€™ã€â€˜ia32â€™ æˆ–è€… â€˜x64â€™ã€‚ mainModule require.main çš„å¤‡é€‰æ–¹æ³•ã€‚ä¸åŒç‚¹ï¼Œå¦‚æœä¸»æ¨¡å—åœ¨è¿è¡Œæ—¶æ”¹å˜ï¼Œrequire.mainå¯èƒ½ä¼šç»§ç»­è¿”å›è€çš„æ¨¡å—ã€‚å¯ä»¥è®¤ä¸ºï¼Œè¿™ä¸¤è€…å¼•ç”¨äº†åŒä¸€ä¸ªæ¨¡å—ã€‚\n// è¾“å‡ºåˆ°ç»ˆç«¯ process.stdout.write(\"Hello World!\" + \"\\n\"); // é€šè¿‡å‚æ•°è¯»å– process.argv.forEach(function(val, index, array) { console.log(index + ': ' + val); }); // è·å–æ‰§è¡Œè·¯å¾„ console.log(process.execPath); // å¹³å°ä¿¡æ¯ console.log(process.platform); // è¾“å‡ºå½“å‰ç›®å½• console.log('å½“å‰ç›®å½•: ' + process.cwd()); // è¾“å‡ºå½“å‰ç‰ˆæœ¬ console.log('å½“å‰ç‰ˆæœ¬: ' + process.version); // è¾“å‡ºå†…å­˜ä½¿ç”¨æƒ…å†µ console.log(process.memoryUsage()); ğŸ”­Node.js MySQL npm install mysql select\nvar mysql = require('mysql'); var connection = mysql.createConnection({ host : 'localhost', user : 'root', password : '123456789', //pwd port: '30306', database: 'IMDB' }); connection.connect(); var sql = 'SELECT * FROM IMConfig;'; console.log(sql); //æŸ¥ connection.query(sql,function (err, result) { if(err){ console.log('[SELECT ERROR] - ',err.message); return; } console.log('++++++++++++++++++++++++--SELECT+++++++++++++++++++++++++++-'); console.log(result); console.log('++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\\n\\n'); }); connection.end(); ERROR 1045 (28000): Access denied for user â€˜rootâ€˜@â€˜localhostâ€˜ (using password: YES) è¿™è¾¹æ˜¯é€šè¿‡dockerå®‰è£…çš„mysqlï¼Œç™»å½•æŠ¥é”™ root@f4a3881e5f06:/# mysql -uroot -p Enter password: 123456 ERROR 1045 (28000): Access denied for user â€˜rootâ€™@â€™localhostâ€™ (using password: YES)\nå¦‚æœå¸¸è§„çš„å‘½ä»¤ mysql -uroot -pæ— æ³•ç™»å½•ï¼Œä½¿ç”¨å‘½ä»¤å°è¯•ï¼š\nmysql -u root -h 127.0.0.1 -p\nError: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested mysql -u root -p ALTER USER â€˜rootâ€™@â€™%â€™ IDENTIFIED WITH mysql_native_password BY â€˜123456789â€™; flush privileges;\ninsert\nconnection.connect(); var addSql = 'INSERT INTO IMConfig(ConfigID,UserID,ConfigName,ConfigCreateTime,ConfigType,ConfigSn) VALUES(0,?,?,?,?,?)'; var addSqlParams = ['1', '11','2023-01-01', '1','1']; //å¢ connection.query(addSql,addSqlParams,function (err, result) { if(err){ console.log('[INSERT ERROR] - ',err.message); return; } console.log('++++++++++++++++++++++++--INSERT+++++++++++++++++++++++++++-'); //console.log('INSERT ID:',result.insertId); console.log('INSERT ID:',result); console.log('+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++--\\n\\n'); }); connection.end(); ER_NO_SUCH_TABLE: Table â€˜IMDB.IMCONFIGâ€™ doesnâ€™t exist ä¸­è‹±æ–‡é”™è¯¯ ER_WRONG_VALUE_COUNT_ON_ROW: Column count doesnâ€™t match value count at row 1 å­—æ®µé”™è¯¯ ER_TRUNCATED_WRONG_VALUE: Incorrect datetime value: â€˜2023-01-01T16:00:00.000Zâ€™ for column â€˜ConfigCreateTimeâ€™ at row 1 å­—æ®µç±»å‹\nupdate\n//update connection.connect(); var modSql = 'UPDATE IMConfig SET ConfigName = ?,ConfigType = ?,ConfigSn = ? WHERE ConfigId = ?'; var modSqlParams = ['lang', '2','1',5]; //æ”¹ connection.query(modSql,modSqlParams,function (err, result) { if(err){ console.log('[UPDATE ERROR] - ',err.message); return; } console.log('++++++++++++++++++++++++--UPDATE+++++++++++++++++++++++++++-'); console.log('UPDATE affectedRows',result.affectedRows); console.log('+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++--\\n\\n'); }); connection.end(); delete\nconnection.connect(); var delSql = 'DELETE FROM IMConfig where ConfigID=5'; //åˆ  connection.query(delSql,function (err, result) { if(err){ console.log('[DELETE ERROR] - ',err.message); return; } console.log('++++++++++++++++++++++++--DELETE+++++++++++++++++++++++++++-'); console.log('DELETE affectedRows',result.affectedRows); console.log('+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++--\\n\\n'); }); connection.end(); ğŸ§µNode.js Socket socket client\n//sk var net = require('net'); var client = net.connect('6001', 'xxxx', function(){ console.log('å·²ç»ä¸æœåŠ¡å™¨è¿æ¥'); client.write('Yes\\r\\n'); }); client.on('data', function(data){ console.log(data.toString()); client.end();//one msg end }); client.on('end', function(){ console.log('å®¢æˆ·ç«¯è¿æ¥ä¸­æ–­'); }); ","wordCount":"2579","inLanguage":"en","datePublished":"2024-05-17T19:00:03Z","dateModified":"2024-05-17T19:00:03Z","author":{"@type":"Person","name":"dwd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://qfsyso.github.io/posts/nodejs-base/"},"publisher":{"@type":"Organization","name":"MLOG","logo":{"@type":"ImageObject","url":"https://qfsyso.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://qfsyso.github.io/ accesskey=h title="MLOG (Alt + H)">MLOG</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://qfsyso.github.io/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://qfsyso.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://qfsyso.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Nodejs base</h1><div class=post-meta><span title='2024-05-17 19:00:03 +0000 UTC'>May 17, 2024</span>&nbsp;Â·&nbsp;13 min&nbsp;Â·&nbsp;dwd</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#nodejs%e5%ae%89%e8%a3%85 aria-label=ğŸ› Node.jså®‰è£…>ğŸ› Node.jså®‰è£…</a><ul><li><a href=#debian-nodejs aria-label="debian nodejs">debian nodejs</a></li></ul></li><li><a href=#helloworld aria-label=ğŸ’¬helloworld>ğŸ’¬helloworld</a></li><li><a href=#nodejs-%e5%88%9b%e5%bb%ba%e7%ac%ac%e4%b8%80%e4%b8%aa%e5%ba%94%e7%94%a8 aria-label="ğŸ‘©â€ğŸ«Node.js åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨">ğŸ‘©â€ğŸ«Node.js åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨</a><ul><li><a href=#require-%e6%8c%87%e4%bb%a4 aria-label="require æŒ‡ä»¤">require æŒ‡ä»¤</a></li><li><a href=#%e5%88%9b%e5%bb%ba%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%8e%a5%e6%94%b6%e5%93%8d%e5%ba%94%e8%af%b7%e6%b1%82 aria-label=åˆ›å»ºæœåŠ¡å™¨/æ¥æ”¶å“åº”è¯·æ±‚>åˆ›å»ºæœåŠ¡å™¨/æ¥æ”¶å“åº”è¯·æ±‚</a></li></ul></li><li><a href=#npm%e4%bd%bf%e7%94%a8 aria-label=ğŸš€npmä½¿ç”¨>ğŸš€npmä½¿ç”¨</a><ul><li><a href=#%e5%85%a8%e5%b1%80%e5%ae%89%e8%a3%85%e4%b8%8e%e6%9c%ac%e5%9c%b0%e5%ae%89%e8%a3%85 aria-label=å…¨å±€å®‰è£…ä¸æœ¬åœ°å®‰è£…>å…¨å±€å®‰è£…ä¸æœ¬åœ°å®‰è£…</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e5%ae%89%e8%a3%85%e4%bf%a1%e6%81%af aria-label=æŸ¥çœ‹å®‰è£…ä¿¡æ¯>æŸ¥çœ‹å®‰è£…ä¿¡æ¯</a></li></ul></li><li><a href=#nodejs-%e5%9b%9e%e8%b0%83%e5%87%bd%e6%95%b0 aria-label="ğŸ”­Node.js å›è°ƒå‡½æ•°">ğŸ”­Node.js å›è°ƒå‡½æ•°</a><ul><li><a href=#%e9%98%bb%e5%a1%9e%e4%bb%a3%e7%a0%81%e5%ae%9e%e4%be%8b aria-label=é˜»å¡ä»£ç å®ä¾‹>é˜»å¡ä»£ç å®ä¾‹</a></li><li><a href=#%e9%9d%9e%e9%98%bb%e5%a1%9e%e4%bb%a3%e7%a0%81%e5%ae%9e%e4%be%8b aria-label=éé˜»å¡ä»£ç å®ä¾‹>éé˜»å¡ä»£ç å®ä¾‹</a></li></ul></li><li><a href=#nodejs-%e4%ba%8b%e4%bb%b6%e5%be%aa%e7%8e%af aria-label="ğŸNode.js äº‹ä»¶å¾ªç¯">ğŸNode.js äº‹ä»¶å¾ªç¯</a><ul><li><a href=#%e4%ba%8b%e4%bb%b6%e9%a9%b1%e5%8a%a8%e7%a8%8b%e5%ba%8f aria-label=äº‹ä»¶é©±åŠ¨ç¨‹åº>äº‹ä»¶é©±åŠ¨ç¨‹åº</a></li><li><a href=#node-%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e6%98%af%e5%a6%82%e4%bd%95%e5%b7%a5%e4%bd%9c%e7%9a%84 aria-label="Node åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ">Node åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ</a></li></ul></li><li><a href=#nodejs-eventemitter aria-label="ğŸ“”Node.js EventEmitter">ğŸ“”Node.js EventEmitter</a></li><li><a href=#-nodejs-buffer aria-label="â› Node.js Buffer">â› Node.js Buffer</a><ul><li><a href=#%e5%88%9b%e5%bb%ba-buffer-%e7%b1%bb aria-label="åˆ›å»º Buffer ç±»">åˆ›å»º Buffer ç±»</a></li><li><a href=#%e5%86%99%e5%85%a5%e7%bc%93%e5%86%b2%e5%8c%ba aria-label=å†™å…¥ç¼“å†²åŒº>å†™å…¥ç¼“å†²åŒº</a></li><li><a href=#%e4%bb%8e%e7%bc%93%e5%86%b2%e5%8c%ba%e8%af%bb%e5%8f%96%e6%95%b0%e6%8d%ae aria-label=ä»ç¼“å†²åŒºè¯»å–æ•°æ®>ä»ç¼“å†²åŒºè¯»å–æ•°æ®</a></li><li><a href=#%e7%bc%93%e5%86%b2%e5%8c%ba%e5%90%88%e5%b9%b6 aria-label=ç¼“å†²åŒºåˆå¹¶>ç¼“å†²åŒºåˆå¹¶</a></li><li><a href=#%e7%bc%93%e5%86%b2%e5%8c%ba%e6%af%94%e8%be%83 aria-label=ç¼“å†²åŒºæ¯”è¾ƒ>ç¼“å†²åŒºæ¯”è¾ƒ</a></li><li><a href=#%e6%8b%b7%e8%b4%9d%e7%bc%93%e5%86%b2%e5%8c%ba aria-label=æ‹·è´ç¼“å†²åŒº>æ‹·è´ç¼“å†²åŒº</a></li><li><a href=#%e7%bc%93%e5%86%b2%e5%8c%ba%e8%a3%81%e5%89%aa aria-label=ç¼“å†²åŒºè£å‰ª>ç¼“å†²åŒºè£å‰ª</a></li><li><a href=#%e7%bc%93%e5%86%b2%e5%8c%ba%e9%95%bf%e5%ba%a6 aria-label=ç¼“å†²åŒºé•¿åº¦>ç¼“å†²åŒºé•¿åº¦</a></li></ul></li><li><a href=#nodejs-stream aria-label="ğŸ‘¨â€ğŸ’»Node.js Stream">ğŸ‘¨â€ğŸ’»Node.js Stream</a></li><li><a href=#nodejs-%e6%a8%a1%e5%9d%97%e7%b3%bb%e7%bb%9f aria-label="ğŸ“Node.js æ¨¡å—ç³»ç»Ÿ">ğŸ“Node.js æ¨¡å—ç³»ç»Ÿ</a></li><li><a href=#nodejs-%e5%8a%a0%e8%bd%bdc aria-label="ğŸ”„nodejs åŠ è½½c++">ğŸ”„nodejs åŠ è½½c++</a></li><li><a href=#nodejs-%e5%87%bd%e6%95%b0 aria-label="ğŸ™‹â€â™€ï¸Node.js å‡½æ•°">ğŸ™‹â€â™€ï¸Node.js å‡½æ•°</a><ul><li><a href=#%e5%8c%bf%e5%90%8d%e5%87%bd%e6%95%b0 aria-label=åŒ¿åå‡½æ•°>åŒ¿åå‡½æ•°</a></li></ul></li><li><a href=#nodejs-%e7%ae%ad%e5%a4%b4%e5%87%bd%e6%95%b0 aria-label="ğŸ™‹â€â™‚Node.js ç®­å¤´å‡½æ•°">ğŸ™‹â€â™‚Node.js ç®­å¤´å‡½æ•°</a></li><li><a href=#nodejs-%e8%b7%af%e7%94%b1 aria-label="ğŸ§ªNode.js è·¯ç”±">ğŸ§ªNode.js è·¯ç”±</a></li><li><a href=#nodejs-%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1 aria-label="ğŸ™Node.js å…¨å±€å¯¹è±¡">ğŸ™Node.js å…¨å±€å¯¹è±¡</a><ul><li><a href=#__filename aria-label=__filename>__filename</a></li><li><a href=#__dirname aria-label=__dirname>__dirname</a></li><li><a href=#settimeoutcb-ms aria-label="setTimeout(cb, ms)">setTimeout(cb, ms)</a></li><li><a href=#cleartimeoutt aria-label=clearTimeout(t)>clearTimeout(t)</a></li><li><a href=#setintervalcb-ms aria-label="setInterval(cb, ms)">setInterval(cb, ms)</a></li><li><a href=#console aria-label=console>console</a></li><li><a href=#process aria-label=process>process</a></li><li><a href=#process-%e5%b1%9e%e6%80%a7 aria-label="Process å±æ€§">Process å±æ€§</a></li></ul></li><li><a href=#nodejs-mysql aria-label="ğŸ”­Node.js MySQL">ğŸ”­Node.js MySQL</a><ul><li><a href=#error-1045-28000-access-denied-for-user-rootlocalhost-using-password-yes aria-label="ERROR 1045 (28000): Access denied for user â€˜rootâ€˜@â€˜localhostâ€˜ (using password: YES)">ERROR 1045 (28000): Access denied for user â€˜rootâ€˜@â€˜localhostâ€˜ (using password: YES)</a></li><li><a href=#error-er_not_supported_auth_mode-client-does-not-support-authentication-protocol-requested aria-label="Error: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested">Error: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested</a></li></ul></li><li><a href=#nodejs-socket aria-label="ğŸ§µNode.js Socket">ğŸ§µNode.js Socket</a></li></ul></div></details></div><div class=post-content><p>ç®€å•çš„è¯´ Node.js å°±æ˜¯è¿è¡Œåœ¨æœåŠ¡ç«¯çš„ JavaScriptã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªåŸºäº Chrome JavaScript è¿è¡Œæ—¶å»ºç«‹çš„ä¸€ä¸ªå¹³å°ã€‚</p><p>Node.js æ˜¯ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ I/O æœåŠ¡ç«¯ JavaScript ç¯å¢ƒï¼ŒåŸºäº Google çš„ V8 å¼•æ“ï¼ŒV8 å¼•æ“æ‰§è¡Œ Javascript çš„é€Ÿåº¦éå¸¸å¿«ï¼Œæ€§èƒ½éå¸¸å¥½ã€‚</p><h1 id=nodejså®‰è£…>ğŸ› Node.jså®‰è£…<a hidden class=anchor aria-hidden=true href=#nodejså®‰è£…>#</a></h1><p>Node.jså®‰è£…åœ¨ä¸Šä¸€ç¯‡æ–‡ç« Debian Node.js HEXO æœ‰è®²åˆ°</p><p>æˆªè‡³ç›®å‰æœ€æ–°çš„ç‰ˆæœ¬æ˜¯20.12.2</p><p>#æŸ¥çœ‹ç‰ˆæœ¬
node -v
v20.12.2</p><p>winä¸‹å¯ä»¥åœ¨å®˜ç½‘ä¸‹è½½å®‰è£…
<a href=https://nodejs.org/en/download>https://nodejs.org/en/download</a></p><h2 id=debian-nodejs>debian nodejs<a hidden class=anchor aria-hidden=true href=#debian-nodejs>#</a></h2><p>node 14ç‰ˆæœ¬</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ apt-get update
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -fsSL https://deb.nodesource.com/setup_14.x | sudo -E bash -
</span></span></code></pre></div><p>#å¦‚æœæç¤ºsudo å‘½ä»¤æ²¡æœ‰æ‰¾åˆ°ï¼Œä¸€å®šè¦ä¸‹è½½ï¼Œæ‰§è¡Œapt-get install sudo -y å³å¯ï¼Œç„¶åå†æ‰§è¡Œä¸Šè¿°å‘½ä»¤</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ apt-get install nodejs -y
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ node --version  //éªŒè¯
</span></span></code></pre></div><p>å½“ç„¶å¦‚æœéœ€è¦å®‰è£…<strong>node20</strong>ç‰ˆæœ¬ï¼Œåªéœ€å°†ä¸Šè¿°å‘½ä»¤æ›¿æ¢ä¸ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
</span></span></code></pre></div><h1 id=helloworld>ğŸ’¬helloworld<a hidden class=anchor aria-hidden=true href=#helloworld>#</a></h1><p>hi.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;hello world node.js &#34;</span>) <span style=color:#75715e>// like javascript~ 
</span></span></span></code></pre></div><p>node hi.js
[20240504n11]</p><h1 id=nodejs-åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨>ğŸ‘©â€ğŸ«Node.js åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨<a hidden class=anchor aria-hidden=true href=#nodejs-åˆ›å»ºç¬¬ä¸€ä¸ªåº”ç”¨>#</a></h1><h2 id=require-æŒ‡ä»¤>require æŒ‡ä»¤<a hidden class=anchor aria-hidden=true href=#require-æŒ‡ä»¤>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>http</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;http&#34;</span>);
</span></span></code></pre></div><h2 id=åˆ›å»ºæœåŠ¡å™¨æ¥æ”¶å“åº”è¯·æ±‚>åˆ›å»ºæœåŠ¡å™¨/æ¥æ”¶å“åº”è¯·æ±‚<a hidden class=anchor aria-hidden=true href=#åˆ›å»ºæœåŠ¡å™¨æ¥æ”¶å“åº”è¯·æ±‚>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>http</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;http&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>createServer</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å‘é€ HTTP å¤´éƒ¨ 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// HTTP çŠ¶æ€å€¼: 200 : OK
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// å†…å®¹ç±»å‹: text/plain
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>writeHead</span>(<span style=color:#ae81ff>200</span>, {<span style=color:#e6db74>&#39;Content-Type&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;text/plain&#39;</span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// å‘é€å“åº”æ•°æ® &#34;Hello World&#34;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>end</span>(<span style=color:#e6db74>&#39;Hello World\n&#39;</span>);
</span></span><span style=display:flex><span>}).<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>8888</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç»ˆç«¯æ‰“å°å¦‚ä¸‹ä¿¡æ¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Server running at http://127.0.0.1:1200/&#39;</span>);
</span></span></code></pre></div><h1 id=npmä½¿ç”¨>ğŸš€npmä½¿ç”¨<a hidden class=anchor aria-hidden=true href=#npmä½¿ç”¨>#</a></h1><p>npm æ˜¯åŒ…ç®¡ç†å·¥å…·
å…è®¸ç”¨æˆ·ä»NPMæœåŠ¡å™¨ä¸‹è½½åˆ«äººç¼–å†™çš„ç¬¬ä¸‰æ–¹åŒ…åˆ°æœ¬åœ°ä½¿ç”¨ã€‚
å…è®¸ç”¨æˆ·ä»NPMæœåŠ¡å™¨ä¸‹è½½å¹¶å®‰è£…åˆ«äººç¼–å†™çš„å‘½ä»¤è¡Œç¨‹åºåˆ°æœ¬åœ°ä½¿ç”¨ã€‚
å…è®¸ç”¨æˆ·å°†è‡ªå·±ç¼–å†™çš„åŒ…æˆ–å‘½ä»¤è¡Œç¨‹åºä¸Šä¼ åˆ°NPMæœåŠ¡å™¨ä¾›åˆ«äººä½¿ç”¨ã€‚</p><p>npm -v</p><p>å¦‚æœä½ å®‰è£…çš„æ˜¯æ—§ç‰ˆæœ¬çš„ npmï¼Œå¯ä»¥å¾ˆå®¹æ˜“å¾—é€šè¿‡ npm å‘½ä»¤æ¥å‡çº§ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><p>$ sudo npm install npm -g
/usr/local/bin/npm -> /usr/local/lib/node_modules/npm/bin/npm-cli.js
<a href=mailto:npm@2.14.2>npm@2.14.2</a> /usr/local/lib/node_modules/npm
å¦‚æœæ˜¯ Window ç³»ç»Ÿä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š</p><p>npm install npm -g
ä½¿ç”¨æ·˜å®é•œåƒçš„å‘½ä»¤ï¼š</p><p>npm install -g cnpm &ndash;registry=https://registry.npmmirror.com</p><h2 id=å…¨å±€å®‰è£…ä¸æœ¬åœ°å®‰è£…>å…¨å±€å®‰è£…ä¸æœ¬åœ°å®‰è£…<a hidden class=anchor aria-hidden=true href=#å…¨å±€å®‰è£…ä¸æœ¬åœ°å®‰è£…>#</a></h2><p>npm çš„åŒ…å®‰è£…åˆ†ä¸ºæœ¬åœ°å®‰è£…ï¼ˆlocalï¼‰ã€å…¨å±€å®‰è£…ï¼ˆglobalï¼‰ä¸¤ç§ï¼Œä»æ•²çš„å‘½ä»¤è¡Œæ¥çœ‹ï¼Œå·®åˆ«åªæ˜¯æœ‰æ²¡æœ‰-gè€Œå·²ï¼Œæ¯”å¦‚</p><p>npm install express # æœ¬åœ°å®‰è£…
npm install express -g # å…¨å±€å®‰è£…
å¦‚æœå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼š</p><p>npm err! Error: connect ECONNREFUSED 127.0.0.1:8087
è§£å†³åŠæ³•ä¸ºï¼š</p><p>$ npm config set proxy null</p><h2 id=æŸ¥çœ‹å®‰è£…ä¿¡æ¯>æŸ¥çœ‹å®‰è£…ä¿¡æ¯<a hidden class=anchor aria-hidden=true href=#æŸ¥çœ‹å®‰è£…ä¿¡æ¯>#</a></h2><p>npm list</p><p>â”€â”€ <a href=mailto:express@4.19.2>express@4.19.2</a></p><p>npm list -g</p><p>ä½¿ç”¨package.json
-node_modules/express/package.json å†…å®¹ï¼š</p><p>Package.json å±æ€§è¯´æ˜</p><p>name - åŒ…åã€‚</p><p>version - åŒ…çš„ç‰ˆæœ¬å·ã€‚</p><p>description - åŒ…çš„æè¿°ã€‚</p><p>homepage - åŒ…çš„å®˜ç½‘ url ã€‚</p><p>author - åŒ…çš„ä½œè€…å§“åã€‚</p><p>contributors - åŒ…çš„å…¶ä»–è´¡çŒ®è€…å§“åã€‚</p><p>dependencies - ä¾èµ–åŒ…åˆ—è¡¨ã€‚å¦‚æœä¾èµ–åŒ…æ²¡æœ‰å®‰è£…ï¼Œnpm ä¼šè‡ªåŠ¨å°†ä¾èµ–åŒ…å®‰è£…åœ¨ node_module ç›®å½•ä¸‹ã€‚</p><p>repository - åŒ…ä»£ç å­˜æ”¾çš„åœ°æ–¹çš„ç±»å‹ï¼Œå¯ä»¥æ˜¯ git æˆ– svnï¼Œgit å¯åœ¨ Github ä¸Šã€‚</p><p>main - main å­—æ®µæŒ‡å®šäº†ç¨‹åºçš„ä¸»å…¥å£æ–‡ä»¶ï¼Œrequire(&lsquo;moduleName&rsquo;) å°±ä¼šåŠ è½½è¿™ä¸ªæ–‡ä»¶ã€‚è¿™ä¸ªå­—æ®µçš„é»˜è®¤å€¼æ˜¯æ¨¡å—æ ¹ç›®å½•ä¸‹é¢çš„ index.jsã€‚</p><p>keywords - å…³é”®å­—</p><p>å¸è½½</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm uninstall express
</span></span><span style=display:flex><span>npm ls
</span></span></code></pre></div><p>æ›´æ–°</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm update express
</span></span></code></pre></div><p>åˆ›å»º</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm init
</span></span></code></pre></div><p>This utility will walk you through creating a package.json file.
It only covers the most common items, and tries to guess sensible defaults.</p><p>See <code>npm help json</code> for definitive documentation on these fields
and exactly what they do.</p><p>Use <code>npm install &lt;pkg> --save</code> afterwards to install a package and
save it as a dependency in the package.json file.</p><p>Press ^C at any time to quit.
name: (node_modules) runoob # æ¨¡å—å
version: (1.0.0)
description: Node.js æµ‹è¯•æ¨¡å—(<a href=https://www.runoob.com>www.runoob.com</a>) # æè¿°
entry point: (index.js)
test command: make test
git repository: <a href=https://github.com/runoob/runoob.git>https://github.com/runoob/runoob.git</a> # Github åœ°å€</p><p>author:
license: (ISC)
About to write to â€¦â€¦/node_modules/package.json: # ç”Ÿæˆåœ°å€</p><p>{
&ldquo;name&rdquo;: &ldquo;runoob&rdquo;,
&ldquo;version&rdquo;: &ldquo;1.0.0&rdquo;,
&ldquo;description&rdquo;: &ldquo;Node.js æµ‹è¯•æ¨¡å—(<a href=https://www.runoob.com>www.runoob.com</a>)&rdquo;,
â€¦â€¦
}</p><p>Is this ok? (yes) yes</p><p>yesåä¼šç”Ÿæˆ package.json
npm adduser
Username: mcmohd
Password:
Email: (this IS public) <a href=mailto:mcmohd@gmail.com>mcmohd@gmail.com</a></p><p>å‘å¸ƒ
npm publish</p><p>å°±å¯ä»¥è·Ÿå…¶ä»–æ¨¡å—ä¸€æ ·ä½¿ç”¨ npm æ¥å®‰è£…</p><h1 id=nodejs-å›è°ƒå‡½æ•°>ğŸ”­Node.js å›è°ƒå‡½æ•°<a hidden class=anchor aria-hidden=true href=#nodejs-å›è°ƒå‡½æ•°>#</a></h1><p>Node.js å¼‚æ­¥ç¼–ç¨‹çš„ç›´æ¥ä½“ç°å°±æ˜¯å›è°ƒã€‚</p><p>å¼‚æ­¥ç¼–ç¨‹ä¾æ‰˜äºå›è°ƒæ¥å®ç°ï¼Œä½†ä¸èƒ½è¯´ä½¿ç”¨äº†å›è°ƒåç¨‹åºå°±å¼‚æ­¥åŒ–äº†ã€‚</p><p>å›è°ƒå‡½æ•°åœ¨å®Œæˆä»»åŠ¡åå°±ä¼šè¢«è°ƒç”¨ï¼ŒNode ä½¿ç”¨äº†å¤§é‡çš„å›è°ƒå‡½æ•°ï¼ŒNode æ‰€æœ‰ API éƒ½æ”¯æŒå›è°ƒå‡½æ•°ã€‚</p><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€è¾¹è¯»å–æ–‡ä»¶ï¼Œä¸€è¾¹æ‰§è¡Œå…¶ä»–å‘½ä»¤ï¼Œåœ¨æ–‡ä»¶è¯»å–å®Œæˆåï¼Œæˆ‘ä»¬å°†æ–‡ä»¶å†…å®¹ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°è¿”å›ã€‚è¿™æ ·åœ¨æ‰§è¡Œä»£ç æ—¶å°±æ²¡æœ‰é˜»å¡æˆ–ç­‰å¾…æ–‡ä»¶ I/O æ“ä½œã€‚è¿™å°±å¤§å¤§æé«˜äº† Node.js çš„æ€§èƒ½ï¼Œå¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘è¯·æ±‚ã€‚</p><p>å›è°ƒå‡½æ•°ä¸€èˆ¬ä½œä¸ºå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°å‡ºç°ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>foo1</span>(<span style=color:#a6e22e>name</span>, <span style=color:#a6e22e>age</span>, <span style=color:#a6e22e>callback</span>) { }
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>foo2</span>(<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>callback1</span>, <span style=color:#a6e22e>callback2</span>) { }
</span></span></code></pre></div><h2 id=é˜»å¡ä»£ç å®ä¾‹>é˜»å¡ä»£ç å®ä¾‹<a hidden class=anchor aria-hidden=true href=#é˜»å¡ä»£ç å®ä¾‹>#</a></h2><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ x.txt ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p>hi hi hi</p><p>åˆ›å»º main.js æ–‡ä»¶, ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFileSync</span>(<span style=color:#e6db74>&#39;x.txt&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œç»“æŸ!&#34;</span>);
</span></span></code></pre></div><p>ä»¥ä¸Šä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p>node main.js</p><p>hi hi hi</p><p>ç¨‹åºæ‰§è¡Œç»“æŸ!</p><h2 id=éé˜»å¡ä»£ç å®ä¾‹>éé˜»å¡ä»£ç å®ä¾‹<a hidden class=anchor aria-hidden=true href=#éé˜»å¡ä»£ç å®ä¾‹>#</a></h2><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ input.txt ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><p>èœé¸Ÿæ•™ç¨‹å®˜ç½‘åœ°å€ï¼šwww.runoob.com
åˆ›å»º main.js æ–‡ä»¶, ä»£ç å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFile</span>(<span style=color:#e6db74>&#39;input.txt&#39;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>err</span>) <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>err</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œç»“æŸ!&#34;</span>);
</span></span></code></pre></div><p>ä»¥ä¸Šä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p><p>node main.js</p><p>ç¨‹åºæ‰§è¡Œç»“æŸ!
hi hi hi
ä»¥ä¸Šä¸¤ä¸ªå®ä¾‹æˆ‘ä»¬äº†è§£äº†é˜»å¡ä¸éé˜»å¡è°ƒç”¨çš„ä¸åŒã€‚ç¬¬ä¸€ä¸ªå®ä¾‹åœ¨æ–‡ä»¶è¯»å–å®Œåæ‰æ‰§è¡Œç¨‹åºã€‚ ç¬¬äºŒä¸ªå®ä¾‹æˆ‘ä»¬ä¸éœ€è¦ç­‰å¾…æ–‡ä»¶è¯»å–å®Œï¼Œè¿™æ ·å°±å¯ä»¥åœ¨è¯»å–æ–‡ä»¶æ—¶åŒæ—¶æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»£ç ï¼Œå¤§å¤§æé«˜äº†ç¨‹åºçš„æ€§èƒ½ã€‚</p><p>å› æ­¤ï¼Œé˜»å¡æ˜¯æŒ‰é¡ºåºæ‰§è¡Œçš„ï¼Œè€Œéé˜»å¡æ˜¯ä¸éœ€è¦æŒ‰é¡ºåºçš„ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦å¤„ç†å›è°ƒå‡½æ•°çš„å‚æ•°ï¼Œæˆ‘ä»¬å°±éœ€è¦å†™åœ¨å›è°ƒå‡½æ•°å†…ã€‚</p><h1 id=nodejs-äº‹ä»¶å¾ªç¯>ğŸNode.js äº‹ä»¶å¾ªç¯<a hidden class=anchor aria-hidden=true href=#nodejs-äº‹ä»¶å¾ªç¯>#</a></h1><p>Node.js æ˜¯å•è¿›ç¨‹å•çº¿ç¨‹åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯å› ä¸º V8 å¼•æ“æä¾›çš„å¼‚æ­¥æ‰§è¡Œå›è°ƒæ¥å£ï¼Œé€šè¿‡è¿™äº›æ¥å£å¯ä»¥å¤„ç†å¤§é‡çš„å¹¶å‘ï¼Œæ‰€ä»¥æ€§èƒ½éå¸¸é«˜ã€‚</p><p>Node.js å‡ ä¹æ¯ä¸€ä¸ª API éƒ½æ˜¯æ”¯æŒå›è°ƒå‡½æ•°çš„ã€‚</p><p>Node.js åŸºæœ¬ä¸Šæ‰€æœ‰çš„äº‹ä»¶æœºåˆ¶éƒ½æ˜¯ç”¨è®¾è®¡æ¨¡å¼ä¸­è§‚å¯Ÿè€…æ¨¡å¼å®ç°ã€‚</p><p>Node.js å•çº¿ç¨‹ç±»ä¼¼è¿›å…¥ä¸€ä¸ªwhile(true)çš„äº‹ä»¶å¾ªç¯ï¼Œç›´åˆ°æ²¡æœ‰äº‹ä»¶è§‚å¯Ÿè€…é€€å‡ºï¼Œæ¯ä¸ªå¼‚æ­¥äº‹ä»¶éƒ½ç”Ÿæˆä¸€ä¸ªäº‹ä»¶è§‚å¯Ÿè€…ï¼Œå¦‚æœæœ‰äº‹ä»¶å‘ç”Ÿå°±è°ƒç”¨è¯¥å›è°ƒå‡½æ•°.</p><h2 id=äº‹ä»¶é©±åŠ¨ç¨‹åº>äº‹ä»¶é©±åŠ¨ç¨‹åº<a hidden class=anchor aria-hidden=true href=#äº‹ä»¶é©±åŠ¨ç¨‹åº>#</a></h2><p>Node.js ä½¿ç”¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ï¼Œå½“web serveræ¥æ”¶åˆ°è¯·æ±‚ï¼Œå°±æŠŠå®ƒå…³é—­ç„¶åè¿›è¡Œå¤„ç†ï¼Œç„¶åå»æœåŠ¡ä¸‹ä¸€ä¸ªwebè¯·æ±‚ã€‚</p><p>å½“è¿™ä¸ªè¯·æ±‚å®Œæˆï¼Œå®ƒè¢«æ”¾å›å¤„ç†é˜Ÿåˆ—ï¼Œå½“åˆ°è¾¾é˜Ÿåˆ—å¼€å¤´ï¼Œè¿™ä¸ªç»“æœè¢«è¿”å›ç»™ç”¨æˆ·ã€‚</p><p>è¿™ä¸ªæ¨¡å‹éå¸¸é«˜æ•ˆå¯æ‰©å±•æ€§éå¸¸å¼ºï¼Œå› ä¸º webserver ä¸€ç›´æ¥å—è¯·æ±‚è€Œä¸ç­‰å¾…ä»»ä½•è¯»å†™æ“ä½œã€‚ï¼ˆè¿™ä¹Ÿç§°ä¹‹ä¸ºéé˜»å¡å¼IOæˆ–è€…äº‹ä»¶é©±åŠ¨IOï¼‰</p><p>åœ¨äº‹ä»¶é©±åŠ¨æ¨¡å‹ä¸­ï¼Œä¼šç”Ÿæˆä¸€ä¸ªä¸»å¾ªç¯æ¥ç›‘å¬äº‹ä»¶ï¼Œå½“æ£€æµ‹åˆ°äº‹ä»¶æ—¶è§¦å‘å›è°ƒå‡½æ•°ã€‚</p><p>EventEmitters -> Events =>&lt;= EventLoop -> Event Handlers</p><p>æ•´ä¸ªäº‹ä»¶é©±åŠ¨çš„æµç¨‹å°±æ˜¯è¿™ä¹ˆå®ç°çš„ï¼Œéå¸¸ç®€æ´ã€‚æœ‰ç‚¹ç±»ä¼¼äºè§‚å¯Ÿè€…æ¨¡å¼ï¼Œäº‹ä»¶ç›¸å½“äºä¸€ä¸ªä¸»é¢˜(Subject)ï¼Œè€Œæ‰€æœ‰æ³¨å†Œåˆ°è¿™ä¸ªäº‹ä»¶ä¸Šçš„å¤„ç†å‡½æ•°ç›¸å½“äºè§‚å¯Ÿè€…(Observer)ã€‚</p><p>Node.js æœ‰å¤šä¸ªå†…ç½®çš„äº‹ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•å…¥ events æ¨¡å—ï¼Œå¹¶é€šè¿‡å®ä¾‹åŒ– EventEmitter ç±»æ¥ç»‘å®šå’Œç›‘å¬äº‹ä»¶ï¼Œå¦‚ä¸‹å®ä¾‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// å¼•å…¥ events æ¨¡å—
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>events</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;events&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»º eventEmitter å¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>eventEmitter</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>EventEmitter</span>();
</span></span></code></pre></div><p>ä»¥ä¸‹ç¨‹åºç»‘å®šäº‹ä»¶å¤„ç†ç¨‹åºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// ç»‘å®šäº‹ä»¶åŠäº‹ä»¶çš„å¤„ç†ç¨‹åº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;eventName&#39;</span>, <span style=color:#a6e22e>eventHandler</span>);
</span></span></code></pre></div><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ç¨‹åºè§¦å‘äº‹ä»¶ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// è§¦å‘äº‹ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;eventName&#39;</span>);
</span></span></code></pre></div><p>main.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// å¼•å…¥ events æ¨¡å—
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>events</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;events&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»º eventEmitter å¯¹è±¡
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>eventEmitter</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>EventEmitter</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºäº‹ä»¶å¤„ç†ç¨‹åº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>connectHandler</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>connected</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;è¿æ¥æˆåŠŸã€‚&#39;</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e>// è§¦å‘ data_received äº‹ä»¶ 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;data_received&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç»‘å®š connection äº‹ä»¶å¤„ç†ç¨‹åº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;connection&#39;</span>, <span style=color:#a6e22e>connectHandler</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ä½¿ç”¨åŒ¿åå‡½æ•°ç»‘å®š data_received äº‹ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data_received&#39;</span>, <span style=color:#66d9ef>function</span>(){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;æ•°æ®æ¥æ”¶æˆåŠŸã€‚&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è§¦å‘ connection äº‹ä»¶ 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;connection&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚&#34;</span>);
</span></span></code></pre></div><p>connection -> connectHandler -> data_received</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-BASH data-lang=BASH><span style=display:flex><span>node main.js
</span></span><span style=display:flex><span>è¿æ¥æˆåŠŸã€‚
</span></span><span style=display:flex><span>æ•°æ®æ¥æ”¶æˆåŠŸã€‚
</span></span><span style=display:flex><span>ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚
</span></span></code></pre></div><h2 id=node-åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„>Node åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ<a hidden class=anchor aria-hidden=true href=#node-åº”ç”¨ç¨‹åºæ˜¯å¦‚ä½•å·¥ä½œçš„>#</a></h2><p>åœ¨ Node åº”ç”¨ç¨‹åºä¸­ï¼Œæ‰§è¡Œå¼‚æ­¥æ“ä½œçš„å‡½æ•°å°†å›è°ƒå‡½æ•°ä½œä¸ºæœ€åä¸€ä¸ªå‚æ•°ï¼Œ å›è°ƒå‡½æ•°æ¥æ”¶é”™è¯¯å¯¹è±¡ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥é‡æ–°çœ‹ä¸‹å‰é¢çš„å®ä¾‹ï¼Œåˆ›å»ºä¸€ä¸ª x.txt ,æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//main.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>readFile</span>(<span style=color:#e6db74>&#39;x.txt&#39;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>data</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>err</span>){
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>stack</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œå®Œæ¯•&#34;</span>);
</span></span></code></pre></div><p>æ‰§è¡Œ åˆ™å¼‚æ­¥è¯»å–x.txtå†…å®¹
æŠŠè·¯åŠ²æ”¹æˆ x1.txtè¯»å–é”™è¯¯åˆ™log é”™è¯¯å†…å®¹</p><h1 id=nodejs-eventemitter>ğŸ“”Node.js EventEmitter<a hidden class=anchor aria-hidden=true href=#nodejs-eventemitter>#</a></h1><p>Node.js æ‰€æœ‰çš„å¼‚æ­¥ I/O æ“ä½œåœ¨å®Œæˆæ—¶éƒ½ä¼šå‘é€ä¸€ä¸ªäº‹ä»¶åˆ°äº‹ä»¶é˜Ÿåˆ—ã€‚</p><p>Node.js é‡Œé¢çš„è®¸å¤šå¯¹è±¡éƒ½ä¼šåˆ†å‘äº‹ä»¶ï¼šä¸€ä¸ª net.Server å¯¹è±¡ä¼šåœ¨æ¯æ¬¡æœ‰æ–°è¿æ¥æ—¶è§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œ ä¸€ä¸ª fs.readStream å¯¹è±¡ä¼šåœ¨æ–‡ä»¶è¢«æ‰“å¼€çš„æ—¶å€™è§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚ æ‰€æœ‰è¿™äº›äº§ç”Ÿäº‹ä»¶çš„å¯¹è±¡éƒ½æ˜¯ events.EventEmitter çš„å®ä¾‹ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//main.js æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>EventEmitter</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;events&#39;</span>).<span style=color:#a6e22e>EventEmitter</span>; 
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>event</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>EventEmitter</span>(); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;some_event&#39;</span>, <span style=color:#66d9ef>function</span>() { 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;some_event äº‹ä»¶è§¦å‘&#39;</span>); 
</span></span><span style=display:flex><span>}); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>setTimeout</span>(<span style=color:#66d9ef>function</span>() { 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;some_event&#39;</span>); 
</span></span><span style=display:flex><span>}, <span style=color:#ae81ff>10000</span>); 
</span></span></code></pre></div><p>10såæ‰§è¡Œ some_event è¾“å‡º äº‹ä»¶è§¦å‘</p><p>EventEmitter çš„æ¯ä¸ªäº‹ä»¶ç”±ä¸€ä¸ªäº‹ä»¶åå’Œè‹¥å¹²ä¸ªå‚æ•°ç»„æˆï¼Œäº‹ä»¶åæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé€šå¸¸è¡¨è¾¾ä¸€å®šçš„è¯­ä¹‰ã€‚å¯¹äºæ¯ä¸ªäº‹ä»¶ï¼ŒEventEmitter æ”¯æŒ è‹¥å¹²ä¸ªäº‹ä»¶ç›‘å¬å™¨ã€‚</p><p>å½“äº‹ä»¶è§¦å‘æ—¶ï¼Œæ³¨å†Œåˆ°è¿™ä¸ªäº‹ä»¶çš„äº‹ä»¶ç›‘å¬å™¨è¢«ä¾æ¬¡è°ƒç”¨ï¼Œäº‹ä»¶å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°å‚æ•°ä¼ é€’ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//main.js æ–‡ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>events</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;events&#39;</span>); 
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>emitter</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>EventEmitter</span>(); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>emitter</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;someEvent&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>arg1</span>, <span style=color:#a6e22e>arg2</span>) { 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;listener1&#39;</span>, <span style=color:#a6e22e>arg1</span>, <span style=color:#a6e22e>arg2</span>); 
</span></span><span style=display:flex><span>}); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>emitter</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;someEvent&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>arg1</span>, <span style=color:#a6e22e>arg2</span>) { 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;listener2&#39;</span>, <span style=color:#a6e22e>arg1</span>, <span style=color:#a6e22e>arg2</span>); 
</span></span><span style=display:flex><span>}); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>emitter</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;someEvent&#39;</span>, <span style=color:#e6db74>&#39;arg1 å‚æ•°&#39;</span>, <span style=color:#e6db74>&#39;arg2 å‚æ•°&#39;</span>); 
</span></span></code></pre></div><p>emitter ä¸ºäº‹ä»¶ someEvent æ³¨å†Œäº†ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨ï¼Œç„¶åè§¦å‘äº† someEvent äº‹ä»¶ã€‚</p><p>è¿è¡Œç»“æœä¸­å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªäº‹ä»¶ç›‘å¬å™¨å›è°ƒå‡½æ•°è¢«å…ˆåè°ƒç”¨ã€‚ è¿™å°±æ˜¯EventEmitteræœ€ç®€å•çš„ç”¨æ³•ã€‚</p><p>EventEmitter æä¾›äº†å¤šä¸ªå±æ€§ï¼Œå¦‚ on å’Œ emitã€‚on å‡½æ•°ç”¨äºç»‘å®šäº‹ä»¶å‡½æ•°ï¼Œemit å±æ€§ç”¨äºè§¦å‘ä¸€ä¸ªäº‹ä»¶ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å…·ä½“çœ‹ä¸‹ EventEmitter çš„å±æ€§ä»‹ç»ã€‚</p><p>.once ç›‘å¬å™¨æœ€å¤šåªä¼šè§¦å‘ä¸€æ¬¡ï¼Œè§¦å‘åç«‹åˆ»è§£é™¤è¯¥ç›‘å¬å™¨</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>events</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;events&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>eventEmitter</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>events</span>.<span style=color:#a6e22e>EventEmitter</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç›‘å¬å™¨ #1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>listener1</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>listener1</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;ç›‘å¬å™¨ listener1 æ‰§è¡Œã€‚&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç›‘å¬å™¨ #2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>listener2</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>listener2</span>() {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;ç›‘å¬å™¨ listener2 æ‰§è¡Œã€‚&#39;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç»‘å®š connection äº‹ä»¶ï¼Œå¤„ç†å‡½æ•°ä¸º listener1 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>addListener</span>(<span style=color:#e6db74>&#39;connection&#39;</span>, <span style=color:#a6e22e>listener1</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç»‘å®š connection äº‹ä»¶ï¼Œå¤„ç†å‡½æ•°ä¸º listener2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;connection&#39;</span>, <span style=color:#a6e22e>listener2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>eventListeners</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>listenerCount</span>(<span style=color:#e6db74>&#39;connection&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>eventListeners</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; ä¸ªç›‘å¬å™¨ç›‘å¬è¿æ¥äº‹ä»¶ã€‚&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å¤„ç† connection äº‹ä»¶ 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;connection&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç§»é™¤ç›‘ç»‘å®šçš„ listener1 å‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>removeListener</span>(<span style=color:#e6db74>&#39;connection&#39;</span>, <span style=color:#a6e22e>listener1</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;listener1 ä¸å†å—ç›‘å¬ã€‚&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è§¦å‘è¿æ¥äº‹ä»¶
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;connection&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>eventListeners</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>listenerCount</span>(<span style=color:#e6db74>&#39;connection&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>eventListeners</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; ä¸ªç›‘å¬å™¨ç›‘å¬è¿æ¥äº‹ä»¶ã€‚&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç»‘å®š connection äº‹ä»¶ï¼Œå¤„ç†å‡½æ•°ä¸º listener2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;connection&#39;</span>, <span style=color:#a6e22e>listener2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>emit</span>(<span style=color:#e6db74>&#39;connection&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>eventListeners</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>eventEmitter</span>.<span style=color:#a6e22e>listenerCount</span>(<span style=color:#e6db74>&#39;connection&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>eventListeners</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; ä¸ªç›‘å¬å™¨ç›‘å¬è¿æ¥äº‹ä»¶ã€‚&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚&#34;</span>);
</span></span></code></pre></div><p>error äº‹ä»¶
EventEmitter å®šä¹‰äº†ä¸€ä¸ªç‰¹æ®Šçš„äº‹ä»¶ errorï¼Œå®ƒåŒ…å«äº†é”™è¯¯çš„è¯­ä¹‰ï¼Œæˆ‘ä»¬åœ¨é‡åˆ° å¼‚å¸¸çš„æ—¶å€™é€šå¸¸ä¼šè§¦å‘ error äº‹ä»¶ã€‚</p><p>å½“ error è¢«è§¦å‘æ—¶ï¼ŒEventEmitter è§„å®šå¦‚æœæ²¡æœ‰å“ åº”çš„ç›‘å¬å™¨ï¼ŒNode.js ä¼šæŠŠå®ƒå½“ä½œå¼‚å¸¸ï¼Œé€€å‡ºç¨‹åºå¹¶è¾“å‡ºé”™è¯¯ä¿¡æ¯ã€‚</p><p>æˆ‘ä»¬ä¸€èˆ¬è¦ä¸ºä¼šè§¦å‘ error äº‹ä»¶çš„å¯¹è±¡è®¾ç½®ç›‘å¬å™¨ï¼Œé¿å…é‡åˆ°é”™è¯¯åæ•´ä¸ªç¨‹åºå´©æºƒã€‚ä¾‹å¦‚ï¼š</p><p>ç»§æ‰¿ EventEmitter
å¤§å¤šæ•°æ—¶å€™æˆ‘ä»¬ä¸ä¼šç›´æ¥ä½¿ç”¨ EventEmitterï¼Œè€Œæ˜¯åœ¨å¯¹è±¡ä¸­ç»§æ‰¿å®ƒã€‚åŒ…æ‹¬ fsã€netã€ http åœ¨å†…çš„ï¼Œåªè¦æ˜¯æ”¯æŒäº‹ä»¶å“åº”çš„æ ¸å¿ƒæ¨¡å—éƒ½æ˜¯ EventEmitter çš„å­ç±»ã€‚</p><p>ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼ŸåŸå› æœ‰ä¸¤ç‚¹ï¼š</p><p>é¦–å…ˆï¼Œå…·æœ‰æŸä¸ªå®ä½“åŠŸèƒ½çš„å¯¹è±¡å®ç°äº‹ä»¶ç¬¦åˆè¯­ä¹‰ï¼Œ äº‹ä»¶çš„ç›‘å¬å’Œå‘ç”Ÿåº”è¯¥æ˜¯ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•ã€‚</p><p>å…¶æ¬¡ JavaScript çš„å¯¹è±¡æœºåˆ¶æ˜¯åŸºäºåŸå‹çš„ï¼Œæ”¯æŒ éƒ¨åˆ†å¤šé‡ç»§æ‰¿ï¼Œç»§æ‰¿ EventEmitter ä¸ä¼šæ‰“ä¹±å¯¹è±¡åŸæœ‰çš„ç»§æ‰¿å…³ç³»ã€‚</p><h1 id=-nodejs-buffer>â› Node.js Buffer<a hidden class=anchor aria-hidden=true href=#-nodejs-buffer>#</a></h1><p>JavaScript è¯­è¨€è‡ªèº«åªæœ‰å­—ç¬¦ä¸²æ•°æ®ç±»å‹ï¼Œæ²¡æœ‰äºŒè¿›åˆ¶æ•°æ®ç±»å‹ã€‚</p><p>ä½†åœ¨å¤„ç†åƒTCPæµæˆ–æ–‡ä»¶æµæ—¶ï¼Œå¿…é¡»ä½¿ç”¨åˆ°äºŒè¿›åˆ¶æ•°æ®ã€‚å› æ­¤åœ¨ Node.jsä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ª Buffer ç±»ï¼Œè¯¥ç±»ç”¨æ¥åˆ›å»ºä¸€ä¸ªä¸“é—¨å­˜æ”¾äºŒè¿›åˆ¶æ•°æ®çš„ç¼“å­˜åŒºã€‚</p><p>åœ¨ Node.js ä¸­ï¼ŒBuffer ç±»æ˜¯éš Node å†…æ ¸ä¸€èµ·å‘å¸ƒçš„æ ¸å¿ƒåº“ã€‚Buffer åº“ä¸º Node.js å¸¦æ¥äº†ä¸€ç§å­˜å‚¨åŸå§‹æ•°æ®çš„æ–¹æ³•ï¼Œå¯ä»¥è®© Node.js å¤„ç†äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯å½“éœ€è¦åœ¨ Node.js ä¸­å¤„ç†I/Oæ“ä½œä¸­ç§»åŠ¨çš„æ•°æ®æ—¶ï¼Œå°±æœ‰å¯èƒ½ä½¿ç”¨ Buffer åº“ã€‚åŸå§‹æ•°æ®å­˜å‚¨åœ¨ Buffer ç±»çš„å®ä¾‹ä¸­ã€‚ä¸€ä¸ª Buffer ç±»ä¼¼äºä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œä½†å®ƒå¯¹åº”äº V8 å †å†…å­˜ä¹‹å¤–çš„ä¸€å—åŸå§‹å†…å­˜ã€‚</p><p>Buffer ä¸å­—ç¬¦ç¼–ç </p><p>Buffer å®ä¾‹ä¸€èˆ¬ç”¨äºè¡¨ç¤ºç¼–ç å­—ç¬¦çš„åºåˆ—ï¼Œæ¯”å¦‚ UTF-8 ã€ UCS2 ã€ Base64 ã€æˆ–åå…­è¿›åˆ¶ç¼–ç çš„æ•°æ®ã€‚ é€šè¿‡ä½¿ç”¨æ˜¾å¼çš„å­—ç¬¦ç¼–ç ï¼Œå°±å¯ä»¥åœ¨ Buffer å®ä¾‹ä¸æ™®é€šçš„ JavaScript å­—ç¬¦ä¸²ä¹‹é—´è¿›è¡Œç›¸äº’è½¬æ¢ã€‚</p><p>Buffer.from() åˆ›å»ºå¯¹è±¡</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>buf</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;test&#39;</span>, <span style=color:#e6db74>&#39;ascii&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è¾“å‡º 72756e6f6f62
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;hex&#39;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è¾“å‡º cnVub29i
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;base64&#39;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//UTF-8
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;UTF-8&#39;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//ascii 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;ascii&#39;</span>));
</span></span><span style=display:flex><span>    <span style=color:#75715e>//utf16le
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;utf16le&#39;</span>));
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>//latin1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;latin1&#39;</span>));
</span></span></code></pre></div><p>Node.js ç›®å‰æ”¯æŒçš„å­—ç¬¦ç¼–ç åŒ…æ‹¬ï¼š</p><p>ascii - ä»…æ”¯æŒ 7 ä½ ASCII æ•°æ®ã€‚å¦‚æœè®¾ç½®å»æ‰é«˜ä½çš„è¯ï¼Œè¿™ç§ç¼–ç æ˜¯éå¸¸å¿«çš„ã€‚</p><p>utf8 - å¤šå­—èŠ‚ç¼–ç çš„ Unicode å­—ç¬¦ã€‚è®¸å¤šç½‘é¡µå’Œå…¶ä»–æ–‡æ¡£æ ¼å¼éƒ½ä½¿ç”¨ UTF-8 ã€‚</p><p>utf16le - 2 æˆ– 4 ä¸ªå­—èŠ‚ï¼Œå°å­—èŠ‚åºç¼–ç çš„ Unicode å­—ç¬¦ã€‚æ”¯æŒä»£ç†å¯¹ï¼ˆU+10000 è‡³ U+10FFFFï¼‰ã€‚</p><p>ucs2 - utf16le çš„åˆ«åã€‚</p><p>base64 - Base64 ç¼–ç ã€‚</p><p>latin1 - ä¸€ç§æŠŠ Buffer ç¼–ç æˆä¸€å­—èŠ‚ç¼–ç çš„å­—ç¬¦ä¸²çš„æ–¹å¼ã€‚</p><p>binary - latin1 çš„åˆ«åã€‚</p><p>hex - å°†æ¯ä¸ªå­—èŠ‚ç¼–ç ä¸ºä¸¤ä¸ªåå…­è¿›åˆ¶å­—ç¬¦ã€‚</p><h2 id=åˆ›å»º-buffer-ç±»>åˆ›å»º Buffer ç±»<a hidden class=anchor aria-hidden=true href=#åˆ›å»º-buffer-ç±»>#</a></h2><p>Buffer æä¾›äº†ä»¥ä¸‹ API æ¥åˆ›å»º Buffer ç±»ï¼š</p><p>Buffer.alloc(size[, fill[, encoding]])ï¼š è¿”å›ä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Buffer å®ä¾‹ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® fillï¼Œåˆ™é»˜è®¤å¡«æ»¡ 0
Buffer.allocUnsafe(size)ï¼š è¿”å›ä¸€ä¸ªæŒ‡å®šå¤§å°çš„ Buffer å®ä¾‹ï¼Œä½†æ˜¯å®ƒä¸ä¼šè¢«åˆå§‹åŒ–ï¼Œæ‰€ä»¥å®ƒå¯èƒ½åŒ…å«æ•æ„Ÿçš„æ•°æ®
Buffer.allocUnsafeSlow(size)
Buffer.from(array)ï¼š è¿”å›ä¸€ä¸ªè¢« array çš„å€¼åˆå§‹åŒ–çš„æ–°çš„ Buffer å®ä¾‹ï¼ˆä¼ å…¥çš„ array çš„å…ƒç´ åªèƒ½æ˜¯æ•°å­—ï¼Œä¸ç„¶å°±ä¼šè‡ªåŠ¨è¢« 0 è¦†ç›–ï¼‰
Buffer.from(arrayBuffer[, byteOffset[, length]])ï¼š è¿”å›ä¸€ä¸ªæ–°å»ºçš„ä¸ç»™å®šçš„ ArrayBuffer å…±äº«åŒä¸€å†…å­˜çš„ Bufferã€‚
Buffer.from(buffer)ï¼š å¤åˆ¶ä¼ å…¥çš„ Buffer å®ä¾‹çš„æ•°æ®ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ Buffer å®ä¾‹
Buffer.from(string[, encoding])ï¼š è¿”å›ä¸€ä¸ªè¢« string çš„å€¼åˆå§‹åŒ–çš„æ–°çš„ Buffer å®ä¾‹</p><h2 id=å†™å…¥ç¼“å†²åŒº>å†™å…¥ç¼“å†²åŒº<a hidden class=anchor aria-hidden=true href=#å†™å…¥ç¼“å†²åŒº>#</a></h2><p>è¯­æ³•
å†™å…¥ Node ç¼“å†²åŒºçš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>write</span>(<span style=color:#a6e22e>string</span>[, <span style=color:#a6e22e>offset</span>[, <span style=color:#a6e22e>length</span>]][, <span style=color:#a6e22e>encoding</span>])
</span></span></code></pre></div><p>å‚æ•°
å‚æ•°æè¿°å¦‚ä¸‹ï¼š</p><p>string - å†™å…¥ç¼“å†²åŒºçš„å­—ç¬¦ä¸²ã€‚</p><p>offset - ç¼“å†²åŒºå¼€å§‹å†™å…¥çš„ç´¢å¼•å€¼ï¼Œé»˜è®¤ä¸º 0 ã€‚</p><p>length - å†™å…¥çš„å­—èŠ‚æ•°ï¼Œé»˜è®¤ä¸º buffer.length</p><p>encoding - ä½¿ç”¨çš„ç¼–ç ã€‚é»˜è®¤ä¸º &lsquo;utf8&rsquo; ã€‚</p><p>æ ¹æ® encoding çš„å­—ç¬¦ç¼–ç å†™å…¥ string åˆ° buf ä¸­çš„ offset ä½ç½®ã€‚ length å‚æ•°æ˜¯å†™å…¥çš„å­—èŠ‚æ•°ã€‚ å¦‚æœ buf æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´ä¿å­˜æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œåˆ™åªä¼šå†™å…¥ string çš„ä¸€éƒ¨åˆ†ã€‚ åªéƒ¨åˆ†è§£ç çš„å­—ç¬¦ä¸ä¼šè¢«å†™å…¥ã€‚</p><p>è¿”å›å€¼
è¿”å›å®é™…å†™å…¥çš„å¤§å°ã€‚å¦‚æœ buffer ç©ºé—´ä¸è¶³ï¼Œ åˆ™åªä¼šå†™å…¥éƒ¨åˆ†å­—ç¬¦ä¸²ã€‚</p><p>å®ä¾‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>alloc</span>(<span style=color:#ae81ff>256</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>len</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#34;123123&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;å†™å…¥å­—èŠ‚æ•° : &#34;</span><span style=color:#f92672>+</span>  <span style=color:#a6e22e>len</span>);
</span></span></code></pre></div><h2 id=ä»ç¼“å†²åŒºè¯»å–æ•°æ®>ä»ç¼“å†²åŒºè¯»å–æ•°æ®<a hidden class=anchor aria-hidden=true href=#ä»ç¼“å†²åŒºè¯»å–æ•°æ®>#</a></h2><p>è¯­æ³•
è¯»å– Node ç¼“å†²åŒºæ•°æ®çš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>([<span style=color:#a6e22e>encoding</span>[, <span style=color:#a6e22e>start</span>[, <span style=color:#a6e22e>end</span>]]])
</span></span></code></pre></div><p>å‚æ•°
å‚æ•°æè¿°å¦‚ä¸‹ï¼š</p><p>encoding - ä½¿ç”¨çš„ç¼–ç ã€‚é»˜è®¤ä¸º &lsquo;utf8&rsquo; ã€‚</p><p>start - æŒ‡å®šå¼€å§‹è¯»å–çš„ç´¢å¼•ä½ç½®ï¼Œé»˜è®¤ä¸º 0ã€‚</p><p>end - ç»“æŸä½ç½®ï¼Œé»˜è®¤ä¸ºç¼“å†²åŒºçš„æœ«å°¾ã€‚</p><p>è¿”å›å€¼
è§£ç ç¼“å†²åŒºæ•°æ®å¹¶ä½¿ç”¨æŒ‡å®šçš„ç¼–ç è¿”å›å­—ç¬¦ä¸²ã€‚</p><p>å®ä¾‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>alloc</span>(<span style=color:#ae81ff>26</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> ; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>26</span> ; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>buf</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>97</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>( <span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;ascii&#39;</span>));       <span style=color:#75715e>// è¾“å‡º: abcdefghijklmnopqrstuvwxyz
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>( <span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;ascii&#39;</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>5</span>));   <span style=color:#75715e>//ä½¿ç”¨ &#39;ascii&#39; ç¼–ç , å¹¶è¾“å‡º: abcde
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>( <span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;utf8&#39;</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>5</span>));    <span style=color:#75715e>// ä½¿ç”¨ &#39;utf8&#39; ç¼–ç , å¹¶è¾“å‡º: abcde
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>( <span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#66d9ef>undefined</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>5</span>)); <span style=color:#75715e>// ä½¿ç”¨é»˜è®¤çš„ &#39;utf8&#39; ç¼–ç , å¹¶è¾“å‡º: abcde
</span></span></span></code></pre></div><p>å°† Buffer è½¬æ¢ä¸º JSON å¯¹è±¡
è¯­æ³•
å°† Node Buffer è½¬æ¢ä¸º JSON å¯¹è±¡çš„å‡½æ•°è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>toJSON</span>()
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>buf</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>([<span style=color:#ae81ff>0x1</span>, <span style=color:#ae81ff>0x2</span>, <span style=color:#ae81ff>0x3</span>, <span style=color:#ae81ff>0x4</span>, <span style=color:#ae81ff>0x5</span>]);
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>json</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>buf</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è¾“å‡º: {&#34;type&#34;:&#34;Buffer&#34;,&#34;data&#34;:[1,2,3,4,5]}
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>json</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>copy</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>json</span>, (<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>value</span>) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;Buffer&#39;</span> <span style=color:#f92672>?</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>data</span>) <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è¾“å‡º: &lt;Buffer 01 02 03 04 05&gt;
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>copy</span>);
</span></span></code></pre></div><h2 id=ç¼“å†²åŒºåˆå¹¶>ç¼“å†²åŒºåˆå¹¶<a hidden class=anchor aria-hidden=true href=#ç¼“å†²åŒºåˆå¹¶>#</a></h2><p>è¯­æ³•
Node ç¼“å†²åŒºåˆå¹¶çš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>concat</span>(<span style=color:#a6e22e>list</span>[, <span style=color:#a6e22e>totalLength</span>])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>((<span style=color:#e6db74>&#39;123&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>((<span style=color:#e6db74>&#39;test&#39;</span>));
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer3</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>concat</span>([<span style=color:#a6e22e>buffer1</span>,<span style=color:#a6e22e>buffer2</span>]);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;buffer3 å†…å®¹: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>buffer3</span>.<span style=color:#a6e22e>toString</span>());
</span></span></code></pre></div><h2 id=ç¼“å†²åŒºæ¯”è¾ƒ>ç¼“å†²åŒºæ¯”è¾ƒ<a hidden class=anchor aria-hidden=true href=#ç¼“å†²åŒºæ¯”è¾ƒ>#</a></h2><p>è¯­æ³•
Node Buffer æ¯”è¾ƒçš„å‡½æ•°è¯­æ³•å¦‚ä¸‹æ‰€ç¤º, è¯¥æ–¹æ³•åœ¨ Node.js v0.12.2 ç‰ˆæœ¬å¼•å…¥ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>compare</span>(<span style=color:#a6e22e>otherBuffer</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;ABC&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;ABCD&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>buffer1</span>.<span style=color:#a6e22e>compare</span>(<span style=color:#a6e22e>buffer2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>result</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buffer1</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; åœ¨ &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>buffer2</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;ä¹‹å‰&#34;</span>);
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>result</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buffer1</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; ä¸ &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>buffer2</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;ç›¸åŒ&#34;</span>);
</span></span><span style=display:flex><span>}<span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buffer1</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; åœ¨ &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>buffer2</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;ä¹‹å&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=æ‹·è´ç¼“å†²åŒº>æ‹·è´ç¼“å†²åŒº<a hidden class=anchor aria-hidden=true href=#æ‹·è´ç¼“å†²åŒº>#</a></h2><p>è¯­æ³•
Node ç¼“å†²åŒºæ‹·è´è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>copy</span>(<span style=color:#a6e22e>targetBuffer</span>[, <span style=color:#a6e22e>targetStart</span>[, <span style=color:#a6e22e>sourceStart</span>[, <span style=color:#a6e22e>sourceEnd</span>]]])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buf1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;abcdefghijkl&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buf2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;123&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>//å°† buf2 æ’å…¥åˆ° buf1 æŒ‡å®šä½ç½®ä¸Š
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>buf2</span>.<span style=color:#a6e22e>copy</span>(<span style=color:#a6e22e>buf1</span>, <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buf1</span>.<span style=color:#a6e22e>toString</span>());
</span></span></code></pre></div><h2 id=ç¼“å†²åŒºè£å‰ª>ç¼“å†²åŒºè£å‰ª<a hidden class=anchor aria-hidden=true href=#ç¼“å†²åŒºè£å‰ª>#</a></h2><p>Node ç¼“å†²åŒºè£å‰ªè¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>slice</span>([<span style=color:#a6e22e>start</span>[, <span style=color:#a6e22e>end</span>]])
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;TEST123TEST&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// å‰ªåˆ‡ç¼“å†²åŒº
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>buffer1</span>.<span style=color:#a6e22e>slice</span>(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;buffer2 content: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>buffer2</span>.<span style=color:#a6e22e>toString</span>());
</span></span></code></pre></div><h2 id=ç¼“å†²åŒºé•¿åº¦>ç¼“å†²åŒºé•¿åº¦<a hidden class=anchor aria-hidden=true href=#ç¼“å†²åŒºé•¿åº¦>#</a></h2><p>è¯­æ³•
Node ç¼“å†²åŒºé•¿åº¦è®¡ç®—è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>buf</span>.<span style=color:#a6e22e>length</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>buffer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#39;123123123&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>//  ç¼“å†²åŒºé•¿åº¦
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;buffer length: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>buffer</span>.<span style=color:#a6e22e>length</span>);
</span></span></code></pre></div><h1 id=nodejs-stream>ğŸ‘¨â€ğŸ’»Node.js Stream<a hidden class=anchor aria-hidden=true href=#nodejs-stream>#</a></h1><p>Node.js Stream(æµ)</p><p>Stream æ˜¯ä¸€ä¸ªæŠ½è±¡æ¥å£ï¼ŒNode ä¸­æœ‰å¾ˆå¤šå¯¹è±¡å®ç°äº†è¿™ä¸ªæ¥å£ã€‚ä¾‹å¦‚ï¼Œå¯¹http æœåŠ¡å™¨å‘èµ·è¯·æ±‚çš„request å¯¹è±¡å°±æ˜¯ä¸€ä¸ª Streamï¼Œè¿˜æœ‰stdoutï¼ˆæ ‡å‡†è¾“å‡ºï¼‰ã€‚</p><p>Node.jsï¼ŒStream æœ‰å››ç§æµç±»å‹ï¼š</p><p>Readable - å¯è¯»æ“ä½œã€‚</p><p>Writable - å¯å†™æ“ä½œã€‚</p><p>Duplex - å¯è¯»å¯å†™æ“ä½œ.</p><p>Transform - æ“ä½œè¢«å†™å…¥æ•°æ®ï¼Œç„¶åè¯»å‡ºç»“æœã€‚</p><p>æ‰€æœ‰çš„ Stream å¯¹è±¡éƒ½æ˜¯ EventEmitter çš„å®ä¾‹ã€‚å¸¸ç”¨çš„äº‹ä»¶æœ‰ï¼š</p><p>data - å½“æœ‰æ•°æ®å¯è¯»æ—¶è§¦å‘ã€‚</p><p>end - æ²¡æœ‰æ›´å¤šçš„æ•°æ®å¯è¯»æ—¶è§¦å‘ã€‚</p><p>error - åœ¨æ¥æ”¶å’Œå†™å…¥è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶è§¦å‘ã€‚</p><p>finish - æ‰€æœ‰æ•°æ®å·²è¢«å†™å…¥åˆ°åº•å±‚ç³»ç»Ÿæ—¶è§¦å‘ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºå¯è¯»æµ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>readerStream</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createReadStream</span>(<span style=color:#e6db74>&#39;x.txt&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è®¾ç½®ç¼–ç ä¸º utf8ã€‚
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>readerStream</span>.<span style=color:#a6e22e>setEncoding</span>(<span style=color:#e6db74>&#39;UTF8&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å¤„ç†æµäº‹ä»¶ --&gt; data, end, and error
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>readerStream</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>chunk</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>data</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>chunk</span>;
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>readerStream</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;end&#39;</span>,<span style=color:#66d9ef>function</span>(){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>data</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>readerStream</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;error&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>err</span>){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>stack</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œå®Œæ¯•&#34;</span>);
</span></span></code></pre></div><p>å†™å…¥æµ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>dataw</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;w123w&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>ws</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createWriteStream</span>(<span style=color:#e6db74>&#39;x.txt&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>ws</span>.<span style=color:#a6e22e>write</span>(<span style=color:#a6e22e>dataw</span>);    
</span></span><span style=display:flex><span><span style=color:#a6e22e>ws</span>.<span style=color:#a6e22e>end</span>();
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;æ•°æ®å†™å…¥æˆåŠŸï¼&#34;</span>);  
</span></span></code></pre></div><p>ç®¡é“æµ
ç®¡é“æä¾›äº†ä¸€ä¸ªè¾“å‡ºæµåˆ°è¾“å…¥æµçš„æœºåˆ¶ã€‚é€šå¸¸æˆ‘ä»¬ç”¨äºä»ä¸€ä¸ªæµä¸­è·å–æ•°æ®å¹¶å°†æ•°æ®ä¼ é€’åˆ°å¦å¤–ä¸€ä¸ªæµä¸­ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºä¸€ä¸ªå¯è¯»æµ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>readerStream</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createReadStream</span>(<span style=color:#e6db74>&#39;x.txt&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// åˆ›å»ºä¸€ä¸ªå¯å†™æµ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>writerStream</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createWriteStream</span>(<span style=color:#e6db74>&#39;output.txt&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// ç®¡é“è¯»å†™æ“ä½œ
</span></span></span><span style=display:flex><span><span style=color:#75715e>// è¯»å– input.txt æ–‡ä»¶å†…å®¹ï¼Œå¹¶å°†å†…å®¹å†™å…¥åˆ° output.txt æ–‡ä»¶ä¸­
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>readerStream</span>.<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>writerStream</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œå®Œæ¯•&#34;</span>);
</span></span></code></pre></div><p>é“¾å¼æµ
é“¾å¼æ˜¯é€šè¿‡è¿æ¥è¾“å‡ºæµåˆ°å¦å¤–ä¸€ä¸ªæµå¹¶åˆ›å»ºå¤šä¸ªæµæ“ä½œé“¾çš„æœºåˆ¶ã€‚é“¾å¼æµä¸€èˆ¬ç”¨äºç®¡é“æ“ä½œã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±æ˜¯ç”¨ç®¡é“å’Œé“¾å¼æ¥å‹ç¼©å’Œè§£å‹æ–‡ä»¶ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>zlib</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;zlib&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// å‹ç¼© input.txt æ–‡ä»¶ä¸º input.txt.gz
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createReadStream</span>(<span style=color:#e6db74>&#39;x.txt&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>zlib</span>.<span style=color:#a6e22e>createGzip</span>())
</span></span><span style=display:flex><span>.<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createWriteStream</span>(<span style=color:#e6db74>&#39;input.txt.gz&#39;</span>));
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;æ–‡ä»¶å‹ç¼©å®Œæˆã€‚&#34;</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>fs</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;fs&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>zlib</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;zlib&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// è§£å‹ input.txt.gz æ–‡ä»¶ä¸º input.txt
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createReadStream</span>(<span style=color:#e6db74>&#39;input.txt.gz&#39;</span>)
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>zlib</span>.<span style=color:#a6e22e>createGunzip</span>())
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>pipe</span>(<span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>createWriteStream</span>(<span style=color:#e6db74>&#39;input2.txt&#39;</span>));
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;æ–‡ä»¶è§£å‹å®Œæˆã€‚&#34;</span>);
</span></span></code></pre></div><h1 id=nodejs-æ¨¡å—ç³»ç»Ÿ>ğŸ“Node.js æ¨¡å—ç³»ç»Ÿ<a hidden class=anchor aria-hidden=true href=#nodejs-æ¨¡å—ç³»ç»Ÿ>#</a></h1><p>~~</p><p>ä¸ºäº†è®©Node.jsçš„æ–‡ä»¶å¯ä»¥ç›¸äº’è°ƒç”¨ï¼ŒNode.jsæä¾›äº†ä¸€ä¸ªç®€å•çš„æ¨¡å—ç³»ç»Ÿã€‚</p><p>æ¨¡å—æ˜¯Node.js åº”ç”¨ç¨‹åºçš„åŸºæœ¬ç»„æˆéƒ¨åˆ†ï¼Œæ–‡ä»¶å’Œæ¨¡å—æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚æ¢è¨€ä¹‹ï¼Œä¸€ä¸ª Node.js æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªæ¨¡å—ï¼Œè¿™ä¸ªæ–‡ä»¶å¯èƒ½æ˜¯JavaScript ä»£ç ã€JSON æˆ–è€…ç¼–è¯‘è¿‡çš„C/C++ æ‰©å±•ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//hello.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>world1</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;hello world node.js &#34;</span>) 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//test.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>hello</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./hello&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>hello</span>.<span style=color:#a6e22e>world1</span>();
</span></span></code></pre></div><p>hello.js é€šè¿‡ exports å¯¹è±¡æŠŠ world1 ä½œä¸ºæ¨¡å—çš„è®¿é—®æ¥å£ï¼Œåœ¨ main.js ä¸­é€šè¿‡ require(&rsquo;./hello&rsquo;) åŠ è½½è¿™ä¸ªæ¨¡å—ï¼Œç„¶åå°±å¯ä»¥ç›´æ¥è®¿ é—® hello.js ä¸­ exports å¯¹è±¡çš„æˆå‘˜å‡½æ•°äº†ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//hello.js 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>Hello</span>() { 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>name</span>; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>setName</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>thyName</span>) { 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>thyName</span>; 
</span></span><span style=display:flex><span>    }; 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>sayHello</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span>() { 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Hello &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>name</span>); 
</span></span><span style=display:flex><span>    }; 
</span></span><span style=display:flex><span>}; 
</span></span><span style=display:flex><span><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Hello</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//test.js 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>Hello</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./hello&#39;</span>); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>hello</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Hello</span>(); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>hello</span>.<span style=color:#a6e22e>setName</span>(<span style=color:#e6db74>&#39;vvv&#39;</span>); 
</span></span><span style=display:flex><span><span style=color:#a6e22e>hello</span>.<span style=color:#a6e22e>sayHello</span>(); 
</span></span></code></pre></div><p>æ¨¡å—æ¥å£çš„å”¯ä¸€å˜åŒ–æ˜¯ä½¿ç”¨ module.exports = Hello ä»£æ›¿äº†exports.world = function(){}ã€‚ åœ¨å¤–éƒ¨å¼•ç”¨è¯¥æ¨¡å—æ—¶ï¼Œå…¶æ¥å£å¯¹è±¡å°±æ˜¯è¦è¾“å‡ºçš„ Hello å¯¹è±¡æœ¬èº«ï¼Œè€Œä¸æ˜¯åŸå…ˆçš„ exportsã€‚</p><p>exports å’Œ module.exports çš„ä½¿ç”¨</p><p>å¦‚æœè¦å¯¹å¤–æš´éœ²å±æ€§æˆ–æ–¹æ³•ï¼Œå°±ç”¨ exports å°±è¡Œï¼Œè¦æš´éœ²å¯¹è±¡(ç±»ä¼¼classï¼ŒåŒ…å«äº†å¾ˆå¤šå±æ€§å’Œæ–¹æ³•)ï¼Œå°±ç”¨ module.exportsã€‚</p><p>PS æ¨¡å—åŠ è½½
ä»æ–‡ä»¶æ¨¡å—ç¼“å­˜ä¸­åŠ è½½
å°½ç®¡åŸç”Ÿæ¨¡å—ä¸æ–‡ä»¶æ¨¡å—çš„ä¼˜å…ˆçº§ä¸åŒï¼Œä½†æ˜¯éƒ½ä¼šä¼˜å…ˆä»æ–‡ä»¶æ¨¡å—çš„ç¼“å­˜ä¸­åŠ è½½å·²ç»å­˜åœ¨çš„æ¨¡å—ã€‚</p><p>ä»åŸç”Ÿæ¨¡å—åŠ è½½
åŸç”Ÿæ¨¡å—çš„ä¼˜å…ˆçº§ä»…æ¬¡äºæ–‡ä»¶æ¨¡å—ç¼“å­˜çš„ä¼˜å…ˆçº§ã€‚require æ–¹æ³•åœ¨è§£ææ–‡ä»¶åä¹‹åï¼Œä¼˜å…ˆæ£€æŸ¥æ¨¡å—æ˜¯å¦åœ¨åŸç”Ÿæ¨¡å—åˆ—è¡¨ä¸­ã€‚ä»¥httpæ¨¡å—ä¸ºä¾‹ï¼Œå°½ç®¡åœ¨ç›®å½•ä¸‹å­˜åœ¨ä¸€ä¸ª http/http.js/http.node/http.json æ–‡ä»¶ï¼Œrequire(&ldquo;http&rdquo;) éƒ½ä¸ä¼šä»è¿™äº›æ–‡ä»¶ä¸­åŠ è½½ï¼Œè€Œæ˜¯ä»åŸç”Ÿæ¨¡å—ä¸­åŠ è½½ã€‚</p><p>åŸç”Ÿæ¨¡å—ä¹Ÿæœ‰ä¸€ä¸ªç¼“å­˜åŒºï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¼˜å…ˆä»ç¼“å­˜åŒºåŠ è½½ã€‚å¦‚æœç¼“å­˜åŒºæ²¡æœ‰è¢«åŠ è½½è¿‡ï¼Œåˆ™è°ƒç”¨åŸç”Ÿæ¨¡å—çš„åŠ è½½æ–¹å¼è¿›è¡ŒåŠ è½½å’Œæ‰§è¡Œã€‚</p><p>ä»æ–‡ä»¶åŠ è½½
å½“æ–‡ä»¶æ¨¡å—ç¼“å­˜ä¸­ä¸å­˜åœ¨ï¼Œè€Œä¸”ä¸æ˜¯åŸç”Ÿæ¨¡å—çš„æ—¶å€™ï¼ŒNode.js ä¼šè§£æ require æ–¹æ³•ä¼ å…¥çš„å‚æ•°ï¼Œå¹¶ä»æ–‡ä»¶ç³»ç»Ÿä¸­åŠ è½½å®é™…çš„æ–‡ä»¶ï¼ŒåŠ è½½è¿‡ç¨‹ä¸­çš„åŒ…è£…å’Œç¼–è¯‘ç»†èŠ‚åœ¨å‰ä¸€èŠ‚ä¸­å·²ç»ä»‹ç»è¿‡ï¼Œè¿™é‡Œæˆ‘ä»¬å°†è¯¦ç»†æè¿°æŸ¥æ‰¾æ–‡ä»¶æ¨¡å—çš„è¿‡ç¨‹ï¼Œå…¶ä¸­ï¼Œä¹Ÿæœ‰ä¸€äº›ç»†èŠ‚å€¼å¾—çŸ¥æ™“ã€‚</p><p>requireæ–¹æ³•æ¥å—ä»¥ä¸‹å‡ ç§å‚æ•°çš„ä¼ é€’ï¼š</p><p>httpã€fsã€pathç­‰ï¼ŒåŸç”Ÿæ¨¡å—ã€‚
./modæˆ–../modï¼Œç›¸å¯¹è·¯å¾„çš„æ–‡ä»¶æ¨¡å—ã€‚
/pathtomodule/modï¼Œç»å¯¹è·¯å¾„çš„æ–‡ä»¶æ¨¡å—ã€‚
modï¼ŒéåŸç”Ÿæ¨¡å—çš„æ–‡ä»¶æ¨¡å—ã€‚</p><h1 id=nodejs-åŠ è½½c>ğŸ”„nodejs åŠ è½½c++<a hidden class=anchor aria-hidden=true href=#nodejs-åŠ è½½c>#</a></h1><p>åœ¨Node.jsä¸­åŠ è½½C++ä»£ç ï¼Œé€šå¸¸æ˜¯é€šè¿‡ç¼–å†™ä¸€ä¸ªC++çš„æ‰©å±•æ¨¡å—ï¼Œç„¶åé€šè¿‡Node.jsçš„requireæ–¹æ³•åŠ è½½è¿™ä¸ªæ¨¡å—ã€‚è¿™å¯ä»¥é€šè¿‡Node.jsçš„åŸç”Ÿæ‰©å±•æ¨¡å—APIå®ç°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡N-APIå®ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªä¸ºæ„å»ºå¯ä»¥åœ¨å¤šä¸ªNode.jsç‰ˆæœ¬ä¸Šå·¥ä½œçš„åŸç”Ÿæ‰©å±•æ¨¡å—è€Œè®¾è®¡çš„APIã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºå¦‚ä½•åˆ›å»ºä¸€ä¸ªC++æ‰©å±•æ¨¡å—å¹¶åœ¨Node.jsä¸­ä½¿ç”¨å®ƒã€‚</p><p>é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£…ä¸€ä¸ªåä¸ºnode-gypçš„å·¥å…·ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨æ¥ç¼–è¯‘C++æ‰©å±•æ¨¡å—çš„å·¥å…·ï¼š</p><p>npm install -g node-gyp
ç„¶åï¼Œåˆ›å»ºä¸€ä¸ªåä¸ºbinding.gypçš„æ–‡ä»¶ï¼Œå®ƒæè¿°äº†å¦‚ä½•æ„å»ºæ‰©å±•æ¨¡å—ï¼š</p><pre tabindex=0><code class=language-gyp data-lang=gyp>{
  &#34;targets&#34;: [
    {
      &#34;target_name&#34;: &#34;addon&#34;,
      &#34;sources&#34;: [ &#34;addon.cc&#34; ]
    }
  ]
}
</code></pre><p>æ¥ä¸‹æ¥ï¼Œåˆ›å»ºä¸€ä¸ªC++æºæ–‡ä»¶ï¼Œä¾‹å¦‚addon.ccï¼Œå®ƒåŒ…å«äº†ä½ çš„C++ä»£ç ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;node.h&gt;</span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>namespace</span> demo {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> v8<span style=color:#f92672>::</span>FunctionCallbackInfo;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> v8<span style=color:#f92672>::</span>Isolate;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> v8<span style=color:#f92672>::</span>Local;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> v8<span style=color:#f92672>::</span>NewStringType;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> v8<span style=color:#f92672>::</span>Object;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> v8<span style=color:#f92672>::</span>String;
</span></span><span style=display:flex><span><span style=color:#66d9ef>using</span> v8<span style=color:#f92672>::</span>Value;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>Method</span>(<span style=color:#66d9ef>const</span> FunctionCallbackInfo<span style=color:#f92672>&lt;</span>Value<span style=color:#f92672>&gt;&amp;</span> args) {
</span></span><span style=display:flex><span>  Isolate<span style=color:#f92672>*</span> isolate <span style=color:#f92672>=</span> args.GetIsolate();
</span></span><span style=display:flex><span>  args.GetReturnValue().Set(String<span style=color:#f92672>::</span>NewFromUtf8(isolate, <span style=color:#e6db74>&#34;world&#34;</span>, NewStringType<span style=color:#f92672>::</span>kNormal).ToLocalChecked());
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>Initialize</span>(Local<span style=color:#f92672>&lt;</span>Object<span style=color:#f92672>&gt;</span> exports) {
</span></span><span style=display:flex><span>  NODE_SET_METHOD(exports, <span style=color:#e6db74>&#34;hello&#34;</span>, Method);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NODE_MODULE(NODE_GYP_MODULE_NAME, Initialize)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>}  <span style=color:#75715e>// namespace demo
</span></span></span></code></pre></div><p>ç¡®ä¿åœ¨binding.gypæ–‡ä»¶çš„åŒä¸€ç›®å½•ä¸‹ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥æ„å»ºæ‰©å±•æ¨¡å—ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>node-gyp configure build
</span></span></code></pre></div><p>è¿™å°†ç”Ÿæˆä¸€ä¸ªç¼–è¯‘å¥½çš„æ‰©å±•æ¨¡å—ï¼Œä½ å¯ä»¥åœ¨Node.jsä¸­é€šè¿‡requireæ¥åŠ è½½å¹¶ä½¿ç”¨å®ƒï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>addon</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;./build/Release/addon.node&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>addon</span>.<span style=color:#a6e22e>hello</span>());  <span style=color:#75715e>// è¾“å‡º: world
</span></span></span></code></pre></div><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒC++æ¨¡å—å¯¼å‡ºäº†ä¸€ä¸ªåä¸ºhelloçš„æ–¹æ³•ï¼Œå½“åœ¨Node.jsä¸­è°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒè¿”å›å­—ç¬¦ä¸²"world"ã€‚</p><h1 id=nodejs-å‡½æ•°>ğŸ™‹â€â™€ï¸Node.js å‡½æ•°<a hidden class=anchor aria-hidden=true href=#nodejs-å‡½æ•°>#</a></h1><p>åœ¨ JavaScriptä¸­ï¼Œä¸€ä¸ªå‡½æ•°å¯ä»¥ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥å…ˆå®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œç„¶åä¼ é€’ï¼Œä¹Ÿå¯ä»¥åœ¨ä¼ é€’å‚æ•°çš„åœ°æ–¹ç›´æ¥å®šä¹‰å‡½æ•°ã€‚</p><p>Node.js ä¸­å‡½æ•°çš„ä½¿ç”¨ä¸ JavaScript ç±»ä¼¼ï¼Œä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥è¿™æ ·åšï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>say</span>(<span style=color:#a6e22e>word</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>word</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>execute</span>(<span style=color:#a6e22e>someFunction</span>, <span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>someFunction</span>(<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>execute</span>(<span style=color:#a6e22e>say</span>, <span style=color:#e6db74>&#34;Hello&#34;</span>);
</span></span></code></pre></div><p>ä»¥ä¸Šä»£ç ä¸­ï¼Œæˆ‘ä»¬æŠŠ say å‡½æ•°ä½œä¸º execute å‡½æ•°çš„ç¬¬ä¸€ä¸ªå˜é‡è¿›è¡Œäº†ä¼ é€’ã€‚è¿™é‡Œä¼ é€’çš„ä¸æ˜¯ say çš„è¿”å›å€¼ï¼Œè€Œæ˜¯ say æœ¬èº«ï¼</p><p>è¿™æ ·ä¸€æ¥ï¼Œ say å°±å˜æˆäº†execute ä¸­çš„æœ¬åœ°å˜é‡ someFunction ï¼Œexecute å¯ä»¥é€šè¿‡è°ƒç”¨ someFunction() ï¼ˆå¸¦æ‹¬å·çš„å½¢å¼ï¼‰æ¥ä½¿ç”¨ say å‡½æ•°ã€‚</p><p>å½“ç„¶ï¼Œå› ä¸º say æœ‰ä¸€ä¸ªå˜é‡ï¼Œ execute åœ¨è°ƒç”¨ someFunction æ—¶å¯ä»¥ä¼ é€’è¿™æ ·ä¸€ä¸ªå˜é‡ã€‚</p><h2 id=åŒ¿åå‡½æ•°>åŒ¿åå‡½æ•°<a hidden class=anchor aria-hidden=true href=#åŒ¿åå‡½æ•°>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>execute</span>(<span style=color:#a6e22e>someFunction</span>, <span style=color:#a6e22e>value</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>someFunction</span>(<span style=color:#a6e22e>value</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>execute</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>word</span>){ <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>word</span>) }, <span style=color:#e6db74>&#34;Hello&#34;</span>);
</span></span></code></pre></div><p>ä¼ é€’</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>http</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;http&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>onRequest</span>(<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>writeHead</span>(<span style=color:#ae81ff>200</span>, {<span style=color:#e6db74>&#34;Content-Type&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text/plain&#34;</span>});
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#34;Hello World&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>end</span>();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>createServer</span>(<span style=color:#a6e22e>onRequest</span>).<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>8888</span>);
</span></span></code></pre></div><p>==></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>http</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;http&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>createServer</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>writeHead</span>(<span style=color:#ae81ff>200</span>, {<span style=color:#e6db74>&#34;Content-Type&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text/plain&#34;</span>});
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#34;Hello World&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>end</span>();
</span></span><span style=display:flex><span>}).<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>8888</span>);
</span></span></code></pre></div><h1 id=nodejs-ç®­å¤´å‡½æ•°>ğŸ™‹â€â™‚Node.js ç®­å¤´å‡½æ•°<a hidden class=anchor aria-hidden=true href=#nodejs-ç®­å¤´å‡½æ•°>#</a></h1><p>åœ¨Node.jsä¸­ï¼Œç®­å¤´å‡½æ•°æ˜¯ä¸€ç§ç®€æ´å†™æ³•ï¼Œç”¨äºå£°æ˜åŒ¿åå‡½æ•°ã€‚å®ƒä»¬æœ€å¸¸ç”¨äºå›è°ƒå‡½æ•°å’Œäº‹ä»¶ç›‘å¬å™¨ç­‰åœºæ™¯ã€‚ç®­å¤´å‡½æ•°çš„è¯­æ³•å¾ˆç®€å•ï¼Œå®ƒçš„åŸºæœ¬æ ¼å¼å¦‚ä¸‹ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>(<span style=color:#a6e22e>param1</span>, <span style=color:#a6e22e>param2</span>, ...) =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// å‡½æ•°ä½“
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>something</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>4</span>, <span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>doubled</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>numbers</span>.<span style=color:#a6e22e>map</span>(<span style=color:#a6e22e>number</span> =&gt; <span style=color:#a6e22e>number</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>doubled</span>); <span style=color:#75715e>// è¾“å‡º: [2, 4, 6, 8, 10]
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;hihihi.&#39;</span>);
</span></span><span style=display:flex><span>}, <span style=color:#ae81ff>2000</span>);
</span></span></code></pre></div><p>ä»¥ä¸Šå†³ç­–å›¾çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œæˆ‘è®¤ä¸ºæœ‰ä¸‰ç‚¹æ¯”è¾ƒé‡è¦ï¼š</p><p>ç®­å¤´å‡½æ•°é€‚åˆäºæ— å¤æ‚é€»è¾‘æˆ–è€…æ— å‰¯ä½œç”¨çš„çº¯å‡½æ•°åœºæ™¯ä¸‹ï¼Œä¾‹å¦‚ç”¨åœ¨ map ã€ reduce ã€ filter çš„å›è°ƒå‡½æ•°å®šä¹‰ä¸­ï¼›
ä¸è¦åœ¨æœ€å¤–å±‚å®šä¹‰ç®­å¤´å‡½æ•°ï¼Œå› ä¸ºåœ¨å‡½æ•°å†…éƒ¨æ“ä½œ this ä¼šå¾ˆå®¹æ˜“æ±¡æŸ“å…¨å±€ä½œç”¨åŸŸã€‚æœ€èµ·ç åœ¨ç®­å¤´å‡½æ•°å¤–éƒ¨åŒ…ä¸€å±‚æ™®é€šå‡½æ•°ï¼Œå°† this æ§åˆ¶åœ¨å¯è§çš„èŒƒå›´å†…ï¼›
å¦‚å¼€å¤´æ‰€è¿°ï¼Œç®­å¤´å‡½æ•°æœ€å¸å¼•äººçš„åœ°æ–¹æ˜¯ç®€æ´ã€‚åœ¨æœ‰å¤šå±‚å‡½æ•°åµŒå¥—çš„æƒ…å†µä¸‹ï¼Œç®­å¤´å‡½æ•°çš„ç®€æ´æ€§å¹¶æ²¡æœ‰å¾ˆå¤§çš„æå‡ï¼Œåè€Œå½±å“äº†å‡½æ•°çš„ä½œç”¨èŒƒå›´çš„è¯†åˆ«åº¦ï¼Œè¿™ç§æƒ…å†µä¸å»ºè®®ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚</p><h1 id=nodejs-è·¯ç”±>ğŸ§ªNode.js è·¯ç”±<a hidden class=anchor aria-hidden=true href=#nodejs-è·¯ç”±>#</a></h1><p>åœ¨ Node.js ä¸­ï¼Œè·¯ç”±ï¼ˆRoutingï¼‰æ˜¯æŒ‡ç¡®å®šå¦‚ä½•å“åº”å¯¹ç‰¹å®šç«¯ç‚¹ï¼ˆURL è·¯å¾„ï¼‰çš„ HTTP è¯·æ±‚çš„è¿‡ç¨‹ã€‚</p><p>æˆ‘ä»¬è¦ä¸ºè·¯ç”±æä¾›è¯·æ±‚çš„ URL å’Œå…¶ä»–éœ€è¦çš„ GET åŠ POST å‚æ•°ï¼Œéšåè·¯ç”±éœ€è¦æ ¹æ®è¿™äº›æ•°æ®æ¥æ‰§è¡Œç›¸åº”çš„ä»£ç ã€‚</p><p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥çœ‹ HTTP è¯·æ±‚ï¼Œä»ä¸­æå–å‡ºè¯·æ±‚çš„ URL ä»¥åŠ GET/POST å‚æ•°ã€‚è¿™ä¸€åŠŸèƒ½åº”å½“å±äºè·¯ç”±è¿˜æ˜¯æœåŠ¡å™¨ï¼ˆç”šè‡³ä½œä¸ºä¸€ä¸ªæ¨¡å—è‡ªèº«çš„åŠŸèƒ½ï¼‰ç¡®å®å€¼å¾—æ¢è®¨ï¼Œä½†è¿™é‡Œæš‚å®šå…¶ä¸ºæˆ‘ä»¬çš„HTTPæœåŠ¡å™¨çš„åŠŸèƒ½ã€‚</p><p>æˆ‘ä»¬éœ€è¦çš„æ‰€æœ‰æ•°æ®éƒ½ä¼šåŒ…å«åœ¨ request å¯¹è±¡ä¸­ï¼Œè¯¥å¯¹è±¡ä½œä¸º onRequest() å›è°ƒå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ã€‚ä½†æ˜¯ä¸ºäº†è§£æè¿™äº›æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–çš„ Node.JS æ¨¡å—ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ url å’Œ querystring æ¨¡å—ã€‚</p><pre><code>                url.parse(string).query
                                        |
        url.parse(string).pathname      |
                    |                   |
                    |                   |
                  ++++++ ++++++++++++++++++-
</code></pre><p>http://localhost:8888/start?foo=bar&amp;hello=world
+++ +++&ndash;
| |
| |
querystring.parse(queryString)[&ldquo;foo&rdquo;] |
|
querystring.parse(queryString)[&ldquo;hello&rdquo;]
ç°åœ¨æˆ‘ä»¬æ¥ç»™ onRequest() å‡½æ•°åŠ ä¸Šä¸€äº›é€»è¾‘ï¼Œç”¨æ¥æ‰¾å‡ºæµè§ˆå™¨è¯·æ±‚çš„ URL è·¯å¾„ï¼š</p><p>router.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>route</span>(<span style=color:#a6e22e>pathname</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;About to route a request for &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>pathname</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>route</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>route</span>;
</span></span></code></pre></div><p>server.js</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>http</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;http&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;url&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>start</span>(<span style=color:#a6e22e>route</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>onRequest</span>(<span style=color:#a6e22e>request</span>, <span style=color:#a6e22e>response</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>pathname</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>url</span>).<span style=color:#a6e22e>pathname</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Request for &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>pathname</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34; received.&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>route</span>(<span style=color:#a6e22e>pathname</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>writeHead</span>(<span style=color:#ae81ff>200</span>, {<span style=color:#e6db74>&#34;Content-Type&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text/plain&#34;</span>});
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#34;Hello World&#34;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>end</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>createServer</span>(<span style=color:#a6e22e>onRequest</span>).<span style=color:#a6e22e>listen</span>(<span style=color:#ae81ff>8888</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;Server has started.&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>exports</span>.<span style=color:#a6e22e>start</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>start</span>;
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//test.js
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>server</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;./server&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>router</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#34;./router&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server</span>.<span style=color:#a6e22e>start</span>(<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>route</span>);
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>node  test.js 
</span></span></code></pre></div><h1 id=nodejs-å…¨å±€å¯¹è±¡>ğŸ™Node.js å…¨å±€å¯¹è±¡<a hidden class=anchor aria-hidden=true href=#nodejs-å…¨å±€å¯¹è±¡>#</a></h1><p>javaScript ä¸­æœ‰ä¸€ä¸ªç‰¹æ®Šçš„å¯¹è±¡ï¼Œç§°ä¸ºå…¨å±€å¯¹è±¡ï¼ˆGlobal Objectï¼‰ï¼Œå®ƒåŠå…¶æ‰€æœ‰å±æ€§éƒ½å¯ä»¥åœ¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹è®¿é—®ï¼Œå³å…¨å±€å˜é‡ã€‚</p><p>åœ¨æµè§ˆå™¨ JavaScript ä¸­ï¼Œé€šå¸¸ window æ˜¯å…¨å±€å¯¹è±¡ï¼Œ è€Œ Node.js ä¸­çš„å…¨å±€å¯¹è±¡æ˜¯ globalï¼Œæ‰€æœ‰å…¨å±€å˜é‡ï¼ˆé™¤äº† global æœ¬èº«ä»¥å¤–ï¼‰éƒ½æ˜¯ global å¯¹è±¡çš„å±æ€§ã€‚</p><p>åœ¨ Node.js æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®åˆ° global çš„å±æ€§ï¼Œè€Œä¸éœ€è¦åœ¨åº”ç”¨ä¸­åŒ…å«å®ƒã€‚</p><p>å…¨å±€å¯¹è±¡ä¸å…¨å±€å˜é‡
global æœ€æ ¹æœ¬çš„ä½œç”¨æ˜¯ä½œä¸ºå…¨å±€å˜é‡çš„å®¿ä¸»ã€‚æŒ‰ç…§ ECMAScript çš„å®šä¹‰ï¼Œæ»¡è¶³ä»¥ä¸‹æ¡ ä»¶çš„å˜é‡æ˜¯å…¨å±€å˜é‡ï¼š</p><p>åœ¨æœ€å¤–å±‚å®šä¹‰çš„å˜é‡ï¼›
å…¨å±€å¯¹è±¡çš„å±æ€§ï¼›
éšå¼å®šä¹‰çš„å˜é‡ï¼ˆæœªå®šä¹‰ç›´æ¥èµ‹å€¼çš„å˜é‡ï¼‰ã€‚
å½“ä½ å®šä¹‰ä¸€ä¸ªå…¨å±€å˜é‡æ—¶ï¼Œè¿™ä¸ªå˜é‡åŒæ—¶ä¹Ÿä¼šæˆä¸ºå…¨å±€å¯¹è±¡çš„å±æ€§ï¼Œåä¹‹äº¦ç„¶ã€‚éœ€è¦æ³¨ æ„çš„æ˜¯ï¼Œåœ¨ Node.js ä¸­ä½ ä¸å¯èƒ½åœ¨æœ€å¤–å±‚å®šä¹‰å˜é‡ï¼Œå› ä¸ºæ‰€æœ‰ç”¨æˆ·ä»£ç éƒ½æ˜¯å±äºå½“å‰æ¨¡å—çš„ï¼Œ è€Œæ¨¡å—æœ¬èº«ä¸æ˜¯æœ€å¤–å±‚ä¸Šä¸‹æ–‡ã€‚</p><p>æ³¨æ„ï¼š æœ€å¥½ä¸è¦ä½¿ç”¨ var å®šä¹‰å˜é‡ä»¥é¿å…å¼•å…¥å…¨å±€å˜é‡ï¼Œå› ä¸ºå…¨å±€å˜é‡ä¼šæ±¡æŸ“å‘½åç©ºé—´ï¼Œæé«˜ä»£ç çš„è€¦åˆé£é™©ã€‚</p><h2 id=__filename>__filename<a hidden class=anchor aria-hidden=true href=#__filename>#</a></h2><p>__filename è¡¨ç¤ºå½“å‰æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬çš„æ–‡ä»¶åã€‚å®ƒå°†è¾“å‡ºæ–‡ä»¶æ‰€åœ¨ä½ç½®çš„ç»å¯¹è·¯å¾„ï¼Œä¸”å’Œå‘½ä»¤è¡Œå‚æ•°æ‰€æŒ‡å®šçš„æ–‡ä»¶åä¸ä¸€å®šç›¸åŒã€‚ å¦‚æœåœ¨æ¨¡å—ä¸­ï¼Œè¿”å›çš„å€¼æ˜¯æ¨¡å—æ–‡ä»¶çš„è·¯å¾„ã€‚</p><h2 id=__dirname>__dirname<a hidden class=anchor aria-hidden=true href=#__dirname>#</a></h2><p>__dirname è¡¨ç¤ºå½“å‰æ‰§è¡Œè„šæœ¬æ‰€åœ¨çš„ç›®å½•ã€‚</p><h2 id=settimeoutcb-ms>setTimeout(cb, ms)<a hidden class=anchor aria-hidden=true href=#settimeoutcb-ms>#</a></h2><p>setTimeout(cb, ms) å…¨å±€å‡½æ•°åœ¨æŒ‡å®šçš„æ¯«ç§’(ms)æ•°åæ‰§è¡ŒæŒ‡å®šå‡½æ•°(cb)ã€‚ï¼šsetTimeout() åªæ‰§è¡Œä¸€æ¬¡æŒ‡å®šå‡½æ•°ã€‚</p><h2 id=cleartimeoutt>clearTimeout(t)<a hidden class=anchor aria-hidden=true href=#cleartimeoutt>#</a></h2><p>clearTimeout( t ) å…¨å±€å‡½æ•°ç”¨äºåœæ­¢ä¸€ä¸ªä¹‹å‰é€šè¿‡ setTimeout() åˆ›å»ºçš„å®šæ—¶å™¨ã€‚ å‚æ•° t æ˜¯é€šè¿‡ setTimeout() å‡½æ•°åˆ›å»ºçš„å®šæ—¶å™¨ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>printHello</span>(){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>( <span style=color:#e6db74>&#34;Hello, World!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// ä¸¤ç§’åæ‰§è¡Œä»¥ä¸Šå‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>t</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setTimeout</span>(<span style=color:#a6e22e>printHello</span>, <span style=color:#ae81ff>2000</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// æ¸…é™¤å®šæ—¶å™¨
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>clearTimeout</span>(<span style=color:#a6e22e>t</span>);
</span></span></code></pre></div><p>æ‰§è¡Œ main.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤º:</p><h2 id=setintervalcb-ms>setInterval(cb, ms)<a hidden class=anchor aria-hidden=true href=#setintervalcb-ms>#</a></h2><p>setInterval(cb, ms) å…¨å±€å‡½æ•°åœ¨æŒ‡å®šçš„æ¯«ç§’(ms)æ•°åæ‰§è¡ŒæŒ‡å®šå‡½æ•°(cb)ã€‚</p><p>è¿”å›ä¸€ä¸ªä»£è¡¨å®šæ—¶å™¨çš„å¥æŸ„å€¼ã€‚å¯ä»¥ä½¿ç”¨ clearInterval(t) å‡½æ•°æ¥æ¸…é™¤å®šæ—¶å™¨ã€‚</p><p>setInterval() æ–¹æ³•ä¼šä¸åœåœ°è°ƒç”¨å‡½æ•°ï¼Œç›´åˆ° clearInterval() è¢«è°ƒç”¨æˆ–çª—å£è¢«å…³é—­ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>printHello</span>(){
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>( <span style=color:#e6db74>&#34;Hello, World!&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// ä¸¤ç§’åæ‰§è¡Œä»¥ä¸Šå‡½æ•°
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>setInterval</span>(<span style=color:#a6e22e>printHello</span>, <span style=color:#ae81ff>2000</span>);
</span></span></code></pre></div><h2 id=console>console<a hidden class=anchor aria-hidden=true href=#console>#</a></h2><p>console ç”¨äºæä¾›æ§åˆ¶å°æ ‡å‡†è¾“å‡ºï¼Œå®ƒæ˜¯ç”± Internet Explorer çš„ JScript å¼•æ“æä¾›çš„è°ƒè¯•å·¥å…·ï¼Œåæ¥é€æ¸æˆä¸ºæµè§ˆå™¨çš„å®æ–½æ ‡å‡†ã€‚</p><pre><code>console.log
console.info
console.error
console.warn
</code></pre><p>console.time(label)
è¾“å‡ºæ—¶é—´ï¼Œè¡¨ç¤ºè®¡æ—¶å¼€å§‹ã€‚
console.timeEnd(label)
ç»“æŸæ—¶é—´ï¼Œè¡¨ç¤ºè®¡æ—¶ç»“æŸã€‚
console.trace</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;ç¨‹åºå¼€å§‹æ‰§è¡Œï¼š&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>counter</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;è®¡æ•°: %d&#34;</span>, <span style=color:#a6e22e>counter</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>time</span>(<span style=color:#e6db74>&#34;è·å–æ•°æ®&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>//
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>100000</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>  )
</span></span><span style=display:flex><span>{}
</span></span><span style=display:flex><span><span style=color:#75715e>// 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>timeEnd</span>(<span style=color:#e6db74>&#39;è·å–æ•°æ®&#39;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œå®Œæ¯•ã€‚&#34;</span>)
</span></span></code></pre></div><h2 id=process>process<a hidden class=anchor aria-hidden=true href=#process>#</a></h2><p>process æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå³ global å¯¹è±¡çš„å±æ€§ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;exit&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>code</span>) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// ä»¥ä¸‹ä»£ç æ°¸è¿œä¸ä¼šæ‰§è¡Œ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>setTimeout</span>(<span style=color:#66d9ef>function</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;è¯¥ä»£ç ä¸ä¼šæ‰§è¡Œ&#34;</span>);
</span></span><span style=display:flex><span>  }, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;é€€å‡ºç ä¸º:&#39;</span>, <span style=color:#a6e22e>code</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;ç¨‹åºæ‰§è¡Œç»“æŸ&#34;</span>);
</span></span></code></pre></div><h2 id=process-å±æ€§>Process å±æ€§<a hidden class=anchor aria-hidden=true href=#process-å±æ€§>#</a></h2><p>Process æä¾›äº†å¾ˆå¤šæœ‰ç”¨çš„å±æ€§ï¼Œä¾¿äºæˆ‘ä»¬æ›´å¥½çš„æ§åˆ¶ç³»ç»Ÿçš„äº¤äº’</p><pre><code>stdout
</code></pre><p>æ ‡å‡†è¾“å‡ºæµ
stderr
æ ‡å‡†é”™è¯¯æµã€‚
stdin
æ ‡å‡†è¾“å…¥æµã€‚
argv
argv å±æ€§è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œç”±å‘½ä»¤è¡Œæ‰§è¡Œè„šæœ¬æ—¶çš„å„ä¸ªå‚æ•°ç»„æˆã€‚å®ƒçš„ç¬¬ä¸€ä¸ªæˆå‘˜æ€»æ˜¯nodeï¼Œç¬¬äºŒä¸ªæˆå‘˜æ˜¯è„šæœ¬æ–‡ä»¶åï¼Œå…¶ä½™æˆå‘˜æ˜¯è„šæœ¬æ–‡ä»¶çš„å‚æ•°ã€‚
execPath
è¿”å›æ‰§è¡Œå½“å‰è„šæœ¬çš„ Node äºŒè¿›åˆ¶æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ã€‚
execArgv
è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜æ˜¯å‘½ä»¤è¡Œä¸‹æ‰§è¡Œè„šæœ¬æ—¶ï¼Œåœ¨Nodeå¯æ‰§è¡Œæ–‡ä»¶ä¸è„šæœ¬æ–‡ä»¶ä¹‹é—´çš„å‘½ä»¤è¡Œå‚æ•°ã€‚
env
è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œæˆå‘˜ä¸ºå½“å‰ shell çš„ç¯å¢ƒå˜é‡
exitCode
è¿›ç¨‹é€€å‡ºæ—¶çš„ä»£ç ï¼Œå¦‚æœè¿›ç¨‹ä¼˜é€šè¿‡ process.exit() é€€å‡ºï¼Œä¸éœ€è¦æŒ‡å®šé€€å‡ºç ã€‚
version
Node çš„ç‰ˆæœ¬ï¼Œæ¯”å¦‚v0.10.18
config
ä¸€ä¸ªåŒ…å«ç”¨æ¥ç¼–è¯‘å½“å‰ node æ‰§è¡Œæ–‡ä»¶çš„ javascript é…ç½®é€‰é¡¹çš„å¯¹è±¡ã€‚å®ƒä¸è¿è¡Œ ./configure è„šæœ¬ç”Ÿæˆçš„ &ldquo;config.gypi&rdquo; æ–‡ä»¶ç›¸åŒã€‚
pid
å½“å‰è¿›ç¨‹çš„è¿›ç¨‹å·ã€‚
title
è¿›ç¨‹åï¼Œé»˜è®¤å€¼ä¸º"node"ï¼Œå¯ä»¥è‡ªå®šä¹‰è¯¥å€¼ã€‚
platform
è¿è¡Œç¨‹åºæ‰€åœ¨çš„å¹³å°ç³»ç»Ÿ &lsquo;darwin&rsquo;, &lsquo;freebsd&rsquo;, &rsquo;linux&rsquo;, &lsquo;sunos&rsquo; æˆ– &lsquo;win32&rsquo;
arch
å½“å‰ CPU çš„æ¶æ„ï¼š&lsquo;arm&rsquo;ã€&lsquo;ia32&rsquo; æˆ–è€… &lsquo;x64&rsquo;ã€‚
mainModule
require.main çš„å¤‡é€‰æ–¹æ³•ã€‚ä¸åŒç‚¹ï¼Œå¦‚æœä¸»æ¨¡å—åœ¨è¿è¡Œæ—¶æ”¹å˜ï¼Œrequire.mainå¯èƒ½ä¼šç»§ç»­è¿”å›è€çš„æ¨¡å—ã€‚å¯ä»¥è®¤ä¸ºï¼Œè¿™ä¸¤è€…å¼•ç”¨äº†åŒä¸€ä¸ªæ¨¡å—ã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>// è¾“å‡ºåˆ°ç»ˆç«¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>stdout</span>.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#34;Hello World!&#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;\n&#34;</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// é€šè¿‡å‚æ•°è¯»å–
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>argv</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>val</span>, <span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>array</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>index</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>val</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#75715e>// è·å–æ‰§è¡Œè·¯å¾„
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>execPath</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// å¹³å°ä¿¡æ¯
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>platform</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// è¾“å‡ºå½“å‰ç›®å½•
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;å½“å‰ç›®å½•: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>cwd</span>());
</span></span><span style=display:flex><span><span style=color:#75715e>// è¾“å‡ºå½“å‰ç‰ˆæœ¬
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;å½“å‰ç‰ˆæœ¬: &#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>version</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>// è¾“å‡ºå†…å­˜ä½¿ç”¨æƒ…å†µ
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>memoryUsage</span>());
</span></span></code></pre></div><h1 id=nodejs-mysql>ğŸ”­Node.js MySQL<a hidden class=anchor aria-hidden=true href=#nodejs-mysql>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>npm install mysql
</span></span></code></pre></div><p>select</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>mysql</span>  <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;mysql&#39;</span>);  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>connection</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mysql</span>.<span style=color:#a6e22e>createConnection</span>({     
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>host</span>     <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;localhost&#39;</span>,       
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>user</span>     <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;root&#39;</span>,              
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>password</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;123456789&#39;</span>,   <span style=color:#75715e>//pwd  
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;30306&#39;</span>,                   
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>database</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;IMDB&#39;</span> 
</span></span><span style=display:flex><span>}); 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>connect</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span>  <span style=color:#a6e22e>sql</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;SELECT * FROM IMConfig;&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>sql</span>);
</span></span><span style=display:flex><span><span style=color:#75715e>//æŸ¥
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>query</span>(<span style=color:#a6e22e>sql</span>,<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>result</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>err</span>){
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;[SELECT ERROR] - &#39;</span>,<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>message</span>);
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;++++++++++++++++++++++++--SELECT+++++++++++++++++++++++++++-&#39;</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>result</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++\n\n&#39;</span>);  
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>end</span>();
</span></span></code></pre></div><h2 id=error-1045-28000-access-denied-for-user-rootlocalhost-using-password-yes>ERROR 1045 (28000): Access denied for user â€˜rootâ€˜@â€˜localhostâ€˜ (using password: YES)<a hidden class=anchor aria-hidden=true href=#error-1045-28000-access-denied-for-user-rootlocalhost-using-password-yes>#</a></h2><p>è¿™è¾¹æ˜¯é€šè¿‡dockerå®‰è£…çš„mysqlï¼Œç™»å½•æŠ¥é”™
root@f4a3881e5f06:/# mysql -uroot -p<br>Enter password: 123456
ERROR 1045 (28000): Access denied for user &lsquo;root&rsquo;@&rsquo;localhost&rsquo; (using password: YES)</p><p>å¦‚æœå¸¸è§„çš„å‘½ä»¤ mysql -uroot -pæ— æ³•ç™»å½•ï¼Œä½¿ç”¨å‘½ä»¤å°è¯•ï¼š</p><p>mysql -u root -h 127.0.0.1 -p</p><h2 id=error-er_not_supported_auth_mode-client-does-not-support-authentication-protocol-requested>Error: ER_NOT_SUPPORTED_AUTH_MODE: Client does not support authentication protocol requested<a hidden class=anchor aria-hidden=true href=#error-er_not_supported_auth_mode-client-does-not-support-authentication-protocol-requested>#</a></h2><p>mysql -u root -p
ALTER USER &lsquo;root&rsquo;@&rsquo;%&rsquo; IDENTIFIED WITH mysql_native_password BY &lsquo;123456789&rsquo;;
flush privileges;</p><p>insert</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>connect</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span>  <span style=color:#a6e22e>addSql</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;INSERT INTO IMConfig(ConfigID,UserID,ConfigName,ConfigCreateTime,ConfigType,ConfigSn) VALUES(0,?,?,?,?,?)&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span>  <span style=color:#a6e22e>addSqlParams</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;1&#39;</span>, <span style=color:#e6db74>&#39;11&#39;</span>,<span style=color:#e6db74>&#39;2023-01-01&#39;</span>, <span style=color:#e6db74>&#39;1&#39;</span>,<span style=color:#e6db74>&#39;1&#39;</span>];
</span></span><span style=display:flex><span><span style=color:#75715e>//å¢
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>query</span>(<span style=color:#a6e22e>addSql</span>,<span style=color:#a6e22e>addSqlParams</span>,<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>result</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>err</span>){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;[INSERT ERROR] - &#39;</span>,<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>message</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }        
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;++++++++++++++++++++++++--INSERT+++++++++++++++++++++++++++-&#39;</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>//console.log(&#39;INSERT ID:&#39;,result.insertId);        
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;INSERT ID:&#39;</span>,<span style=color:#a6e22e>result</span>);        
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++--\n\n&#39;</span>);  
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>end</span>();
</span></span></code></pre></div><p>ER_NO_SUCH_TABLE: Table &lsquo;IMDB.IMCONFIG&rsquo; doesn&rsquo;t exist
ä¸­è‹±æ–‡é”™è¯¯
ER_WRONG_VALUE_COUNT_ON_ROW: Column count doesn&rsquo;t match value count at row 1
å­—æ®µé”™è¯¯
ER_TRUNCATED_WRONG_VALUE: Incorrect datetime value: &lsquo;2023-01-01T16:00:00.000Z&rsquo; for column &lsquo;ConfigCreateTime&rsquo; at row 1
å­—æ®µç±»å‹</p><p>update</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//update 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>connect</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>modSql</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;UPDATE IMConfig SET ConfigName = ?,ConfigType = ?,ConfigSn = ? WHERE ConfigId = ?&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>modSqlParams</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;lang&#39;</span>, <span style=color:#e6db74>&#39;2&#39;</span>,<span style=color:#e6db74>&#39;1&#39;</span>,<span style=color:#ae81ff>5</span>];
</span></span><span style=display:flex><span><span style=color:#75715e>//æ”¹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>query</span>(<span style=color:#a6e22e>modSql</span>,<span style=color:#a6e22e>modSqlParams</span>,<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>result</span>) {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>err</span>){
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;[UPDATE ERROR] - &#39;</span>,<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>message</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }        
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;++++++++++++++++++++++++--UPDATE+++++++++++++++++++++++++++-&#39;</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;UPDATE affectedRows&#39;</span>,<span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>affectedRows</span>);
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++--\n\n&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>end</span>();
</span></span></code></pre></div><p>delete</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>connect</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>delSql</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;DELETE FROM IMConfig where ConfigID=5&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>//åˆ 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>query</span>(<span style=color:#a6e22e>delSql</span>,<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>result</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>err</span>){
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;[DELETE ERROR] - &#39;</span>,<span style=color:#a6e22e>err</span>.<span style=color:#a6e22e>message</span>);
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>        }        
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;++++++++++++++++++++++++--DELETE+++++++++++++++++++++++++++-&#39;</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;DELETE affectedRows&#39;</span>,<span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>affectedRows</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++--\n\n&#39;</span>);  
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>connection</span>.<span style=color:#a6e22e>end</span>();
</span></span></code></pre></div><h1 id=nodejs-socket>ğŸ§µNode.js Socket<a hidden class=anchor aria-hidden=true href=#nodejs-socket>#</a></h1><p>socket client</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=display:flex><span><span style=color:#75715e>//sk
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>net</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;net&#39;</span>);
</span></span><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>client</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>net</span>.<span style=color:#a6e22e>connect</span>(<span style=color:#e6db74>&#39;6001&#39;</span>, <span style=color:#e6db74>&#39;xxxx&#39;</span>, <span style=color:#66d9ef>function</span>(){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;å·²ç»ä¸æœåŠ¡å™¨è¿æ¥&#39;</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>write</span>(<span style=color:#e6db74>&#39;Yes\r\n&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span><span style=display:flex><span><span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data&#39;</span>, <span style=color:#66d9ef>function</span>(<span style=color:#a6e22e>data</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>toString</span>());
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>end</span>();<span style=color:#75715e>//one msg end
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>});
</span></span><span style=display:flex><span><span style=color:#a6e22e>client</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;end&#39;</span>, <span style=color:#66d9ef>function</span>(){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;å®¢æˆ·ç«¯è¿æ¥ä¸­æ–­&#39;</span>);
</span></span><span style=display:flex><span>});
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://qfsyso.github.io/tags/node/>Node</a></li><li><a href=https://qfsyso.github.io/tags/helloworld/>Helloworld</a></li><li><a href=https://qfsyso.github.io/tags/buffer/>Buffer</a></li><li><a href=https://qfsyso.github.io/tags/stream/>Stream</a></li><li><a href=https://qfsyso.github.io/tags/c++/>C++</a></li><li><a href=https://qfsyso.github.io/tags/router/>Router</a></li><li><a href=https://qfsyso.github.io/tags/mysql/>MySQL</a></li><li><a href=https://qfsyso.github.io/tags/socket/>Socket</a></li></ul><nav class=paginav><a class=prev href=https://qfsyso.github.io/posts/nodejs-study/><span class=title>Â« Prev</span><br><span>Nodejs Study</span>
</a><a class=next href=https://qfsyso.github.io/posts/harmonyos-photos-column-swiper-grid/><span class=title>Next Â»</span><br><span>HarmonyOS Photos Column Swiper Grid</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Nodejs base on x" href="https://x.com/intent/tweet/?text=Nodejs%20base&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f&amp;hashtags=Node%2cHelloworld%2cBuffer%2cStream%2cC%2b%2b%2cRouter%2cMySQL%2cSocket"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Nodejs base on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f&amp;title=Nodejs%20base&amp;summary=Nodejs%20base&amp;source=https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Nodejs base on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f&title=Nodejs%20base"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Nodejs base on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Nodejs base on whatsapp" href="https://api.whatsapp.com/send?text=Nodejs%20base%20-%20https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Nodejs base on telegram" href="https://telegram.me/share/url?text=Nodejs%20base&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Nodejs base on ycombinator" href="https://news.ycombinator.com/submitlink?t=Nodejs%20base&u=https%3a%2f%2fqfsyso.github.io%2fposts%2fnodejs-base%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><div class=wtime><div class=wtime2>CST<span id=beijingTime></span> GMT <span id=londonTime></span> EST <span id=newYorkTime></span> PST<span id=losAngelesTime></span></div><div class=wtime2 style=display:none>ä¸œäº¬<span id=tokyoTime></span></div><div class=wtime2 style=display:none>æ¬§æ´²-å·´é»<span id=parisTime></span></div><div class=wtime2 style=display:none>UTC<span id=utcTime></span></div></div><span>&copy; 2025 <a href=https://qfsyso.github.io/>MLOG</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script type=text/javascript>const timeZoneOffsets={beijing:8,tokyo:9,paris:[1,2],london:[0,1],newYork:[-5,-4],losAngeles:[-8,-7]};function padZero(e){return e<10?"0"+e:e}function formatTime(e){const t=e.getFullYear(),n=padZero(e.getMonth()+1),s=padZero(e.getDate()),o=padZero(e.getHours()),i=padZero(e.getMinutes()),a=padZero(e.getSeconds());return`${t}-${n}-${s} ${o}:${i}:${a}`}function isDaylightSavingTime(e,t){const o=e.getMonth(),n=new Date(e.getFullYear(),3,8,2,0,0),s=new Date(e.getFullYear(),10,1,2,0,0);return(t==="paris"||t==="london"||t==="newYork"||t==="losAngeles")&&e>=n&&e<s}function updateTime(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),n=formatTime(t);document.getElementById("utcTime").innerHTML=n;for(const n in timeZoneOffsets){const e=timeZoneOffsets[n];let s;Array.isArray(e)?s=isDaylightSavingTime(t,n)?e[1]:e[0]:s=e;const o=new Date(t.getTime()+s*60*60*1e3);document.getElementById(n+"Time").innerHTML=formatTime(o)}setTimeout(updateTime,1e3)}window.onload=function(){updateTime()};function notfound(e){var n=e.src,t=n.split("/"),s=t[t.length-1];e.src="https://47.115.223.75:8080/group1/v2/"+s+"?timestamp="+Date.now(),e.onerror=null}</script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>