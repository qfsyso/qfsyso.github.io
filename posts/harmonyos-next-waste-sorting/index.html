<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>HarmonyOS Next Waste Sorting | MLOG</title>
<meta name=keywords content="HarmonyOS"><meta name=description content="环境 DevEco Studio NEXT Beta1 Build Version: 5.0 API 13
Waste Sorting 垃圾分类
算法 //springCurve回弹 animateToImmediately({ duration:800, curve: curves.springCurve(0, 20, 90, 20), // 其他配置 }); 初始偏移量、振幅、周期和阻尼系数，通过这些参数可以控制动画的弹性效果
//Fisher-Yates洗牌 shuffleItems() { for (let i = this.garbageItems.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); let temp = this.garbageItems[i]; this.garbageItems[i] = this.garbageItems[j]; this.garbageItems[j] = temp; } } 代码 import { curves } from '@kit.ArkUI'; // 导入ArkUI工具包中的曲线模块 // 定义垃圾项目类 class GarbageItem { name: string; // 垃圾名称 type: number; // 垃圾类型 description?"><meta name=author content="dwd"><link rel=canonical href=https://qfsyso.github.io/posts/harmonyos-next-waste-sorting/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://qfsyso.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://qfsyso.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://qfsyso.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://qfsyso.github.io/apple-touch-icon.png><link rel=mask-icon href=https://qfsyso.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://qfsyso.github.io/posts/harmonyos-next-waste-sorting/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://qfsyso.github.io/posts/harmonyos-next-waste-sorting/"><meta property="og:site_name" content="MLOG"><meta property="og:title" content="HarmonyOS Next Waste Sorting"><meta property="og:description" content="环境 DevEco Studio NEXT Beta1 Build Version: 5.0 API 13
Waste Sorting 垃圾分类
算法 //springCurve回弹 animateToImmediately({ duration:800, curve: curves.springCurve(0, 20, 90, 20), // 其他配置 }); 初始偏移量、振幅、周期和阻尼系数，通过这些参数可以控制动画的弹性效果
//Fisher-Yates洗牌 shuffleItems() { for (let i = this.garbageItems.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); let temp = this.garbageItems[i]; this.garbageItems[i] = this.garbageItems[j]; this.garbageItems[j] = temp; } } 代码 import { curves } from '@kit.ArkUI'; // 导入ArkUI工具包中的曲线模块 // 定义垃圾项目类 class GarbageItem { name: string; // 垃圾名称 type: number; // 垃圾类型 description?"><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-12-15T15:33:54+00:00"><meta property="article:modified_time" content="2024-12-15T15:33:54+00:00"><meta property="article:tag" content="HarmonyOS"><meta name=twitter:card content="summary"><meta name=twitter:title content="HarmonyOS Next Waste Sorting"><meta name=twitter:description content="环境 DevEco Studio NEXT Beta1 Build Version: 5.0 API 13
Waste Sorting 垃圾分类
算法 //springCurve回弹 animateToImmediately({ duration:800, curve: curves.springCurve(0, 20, 90, 20), // 其他配置 }); 初始偏移量、振幅、周期和阻尼系数，通过这些参数可以控制动画的弹性效果
//Fisher-Yates洗牌 shuffleItems() { for (let i = this.garbageItems.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); let temp = this.garbageItems[i]; this.garbageItems[i] = this.garbageItems[j]; this.garbageItems[j] = temp; } } 代码 import { curves } from '@kit.ArkUI'; // 导入ArkUI工具包中的曲线模块 // 定义垃圾项目类 class GarbageItem { name: string; // 垃圾名称 type: number; // 垃圾类型 description?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://qfsyso.github.io/posts/"},{"@type":"ListItem","position":2,"name":"HarmonyOS Next Waste Sorting","item":"https://qfsyso.github.io/posts/harmonyos-next-waste-sorting/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"HarmonyOS Next Waste Sorting","name":"HarmonyOS Next Waste Sorting","description":"环境 DevEco Studio NEXT Beta1 Build Version: 5.0 API 13\nWaste Sorting 垃圾分类\n算法 //springCurve回弹 animateToImmediately({ duration:800, curve: curves.springCurve(0, 20, 90, 20), // 其他配置 }); 初始偏移量、振幅、周期和阻尼系数，通过这些参数可以控制动画的弹性效果\n//Fisher-Yates洗牌 shuffleItems() { for (let i = this.garbageItems.length - 1; i \u0026gt; 0; i--) { const j = Math.floor(Math.random() * (i + 1)); let temp = this.garbageItems[i]; this.garbageItems[i] = this.garbageItems[j]; this.garbageItems[j] = temp; } } 代码 import { curves } from \u0026#39;@kit.ArkUI\u0026#39;; // 导入ArkUI工具包中的曲线模块 // 定义垃圾项目类 class GarbageItem { name: string; // 垃圾名称 type: number; // 垃圾类型 description?","keywords":["HarmonyOS"],"articleBody":"环境 DevEco Studio NEXT Beta1 Build Version: 5.0 API 13\nWaste Sorting 垃圾分类\n算法 //springCurve回弹 animateToImmediately({ duration:800, curve: curves.springCurve(0, 20, 90, 20), // 其他配置 }); 初始偏移量、振幅、周期和阻尼系数，通过这些参数可以控制动画的弹性效果\n//Fisher-Yates洗牌 shuffleItems() { for (let i = this.garbageItems.length - 1; i \u003e 0; i--) { const j = Math.floor(Math.random() * (i + 1)); let temp = this.garbageItems[i]; this.garbageItems[i] = this.garbageItems[j]; this.garbageItems[j] = temp; } } 代码 import { curves } from '@kit.ArkUI'; // 导入ArkUI工具包中的曲线模块 // 定义垃圾项目类 class GarbageItem { name: string; // 垃圾名称 type: number; // 垃圾类型 description?: string; // 垃圾描述，可选 // 构造函数初始化垃圾项目 constructor(name: string, type: number, description?: string) { this.name = name; // 设置垃圾名称 this.type = type; // 设置垃圾类型 this.description = description || \"\"; // 设置垃圾描述，默认为空字符串 } } // 定义垃圾类别类 class GarbageCategory { name: string; // 类别名称 type: number; // 类别类型 color: string; // 类别颜色 description: string; // 类别描述 // 构造函数初始化垃圾类别 constructor(name: string, type: number, color: string, description: string) { this.name = name; // 设置类别名称 this.type = type; // 设置类别类型 this.color = color; // 设置类别颜色 this.description = description; // 设置类别描述 } } // 使用组件装饰器定义一个名为Index的应用入口 @Entry @Component struct Index { // 定义状态变量 @State currentQuestionIndex: number = 0; // 当前题目索引 @State quizResults: string[] = []; // 测验结果数组 @State totalScore: number = 0; // 总得分 @State showAnimation: boolean = false; // 是否显示动画 @State scaleOptions: ScaleOptions = { x: 1, y: 1 }; // 缩放选项 @State itemXPosition: number = 0; // 物品X轴位置 @State itemOpacity: number = 1.0; // 物品透明度 // 初始化垃圾类别数组 @State garbageCategories: GarbageCategory[] = [ new GarbageCategory(\"有害垃圾\", 0, \"#e2413f\", \"对人体健康或自然环境可能造成直接或潜在危害的生活垃圾\"), // 创建有害垃圾类别 new GarbageCategory(\"可回收物\", 1, \"#1c6bb5\", \"适宜回收和资源利用的物品\"), // 创建可回收物类别 new GarbageCategory(\"厨余垃圾\", 2, \"#4ca84e\", \"上海称湿垃圾，易腐烂的、含有机质的生活垃圾\"), // 创建厨余垃圾类别 new GarbageCategory(\"其他垃圾\", 3, \"#5f5f5f\", \"上海称干垃圾，不能归类于以上三类的生活垃圾\"), // 创建其他垃圾类别 ]; @State garbageItems: GarbageItem[] = [ new GarbageItem(\"菜帮菜叶\", 2), new GarbageItem(\"剩菜剩饭\", 2), new GarbageItem(\"过期食品\", 2), new GarbageItem(\"瓜果皮壳\", 2), new GarbageItem(\"鱼骨鱼刺\", 2), new GarbageItem(\"鸡蛋及蛋壳\", 2), new GarbageItem(\"残枝落叶\", 2), new GarbageItem(\"茶叶渣\", 2), new GarbageItem(\"酒瓶\", 1,), new GarbageItem(\"玻璃杯\", 1), new GarbageItem(\"调味瓶\", 1), new GarbageItem(\"图书\", 1), new GarbageItem(\"打印纸\", 1), new GarbageItem(\"信封\", 1), new GarbageItem(\"易拉罐\", 1), new GarbageItem(\"金属刀具\", 1), new GarbageItem(\"奶粉桶\", 1), new GarbageItem(\"衣服裤子\", 1), new GarbageItem(\"毛绒玩具\", 1), new GarbageItem(\"鞋\", 1), new GarbageItem(\"饮料瓶\", 1), new GarbageItem(\"塑料盆\", 1), new GarbageItem(\"食用油桶\", 1), new GarbageItem(\"洗衣机\", 1), new GarbageItem(\"电烤箱\", 1), new GarbageItem(\"电视机\", 1), new GarbageItem(\"充电电池\", 0), new GarbageItem(\"废含汞荧光灯管\", 0), new GarbageItem(\"过期药品及其包装物\", 0), new GarbageItem(\"油漆桶\", 0), new GarbageItem(\"血压计\", 0), new GarbageItem(\"废水银温度计\", 0), new GarbageItem(\"杀虫喷雾罐\", 0), new GarbageItem(\"废X光片等感光胶片\", 0), new GarbageItem(\"食品袋\", 3), new GarbageItem(\"大棒骨\", 3), new GarbageItem(\"创可贴\", 3), new GarbageItem(\"污损塑料袋\", 3), new GarbageItem(\"烟屁\", 3), new GarbageItem(\"陶瓷碎片\", 3), new GarbageItem(\"餐巾纸\", 3, \"厕纸、卫生纸遇水即溶，不算可回收的“纸张”，类似的还有烟盒等。\"), new GarbageItem(\"卫生纸\", 3, \"厕纸、卫生纸遇水即溶，不算可回收的“纸张”，类似的还有烟盒等。\"), ]; // 在组件即将出现时重置测验 aboutToAppear(): void { this.resetQuiz(); // 调用重置测验方法 } // 重置测验状态 resetQuiz() { this.quizResults = []; // 清空测验结果 this.totalScore = 0; // 清零总得分 this.currentQuestionIndex = 0; // 重置当前题目索引 this.shuffleItems(); // 打乱垃圾项目顺序 } // 打乱垃圾项目顺序 shuffleItems() { for (let i = this.garbageItems.length - 1; i \u003e 0; i--) { const j = Math.floor(Math.random() * (i + 1)); // 随机索引 let temp = this.garbageItems[i]; // 临时存储 this.garbageItems[i] = this.garbageItems[j]; // 交换位置 this.garbageItems[j] = temp; // 交换位置 } } // 检查用户选择的答案 checkAnswer(categoryType: number) { const currentItem = this.garbageItems[this.currentQuestionIndex]; // 获取当前垃圾项目 this.quizResults.push(`${currentItem.name}（${this.garbageCategories[categoryType].name}）【${currentItem.type === categoryType ? \"✔\" : this.garbageCategories[currentItem.type].name}】`); // 添加到测验结果中 if (currentItem.type === categoryType) { // 如果答案正确 this.totalScore += 10; // 加十分 } this.currentQuestionIndex++; // 进入下一个题目 if (this.currentQuestionIndex \u003e= 10) { // 如果完成了十个题目 this.displayResults(); // 显示结果 this.resetQuiz(); // 重置测验 } } // 显示测验结果 displayResults() { let sheets: SheetInfo[] = []; // 初始化结果页面列表 for (let i = 0; i \u003c this.quizResults.length; i++) { // 循环添加每一个结果 sheets.push({ title: this.quizResults[i], // 设置标题为测验结果 action: () =\u003e { // 不执行任何操作 } }); } this.getUIContext().showActionSheet({ // 显示结果页 title: '成绩单', // 标题 message: `总分数:${this.totalScore}`, // 分数信息 confirm: { // 确认按钮 defaultFocus: true, // 默认焦点 value: '我知道了', // 按钮文本 action: () =\u003e { // 点击后的动作 } }, onWillDismiss: () =\u003e { // 关闭前的动作 }, alignment: DialogAlignment.Center, // 对齐方式为中心 sheets: sheets // 结果页面列表 }); } // 构建用户界面 build() { Column() { // 创建列布局 Text(`垃圾分类测验:${this.currentQuestionIndex + 1}/10`) // 显示当前题目序号 .fontSize('30lpx') // 设置字体大小 .margin(20); // 设置外边距 Stack() { // 创建堆栈布局 Text(`${this.garbageItems[this.currentQuestionIndex].name}`) // 显示当前垃圾项目名称 .textAlign(TextAlign.Center) // 居中对齐 .width('130lpx') // 设置宽度 .height('130lpx') // 设置高度 .border({ width: 1 }) // 设置边框宽度 .borderRadius(5) // 设置圆角半径 .fontColor(Color.White) // 设置字体颜色 .backgroundColor(Color.Orange) // 设置背景颜色 .fontSize('20lpx') // 设置字体大小 .padding(2) // 设置内边距 .scale(this.scaleOptions); // 设置缩放比例 if (this.showAnimation) { // 如果显示动画 Particle({ // 创建粒子效果 particles: [ // 初始化粒子数组 { emitter: { // 粒子发射器配置 particle: { // 粒子类型配置 type: ParticleType.POINT, // 粒子类型为点 config: { // 配置 radius: 5 // 点的半径 }, count: 50, // 粒子数量 lifetime: -1, // 生命周期 lifetimeRange: -1 // 生命周期范围 }, emitRate: 100, // 发射速率 position: ['25%', 0], // 发射位置 size: ['100lpx', '100lpx'], // 发射器大小 shape: ParticleEmitterShape.RECTANGLE // 发射器形状为矩形 }, color: { // 粒子颜色配置 range: [Color.Orange, Color.Orange], // 颜色范围 updater: { // 更新器配置 type: ParticleUpdater.CURVE, // 变化方式为曲线变化 config: [ // 配置项 { from: Color.Orange, // 起始颜色 to: Color.Orange, // 终止颜色 startMillis: 0, // 开始时间 endMillis: -1, // 结束时间 curve: Curve.FastOutLinearIn // 曲线类型 } ] } }, scale: { // 粒子大小配置 range: [0.8, 1.2], // 大小范围 updater: { // 更新器配置 type: ParticleUpdater.CURVE, // 变化方式为曲线变化 config: [ // 配置项 { from: 1.0, // 起始大小 to: 1.0, // 终止大小 startMillis: 0, // 开始时间 endMillis: -1, // 结束时间 curve: Curve.EaseIn } ] } }, // 粒子加速度配置 acceleration: { speed: { range: [8000, 10000], // 向下减速，模拟重力 updater: { type: ParticleUpdater.RANDOM, // 加速度线性变化 config: [400, 500] } }, angle: { range: [90, 90] // 方向固定向下 } }, } ] }).width(\"100%\").height(\"100%\"); } } .width('150lpx') .height('300lpx') .align(Alignment.Top) .translate({x:`${this.itemXPosition}lpx`,y:0}); Row() { ForEach(this.garbageCategories, (category: GarbageCategory) =\u003e { Column() { Text(category.name) .fontColor(Color.White) .fontSize('30lpx') .padding(5); Divider(); Text(category.description) .fontColor(Color.White) .fontSize('28lpx') .padding(5); } .backgroundColor(category.color) .height('280lpx') .width(\"24%\") .border({ width: 1 }) .borderRadius(5) .margin({ left: 1, right: 1 }) .clickEffect({ scale: 0.8, level: ClickEffectLevel.MIDDLE }) .onClick(() =\u003e { if(this.showAnimation){ return } this.showAnimation = true let itemX:number = 0 if(category.type==0){ itemX = -270 }else if(category.type==1){ itemX = -90 }else if(category.type==2){ itemX = 90 }else if(category.type==3){ itemX = 270 } animateToImmediately({ duration:200, onFinish:()=\u003e{ animateToImmediately({ duration:800, curve: curves.springCurve(0, 20, 90, 20), onFinish:()=\u003e{ animateToImmediately({ duration:200, onFinish:()=\u003e{ this.itemXPosition = 0 this.checkAnswer(category.type); this.showAnimation = false } },()=\u003e{ this.itemXPosition = 0 this.scaleOptions = { x: 1.0, y: 1.0 }; }) } },()=\u003e{ this.scaleOptions = { x: 1.3, y: 1.3 }; }) } },()=\u003e{ this.itemXPosition = itemX }) }); }); } Button('重新开始').clickEffect({ level: ClickEffectLevel.LIGHT }).margin({ top: 50 }).onClick(() =\u003e { this.resetQuiz() }); }.width('100%'); } } catch cat 围住神经猫\n算法 1. 广度优先搜索（BFS）： 广度优先搜索（Breadth-First Search，简称 BFS）是一种用于图和树结构的遍历或搜索算法。它从一个起始节点开始，首先访问该节点的所有邻接节点，然后再以同样的方式逐层访问这些邻接节点的邻接节点，直到访问完整个图或者找到目标节点为止。BFS的特点是按照从近到远的顺序访问节点，因此它非常适合用来寻找最短路径问题，尤其是在所有边的权重相等的情况下。\nBFS的基本步骤如下： 初始化：选择一个起始节点，将其放入队列，并标记为已访问。 循环处理： 从队列中取出第一个节点。 检查该节点是否为目标节点；如果是，则结束搜索。 否则，将该节点的所有未访问过的邻接节点加入队列，并标记为已访问。 终止条件：当队列为空时，表示所有可到达的节点都已经被访问过，如果此时还没有找到目标节点，则说明目标节点不可达。\n在 findNeighbors 方法中，通过遍历当前单元格的邻居来获取周围非墙壁且可以移动的单元格集合。这类似于广度优先搜索的思想，逐层遍历邻居单元格。\nfindNeighbors(cell: Cell): Cell[] { let neighbors: Cell[] = []; // 检查当前单元格的六个方向邻居，将非墙壁且可以移动的单元格加入集合 // ... return neighbors; } 2. 启发式搜索： 在 selectNextMove 方法中，根据一定的启发式函数选择下一个移动位置，以确保小猫朝着离边界最近的方向移动。这种启发式搜索可以帮助小猫更智能地选择下一步的移动位置。\nselectNextMove(emptyNeighbors: Cell[]): Cell { // 根据启发式函数选择最优的移动位置 // ... return closestToEdge || emptyNeighbors[0]; } 3. 曼哈顿距离计算： 曼哈顿距离（Manhattan Distance），也称为城市街区距离（City Block distance）或出租车几何，是衡量在标准坐标系中两个点之间沿轴向距离的总和。简单来说，它是从一个点到另一个点，在只允许水平或垂直移动的情况下，必须经过的最小距离。这个概念得名于美国纽约市曼哈顿区的街道布局，因为那里的街道大多呈网格状分布，车辆只能沿着这些街道行驶，而不能斜穿。\n在 computeHeuristic 方法中，使用曼哈顿距离计算启发式函数的值，以评估当前单元格到边界的距离。曼哈顿距离是在网格上两点之间的距离，沿着网格的边缘移动。\ncomputeHeuristic(cell: Cell): number { // 计算曼哈顿距离作为启发式函数的值 // ... return minDistanceX + minDistanceY; } wood fish 电子木鱼\nanimateToImmediately\n// 观察者模式装饰器 @ObservedV2 class Cell { value: string = '功德+1'; // 默认显示的文字 @Trace // 跟踪属性变化 opacity: number = 0; // 文字透明度 @Trace // 跟踪属性变化 y: number = 0; // 文字的垂直偏移量 } // 主入口组件 @Entry @Component struct Index { @State list: Cell[] = []; // 存储所有 Cell 对象的数组 indexCount: number = 0; // 记录当前滚动的索引 count: number = 10; // 列表中 Cell 对象的数量 image: string = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQsAAADICAYAAAD/XsT8AAAAAXNSR0IArs4c6QAAEApJREFUeF7tnV921LgSh+093Hfg6S7iPgALmDUAKyFZyQwrubASYCWelMfqcXfabVkuSVXS1+eEhESWpV+Vv1Mq/fE48EGBgwpM0/R2GIYPy2Vvlu/yO/msv8vPvyKrl3KhrHz/vVx3+d04jrF1Rd6SYkcUGI8UpmxfCixQkAf+/QKBNSRqiLGGifz8YwHML0CS3xzAIr/GLu6wgOHT0liJGkLk4KL9q6jke4DIOI7yMx8lBYCFkpAeq1kBwiMcYiWXCASAxKr1oBywUBDRUxUrQHxe5Rc8deFsW8NQ5i+JQIg+4uUEFvFauS25AsST207kaziRR6S2wCJSKI/Fpmn6+jKW7zWCSDVZgMc3oo5rCYFFqksZvY4oQtUwAg6GK4ukwELVt+pVtkAiRBL1GtLunQM4JOLocr0HsHDu3NM0yUzGn50mK2tYr9thCrCo4W4K91wiCYGEt/UQCr03U4WA43kcRxmqNP8BFs5MzHDDpMHmIco4js8mW6fUKGChJGTuakhc5lZYpf6m8xrAQsVH8layTIGyRiKvzJq1NxlpAAtNF1Gui+SlsqDlqxNofGllvQawKO9Au3dkyLErkacCzUQZwMKY2y3RxP+NNYvmnFdANrNJlOF2jQawOO8EKjUwy6Eio/VKBBQfvQIDWBhwL6IJA0Yo1wS3wxJgUc5J7t5pmiZZWCWbvfj0o4BLYACLSg7KCsxKwtu67ZOnhVzAooLzMOyoILrdW8rKzy92m/dvy4BFYSuxwKqw4D5u5wIYwKKQMzHsKCS039t8H8fxo+XmA4sC1mHYUUDkNm4hrzR4Z7UrwCKzZQBFZoHbq94sMIBFRmcjP5FR3LarNgkMYJHJ6Vg/kUnYfqo1BwxgkcH5pmmSvR2cYJVB286qNDVLAiwUvY8ZD0UxqSooYAYYwELJKRdQ/FSqjmpQYK2ACWAACwWnBBQKIlLFngLVl4YDiz0T7fwdUJwUkMuPKFAVGMDiiKluygKKE+JxaaoC1YABLBJNxmKrROG4TEOBKsAAFgmmAxQJonGJpgJVXm4ELA6aEFAcFIziuRQofnI4sDhgSnIUB8SiaAkFigIDWESaFFBECkWx0goUOwQYWESYlpWZESJRpKYCRYABLCJMzF6PCJEoUluB7BvPgMWOiQFF7WeA+x9QICswgMUDSwCKA25KUSsKZNtHAiw2TAworPg+7UhQIAswgMUdS3DCVYJ7cok1BdRXeQKLGxOz6Mqaz9OeEwqoAgNYrCwBKE64JZdaVEB10RawWEzMoiuLvk6bFBRQW4MBLP6FBedmKngmVZhUQGVKFVgMw8DMh0kHp1G6CpzOX3QPC2Y+dD2S2swqcDp/0TUsSGiadWwalkeBU+9T7RYWS0JT8hRv89iFWlHAnAKnchc9w4KEpjlfpkEFFHg3jqMMSQ5/uoQFeYrDfsIFjSgwjmPyM598oVftyFN4tRzt1lAAWESqyMKrSKEo1qoCpzaYdRVZsJ6i1WeAfkUqACxihCJPEaMSZRpXIDm5Kbp0EVmQp2j8EaB7MQqciip6ggXTpDHuRJmWFTgVVXQBi2ma/hyG4XPLXkDfUOCBAqeXeYe6mx6GMPzgIepcAbXt6c1HFtM0/WQ5d+ePS5/dF0hIjuJZs/vNRhZMk2q6CXU5UGAGxDAM31KXc+/1sUlYMPzYMzt/b0CBAIdBO4LY0qZVWDD8aOBpoAtXCggc5Ot7zujhkebNwYLZDx6xhhQI0cOPcRwFElU/TcGC4UdVX+Lm5xUwBYfb7rQGCxZfnXdYaiingGk4NAsL9n6U83DulKyAKzg0CQuGH8nOy4V5FXANh1ZhwfAjr9NTe5wCTcGhOVgw/IjzYkplUaAoHJbDm+SAafl6s/Qo/H+rg+G8zR9LATm0N2lmxXWCk+FHlgeASrcVKAKHBQrSik9LUz68rK+QL61PWK/xfGS1p3dYsPhKy32o51aB9SKorOscFjjkAsMjyx7aQ+IWFiy+4ulWVqAIHBYwSJQgwwjtiCFVkqiDcVzCguFHqk9w3UqBy96KXMunjYJhywl2geEVFgw/eO6PKpBt41WBHMPRvqaWf/jyZHewYPYj1Q+6uy5LMvJOtLA3G+FJ+IenarmCBe/98OR3Rduqnm9YTVO+X6YqBQqaMxJFBTpws82XJ3uDBYuvDli94aJq+YaGhhCa5v54by2GG1hM0ySH7srhu3z6UkAtargTLUikIBEDn2sF7kYXnmAxYdEuFFhHDafWN6zWLwgQOOH9mPu8ii5cwII1Fces7Kh0WEko30+BQfq8goOV9QuOTPGqqa+mUs3DgjUVnv1tPgYuAEE6IvsTZG9C2K9wunOLf0gS8ul0ZVSwVkDs9G79Cw+wIKlp34lfQSF1s1JsV5cpdBlakHOIFe14uauhiGlYkNQ8bt0CV6gOHY60dzXMIIo4Ilx62atFWtZhwUrNdENrXFkNDOvGAwkNUybVcTUUMQsLVmomGffMRSbAACTOmFD/2pd3klwYYRkWTJXq2z7UGBKM8gar07MQ2s1cIomvTHdqK5tU3yVvYRIWTJUmGfXRReaihnuNXWY2ZOEdSUt1F0iu8JK3MAcLpkqTjXo17bW897LYq+3OtJqZjTPqZb/2sprTIiyYKj1u/yw7LI83I/4KkpbxWlUueUlymoIFUUW0W7iDQ+gZkIi2saWCc97CGiyIKu67iFs4AAlLz3xyW2zBggVYV4YMcPg9jqPMWLj9EEm4Nd264XOS00xkMU0TC7D+2Uchx7O7BoR4GZBoAhKhE3ZgQVQxb4L6prnBqparskailvJZ7zvPiJiILDqOKh4ekJrV/MqVAwllQW1VN8+IVIdFp1FFa5GELKTq4XxKW49wudaYgUVPy7rlHZNfGhpuAIlyD2zVO8kekaqRRUebxR4esV7VCw7enCXZBwVrp/h/asOih6iiibwEkGjnqU/syX+rwaKDqKKJaAJIJD5a7V1WFRYtRxXuowkg0d7TfrJH/6sSWTS8Bd19NAEkTj5S7V5eDRYtRhWbr33z4D9AwoOVqrbxj+KRRaNRxe7r6qua+cHNgYRVy5hrVxVYtBZVyLoJd3s5gIS5h9F6g8rCosGo4u4LZC1bHUhYto7ptn0pOgx5mS5tKapwBYpl7wYrLk0/j6YbVw4WjUUVbqZGgYTpB9BT44rCopmoovYy+RgPAxIxKlHmgAJlYNFYVGE6oclW8QPuT9EjChSDRTNRxctLeUzmKoDEEb+nbIIC+WHRWFQhGpvKV3B8XYLbc0mKAnlhsTiynK3Z0scELIBESy7loi/ZYSFTdZ9dSBHfyKrLuoFEvKEoqapAPlg0GlWI+levoVc1x4PKgEQppbnPhgJZYdFiVBF0LJrk7ODsD55Q+wrkWe7dwWsIi+QtgIT9J6ijFmaDReuvIcw6FOGt4h09gn66qg+Ljo72V1+cBST8PDkdtlT38JuGk5r3fEMtumAnaIePnr8uq8Oi9eHHrYlPHXoDJPw9MR23WA8WHSfjDic7l6Ha12EY3nbsfHTdlwI6p3t3MPuxZ9aog3rJSezJyN8NK3D+JUOd5Sn2bCnQkCP2fiwF5f/y+fTyj7zflA8KeFVABRa95Sm8Gpt2o0CyAqffdTpNE6BIlp8LUcCNAufeot5xQtONhWkoCigpMM/6JR3YS0JTyQRUgwI+FEiDBQlNH9allSigqMC8WvlwZEGeQtEEVIUCPhSYd1kfggWg8GFZWokCygq8G8fxVzQsSGgqy091KOBEgfDqiyhYkNB0YlWaiQL6Clz2P+3CAlDoq0+NKOBIgctRDA9hscx8yMIrNjw5si5NRQFFBeZ8hdS3BwtWaCqqTlUo4E2B9as6N2FBQtObWWkvCqgrcHVey11YkKdQF50KUcCjAldHR76CBSs0PdqUNqNAFgUu+Yq7OQsWXmURnUpRwJsCr46MvIosOjqZ25vhaC8KlFbg1en1t7CYSreI+6EACphU4GoIcjUMmaap5dcNmrQGjUIBowrcPbV+jiyY/TBqMpqFAnUUuPsCrQALooo6RuGuKGBOgfVCrHXjAizIVZgzGQ1CgSoKbL6Wc2QGpIpBuCkKmFRgK6qYE5wkNk3ajEahQA0FHr6OU2DBZrEaZuGeKGBPgVfTpVc5i2mafrIF3Z7VaBEKFFZg9yXfElkAi8JW4XYoYE2BR7mK0FaBBTMh1ixHe1CgrAKbMyAMQ8oagruhgGUF5lcTxjSQBGeMSpRBgXYVmN8JEtM9gcXXl4JPMYUpgwIo0JQCu0nN22EIsGjK/nQGBaIUiB5+rBOccnK3zIjwQQEU6EeB6OHHBRbyAwuz+vEQeooCL+uqDg0/bmHxeRgG2XnKBwVQoG0Fvo/j+DGli2HXKUORFPW4BgV8KXA4T3GV4Az/YfepL6vTWhRIUOBwnmILFhJdyFDkQ0IjuAQFUMC2AqdAIV27PbCX4Yhtg9M6FEhRIGo5917F914yRLJzTzX+jgJ+FHh62ST2rNHcrdcXslBLQ13qQIG6CiRNkW41mRcj1zUmd0eBXAqoguJVzuK21ewbyWVH6kWBrAqog2IXFlJgeVGyHL0nyU8+KIACthVQSWbe6+LmMGRdeAHGp5ffsTvVtqPQur4VOD09+ki+KFiEClbQkBmTvUjj13Kd7JUPP/8ehuH98nu5njUdfTs3vddRQJ4viSiizqVIveUhWNyJNgIw5HsAgiwpDT/vtmsBkEBDIAJAdhWjAApcKSDPmkQU0c9cqn7JsEi94d51CzykmABEhj5EH3ui8fdeFciSyNwS0xwsbhsKPHp9Duj3jgLZEpluYbEBDxmuSNTBsIVnqjcFig07boU1H1nsecIq58GQZU8s/u5dAbWl2ylCuIfFRtKVqCPFG7jGqgJFZjv2Ot8ULDaGLCRK97yAv1tVQCAhSUyVjWBnO9k0LO5EHWGKVtaJ8EEBywpUHXLcE6YbWGxEHSHPwfSs5cemr7aZGHIAiw2nu1kYRtTR18NppbdmIREE6jay2PKQBRwyJSsrSiXiIOqw8ji12Q6BxPM4jn9Z7x6w2LEQUYd1F3bbPjeQILJI8LHValJyHQn6ccmsgGz2ktWX2fdyaOtNZHFCUTbBnRCvr0vnKdBhGL55hASRRQZnBR4ZRPVdpal1EmelJLI4q+CD64FHRnHtVt1EFMHUaWUHAx6VDZDv9gEQP3IfQJOvC/s1E1nsa5StxAoeb5imzSZzroq7AMRaPGCRy5US6yX6SBSuzGXNDjFi5AMWMSpVLLNaJBYWinGGRzl7dBc9PJIWWJRzPLU73ZwextmlasrO58jKFGfTuYdUuYBFqnIGr9uIQiQS2TuJ3WBvsjdJwBBOngcOEXIDiwiRvBe5iUSkOyEa6QEkAoUABuk7YEh0aGCRKFxLl23ARLoYYGI9MglACN/l/TTySoqs79FoyQdi+gIsYlSiTHiNZVDiNiKRqd/1O2TWit0DzRZ8bvdLhIdf6lu/qGr+GRiUdcy/AeOQohjN6eIJAAAAAElFTkSuQmCC' // 初始化方法，在组件即将显示时被调用 aboutToAppear(): void { for (let i = 0; i \u003c this.count; i++) { this.list.push(new Cell()); // 初始化 Cell 数组 } } // 构建 UI 的方法 build() { Column() { // 创建一个垂直布局容器 Stack() { // 创建一个堆栈布局容器 ForEach(this.list, (item: Cell, _index: number) =\u003e { // 遍历 list 中的每一个 Cell Text(item.value)// 显示 Cell 中的文字 .fontColor(Color.White)// 设置文字颜色为白色 .fontSize('50lpx')// 设置文字大小 .translate({ x: 0, y: `${item.y}lpx` })// 设置文字的垂直偏移量 .opacity(item.opacity) // 设置文字的透明度 }) } .width('300lpx') // 设置堆栈布局容器的宽度 .height('300lpx') // 设置堆栈布局容器的高度 .align(Alignment.BottomEnd) // 设置对齐方式为底部右端 Image(this.image)// 显示图片 .width('300lpx')// 设置图片宽度 .height('300lpx')// 设置图片高度 .objectFit(ImageFit.Contain)// 图片适应容器 .clickEffect({ // 点击效果配置 scale: 0.5, // 缩放比例 level: ClickEffectLevel.LIGHT // 效果级别 }) .onClick(() =\u003e { // 点击图片时触发的回调 let index = this.indexCount % this.count; // 计算当前滚动的索引 this.indexCount++; // 更新索引计数器 animateToImmediately({ // 立即开始动画 duration: 0, // 动画持续时间为0毫秒 onFinish: () =\u003e { // 动画完成后的回调 animateToImmediately({ // 再次立即开始动画 duration: 1000, // 动画持续时间为1000毫秒 }, () =\u003e { this.list[index].y = -200 // 设置 Cell 的垂直偏移量 this.list[index].opacity = 0 // 设置 Cell 的透明度 }) } }, () =\u003e { this.list[index].y = 0 // 设置 Cell 的垂直偏移量 this.list[index].opacity = 1 // 设置 Cell 的透明度 }) }) } .height('100%') // 设置容器高度为100% .width('100%') // 设置容器宽度为100% .backgroundColor(Color.Black) // 设置背景颜色为黑色 } } Sokoban 推箱子\nimport { promptAction } from '@kit.ArkUI' // 导入ArkUI工具包中的提示操作模块 @ObservedV2 // 观察者模式装饰器 class Cell { // 定义游戏中的单元格类 @Trace // 跟踪装饰器，标记属性以被跟踪 type: number = 0; // 单元格类型，0：透明，1：墙，2：可移动区域 @Trace topLeft: number = 0; // 左上角圆角大小 @Trace topRight: number = 0; // 右上角圆角大小 @Trace bottomLeft: number = 0; // 左下角圆角大小 @Trace bottomRight: number = 0; // 右下角圆角大小 @Trace x: number = 0; // 单元格的X坐标偏移量 @Trace y: number = 0; // 单元格的Y坐标偏移量 constructor(cellType: number) { // 构造函数 this.type = cellType; // 初始化单元格类型 } } @ObservedV2 // 观察者模式装饰器 class MyPosition { // 定义位置类 @Trace // 跟踪装饰器，标记属性以被跟踪 x: number = 0; // X坐标 @Trace y: number = 0; // Y坐标 setPosition(x: number, y: number) { // 设置位置的方法 this.x = x; // 更新X坐标 this.y = y; // 更新Y坐标 } } @Entry // 入口装饰器 @Component // 组件装饰器 struct Sokoban { // 定义游戏主结构 cellWidth: number = 100; // 单元格宽度 @State grid: Cell[][] = [ // 游戏网格状态 [new Cell(0), new Cell(1), new Cell(1), new Cell(1), new Cell(1), new Cell(1)], [new Cell(1), new Cell(1), new Cell(2), new Cell(2), new Cell(2), new Cell(1)], [new Cell(1), new Cell(2), new Cell(2), new Cell(2), new Cell(1), new Cell(1)], [new Cell(1), new Cell(2), new Cell(2), new Cell(2), new Cell(2), new Cell(1)], [new Cell(1), new Cell(1), new Cell(2), new Cell(2), new Cell(2), new Cell(1)], [new Cell(0), new Cell(1), new Cell(1), new Cell(1), new Cell(1), new Cell(1)], ]; @State victoryPositions: MyPosition[] = [new MyPosition(), new MyPosition()]; // 胜利位置数组 @State cratePositions: MyPosition[] = [new MyPosition(), new MyPosition()]; // 箱子位置数组 playerPosition: MyPosition = new MyPosition(); // 玩家位置 @State screenStartX: number = 0; // 触摸开始时的屏幕X坐标 @State screenStartY: number = 0; // 触摸开始时的屏幕Y坐标 @State lastScreenX: number = 0; // 触摸结束时的屏幕X坐标 @State lastScreenY: number = 0; // 触摸结束时的屏幕Y坐标 @State startTime: number = 0; // 游戏开始时间 isAnimationRunning: boolean = false // 动画是否正在运行 aboutToAppear(): void { // 游戏加载前的准备工作 // 初始化某些单元格的圆角大小... this.grid[0][1].topLeft = 25; this.grid[0][5].topRight = 25; this.grid[1][0].topLeft = 25; this.grid[4][0].bottomLeft = 25; this.grid[5][1].bottomLeft = 25; this.grid[5][5].bottomRight = 25; this.grid[1][1].bottomRight = 10; this.grid[4][1].topRight = 10; this.grid[2][4].topLeft = 10; this.grid[2][4].bottomLeft = 10; this.initializeGame(); // 初始化游戏 } initializeGame() { // 初始化游戏状态 this.startTime = Date.now(); // 设置游戏开始时间为当前时间 // 设置胜利位置和箱子位置... this.startTime = Date.now(); // 设置游戏开始时间为当前时间 this.victoryPositions[0].setPosition(1, 3); this.victoryPositions[1].setPosition(1, 4); this.cratePositions[0].setPosition(2, 2); this.cratePositions[1].setPosition(2, 3); this.playerPosition.setPosition(1, 2); } isVictoryPositionVisible(x: number, y: number): boolean { // 判断位置是否为胜利位置 return this.victoryPositions.some(position =\u003e position.x === x \u0026\u0026 position.y === y); // 返回是否有胜利位置与给定位置匹配 } isCratePositionVisible(x: number, y: number): boolean { // 判断位置是否为箱子位置 return this.cratePositions.some(position =\u003e position.x === x \u0026\u0026 position.y === y); // 返回是否有箱子位置与给定位置匹配 } isPlayerPositionVisible(x: number, y: number): boolean { // 判断位置是否为玩家位置 return this.playerPosition.x === x \u0026\u0026 this.playerPosition.y === y; // 返回玩家位置是否与给定位置相同 } movePlayer(direction: string) { const directions: object = Object({ 'right': Object({ dx: 0, dy: 1}), 'left': Object({ dx:0 , dy:-1 }), 'down': Object({ dx: 1, dy: 0 }), 'up': Object({ dx: -1, dy: 0 }) }); const dx: number = directions[direction]['dx']; //{ dx, dy } const dy: number = directions[direction]['dy']; //{ dx, dy } const newX: number = this.playerPosition.x + dx; const newY: number = this.playerPosition.y + dy; const targetCell = this.grid[newX][newY]; // 检查新位置是否超出边界 if (!targetCell) { return; } // 如果新位置是墙，则不能移动 if (targetCell.type === 1) { return; } let crateIndex = -1; if (this.isCratePositionVisible(newX, newY)) { const crateBehindCell = this.grid[newX + dx][newY + dy]; if (!crateBehindCell || crateBehindCell.type !== 2) { return; } crateIndex = this.cratePositions.findIndex(crate =\u003e crate.x === newX \u0026\u0026 crate.y === newY); if (crateIndex === -1 || this.isCratePositionVisible(newX + dx, newY + dy)) { return; } } if (this.isAnimationRunning) { return } this.isAnimationRunning = true animateToImmediately({ duration: 150, onFinish: () =\u003e { animateToImmediately({ duration: 0, onFinish: () =\u003e { this.isAnimationRunning = false } }, () =\u003e { if (crateIndex !== -1) { this.grid[this.cratePositions[crateIndex].x][this.cratePositions[crateIndex].y].x = 0; this.grid[this.cratePositions[crateIndex].x][this.cratePositions[crateIndex].y].y = 0; this.cratePositions[crateIndex].x += dx; this.cratePositions[crateIndex].y += dy; } this.grid[this.playerPosition.x][this.playerPosition.y].x = 0 this.grid[this.playerPosition.x][this.playerPosition.y].y = 0 this.playerPosition.setPosition(newX, newY); // 检查是否获胜 const isAllCrateOnTarget = this.cratePositions.every(crate =\u003e { return this.victoryPositions.some(victory =\u003e crate.x === victory.x \u0026\u0026 crate.y === victory.y); }); if (isAllCrateOnTarget) { console.log(\"恭喜你，你赢了！\"); // 可以在这里添加胜利处理逻辑 promptAction.showDialog({ // 显示对话框 title: '游戏胜利！', // 对话框标题 message: '恭喜你，用时：' + ((Date.now() - this.startTime) / 1000).toFixed(3) + '秒', // 对话框消息 buttons: [{ text: '重新开始', color: '#ffa500' }] // 对话框按钮 }).then(() =\u003e { // 对话框关闭后执行 this.initializeGame(); // 重新开始游戏 }); } }) } }, () =\u003e { this.grid[this.playerPosition.x][this.playerPosition.y].x = dy * this.cellWidth; this.grid[this.playerPosition.x][this.playerPosition.y].y = dx * this.cellWidth; if (crateIndex !== -1) { this.grid[this.cratePositions[crateIndex].x][this.cratePositions[crateIndex].y].x = dy * this.cellWidth; this.grid[this.cratePositions[crateIndex].x][this.cratePositions[crateIndex].y].y = dx * this.cellWidth; } console.info(`dx:${dx},dy:${dy}`) }) } build() { Column({ space: 20 }) { //游戏区 Stack() { //非零区加瓷砖 Column() { ForEach(this.grid, (row: [], rowIndex: number) =\u003e { Row() { ForEach(row, (item: Cell, colIndex: number) =\u003e { Stack() { Text() .width(`${this.cellWidth}lpx`) .height(`${this.cellWidth}lpx`) .backgroundColor(item.type == 0 ? Color.Transparent : ((rowIndex + colIndex) % 2 == 0 ? \"#cfb381\" : \"#e1ca9f\")) .borderRadius({ topLeft: item.topLeft \u003e 10 ? item.topLeft : 0, topRight: item.topRight \u003e 10 ? item.topRight : 0, bottomLeft: item.bottomLeft \u003e 10 ? item.bottomLeft : 0, bottomRight: item.bottomRight \u003e 10 ? item.bottomRight : 0 }) //如果和是胜利坐标，显示叉号 Stack() { Text() .width(`${this.cellWidth / 2}lpx`) .height(`${this.cellWidth / 8}lpx`) .backgroundColor(Color.White) Text() .width(`${this.cellWidth / 8}lpx`) .height(`${this.cellWidth / 2}lpx`) .backgroundColor(Color.White) }.rotate({ angle: 45 }) .visibility(this.isVictoryPositionVisible(rowIndex, colIndex) ? Visibility.Visible : Visibility.None) } }) } }) } Column() { ForEach(this.grid, (row: [], rowIndex: number) =\u003e { Row() { ForEach(row, (item: Cell, colIndex: number) =\u003e { //是否显示箱子 Stack() { Text() .width(`${this.cellWidth}lpx`) .height(`${this.cellWidth}lpx`) .backgroundColor(item.type == 1 ? \"#412c0f\" : Color.Transparent) .borderRadius({ topLeft: item.topLeft, topRight: item.topRight, bottomLeft: item.bottomLeft, bottomRight: item.bottomRight }) Text('箱') .fontColor(Color.White) .textAlign(TextAlign.Center) .fontSize(`${this.cellWidth / 2}lpx`) .width(`${this.cellWidth - 5}lpx`) .height(`${this.cellWidth - 5}lpx`) .backgroundColor(\"#cb8321\")//#995d12 #cb8321 .borderRadius(10) .visibility(this.isCratePositionVisible(rowIndex, colIndex) ? Visibility.Visible : Visibility.None) Text('我') .fontColor(Color.White) .textAlign(TextAlign.Center) .fontSize(`${this.cellWidth / 2}lpx`) .width(`${this.cellWidth - 5}lpx`) .height(`${this.cellWidth - 5}lpx`) .backgroundColor(\"#007dfe\")//#995d12 #cb8321 .borderRadius(10) .visibility(this.isPlayerPositionVisible(rowIndex, colIndex) ? Visibility.Visible : Visibility.None) } .width(`${this.cellWidth}lpx`) .height(`${this.cellWidth}lpx`) .translate({ x: `${item.x}lpx`, y: `${item.y}lpx` }) }) } }) } } Button('重新开始').clickEffect({ level: ClickEffectLevel.MIDDLE }) .onClick(() =\u003e { this.initializeGame(); }); } .width('100%') .height('100%') .backgroundColor(\"#fdb300\") .padding({ top: 20 }) .onTouch((e) =\u003e { if (e.type === TouchType.Down \u0026\u0026 e.touches.length \u003e 0) { // 触摸开始，记录初始位置 this.screenStartX = e.touches[0].x; this.screenStartY = e.touches[0].y; } else if (e.type === TouchType.Up \u0026\u0026 e.changedTouches.length \u003e 0) { // 当手指抬起时，更新最后的位置 this.lastScreenX = e.changedTouches[0].x; this.lastScreenY = e.changedTouches[0].y; } }) .gesture( SwipeGesture({ direction: SwipeDirection.All })// 支持方向中 all可以是上下左右 .onAction((_event: GestureEvent) =\u003e { const swipeX = this.lastScreenX - this.screenStartX; const swipeY = this.lastScreenY - this.screenStartY; // 清除开始位置记录，准备下一次滑动判断 this.screenStartX = 0; this.screenStartY = 0; if (Math.abs(swipeX) \u003e Math.abs(swipeY)) { if (swipeX \u003e 0) { // 向右滑动 this.movePlayer('right'); } else { // 向左滑动 this.movePlayer('left'); } } else { if (swipeY \u003e 0) { // 向下滑动 this.movePlayer('down'); } else { // 向上滑动 this.movePlayer('up'); } } }) ) } } Memory Flip 记忆翻转\nimport { promptAction } from '@kit.ArkUI' // 导入用于显示对话框的模块 // 使用装饰器来观察数据变化 @ObservedV2 class GameCell { // 定义单元格类 @Trace value: string; // 单元格的值，即卡片上的图案 @Trace isVisible: boolean = false; // 控制卡片是否可见 isFrontVisible: boolean = false; // 控制卡片是否正面朝上 isMatched: boolean = false; // 标记卡片是否已被匹配 isAnimationRunning: boolean = false; // 动画是否正在运行 @Trace rotationAngle: number = 0; // 卡片的旋转角度 constructor(value: string) { // 构造函数，初始化单元格 this.value = value; // 设置单元格的值 } // 展示卡片正面的方法 revealFace(animationTime: number, callback?: () =\u003e void) { if (this.isAnimationRunning) { // 如果已经有动画在运行，则返回 return; } this.isAnimationRunning = true; // 设置动画状态为运行中 animateToImmediately({ // 开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 animateToImmediately({ // 再次开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 this.isFrontVisible = true; // 设置卡片为正面朝上 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } }, () =\u003e { // 动画开始时的回调 this.isVisible = true; // 设置卡片为可见 this.rotationAngle = 0; // 设置旋转角度为0 }); } }, () =\u003e { // 动画开始时的回调 this.isVisible = false; // 设置卡片为不可见 this.rotationAngle = 90; // 设置旋转角度为90度 }); } // 重置卡片状态的方法 reset() { this.isVisible = false; // 设置卡片为不可见 this.rotationAngle = 180; // 设置旋转角度为180度 this.isFrontVisible = false; // 设置卡片为背面朝上 this.isAnimationRunning = false; // 设置动画状态为停止 this.isMatched = false; // 设置卡片为未匹配 } // 隐藏卡片正面的方法 hideFace(animationTime: number, callback?: () =\u003e void) { if (this.isAnimationRunning) { // 如果已经有动画在运行，则返回 return; } this.isAnimationRunning = true; // 设置动画状态为运行中 animateToImmediately({ // 开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 animateToImmediately({ // 再次开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 this.isFrontVisible = false; // 设置卡片为背面朝上 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } }, () =\u003e { // 动画开始时的回调 this.isVisible = false; // 设置卡片为不可见 this.rotationAngle = 180; // 设置旋转角度为180度 }); } }, () =\u003e { // 动画开始时的回调 this.isVisible = true; // 设置卡片为可见 this.rotationAngle = 90; // 设置旋转角度为90度 }); } } // 定义组件入口 @Entry @Component struct MemoryGame { // 定义游戏组件 @State gameCells: GameCell[] = []; // 存储游戏中的所有单元格 @State cellSize: number = 150; // 单元格的大小 @State cellSpacing: number = 5; // 单元格之间的间距 @State transitionDuration: number = 150; // 过渡动画的持续时间 @State firstSelectedIndex: number | null = null; // 记录第一次选择的卡片索引 @State secondSelectedIndex: number | null = null; // 记录第二次选择的卡片索引 @State isGameOver: boolean = false; // 游戏是否结束 @State startTime: number = 0; // 游戏开始时间 aboutToAppear(): void { // 组件即将显示时触发 let cardValues: string[] = [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\"]; // 定义卡片的值 for (let value of cardValues) { // 遍历卡片值 this.gameCells.push(new GameCell(value)); // 添加到游戏单元格数组中 this.gameCells.push(new GameCell(value)); // 每个值添加两次以形成对 } this.shuffleCards(); // 洗牌 } // 洗牌方法 shuffleCards() { this.firstSelectedIndex = null; // 清除第一次选择索引 this.secondSelectedIndex = null; // 清除第二次选择索引 this.isGameOver = false; // 游戏未结束 this.startTime = Date.now(); // 设置游戏开始时间为当前时间 for (let i = 0; i \u003c 16; i++) { // 重置所有单元格状态 this.gameCells[i].reset(); } for (let i = this.gameCells.length - 1; i \u003e 0; i--) { // 洗牌算法 const randomIndex = Math.floor(Math.random() * (i + 1)); // 随机索引 let tempValue = this.gameCells[i].value; // 临时保存值 this.gameCells[i].value = this.gameCells[randomIndex].value; // 交换值 this.gameCells[randomIndex].value = tempValue; // 交换值 } } // 检查卡片是否匹配的方法 checkForMatch() { if (this.firstSelectedIndex !== null \u0026\u0026 this.secondSelectedIndex !== null) { // 确保两个索引都不为空 const firstCell = this.gameCells[this.firstSelectedIndex]; // 获取第一个选中的单元格 const secondCell = this.gameCells[this.secondSelectedIndex]; // 获取第二个选中的单元格 if (firstCell.value === secondCell.value) { // 如果两个单元格的值相同 firstCell.isMatched = true; // 标记为已匹配 secondCell.isMatched = true; // 标记为已匹配 this.firstSelectedIndex = null; // 清除第一次选择索引 this.secondSelectedIndex = null; // 清除第二次选择索引 if (this.gameCells.every(cell =\u003e cell.isMatched)) { // 如果所有单元格都已匹配 this.isGameOver = true; // 游戏结束 console.info(\"游戏结束\"); // 打印信息 promptAction.showDialog({ // 显示对话框 title: '游戏胜利！', // 对话框标题 message: '恭喜你，用时：' + ((Date.now() - this.startTime) / 1000).toFixed(3) + '秒', // 对话框消息 buttons: [{ text: '重新开始', color: '#ffa500' }] // 对话框按钮 }).then(() =\u003e { // 对话框关闭后执行 this.shuffleCards(); // 重新开始游戏 }); } } else { // 如果两个单元格的值不同 setTimeout(() =\u003e { // 延迟一段时间后 if (this.firstSelectedIndex !== null) { // 如果第一个索引不为空 this.gameCells[this.firstSelectedIndex].hideFace(this.transitionDuration, () =\u003e { // 隐藏卡片 this.firstSelectedIndex = null; // 清除第一次选择索引 }); } if (this.secondSelectedIndex !== null) { // 如果第二个索引不为空 this.gameCells[this.secondSelectedIndex].hideFace(this.transitionDuration, () =\u003e { // 隐藏卡片 this.secondSelectedIndex = null; // 清除第二次选择索引 }); } }, 400); // 延迟时间 } } } // 构建游戏界面的方法 build() { Column({ space: 20 }) { // 创建一个垂直布局 Flex({ wrap: FlexWrap.Wrap }) { // 创建一个可换行的弹性布局 ForEach(this.gameCells, (gameCell: GameCell, index: number) =\u003e { // 遍历游戏单元格 Text(`${gameCell.isVisible ? gameCell.value : ''}`) // 显示单元格的值或空字符串 .width(`${this.cellSize}lpx`) // 设置宽度 .height(`${this.cellSize}lpx`) // 设置高度 .margin(`${this.cellSpacing}lpx`) // 设置边距 .fontSize(`${this.cellSize / 2}lpx`) // 设置字体大小 .textAlign(TextAlign.Center) // 文本居中 .backgroundColor(gameCell.isVisible ? Color.Orange : Color.Gray) // 设置背景颜色 .fontColor(Color.White) // 设置字体颜色 .borderRadius(5) // 设置圆角 .rotate({ // 设置旋转 x: 0, y: 1, z: 0, angle: gameCell.rotationAngle, // 旋转角度 centerX: `${this.cellSize / 2}lpx`, // 中心点X坐标 centerY: `${this.cellSize / 2}lpx`, // 中心点Y坐标 }) .onClick(() =\u003e { // 单击事件处理 if (this.isGameOver) { // 如果游戏已结束 console.info(\"游戏已结束\"); // 打印信息 return; } if (gameCell.isMatched) { // 如果单元格已匹配 console.info(\"当前已标记\"); // 打印信息 return; } if (this.firstSelectedIndex == null) { // 如果没有第一次选择 this.firstSelectedIndex = index; // 设置第一次选择索引 if (!gameCell.isFrontVisible) { // 如果不是正面朝上 gameCell.revealFace(this.transitionDuration); // 展示正面 } } else if (this.firstSelectedIndex == index) { // 如果与第一次选择相同 console.info(\"和上一次点击的是一样的，不予处理\"); // 打印信息 } else if (this.secondSelectedIndex == null) { // 如果没有第二次选择 this.secondSelectedIndex = index; // 设置第二次选择索引 if (!gameCell.isFrontVisible) { // 如果不是正面朝上 gameCell.revealFace(this.transitionDuration, () =\u003e { // 展示正面 this.checkForMatch(); // 检查是否匹配 }); } } }); }); }.width(`${(this.cellSize + this.cellSpacing * 2) * 4}lpx`); // 设置宽度 Button('重新开始') // 创建“重新开始”按钮 .onClick(() =\u003e { // 按钮点击事件 this.shuffleCards(); // 重新开始游戏 }); }.height('100%').width('100%'); // 设置高度和宽度 } } 3cup ball 三杯猜球\n// 使用装饰器来追踪对象的变化 @ObservedV2 class Cup { // 使用装饰器来追踪属性的变化 @Trace positionX: number; // 杯子的X轴位置 @Trace positionY: number; // 杯子的Y轴位置 @Trace containsBall: boolean; // 杯子内是否有球 @Trace isRevealed: boolean; // 杯子是否打开 // 构造函数初始化杯子的状态 constructor(hasBall: boolean) { this.positionX = 0; this.positionY = 0; this.containsBall = hasBall; this.isRevealed = true; } } // 游戏入口组件 @Entry @Component struct ThreeCupGame { // 游戏状态变量 @State gameCups: Cup[] = [// 初始化三个杯子，其中一个有球 new Cup(true), new Cup(false), new Cup(false) ]; @State cupWidth: number = 200; // 杯子宽度 @State cupSpacing: number = 10; // 杯子之间的间距 @State animationDurationMs: number = 140; // 动画持续时间（毫秒） @State isGameAnimating: boolean = false; // 是否正在动画中 @State mixingCount: number = 5; // 每局游戏混合次数 @State currentMixingCount: number = 0; // 当前正在进行的混合次数计数 // 开始游戏的方法 startGame() { this.currentMixingCount--; // 减少混合次数 const cupPairs = [[0, 1], [0, 2], [1, 2]]; // 可能的杯子对组合 const selectedPair = cupPairs[Math.floor(Math.random() * cupPairs.length)]; // 随机选择一对 this.moveCups(selectedPair[0], selectedPair[1]); // 开始移动选定的两个杯子 } // 移动指定的两个杯子 moveCups(cupIndex1: number, cupIndex2: number) { const direction: number = Math.random() \u003c 0.5 ? -1 : 1; // 随机方向 const distanceFactor: number = Math.abs(cupIndex1 - cupIndex2); // 距离因子 const adjustedDistanceFactor: number = distanceFactor === 1 ? 2 : 1; // 根据距离调整因子 animateToImmediately({ delay: 0, duration: this.animationDurationMs }, () =\u003e { this.gameCups[cupIndex1].positionY = -direction * (this.cupWidth + this.cupSpacing * 2) / adjustedDistanceFactor }) animateToImmediately({ delay: this.animationDurationMs, duration: this.animationDurationMs }, () =\u003e { this.gameCups[cupIndex1].positionX = (this.cupWidth + this.cupSpacing * 2) * distanceFactor this.gameCups[cupIndex1].positionY = -direction * (this.cupWidth + this.cupSpacing * 2) / adjustedDistanceFactor }) animateToImmediately({ delay: this.animationDurationMs * 2, duration: this.animationDurationMs }, () =\u003e { this.gameCups[cupIndex1].positionX = (this.cupWidth + this.cupSpacing * 2) * distanceFactor this.gameCups[cupIndex1].positionY = 0 }) animateToImmediately({ delay: 0, duration: this.animationDurationMs }, () =\u003e { this.gameCups[cupIndex2].positionY = direction * (this.cupWidth + this.cupSpacing * 2) / adjustedDistanceFactor }) animateToImmediately({ delay: this.animationDurationMs, duration: this.animationDurationMs }, () =\u003e { this.gameCups[cupIndex2].positionX = -(this.cupWidth + this.cupSpacing * 2) * distanceFactor this.gameCups[cupIndex2].positionY = direction * (this.cupWidth + this.cupSpacing * 2) / adjustedDistanceFactor }) animateToImmediately({ delay: this.animationDurationMs * 2, duration: this.animationDurationMs, onFinish: () =\u003e { this.swapBalls(cupIndex1, cupIndex2) } }, () =\u003e { this.gameCups[cupIndex2].positionX = -(this.cupWidth + this.cupSpacing * 2) * distanceFactor this.gameCups[cupIndex2].positionY = 0 }) } // 重置杯子的位置 resetCupPosition(cupIndex: number) { this.gameCups[cupIndex].positionX = 0; this.gameCups[cupIndex].positionY = 0; } // 交换两个杯子内的球 swapBalls(cupIndex1: number, cupIndex2: number) { this.resetCupPosition(cupIndex1); this.resetCupPosition(cupIndex2); let temporaryBallStatus = this.gameCups[cupIndex1].containsBall; this.gameCups[cupIndex1].containsBall = this.gameCups[cupIndex2].containsBall; this.gameCups[cupIndex2].containsBall = temporaryBallStatus; if (this.currentMixingCount \u003c= 0) { this.isGameAnimating = false; } else { setTimeout(() =\u003e { this.startGame(); }, 10); } } // 构建游戏界面 build() { Column({ space: 20 }) { // 游戏标题 Text('猜小球游戏') .fontSize(24) .margin({ top: 20 }); // 动画速度控制器 Counter() { Text(`当前速度${this.animationDurationMs}毫秒`) .fontColor(Color.Black) .fontSize('26lpx'); }.width('400lpx').onInc(() =\u003e { this.animationDurationMs += 10; }).onDec(() =\u003e { this.animationDurationMs -= 10; this.animationDurationMs = this.animationDurationMs \u003c 10 ? 10 : this.animationDurationMs; }); // 混合次数控制器 Counter() { Text(`每局混合${this.mixingCount}次`) .fontColor(Color.Black) .fontSize('26lpx'); }.width('400lpx').onInc(() =\u003e { this.mixingCount += 1; }).onDec(() =\u003e { this.mixingCount -= 1; this.mixingCount = this.mixingCount \u003c 1 ? 1 : this.mixingCount }); // 杯子布局 Row() { ForEach(this.gameCups, (cup: Cup) =\u003e { Text(cup.isRevealed ? (cup.containsBall ? '小球' : '空') : '') .width(`${this.cupWidth}lpx`) .height(`${this.cupWidth}lpx`) .margin(`${this.cupSpacing}lpx`) .backgroundColor(Color.Orange) .fontSize(`${this.cupWidth / 4}lpx`) .textAlign(TextAlign.Center) .fontColor(Color.White) .borderRadius(5) .translate({ x: `${cup.positionX}lpx`, y: `${cup.positionY}lpx` }) .onClick(() =\u003e { if (!this.isGameAnimating) { cup.isRevealed = true; } }); }); }.justifyContent(FlexAlign.Center).width('100%').height('720lpx').backgroundColor(Color.Gray); // 开始游戏按钮 Button('开始游戏').onClick(() =\u003e { if (!this.isGameAnimating) { this.currentMixingCount = this.mixingCount; this.isGameAnimating = true; this.gameCups.forEach(cup =\u003e cup.isRevealed = false); this.startGame(); } }); }.width('100%').height('100%'); } } 2048 // 使用装饰器标记Cell类，可能表示该类具有可观测性 @ObservedV2 class Cell { // 使用Trace装饰器标记value属性，可能表示该属性的变化会被追踪 @Trace value: number; // 构造函数初始化单元格的值为0 constructor() { this.value = 0; } } // 使用Entry和Component装饰器标记Game2048结构体，可能表示这是程序的入口点，并且该结构体定义了一个组件 @Entry @Component // 定义Game2048结构体 struct Game2048 { // 使用State装饰器标记状态变量，可能表示这些变量是组件的状态 @State board: Cell[][] = []; // 游戏盘面 @State score: number = 0; // 分数 @State cellSize: number = 200; // 单元格大小 @State cellMargin: number = 5; // 单元格之间的边距 @State screenStartX: number = 0; // 触摸开始时的屏幕X坐标 @State screenStartY: number = 0; // 触摸开始时的屏幕Y坐标 @State lastScreenX: number = 0; // 触摸结束时的屏幕X坐标 @State lastScreenY: number = 0; // 触摸结束时的屏幕Y坐标 // 定义颜色数组 colors: string[] = [ '#CCCCCC', // 0 - 灰色 '#FFC107', // 2 - 黄色 '#FF9800', // 4 - 橙色 '#FF5722', // 8 - 深橙色 '#F44336', // 16 - 红色 '#9C27B0', // 32 - 紫色 '#3F51B5', // 64 - 蓝紫色 '#00BCD4', // 128 - 蓝色 '#009688', // 256 - 深青色 '#4CAF50', // 512 - 绿色 '#8BC34A', // 1024 - 浅绿色 '#CDDC39', // 2048 - 柠檬黄 '#FFEB3B', // 4096 - 淡黄色 '#795548', // 8192 - 棕色 '#607D8B', // 16384 - 深灰色 '#9E9E9E', // 32768 - 灰色 '#000000' // 以上 - 黑色 ]; // 游戏即将出现时执行的方法 aboutToAppear() { this.score = 0; // 重置分数 this.initBoard(); // 重新初始化游戏板 this.addRandomTiles(2); // 添加两个随机方块 } // 初始化游戏盘面 initBoard() { if (this.board.length == 0) { for (let i = 0; i \u003c 4; i++) { let cellArr: Cell[] = []; for (let j = 0; j \u003c 4; j++) { cellArr.push(new Cell()); // 创建新单元格 } this.board.push(cellArr); // 添加到盘面 } } else { for (let i = 0; i \u003c this.board.length; i++) { for (let j = 0; j \u003c this.board[i].length; j++) { this.board[i][j].value = 0; // 清空单元格 } } } } // 在盘面上添加指定数量的随机方块 addRandomTiles(count: number) { let emptyCells: object[] = []; for (let row = 0; row \u003c 4; row++) { for (let col = 0; col \u003c 4; col++) { if (this.board[row][col].value === 0) { emptyCells.push(Object({ row: row, col: col })); // 记录空单元格位置 } } } for (let i = 0; i \u003c count; i++) { if (emptyCells.length \u003e 0) { let randomIndex = Math.floor(Math.random() * emptyCells.length); let obj = emptyCells[randomIndex]; this.board[obj['row']][obj['col']].value = Math.random() \u003c 0.9 ? 2 : 4; // 随机生成2或4 emptyCells.splice(randomIndex, 1); // 移除已使用的空单元格位置 } } } // 向左滑动 slideLeft() { for (let row = 0; row \u003c 4; row++) { let tempRow: number[] = []; // 临时存储行数据 let merged: boolean[] = new Array(4).fill(false); // 标记是否已经合并过 for (let col = 0; col \u003c 4; col++) { if (this.board[row][col].value !== 0) { tempRow.push(this.board[row][col].value); // 移动非零值 } } let mergePos = 0; while (mergePos \u003c tempRow.length - 1) { if (tempRow[mergePos] === tempRow[mergePos + 1] \u0026\u0026 !merged[mergePos]) { tempRow[mergePos] *= 2; // 合并 this.score += tempRow[mergePos]; // 更新分数 merged[mergePos] = true; // 标记已合并 tempRow.splice(mergePos + 1, 1); // 移除合并过的值 } else { mergePos++; } } while (tempRow.length \u003c 4) { tempRow.push(0); // 填充空位 } for (let col = 0; col \u003c 4; col++) { this.board[row][col].value = tempRow[col]; // 更新盘面 } } } // 向右滑动 slideRight() { for (let row = 0; row \u003c 4; row++) { let tempRow: number[] = []; // 临时存储行数据 let merged: boolean[] = new Array(4).fill(false); // 标记是否已经合并过 for (let col = 3; col \u003e= 0; col--) { if (this.board[row][col].value !== 0) { tempRow.unshift(this.board[row][col].value); // 移动非零值 } } let mergePos = tempRow.length - 1; while (mergePos \u003e 0) { if (tempRow[mergePos] === tempRow[mergePos - 1] \u0026\u0026 !merged[mergePos - 1]) { tempRow[mergePos] *= 2; // 合并 this.score += tempRow[mergePos]; // 更新分数 merged[mergePos - 1] = true; // 标记已合并 tempRow.splice(mergePos - 1, 1); // 移除合并过的值 } else { mergePos--; } } while (tempRow.length \u003c 4) { tempRow.unshift(0); // 填充空位 } for (let col = 0; col \u003c 4; col++) { this.board[row][col].value = tempRow[col]; // 更新盘面 } } } // 向上滑动 slideUp() { for (let col = 0; col \u003c 4; col++) { let tempCol: number[] = []; // 临时存储列数据 let merged: boolean[] = new Array(4).fill(false); // 标记是否已经合并过 for (let row = 0; row \u003c 4; row++) { if (this.board[row][col].value !== 0) { tempCol.push(this.board[row][col].value); // 移动非零值 } } let mergePos = 0; while (mergePos \u003c tempCol.length - 1) { if (tempCol[mergePos] === tempCol[mergePos + 1] \u0026\u0026 !merged[mergePos]) { tempCol[mergePos] *= 2; // 合并 this.score += tempCol[mergePos]; // 更新分数 merged[mergePos] = true; // 标记已合并 tempCol.splice(mergePos + 1, 1); // 移除合并过的值 } else { mergePos++; } } while (tempCol.length \u003c 4) { tempCol.push(0); // 填充空位 } for (let newRow = 0; newRow \u003c 4; newRow++) { this.board[newRow][col].value = tempCol[newRow]; // 更新盘面 } } } // 向下滑动 slideDown() { for (let col = 0; col \u003c 4; col++) { let tempCol: number[] = []; // 临时存储列数据 let merged: boolean[] = new Array(4).fill(false); // 标记是否已经合并过 // 从下往上遍历列 for (let row = 3; row \u003e= 0; row--) { if (this.board[row][col].value !== 0) { tempCol.unshift(this.board[row][col].value); // 移动非零值 } } let mergePos = tempCol.length - 1; while (mergePos \u003e 0) { if (tempCol[mergePos] === tempCol[mergePos - 1] \u0026\u0026 !merged[mergePos - 1]) { tempCol[mergePos] *= 2; // 合并 this.score += tempCol[mergePos]; // 更新分数 merged[mergePos - 1] = true; // 标记已合并 tempCol.splice(mergePos - 1, 1); // 移除合并过的值 } else { mergePos--; } } // 如果数组长度小于4，用0填充 while (tempCol.length \u003c 4) { tempCol.unshift(0); // 填充空位 } // 将处理后的数组元素放回到棋盘的对应列中 for (let row = 0; row \u003c 4; row++) { this.board[3 - row][col].value = tempCol[3 - row]; // 注意反转顺序 } } } // 构建游戏界面 build() { // 布局容器 Column({ space: 10 }) { // 显示得分 Text(`得分: ${this.score}`) .fontSize(24) .margin({ top: 20 }) // 底层背景布局 Flex({ wrap: FlexWrap.Wrap, direction: FlexDirection.Row }) { // 遍历每个单元格 ForEach(this.board.flat(), (cell: Cell, index: number) =\u003e { // 显示单元格上的数字 Text(`${cell.value || ''}`) .width(`${this.cellSize}px`) .height(`${this.cellSize}px`) .margin(`${this.cellMargin}px`) .fontSize(`${cell.value \u003e= 100 ? this.cellSize / 3 : this.cellSize / 2}px`) // 根据数字大小调整字体大小 .textAlign(TextAlign.Center) .backgroundColor(this.colors[cell.value == 0?0:Math.floor(Math.log2(cell.value))]) // 设置背景颜色 .fontColor(cell.value === 0 ? '#000' : '#fff') // 设置字体颜色 .borderRadius(5) // 圆角 }) } .width(`${(this.cellSize + this.cellMargin * 2) * 4}px`) // 设置容器宽度 // 重新开始按钮 Button('重新开始').onClick(() =\u003e { this.aboutToAppear(); // 重新开始游戏 }) } .width('100%') .height('100%') .onTouch((e) =\u003e { if (e.type === TouchType.Down \u0026\u0026 e.touches.length \u003e 0) { // 触摸开始，记录初始位置 this.screenStartX = e.touches[0].x; this.screenStartY = e.touches[0].y; } else if (e.type === TouchType.Up \u0026\u0026 e.changedTouches.length \u003e 0) { // 当手指抬起时，更新最后的位置 this.lastScreenX = e.changedTouches[0].x; this.lastScreenY = e.changedTouches[0].y; } }) .gesture( SwipeGesture({ direction: SwipeDirection.All }) // 支持方向中 all可以是上下左右 .onAction((_event: GestureEvent) =\u003e { const swipeX = this.lastScreenX - this.screenStartX; const swipeY = this.lastScreenY - this.screenStartY; // 清除开始位置记录，准备下一次滑动判断 this.screenStartX = 0; this.screenStartY = 0; if (Math.abs(swipeX) \u003e Math.abs(swipeY)) { if (swipeX \u003e 0) { this.slideRight(); // 向右滑动 } else { this.slideLeft(); // 向左滑动 } } else { if (swipeY \u003e 0) { this.slideDown(); // 向下滑动 } else { this.slideUp(); // 向上滑动 } } this.addRandomTiles(1); // 添加一个随机方块 }) ) } } X✔ import { promptAction } from '@kit.ArkUI'; const winningLines = [ [0, 0, 0, 1, 0, 2], // Horizontal 1 [1, 0, 1, 1, 1, 2], // Horizontal 2 [2, 0, 2, 1, 2, 2], // Horizontal 3 [0, 0, 1, 0, 2, 0], // Vertical 1 [0, 1, 1, 1, 2, 1], // Vertical 2 [0, 2, 1, 2, 2, 2], // Vertical 3 [0, 0, 1, 1, 2, 2], // Diagonal \\ [0, 2, 1, 1, 2, 0]// Diagonal / ]; @ObservedV2 class GridCell { @Trace value: string = \"\"; // 当前格子的值 rowIndex: number = 0; // 格子所在的行号 colIndex: number = 0; // 格子所在的列号 constructor(rowIndex: number, colIndex: number) { this.rowIndex = rowIndex; this.colIndex = colIndex; } } @Entry @Component struct TicTacToe { @State board: GridCell[][] = []; // 游戏板 @State currentPlayer: string = 'X'; // 当前玩家 @State isGameOver: boolean = false; // 游戏是否结束 @State winner: string = ''; // 获胜者 @State cellSize: number = 120; // 单元格大小 @State cellMargin: number = 5; // 单元格边距 // 组件即将出现时初始化游戏 aboutToAppear(): void { this.board = [ [new GridCell(0, 0), new GridCell(0, 1), new GridCell(0, 2)], [new GridCell(1, 0), new GridCell(1, 1), new GridCell(1, 2)], [new GridCell(2, 0), new GridCell(2, 1), new GridCell(2, 2)] ]; this.initGame(); // 初始化游戏状态 } // 重置游戏状态 initGame() { for (let i = 0; i \u003c 3; i++) { for (let j = 0; j \u003c 3; j++) { this.board[i][j].value = ''; // 清空所有单元格 } } this.currentPlayer = 'X'; // 设置当前玩家为X this.isGameOver = false; // 游戏未结束 this.winner = ''; // 无获胜者 } // 检查是否有玩家获胜 checkForWinner() { for (let line of winningLines) { // 遍历所有胜利线路 const mark = this.board[line[0]][line[1]].value; if (mark \u0026\u0026 // 如果有标记 mark === this.board[line[2]][line[3]].value \u0026\u0026 // 并且等于同一行的下一个标记 mark === this.board[line[4]][line[5]].value) { // 再次等于同一行的下一个标记 this.isGameOver = true; // 游戏结束 this.winner = mark; // 设置获胜者 return mark; // 返回获胜者的标记 } } const allCellsFilled = this.board.flat().every(cell =\u003e cell.value !== ''); // 检查所有单元格是否已填满 if (allCellsFilled) { this.isGameOver = true; // 游戏结束 this.winner = '平局'; // 设置为平局 return '平局'; // 返回平局标识 } return ''; // 无获胜者 } // 玩家落子 placeMark(rowIndex: number, colIndex: number) { if (!this.isGameOver \u0026\u0026 this.board[rowIndex][colIndex].value === '') { // 如果游戏未结束且单元格为空 this.board[rowIndex][colIndex].value = this.currentPlayer; // 放置标记 const result = this.checkForWinner(); // 检查是否有获胜者 if (result) { // 如果有获胜者 console.info(`${result} 获胜！`); let message = `${result} 获胜！`; // 设置提示信息 if (result === '平局') { message = '平局！'; // 如果是平局 } promptAction.showDialog({ // 显示对话框 title: `游戏结束`, // 标题 message, // 提示信息 buttons: [ // 按钮 { text: '重新开始', // 文本 color: '#ffa500' // 颜色 } ], }).then(() =\u003e { this.initGame(); // 重新开始游戏 }); } else { // 如果没有获胜者 this.currentPlayer = this.currentPlayer === 'X' ? 'O' : 'X'; // 切换玩家 if (this.currentPlayer === 'O') { // 如果是AI玩家 this.aiMove(); // AI落子 } } } } // AI落子 aiMove() { let moveFound = false; let bestMove: null | number[] = null; // 寻找最佳落子位置 bestMove = this.findWinningMove('O'); // 检查AI是否有胜利机会 console.info(`bestMove a:${JSON.stringify(bestMove)}`); if (bestMove) { moveFound = true; } else { bestMove = this.findWinningMove('X'); // 检查玩家是否有胜利机会 console.info(`bestMove b:${JSON.stringify(bestMove)}`); if (bestMove) { moveFound = true; } else { bestMove = this.findRandomMove(); // 随机落子 console.info(`bestMove c:${JSON.stringify(bestMove)}`); if (bestMove) { moveFound = true; } } } if (moveFound \u0026\u0026 bestMove) { // 如果找到了合适的落子位置 console.info(`bestMove:${JSON.stringify(bestMove)}`); this.placeMark(bestMove[0], bestMove[1]); // 落子 } } // 寻找给定玩家是否有机会赢，并返回这样的移动位置 findWinningMove(player: string) { for (let line of winningLines) { // 遍历所有胜利线路 let missingIndex = -1; let noEmptyCount = 0; for (let i = 0; i \u003c line.length; i += 2) { // 检查每个单元格 if (this.board[line[i]][line[i + 1]].value === player) { // 如果是该玩家的标记 noEmptyCount++; // 计数 } else if (this.board[line[i]][line[i + 1]].value === '') { // 如果为空 missingIndex = i; // 记录空格位置 } } if (noEmptyCount === 2 \u0026\u0026 missingIndex != -1) { // 如果有两个标记且有一个空格 return [line[missingIndex], line[missingIndex + 1]]; // 返回空格位置 } } return null; // 未找到合适位置 } // 寻找一个随机的合法落子位置 findRandomMove() { let emptyCells: number[][] = []; // 存储空格位置 for (let i = 0; i \u003c 3; i++) { for (let j = 0; j \u003c 3; j++) { if (this.board[i][j].value === '') { // 如果单元格为空 emptyCells.push([i, j]); // 添加到空格列表 } } } if (emptyCells.length \u003e 0) { // 如果有空格 return emptyCells[Math.floor(Math.random() * emptyCells.length)]; // 随机选择一个空格 } return null; // 未找到空格 } // 构建游戏界面 build() { Column({ space: 20 }) { // 创建主列布局 Flex({ wrap: FlexWrap.Wrap }) { // 创建主行布局 ForEach(this.board, (row: GridCell[], _index: number) =\u003e { // 遍历每一行 ForEach(row, (cell: GridCell, _index: number) =\u003e { // 遍历每一个单元格 Text(cell.value) // 显示单元格内的文本 .width(`${this.cellSize}lpx`) // 设置宽度 .height(`${this.cellSize}lpx`) // 设置高度 .margin(`${this.cellMargin}lpx`) // 设置边距 .fontSize(`${this.cellSize / 2}lpx`) // 设置字体大小 .textAlign(TextAlign.Center) // 居中文本 .backgroundColor(cell.value === 'X' ? Color.Red : // 设置背景颜色 cell.value === 'O' ? Color.Blue : Color.Gray) .fontColor(Color.White) // 设置字体颜色 .borderRadius(5) // 设置圆角 .onClick(() =\u003e { // 点击事件 this.placeMark(cell.rowIndex, cell.colIndex); // 落子 }); }) }) } .width(`${(this.cellSize + this.cellMargin * 2) * 3}lpx`) // 设置宽度 Button('重新开始') // 重新开始按钮 .width('50%') // 设置宽度 .height('10%') // 设置高度 .onClick(() =\u003e { // 点击事件 this.initGame(); // 重新开始游戏 }); } .width('100%') // 设置宽度 .height('100%'); // 设置高度 } } mine 扫雷\n实现步骤\n步骤1：定义游戏状态\n首先，我们需要定义游戏的状态变量，包括游戏面板数据、地雷数量、已揭示方块集合、标记为地雷的方块集合等。\n步骤2：初始化游戏\n在组件即将显示时初始化游戏，包括清空状态变量、生成游戏面板、放置地雷等。\n步骤3：生成游戏面板与放置地雷\n游戏面板由10x10的方块组成，随机放置10个地雷，并计算每个方块周围的地雷数量。\n步骤4：处理用户交互\n用户可以通过点击方块来揭示其内容，也可以通过长按来标记地雷。\n步骤5：显示游戏结果\n当玩家揭示到地雷时，游戏结束；当所有非雷方块都被揭示时，游戏胜利。\n步骤6：定义Cell类\n最后，定义一个Cell类来存储每个方块的信息。\nimport { promptAction } from '@kit.ArkUI'; @Entry @Component struct MineSweeper { // 游戏面板数据 @State private gameBoard: Cell[][] = []; // 地雷总数 @State private mineCount: number = 10; // 已经揭示的方块集合 @State private revealedCells: Set\u003cstring\u003e = new Set(); // 标记为地雷的方块集合 @State private flaggedCells: Set\u003cstring\u003e = new Set(); // 方块大小 @State private cellSize: number = 60; // 方块之间的边距 @State private cellMargin: number = 2; // 游戏开始时间 private startTime: number = Date.now(); // 游戏结束标志 @State private isGameOver: boolean = false; // 在组件即将显示时初始化游戏 aboutToAppear(): void { this.initializeGame(); } // 初始化游戏 private initializeGame() { this.isGameOver = false; this.startTime = Date.now(); this.revealedCells.clear(); this.flaggedCells.clear(); this.generateBoard(); } // 生成游戏面板 private generateBoard() { this.gameBoard = []; for (let i = 0; i \u003c 10; i++) { this.gameBoard.push([]); for (let j = 0; j \u003c 10; j++) { this.gameBoard[i].push(new Cell(i, j)); } } this.placeMines(); this.calculateNumbers(); } // 随机放置地雷 private placeMines() { let placed = 0; while (placed \u003c this.mineCount) { let x = Math.floor(Math.random() * 10); let y = Math.floor(Math.random() * 10); if (!this.gameBoard[x][y].hasMine) { this.gameBoard[x][y].hasMine = true; placed++; } } } // 计算每个方块周围的地雷数量 private calculateNumbers() { for (let i = 0; i \u003c 10; i++) { for (let j = 0; j \u003c 10; j++) { if (!this.gameBoard[i][j].hasMine) { this.gameBoard[i][j].neighborMines = this.countNeighborMines(i, j); this.gameBoard[i][j].value = this.gameBoard[i][j].neighborMines.toString(); } else { this.gameBoard[i][j].value = '雷'; } } } } // 计算给定坐标周围地雷的数量 private countNeighborMines(row: number, col: number): number { let count = 0; for (let dx = -1; dx \u003c= 1; dx++) { for (let dy = -1; dy \u003c= 1; dy++) { if (dx === 0 \u0026\u0026 dy === 0) { continue; } let newRow = row + dx, newCol = col + dy; if (newRow \u003e= 0 \u0026\u0026 newRow \u003c 10 \u0026\u0026 newCol \u003e= 0 \u0026\u0026 newCol \u003c 10 \u0026\u0026 this.gameBoard[newRow][newCol].hasMine) { count++; } } } return count; } // 揭示方块 private revealCell(row: number, col: number) { if (this.isGameOver || this.revealedCells.has(`${row},${col}`)) { return; } const key = `${row},${col}`; this.revealedCells.add(key); if (this.gameBoard[row][col].hasMine) { this.showGameOverDialog(); } else { if (this.gameBoard[row][col].neighborMines === 0) { for (let dx = -1; dx \u003c= 1; dx++) { for (let dy = -1; dy \u003c= 1; dy++) { if (dx === 0 \u0026\u0026 dy === 0) { continue; } let newRow = row + dx, newCol = col + dy; if (newRow \u003e= 0 \u0026\u0026 newRow \u003c 10 \u0026\u0026 newCol \u003e= 0 \u0026\u0026 newCol \u003c 10) { this.revealCell(newRow, newCol); } } } } } if (this.isVictory()) { this.showVictoryDialog(); } } // 显示游戏结束对话框 private showGameOverDialog() { this.isGameOver = true; promptAction.showDialog({ title: '游戏结束: 游戏失败！', buttons: [{ text: '重新开始', color: '#ffa500' }] }).then(() =\u003e { this.initializeGame(); }); } // 显示胜利对话框 private showVictoryDialog() { this.isGameOver = true; promptAction.showDialog({ title: '恭喜你，游戏胜利！', message: `用时：${((Date.now() - this.startTime) / 1000).toFixed(3)}秒`, buttons: [{ text: '重新开始', color: '#ffa500' }] }).then(() =\u003e { this.initializeGame(); }); } // 判断游戏是否胜利 private isVictory() { let revealedNonMineCount = 0; for (let i = 0; i \u003c this.gameBoard.length; i++) { for (let j = 0; j \u003c this.gameBoard[i].length; j++) { if (this.revealedCells.has(`${i},${j}`)) { revealedNonMineCount++; } } } return revealedNonMineCount == 90; } // 决定是否显示方块值 private isShowValue(cell: Cell): string { if (this.isGameOver) { return cell.value === '0' ? '' : cell.value; } else { if (this.revealedCells.has(`${cell.row},${cell.column}`)) { return cell.value === '0' ? '' : cell.value; } else { return ''; } } } build() { Column({ space: 10 }) { // 重置游戏按钮 Button('重新开始').onClick(() =\u003e this.initializeGame()); // 创建游戏面板容器 Flex({ wrap: FlexWrap.Wrap }) { // 遍历每一行 ForEach(this.gameBoard, (row: Cell[], rowIndex: number) =\u003e { // 遍历每一列 ForEach(row, (cell: Cell, colIndex: number) =\u003e { Stack() { // 显示方块上的数字或雷 Text(this.isShowValue(cell)) .width(`${this.cellSize}lpx`) .height(`${this.cellSize}lpx`) .margin(`${this.cellMargin}lpx`) .fontSize(`${this.cellSize / 2}lpx`) .textAlign(TextAlign.Center) .backgroundColor(this.revealedCells.has(`${rowIndex},${colIndex}`) ? (this.isShowValue(cell) === '雷' ? Color.Red : Color.White) : Color.Gray) .fontColor(!this.revealedCells.has(`${rowIndex},${colIndex}`) || this.isShowValue(cell) === '雷' ? Color.White : Color.Black) .borderRadius(5) .parallelGesture(GestureGroup(GestureMode.Exclusive, TapGesture({ count: 1, fingers: 1 }) .onAction(() =\u003e this.revealCell(rowIndex, colIndex)), LongPressGesture({ repeat: true }) .onAction(() =\u003e cell.isFlag = true) )); // 显示标记旗帜 Text(`${!this.revealedCells.has(`${rowIndex},${colIndex}`) ? '旗' : ''}`) .width(`${this.cellSize}lpx`) .height(`${this.cellSize}lpx`) .margin(`${this.cellMargin}lpx`) .fontSize(`${this.cellSize / 2}lpx`) .textAlign(TextAlign.Center) .fontColor(Color.White) .visibility(cell.isFlag \u0026\u0026 !this.isGameOver ? Visibility.Visible : Visibility.None) .onClick(() =\u003e { cell.isFlag = false; }) } }); }); } .width(`${(this.cellSize + this.cellMargin * 2) * 10}lpx`); } .backgroundColor(Color.Orange) .width('100%') .height('100%'); } } // 方块类 @ObservedV2 class Cell { // 方块所在的行 row: number; // 方块所在的列 column: number; // 是否有地雷 hasMine: boolean = false; // 周围地雷数量 neighborMines: number = 0; // 是否被标记为地雷 @Trace isFlag: boolean = false; // 方块值 @Trace value: string; // 构造函数 constructor(row: number, column: number) { this.row = row; this.column = column; this.value = ''; } } Schrulte Grid 舒尔特方格（Schrulte Grid），也被称为舒尔特表或舒尔特图表，是一种用于训练注意力、视觉搜索速度和广度的简单而有效的工具。它通常由一个5x5的方格组成，每个小格子里随机填写了1到25的数字。训练者需要尽快地按照数字顺序找出这些数字，并用手指指出或说出它们的位置。\n这种练习可以帮助提高眼睛的移动速度、扩大视野范围、增强大脑的反应速度和专注力，因此常被用来作为儿童和成人的注意力训练方法之一。此外，它也被一些专业领域（如飞行员、运动员等）用来提升快速信息处理能力和决策效率。\n进行舒尔特方格训练时，建议：\n保持正确的姿势，确保光线充足。 眼睛与纸面保持适当距离，一般为30-40厘米。 尽量不要用手指直接指着数字，以锻炼眼睛的移动能力。 随着熟练程度的提高，可以尝试更复杂或更大的方格，比如6x6或7x7。 定期练习，但也要注意休息，避免过度疲劳。 舒尔特方格不仅是一个简单的游戏，也是一个实用的认知训练工具，对于改善注意力集中度和个人效率有着积极的作用。\nimport { promptAction } from '@kit.ArkUI'; @Entry @Component struct Index { @State numbers: number[] = []; @State currentIndex: number = 0; //用于判断用户点击是否正确 @State timeStart: number = 0; @State widthItem: number = 120 @State marginItem: number = 5 // 初始化舒尔特方格 initGrid() { this.numbers = [] for (let i = 0; i \u003c 25; i++) { this.numbers.push(i + 1) } this.shuffleArray(JSON.parse(JSON.stringify(this.numbers))); this.currentIndex = 0; this.timeStart = Date.now() } // 随机打乱数组 shuffleArray(array: number[]) { for (let i = array.length - 1; i \u003e 0; i--) { const j = Math.floor(Math.random() * 25); let temp = array[i] array[i] = array[j] array[j] = temp } this.numbers = array } // 判断是否完成 isCompleted() { return this.currentIndex === 25; } build() { Column({ space: 20 }) { Flex({ wrap: FlexWrap.Wrap }) { ForEach(this.numbers, (item: number, index: number) =\u003e { Text(`${item}`) .width(`${this.widthItem}lpx`) .height(`${this.widthItem}lpx`) .margin(`${this.marginItem}lpx`) .fontSize(`${this.widthItem/2}lpx`) .textAlign(TextAlign.Center) .backgroundColor(Color.Orange) .fontColor(Color.White) .borderRadius(5) .visibility(item \u003c= this.currentIndex ? Visibility.Hidden : Visibility.Visible) .onClick(() =\u003e { if (this.numbers[index] === this.currentIndex + 1) { this.currentIndex++; if (this.isCompleted()) { console.info('完成！'); promptAction.showDialog({ title: `用时`, message: `${((Date.now() - this.timeStart) / 1000).toFixed(3)}秒`, buttons: [ { text: '重新开始', color: '#ffa500' } ], }).then(()=\u003e{ this.initGrid(); }) } } else { console.info('错误的顺序！'); } }) }) } .width(`${(this.widthItem + this.marginItem * 2) * 5}lpx`) .height(`${(this.widthItem + this.marginItem * 2) * 5}lpx`) // 开始按钮 Button('开始') .width('50%') .height('10%') .onClick(() =\u003e { this.initGrid(); console.info('游戏开始'); }); } .width('100%') .height('100%') } } Piece 拼图\n算法： 随机 剪裁 交换\nimport { fileIo as fs } from '@kit.CoreFileKit'; import { common } from '@kit.AbilityKit'; import { promptAction } from '@kit.ArkUI'; import { image } from '@kit.ImageKit'; import { photoAccessHelper } from '@kit.MediaLibraryKit'; // 定义拼图组件接口 interface PuzzlePiece { // 拼图块的像素地图 pixelMap: image.PixelMap; // 原始图片中的索引位置 originalIndex: number; } // 使用装饰器定义页面组件 @Entry @Component struct Page30 { // 状态变量：选中图片的URI @State selectedImageUrl: string = ''; // 状态变量：原始图片的URI @State originalImageUrl: string = ''; // 状态变量：存储拼图块的数组 @State puzzlePieces: Array\u003cPuzzlePiece\u003e = []; // 状态变量：记录当前选中的拼图块索引 @State selectedPiece: number = -1; // 弹出图片选择器方法 async openPicker() { try { let PhotoSelectOptions = new photoAccessHelper.PhotoSelectOptions(); PhotoSelectOptions.MIMEType = photoAccessHelper.PhotoViewMIMETypes.IMAGE_TYPE; PhotoSelectOptions.maxSelectNumber = 1; let photoPicker = new photoAccessHelper.PhotoViewPicker(); let uris: photoAccessHelper.PhotoSelectResult = await photoPicker.select(PhotoSelectOptions) if (!uris || uris.photoUris.length === 0) return; // 获取选中图片的第一张URI let uri: string = uris.photoUris[0]; // 打开文件读取流 let file = fs.openSync(uri, fs.OpenMode.READ_ONLY); // 获取当前上下文 let context = getContext(this) as common.UIAbilityContext; // 新建一个保存裁剪后图片的路径 let newUrl = context.filesDir + '/test' + new Date().getTime() + '.jpg'; // 复制图片到新的路径 fs.copyFileSync(file.fd, newUrl); // 关闭文件读取流 fs.closeSync(file); // 更新状态变量：设置显示图片的URI this.selectedImageUrl = newUrl; // 更新状态变量：保存原始图片的URI this.originalImageUrl = uri; // 图片更改时触发的方法 this.imgChange(); } catch (e) { console.error('openPicker', JSON.stringify(e)); } } // 图片更改处理方法 async imgChange() { try { // 创建图片源对象 const imageSource: image.ImageSource = image.createImageSource(this.selectedImageUrl); // 图片解码选项 let decodingOptions: image.DecodingOptions = { editable: true, desiredPixelFormat: 3, }; // 创建像素地图 let mPixelMap: image.PixelMap = await imageSource.createPixelMap(decodingOptions); // 获取图片信息 let mImageInfo: image.ImageInfo = await mPixelMap.getImageInfo(); // 计算每个拼图块的大小 const pieceSize: image.Size = { width: mImageInfo.size.width / 3, height: mImageInfo.size.height / 3, }; // 清空已有拼图块数据 this.puzzlePieces.splice(0); // 遍历图片生成9个拼图块 let count = 0; for (let row = 0; row \u003c 3; row++) { for (let col = 0; col \u003c 3; col++) { // 创建基于原图的新图片源 const imageSource = image.createImageSource(this.selectedImageUrl); // 创建新像素地图 let mPixelMap = await imageSource.createPixelMap(decodingOptions); // 计算裁剪区域 const cutRegion: image.Region = { x: col * pieceSize.width, y: row * pieceSize.height, size: pieceSize, }; // 裁剪像素地图 await mPixelMap.crop(cutRegion); // 创建并添加拼图块至数组 const piece: PuzzlePiece = { pixelMap: mPixelMap, originalIndex: count++, }; this.puzzlePieces.push(piece); } } // 打乱拼图块顺序 for (let i = this.puzzlePieces.length - 1; i \u003e 0; i--) { const j = Math.floor(Math.random() * (i + 1)); let temp: PuzzlePiece = this.puzzlePieces[i]; this.puzzlePieces[i] = this.puzzlePieces[j]; this.puzzlePieces[j] = temp; } } catch (e) { console.error('imgChange', JSON.stringify(e)); } } // 构建UI界面 build() { Column() { // 添加选择图片按钮，点击后调用打开图片选择器方法 Button('选择图片→').onClick(() =\u003e { this.openPicker(); }); // 显示原始图片（如果已选择） if (this.originalImageUrl) { Text('原始图片↓'); Image(this.originalImageUrl) .width('180lpx') .height('180lpx') .objectFit(ImageFit.Contain); } // 如果有拼图块，则显示游戏区 if (this.puzzlePieces.length \u003e 0) { Text('游戏图片↓'); // 游戏区域采用网格布局 Grid() { // 遍历所有拼图块并创建网格项 ForEach(this.puzzlePieces, (item: PuzzlePiece, index: number) =\u003e { GridItem() { // 显示拼图块图像 Image(item.pixelMap) .width('200lpx') .height('200lpx') .margin('5lpx') // 根据是否选中调整缩放比例 .scale(this.selectedPiece == index ? { x: 0.5, y: 0.5 } : { x: 1, y: 1 }) // 添加点击事件处理 .onClick(() =\u003e { // 处理拼图交换逻辑 if (this.selectedPiece == -1) { this.selectedPiece = index; } else if (this.selectedPiece == index) { this.selectedPiece = -1; } else { let temp: PuzzlePiece = this.puzzlePieces[this.selectedPiece]; this.puzzlePieces[this.selectedPiece] = this.puzzlePieces[index]; this.puzzlePieces[index] = temp; this.selectedPiece = -1; // 检查拼图是否完成 let isSucc: boolean = true; for (let i = 0; i \u003c this.puzzlePieces.length; i++) { console.info('====item', this.puzzlePieces[i].originalIndex, i); if (this.puzzlePieces[i].originalIndex !== i) { isSucc = false; break; } } // 如果拼图完成，弹出提示对话框 if (isSucc) { promptAction.showDialog({ message: '拼图完成！', }); } } }); } }) // End of ForEach } // End of Grid .backgroundColor(\"#fafafa\"); // 设置网格背景色 } } // End of Column .width('100%'); // 设置列宽度为100% } } ruler 直尺\nimport { window } from '@kit.ArkUI'; // 导入窗口相关的API import { deviceInfo } from '@kit.BasicServicesKit'; // 导入设备信息相关的API // 定义直尺线类 class RulerLine { index: number; // 线的索引 height: number; // 线的高度 constructor(index: number, height: number) { this.index = index; // 初始化索引 this.height = height; // 初始化高度 } // 显示线的编号 showNumber(): string { return this.index % 10 === 0 ? `${Math.floor(this.index / 10)}` : ''; // 每10个线显示一个编号 } } // 扩展文本样式 @Extend(Text) function fancy() { .fontColor(\"#019dfe\") // 设置字体颜色 .fontSize(20); // 设置字体大小 } // 定义直尺组件 @Entry @Component struct RulerComponent { @State maxRulerHeight: number = 0; // 最大直尺高度 @State @Watch('onCellWidthChanged') cellWidthInPixels: number = 17.28; // 每毫米对应的像素 @State textWidth: number = 80; // 文本宽度 @State rulerLines: RulerLine[] = []; // 直尺线数组 @State leftOffsetX: number = -300; // 左侧偏移 @State currentPositionX: number = -300; // 当前X位置 @State @Watch('onContainerHeightChanged') containerHeight: number = 53; // 容器高度 @State originalContainerHeight: number = 53; // 原始容器高度 @State @Watch('onCellWidthChanged') containerWidth: number = 0; // 容器宽度 // 处理单元格宽度变化 onCellWidthChanged() { this.maxRulerHeight = vp2px(this.containerWidth) / this.cellWidthInPixels / 10; // 更新最大直尺高度 } // 处理容器高度变化 onContainerHeightChanged() { this.containerHeight = Math.max(this.containerHeight, 53); // 确保容器高度不小于53 } // 组件即将出现时 aboutToAppear(): void { // 设置当前应用为横屏显示 window.getLastWindow(getContext()).then((windowClass) =\u003e { windowClass.setPreferredOrientation(window.Orientation.LANDSCAPE); // 设置为横屏 }); // 初始化直尺线 for (let i = 0; i \u003c= 15 * 10; i++) { let lineHeight: number = (i % 10 === 0) ? 90 : (i % 5 === 0) ? 60 : 45; // 根据索引设置线的高度 this.rulerLines.push(new RulerLine(i, lineHeight)); // 将新线添加到数组中 } } // 构建UI build() { Column() { // 创建一个列布局 Stack() { // 创建一个堆叠布局 Stack() { // 创建另一个堆叠布局 ForEach(this.rulerLines, (line: RulerLine, index: number) =\u003e { // 遍历直尺线数组 Line()// 创建一条线 .width(1)// 设置线宽 .height(`${line.height}px`)// 设置线高 .backgroundColor(Color.White)// 设置线的背景颜色 .margin({ left: `${this.cellWidthInPixels * index}px` }); // 设置线的左边距 Text(line.showNumber())// 显示线的编号 .fontColor(Color.White)// 设置字体颜色 .fontSize(18)// 设置字体大小 .width(`${this.textWidth}px`)// 设置文本宽度 .height(`${this.textWidth}px`)// 设置文本高度 .textAlign(TextAlign.Center)// 设置文本对齐方式 .margin({ left: `${this.cellWidthInPixels * index - this.textWidth / 2}px`, top: `${line.height}px` }); // 设置文本位置 }); }.width('100%').height('100%').align(Alignment.TopStart); // 设置堆叠布局的宽高和对齐方式 Column({ space: 15 }) { // 创建一个列布局，设置间距 Text(`当前设备：${deviceInfo.marketName}`).fancy(); // 显示当前设备名称 Counter() { // 创建一个计数器 Text(`选中区距离：${this.maxRulerHeight.toFixed(2)}厘米`).fancy(); // 显示选中区距离 } .foregroundColor(Color.White) // 设置计数器字体颜色 .width(300) // 设置计数器宽度 .onInc(() =\u003e { // 增加计数器时的处理 this.containerHeight = px2vp(vp2px(this.containerHeight) + this.cellWidthInPixels / 10); // 更新容器高度 }) .onDec(() =\u003e { // 减少计数器时的处理 this.containerHeight = px2vp(vp2px(this.containerHeight) - this.cellWidthInPixels / 10); // 更新容器高度 }); Counter() { // 创建另一个计数器 Text(`每毫米间距：${this.cellWidthInPixels.toFixed(2)}px`).fancy(); // 显示每毫米间距 } .foregroundColor(Color.White) // 设置计数器字体颜色 .width(300) // 设置计数器宽度 .onInc(() =\u003e { // 增加计数器时的处理 this.cellWidthInPixels += 0.01; // 增加每毫米间距 }) .onDec(() =\u003e { // 减少计数器时的处理 this.cellWidthInPixels = Math.max(0.01, this.cellWidthInPixels - 0.01); // 减少每毫米间距，确保不小于0.01 }); } RelativeContainer() { // 创建一个相对布局容器 Rect()// 创建一个矩形 .fill(\"#80019dfe\")// 设置填充颜色 .borderColor(\"#019dfe\")// 设置边框颜色 .borderWidth({ left: 1, right: 1 })// 设置边框宽度 .clip(true)// 启用裁剪 .width(\"100%\")// 设置宽度为100% .height(\"100%\")// 设置高度为100% .onAreaChange((oldArea: Area, newArea: Area) =\u003e { // 处理区域变化 this.containerWidth = newArea.width as number; // 更新容器宽度 }); Stack() { // 创建一个堆叠布局 Circle({ height: 30, width: 30 })// 创建一个圆形 .fill(\"#019dfe\")// 设置填充颜色 .stroke(Color.Transparent)// 设置边框颜色为透明 .strokeWidth(3); // 设置边框宽度 Circle({ height: 40, width: 40 })// 创建另一个圆形 .fill(Color.Transparent)// 设置填充颜色为透明 .stroke(\"#019dfe\")// 设置边框颜色 .strokeWidth(3); // 设置边框宽度 } .hitTestBehavior(HitTestMode.Block) // 设置碰撞检测行为 .padding(20) // 设置内边距 .alignRules({ // 设置对齐规则 center: { anchor: \"__container__\", align: VerticalAlign.Center }, // 垂直居中 middle: { anchor: \"__container__\", align: HorizontalAlign.Start } // 左对齐 }) .gesture(PanGesture({ // 左侧拖动手势 fingers: 1, // 单指拖动 direction: PanDirection.Horizontal, // 水平拖动 distance: 1 // 最小拖动距离 }).onActionUpdate((event: GestureEvent) =\u003e { // 拖动更新时的处理 this.leftOffsetX = this.currentPositionX + event.offsetX / 2; // 更新左侧偏移 this.containerHeight = this.originalContainerHeight - event.offsetX; // 更新容器高度 }).onActionEnd(() =\u003e { // 拖动结束时的处理 this.currentPositionX = this.leftOffsetX; // 更新位置 this.originalContainerHeight = this.containerHeight; // 更新原始高度 })); Stack() { // 创建另一个堆叠布局 Circle({ height: 30, width: 30 })// 创建一个圆形 .fill(\"#019dfe\")// 设置填充颜色 .stroke(Color.Transparent)// 设置边框颜色为透明 .strokeWidth(3); // 设置边框宽度 Circle({ height: 40, width: 40 })// 创建另一个圆 .fill(Color.Transparent)// 设置填充颜色为透明 .stroke(\"#019dfe\")// 设置边框颜色 .strokeWidth(3); // 设置边框宽度 } .hitTestBehavior(HitTestMode.Block) // 设置碰撞检测行为 .padding(20) // 设置内边距 .alignRules({ // 设置对齐规则 center: { anchor: \"__container__\", align: VerticalAlign.Center }, // 垂直居中 middle: { anchor: \"__container__\", align: HorizontalAlign.End } // 右对齐 }) .gesture(PanGesture({ // 右侧拖动手势 fingers: 1, // 单指拖动 direction: PanDirection.Horizontal, // 水平拖动 distance: 1 // 最小拖动距离 }).onActionUpdate((event: GestureEvent) =\u003e { // 拖动更新时的处理 this.leftOffsetX = this.currentPositionX + event.offsetX / 2; // 更新左侧偏移 this.containerHeight = this.originalContainerHeight + event.offsetX; // 更新容器高度 }).onActionEnd(() =\u003e { // 拖动结束时的处理 this.currentPositionX = this.leftOffsetX; // 更新位置 this.originalContainerHeight = this.containerHeight; // 更新原始高度 })); } .width(this.containerHeight) // 设置宽度 .height(\"100%\") // 设置高度 .translate({ x: this.leftOffsetX }) // 使用左侧偏移 .gesture(PanGesture({ // 左侧拖动手势 fingers: 1, // 单指拖动 direction: PanDirection.Horizontal, // 水平拖动 distance: 1 // 最小拖动距离 }).onActionUpdate((event: GestureEvent) =\u003e { // 拖动更新时的处理 if (event) { this.leftOffsetX = this.currentPositionX + event.offsetX; // 更新左侧偏移 } }).onActionEnd(() =\u003e { // 拖动结束时的处理 this.currentPositionX = this.leftOffsetX; // 更新位置 })); } }.height('100%').width('100%') // 设置高度和宽度 .padding({ left: 30, right: 10 }) // 设置内边距 .backgroundColor(\"#181b22\"); // 设置背景颜色 } } randon password 随机密码\n// 导入剪贴板服务 import { pasteboard } from '@kit.BasicServicesKit'; // 导入弹窗提示服务 import { promptAction } from '@kit.ArkUI'; // 使用装饰器定义一个可观察的类，用于密码选项 @ObservedV2 class PasswordOption { name: string; // 选项名称 characters: string; // 该选项对应的字符集 // 定义是否选中，默认为true @Trace selected: boolean = true; // 定义是否启用，默认为true @Trace enabled: boolean = true; // 构造函数，初始化name和characters constructor(name: string, characters: string) { this.name = name; this.characters = characters; } } // 使用装饰器定义一个入口组件 @Entry @Component struct PasswordGeneratorPage { // 定义密码选项数组 @State options: PasswordOption[] = [ new PasswordOption(\"大写字母\", \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"), new PasswordOption(\"小写字母\", \"abcdefghijklmnopqrstuvwxyz\"), new PasswordOption(\"数字\", \"0123456789\"), new PasswordOption(\"特殊字符\", \"!@#$%^\u0026*()_+-=[]{}|;:,.\u003c\u003e?\"), ]; // 定义密码长度状态，默认值为10 @State passwordLength: number = 10; // 基础间距 @State baseSpacing: number = 30; // 生成的密码 @State generatedPassword: string = ''; // 是否启用复制按钮 @State isCopyButtonEnabled: boolean = false; // 主题色 @State primaryColor: string = '#71dec7'; // 字体颜色 @State fontColor: string = \"#2e2e2e\"; // 生成密码的方法 generatePassword() { let characterSet = ''; // 初始化字符集合 // 遍历所有选项，如果选项被选中则加入字符集合 for (let option of this.options) { if (option.selected) { characterSet += option.characters } } let password = ''; // 初始化密码字符串 // 根据密码长度生成随机密码 for (let i = 0; i \u003c this.passwordLength; i++) { const randomIndex = Math.floor(Math.random() * characterSet.length); password += characterSet[randomIndex]; } this.generatedPassword = password; // 更新生成的密码 } // 复制到剪贴板的方法 copyToClipboard(text: string) { const pasteboardData = pasteboard.createData(pasteboard.MIMETYPE_TEXT_PLAIN, text); // 创建剪贴板数据 const systemPasteboard = pasteboard.getSystemPasteboard(); // 获取系统剪贴板 systemPasteboard.setData(pasteboardData); // 将数据放入剪切板 promptAction.showToast({ message: '已复制' }); // 显示复制成功的提示 } // 检查选项选择状态的方法 checkOptionsSelection() { let selectedCount = 0; // 记录已选中的选项数量 let lastSelectedIndex = 0; // 记录最后一个选中的选项索引 // 遍历所有选项 for (let i = 0; i \u003c this.options.length; i++) { this.options[i].enabled = true; // 默认启用所有选项 if (this.options[i].selected) { lastSelectedIndex = i; // 更新最后一个选中的选项索引 selectedCount++; // 增加选中计数 } } // 如果只有一个选项被选中，则禁用该选项防止其被取消选中 if (selectedCount === 1) { this.options[lastSelectedIndex].enabled = false; } } // 构建页面布局的方法 build() { Column() { // 标题栏 Text(\"随机密码生成\") .width('100%')// 设置宽度为100% .height(54)// 设置高度为54 .fontSize(18)// 设置字体大小 .fontWeight(600)// 设置字体粗细 .backgroundColor(Color.White)// 设置背景颜色 .textAlign(TextAlign.Center)// 设置文本居中对齐 .fontColor(this.fontColor); // 设置字体颜色 // 密码长度设置部分 Column() { Row() { Text(`密码长度：`)// 密码长度标签 .fontWeight(600) .fontSize(18) .fontColor(this.fontColor); Text(`${this.passwordLength}`)// 显示当前密码长度 .fontWeight(600) .fontSize(18) .fontColor(this.primaryColor); } .margin({ top: `${this.baseSpacing}lpx`, left: `${this.baseSpacing}lpx` }); // 滑动条设置密码长度 Row() { Text('4').fontColor(this.fontColor).width(20); Slider({ value: this.passwordLength, // 当前值 min: 4, // 最小值 max: 32, // 最大值 style: SliderStyle.InSet // 滑动条样式 }) .layoutWeight(1)// 布局权重 .blockColor(Color.White)// 滑块颜色 .trackColor('#EBEBEB')// 轨道颜色 .trackThickness(30)// 轨道厚度 .blockSize({ width: 55, height: 55 })// 滑块大小 .selectedColor(this.primaryColor)// 选中颜色 .onChange((value: number, mode: SliderChangeMode) =\u003e { this.passwordLength = value; // 更新密码长度 console.info('value:' + value + 'mode' + mode.toString); // 打印日志 }); Text('32').fontColor(this.fontColor).width(20); }.margin({ left: `${this.baseSpacing}lpx`, right: `${this.baseSpacing}lpx`, top: `${this.baseSpacing}lpx`, }); // 选项设置部分 Text('选项') .fontWeight(600) .fontSize(18) .fontColor(this.fontColor) .margin({ left: `${this.baseSpacing}lpx`, top: `${this.baseSpacing}lpx`, bottom: `${this.baseSpacing}lpx` }); // 动态生成每个选项的UI元素 ForEach(this.options, (option: PasswordOption, index: number) =\u003e { Row() { Text(option.name)// 选项名称 .fontWeight(400) .fontSize(16) .fontColor(this.fontColor) .layoutWeight(1); Toggle({ type: ToggleType.Switch, isOn: option.selected })// 切换按钮 .width('100lpx') .height('50lpx') .enabled(option.enabled)// 是否启用切换 .selectedColor(this.primaryColor) .onChange((isOn: boolean) =\u003e { option.selected = isOn; // 更新选项状态 this.checkOptionsSelection(); // 检查选项选择状态 }); } .width('100%') .padding({ left: `${this.baseSpacing}lpx`, right: `${this.baseSpacing}lpx`, top: `${this.baseSpacing / 3}lpx`, bottom: `${this.baseSpacing / 3}lpx` }) .hitTestBehavior(HitTestMode.Block) .onClick(() =\u003e { if (option.enabled) { option.selected = !option.selected; // 切换选项状态 } }); }); // 生成密码按钮 Text('生成密码') .fontColor(Color.White) .backgroundColor(this.primaryColor) .height(54) .textAlign(TextAlign.Center) .borderRadius(10) .fontSize(18) .width(`${650 - this.baseSpacing * 2}lpx`) .margin({ top: `${this.baseSpacing}lpx`, left: `${this.baseSpacing}lpx`, right: `${this.baseSpacing}lpx`, bottom: `${this.baseSpacing}lpx` }) .clickEffect({ level: ClickEffectLevel.HEAVY, scale: 0.8 })// 点击效果 .onClick(() =\u003e { this.generatePassword(); // 生成密码 }); } .width('650lpx') .margin({ top: 20 }) .backgroundColor(Color.White) .borderRadius(10) .alignItems(HorizontalAlign.Start); // 显示生成的密码 Column() { Text(`密码结果：`) .fontWeight(600) .fontSize(18) .fontColor(this.fontColor) .margin({ top: `${this.baseSpacing}lpx`, left: `${this.baseSpacing}lpx`, }); Text(`${this.generatedPassword}`)// 显示生成的密码 .width('650lpx') .fontColor(this.primaryColor) .fontSize(18) .textAlign(TextAlign.Center) .padding({ left: 5, right: 5 }) .margin({ top: `${this.baseSpacing / 3}lpx` }); // 复制按钮 Text('复制') .enabled(this.generatedPassword ? true : false)// 只有生成了密码才启用复制按钮 .fontColor(Color.White) .backgroundColor(this.primaryColor) .height(54) .textAlign(TextAlign.Center) .borderRadius(10) .fontSize(18) .width(`${650 - this.baseSpacing * 2}lpx`) .margin({ top: `${this.baseSpacing}lpx`, left: `${this.baseSpacing}lpx`, right: `${this.baseSpacing}lpx`, bottom: `${this.baseSpacing}lpx` }) .clickEffect({ level: ClickEffectLevel.HEAVY, scale: 0.8 }) .onClick(() =\u003e { this.copyToClipboard(this.generatedPassword); // 复制密码 }); } .width('650lpx') .backgroundColor(Color.White) .borderRadius(10) .margin({ top: `${this.baseSpacing}lpx` }) .alignItems(HorizontalAlign.Start); } .height('100%') .width('100%') .backgroundColor(\"#f2f3f5\"); // 页面背景颜色 } } chinese ohpm install @nutpi/chinese_transverter\n// 导入必要的转换库，提供简体与繁体之间的转换功能 import { transverter, TransverterType, TransverterLanguage } from \"@nutpi/chinese_transverter\"; // 导入剪贴板服务，用于将文本复制到系统剪贴板 import { pasteboard } from '@kit.BasicServicesKit'; // 导入提示服务，用于向用户显示消息 import { promptAction } from '@kit.ArkUI'; // 使用@Entry装饰器标记此组件为应用的入口点 @Entry // 使用@Component装饰器定义一个名为SimplifiedTraditionalConverter的组件 @Component struct SimplifiedTraditionalConverter { // 定义状态变量inputText，存储用户输入的原始文本，当其值变化时触发onInputTextChanged方法 @State @Watch('onInputTextChanged') inputText: string = ''; // 定义状态变量simplifiedResult，存储转换后的简体结果 @State simplifiedResult: string = ''; // 定义状态变量traditionalResult，存储转换后的繁体结果 @State traditionalResult: string = ''; // 定义状态变量isInputFocused，表示输入框是否获得了焦点 @State isInputFocused: boolean = false; // 定义主题颜色 @State private themeColor: string = '#439fff'; // 定义文本颜色 @State private textColor: string = \"#2e2e2e\"; // 定义基础内边距大小 @State private basePadding: number = 30; // 定义最小文本区域高度 @State private minTextAreaHeight: number = 50; // 定义最大文本区域高度 @State private maxTextAreaHeight: number = 300; // 当inputText状态改变时触发的方法，用于更新转换结果 onInputTextChanged() { // 将inputText转换为简体，并更新simplifiedResult this.simplifiedResult = transverter({ type: TransverterType.SIMPLIFIED, str: this.inputText, language: TransverterLanguage.ZH_CN }); // 将inputText转换为繁体，并更新traditionalResult this.traditionalResult = transverter({ type: TransverterType.TRADITIONAL, str: this.inputText, language: TransverterLanguage.ZH_CN }); } // 将给定的文本复制到剪贴板，并显示提示信息 private copyToClipboard(text: string): void { const clipboardData = pasteboard.createData(pasteboard.MIMETYPE_TEXT_PLAIN, text); // 创建剪贴板数据 const systemClipboard = pasteboard.getSystemPasteboard(); // 获取系统剪贴板 systemClipboard.setData(clipboardData); // 设置剪贴板数据 promptAction.showToast({ message: '已复制到剪贴板' }); // 显示复制成功的提示 } // 构建组件的UI build() { Scroll() { // 创建可滚动的容器 Column() { // 在滚动容器中创建垂直布局 // 创建标题文本 Text(\"简体繁体转换器\") .width('100%') .height(54) .fontSize(18) .fontWeight(600) .backgroundColor(Color.White) .textAlign(TextAlign.Center) .fontColor(this.textColor); // 创建用户输入区域 Column() { // 创建多行文本输入框 TextArea({ text: $$this.inputText, placeholder: '请输入简体/繁体字（支持混合输入）' }) .fontSize(18) .placeholderColor(this.isInputFocused ? this.themeColor : Color.Gray) .fontColor(this.isInputFocused ? this.themeColor : this.textColor) .borderColor(this.isInputFocused ? this.themeColor : Color.Gray) .caretColor(this.themeColor) .onBlur(() =\u003e this.isInputFocused = false) // 当输入框失去焦点时，更新isInputFocused状态 .onFocus(() =\u003e this.isInputFocused = true) // 当输入框获得焦点时，更新isInputFocused状态 .borderWidth(1) .borderRadius(10) .backgroundColor(Color.White) .constraintSize({ minHeight: this.minTextAreaHeight, maxHeight: this.maxTextAreaHeight }); // 创建清空按钮 Text('清空') .borderWidth(1) .borderColor(this.themeColor) .fontColor(this.themeColor) .height(50) .textAlign(TextAlign.Center) .borderRadius(10) .fontSize(18) .width(`${650 - this.basePadding * 2}lpx`) .margin({ top: `${this.basePadding}lpx` }) .clickEffect({ level: ClickEffectLevel.HEAVY, scale: 0.8 }) // 添加点击效果 .onClick(() =\u003e this.inputText = \"\"); // 清空输入框 } .width('650lpx') .padding(`${this.basePadding}lpx`) .margin({ top: 20 }) .backgroundColor(Color.White) .borderRadius(10) .alignItems(HorizontalAlign.Start); // 创建繁体结果展示与复制区域 Column() { // 创建繁体结果标题 Text(`繁体结果：`) .fontWeight(600) .fontSize(18) .fontColor(this.textColor); // 创建繁体结果展示文本 Text(`${this.traditionalResult}`) .constraintSize({ minHeight: this.minTextAreaHeight, maxHeight: this.maxTextAreaHeight }) .fontColor(this.themeColor) .fontSize(18) .textAlign(TextAlign.Start) .copyOption(CopyOptions.InApp) .margin({ top: `${this.basePadding / 3}lpx` }); // 创建复制繁体结果按钮 Text('复制') .enabled(this.traditionalResult ? true : false) // 只有当有繁体结果时，按钮才可用 .fontColor(Color.White) .backgroundColor(this.themeColor) .height(50) .textAlign(TextAlign.Center) .borderRadius(10) .fontSize(18) .width(`${650 - this.basePadding * 2}lpx`) .margin({ top: `${this.basePadding}lpx` }) .clickEffect({ level: ClickEffectLevel.HEAVY, scale: 0.8 }) .onClick(() =\u003e this.copyToClipboard(this.traditionalResult)); // 复制繁体结果到剪贴板 } .width('650lpx') .padding(`${this.basePadding}lpx`) .backgroundColor(Color.White) .borderRadius(10) .margin({ top: `${this.basePadding}lpx` }) .alignItems(HorizontalAlign.Start); // 创建简体结果展示与复制区域 Column() { // 创建简体结果标题 Text(`简体结果：`) .fontWeight(600) .fontSize(18) .fontColor(this.textColor); // 创建简体结果展示文本 Text(`${this.simplifiedResult}`) .constraintSize({ minHeight: this.minTextAreaHeight, maxHeight: this.maxTextAreaHeight }) .fontColor(this.themeColor) .fontSize(18) .textAlign(TextAlign.Start) .copyOption(CopyOptions.InApp) .margin({ top: `${this.basePadding / 3}lpx` }); // 创建复制简体结果按钮 Text('复制') .enabled(this.simplifiedResult ? true : false) // 只有当有简体结果时，按钮才可用 .fontColor(Color.White) .backgroundColor(this.themeColor) .height(50) .textAlign(TextAlign.Center) .borderRadius(10) .fontSize(18) .width(`${650 - this.basePadding * 2}lpx`) .margin({ top: `${this.basePadding}lpx` }) .clickEffect({ level: ClickEffectLevel.HEAVY, scale: 0.8 }) .onClick(() =\u003e this.copyToClipboard(this.simplifiedResult)); // 复制简体结果到剪贴板 } .width('650lpx') .padding(`${this.basePadding}lpx`) .backgroundColor(Color.White) .borderRadius(10) .margin({ top: `${this.basePadding}lpx` }) .alignItems(HorizontalAlign.Start); } } .width('100%') .height('100%') .backgroundColor(\"#f2f3f5\") .align(Alignment.Top) .padding({ bottom: `${this.basePadding}lpx` }); } } Up Lower 数字转中文大小写\nohpm install @nutpi/chinese-finance-number ohpm install @nutpi/chinese-number-format // 导入必要的模块 import { promptAction } from '@kit.ArkUI'; // 用于显示提示信息 import { pasteboard } from '@kit.BasicServicesKit'; // 用于处理剪贴板操作 import { toChineseNumber } from '@nutpi/chinese-finance-number'; // 将数字转换为中文大写金额 import { toChineseWithUnits, // 将数字转换为带单位的中文 toUpperCase, // 将中文小写转换为大写 } from '@nutpi/chinese-number-format'; @Entry // 标记此组件为入口点 @Component // 定义一个组件 struct NumberToChineseConverter { @State private exampleNumber: number = 88.8; // 示例数字 @State private textColor: string = \"#2e2e2e\"; // 文本颜色 @State private lineColor: string = \"#d5d5d5\"; // 分割线颜色 @State private basePadding: number = 30; // 基础内边距 @State private chineseLowercase: string = \"\"; // 转换后的小写中文 @State private chineseUppercase: string = \"\"; // 转换后的中文大写 @State private chineseUppercaseAmount: string = \"\"; // 转换后的中文大写金额 @State @Watch('inputChanged') private inputText: string = \"\"; // 监听输入文本变化 // 当输入文本改变时触发的方法 inputChanged() { this.chineseLowercase = toChineseWithUnits(Number(this.inputText), 'zh-CN'); // 转换为小写中文并带上单位 this.chineseUppercase = toUpperCase(this.chineseLowercase, 'zh-CN'); // 将小写中文转换为大写 this.chineseUppercaseAmount = toChineseNumber(Number(this.inputText)); // 转换为大写金额 } // 复制文本到剪贴板的方法 private copyToClipboard(text: string): void { const pasteboardData = pasteboard.createData(pasteboard.MIMETYPE_TEXT_PLAIN, text); // 创建剪贴板数据 const systemPasteboard = pasteboard.getSystemPasteboard(); // 获取系统剪贴板 systemPasteboard.setData(pasteboardData); // 设置剪贴板数据 promptAction.showToast({ message: '已复制' }); // 显示复制成功的提示 } // 构建用户界面的方法 build() { Column() { // 主列容器 // 页面标题 Text('数字转中文大小写') .fontColor(this.textColor) // 设置字体颜色 .fontSize(18) // 设置字体大小 .width('100%') // 设置宽度 .height(50) // 设置高度 .textAlign(TextAlign.Center) // 文本居中对齐 .backgroundColor(Color.White) // 设置背景颜色 .shadow({ // 添加阴影效果 radius: 2, // 阴影半径 color: this.lineColor, // 阴影颜色 offsetX: 0, // X轴偏移量 offsetY: 5 // Y轴偏移量 }); Scroll() { // 滚动视图 Column() { // 内部列容器 // 工具介绍部分 Column() { Text('工具介绍').fontSize(20).fontWeight(600).fontColor(this.textColor); // 设置介绍文字样式 Text('将数字转换为中文格式，适用于票据填写、合同文书、财务报表等多种场景。支持从最小单位“分”到最大单位“千兆”的数字转换。') .textAlign(TextAlign.JUSTIFY) .fontSize(18).fontColor(this.textColor).margin({ top: `${this.basePadding / 2}lpx` }); // 设置介绍详情文字样式 } .alignItems(HorizontalAlign.Start) // 对齐方式 .width('650lpx') // 设置宽度 .padding(`${this.basePadding}lpx`) // 设置内边距 .margin({ top: `${this.basePadding}lpx` }) // 设置外边距 .borderRadius(10) // 设置圆角 .backgroundColor(Color.White) // 设置背景颜色 .shadow({ // 添加阴影效果 radius: 10, // 阴影半径 color: this.lineColor, // 阴影颜色 offsetX: 0, // X轴偏移量 offsetY: 0 // Y轴偏移量 }); // 输入区 Column() { Row() { // 行容器 Text('示例') .fontColor(\"#5871ce\") // 设置字体颜色 .fontSize(18) // 设置字体大小 .padding(`${this.basePadding / 2}lpx`) // 设置内边距 .backgroundColor(\"#f2f1fd\") // 设置背景颜色 .borderRadius(5) // 设置圆角 .clickEffect({ level: ClickEffectLevel.LIGHT, scale: 0.8 }) // 设置点击效果 .onClick(() =\u003e { // 点击事件 this.inputText = `${this.exampleNumber}`; // 设置输入框文本为示例数字 }); Blank(); // 占位符 Text('清空') .fontColor(\"#e48742\") // 设置字体颜色 .fontSize(18) // 设置字体大小 .padding(`${this.basePadding / 2}lpx`) // 设置内边距 .clickEffect({ level: ClickEffectLevel.LIGHT, scale: 0.8 }) // 设置点击效果 .backgroundColor(\"#ffefe6\") // 设置背景颜色 .borderRadius(5) // 设置圆角 .onClick(() =\u003e { // 点击事件 this.inputText = \"\"; // 清空输入框 }); }.height(45) // 设置高度 .justifyContent(FlexAlign.SpaceBetween) // 子元素水平分布方式 .width('100%'); // 设置宽度 Divider().margin({ top: 5, bottom: 5 }); // 分割线 TextInput({ text: $$this.inputText, placeholder: `请输入数字，例如：${this.exampleNumber}` }) // 输入框 .width('100%') // 设置宽度 .fontSize(18) // 设置字体大小 .caretColor(this.textColor) // 设置光标颜色 .fontColor(this.textColor) // 设置字体颜色 .margin({ top: `${this.basePadding}lpx` }) // 设置外边距 .padding(0) // 设置内边距 .backgroundColor(Color.Transparent) // 设置背景颜色 .borderRadius(0) // 设置圆角 .type(InputType.NUMBER_DECIMAL); // 设置输入类型为数字 } .alignItems(HorizontalAlign.Start) // 对齐方式 .width('650lpx') // 设置宽度 .padding(`${this.basePadding}lpx`) // 设置内边距 .margin({ top: `${this.basePadding}lpx` }) // 设置外边距 .borderRadius(10) // 设置圆角 .backgroundColor(Color.White) // 设置背景颜色 .shadow({ // 添加阴影效果 radius: 10, // 阴影半径 color: this.lineColor, // 阴影颜色 offsetX: 0, // X轴偏移量 offsetY: 0 // Y轴偏移量 }); // 结果区 Column() { Row() { Text(`小写：${this.chineseLowercase}`).fontColor(this.textColor).fontSize(18).layoutWeight(1); // 显示小写结果 Text('复制') .fontColor(Color.White) // 设置字体颜色 .fontSize(18) // 设置字体大小 .padding(`${this.basePadding / 2}lpx`) // 设置内边距 .backgroundColor(\"#0052d9\") // 设置背景颜色 .borderRadius(5) // 设置圆角 .clickEffect({ level: ClickEffectLevel.LIGHT, scale: 0.8 }) // 设置点击效果 .onClick(() =\u003e { // 点击事件 this.copyToClipboard(this.chineseLowercase); // 复制小写结果到剪贴板 }); }.constraintSize({ minHeight: 45 }) // 最小高度 .justifyContent(FlexAlign.SpaceBetween) // 子元素水平分布方式 .width('100%'); // 设置宽度 Divider().margin({ top: 5, bottom: 5 }); // 分割线 Row() { Text(`大写：${this.chineseUppercase}`).fontColor(this.textColor).fontSize(18).layoutWeight(1); // 显示大写结果 Text('复制') .fontColor(Color.White) // 设置字体颜色 .fontSize(18) // 设置字体大小 .padding(`${this.basePadding / 2}lpx`) // 设置内边距 .backgroundColor(\"#0052d9\") // 设置背景颜色 .borderRadius(5) // 设置圆角 .clickEffect({ level: ClickEffectLevel.LIGHT, scale: 0.8 }) // 设置点击效果 .onClick(() =\u003e { // 点击事件 this.copyToClipboard(this.chineseUppercase); // 复制大写结果到剪贴板 }); }.constraintSize({ minHeight: 45 }) // 最小高度 .justifyContent(FlexAlign.SpaceBetween) // 子元素水平分布方式 .width('100%'); // 设置宽度 Divider().margin({ top: 5, bottom: 5 }); // 分割线 Row() { Text(`大写金额：${this.chineseUppercaseAmount}`).fontColor(this.textColor).fontSize(18).layoutWeight(1); // 显示大写金额结果 Text('复制') .fontColor(Color.White) // 设置字体颜色 .fontSize(18) // 设置字体大小 .padding(`${this.basePadding / 2}lpx`) // 设置内边距 .backgroundColor(\"#0052d9\") // 设置背景颜色 .borderRadius(5) // 设置圆角 .clickEffect({ level: ClickEffectLevel.LIGHT, scale: 0.8 }) // 设置点击效果 .onClick(() =\u003e { // 点击事件 this.copyToClipboard(this.chineseUppercaseAmount); // 复制大写金额结果到剪贴板 }); }.constraintSize({ minHeight: 45 }) // 最小高度 .justifyContent(FlexAlign.SpaceBetween) // 子元素水平分布方式 .width('100%'); // 设置宽度 } .alignItems(HorizontalAlign.Start) // 对齐方式 .width('650lpx') // 设置宽度 .padding(`${this.basePadding}lpx`) // 设置内边距 .margin({ top: `${this.basePadding}lpx` }) // 设置外边距 .borderRadius(10) // 设置圆角 .backgroundColor(Color.White) // 设置背景颜色 .shadow({ // 添加阴影效果 radius: 10, // 阴影半径 color: this.lineColor, // 阴影颜色 offsetX: 0, // X轴偏移量 offsetY: 0 // Y轴偏移量 }); } }.scrollBar(BarState.Off).clip(false); // 关闭滚动条，不允许裁剪 } .height('100%') // 设置高度 .width('100%') // 设置宽度 .backgroundColor(\"#f4f8fb\"); // 设置页面背景颜色 } } Tangram 七巧板\n@ObservedV2 // 监听数据变化的装饰器 class TangramBlock { // 定义七巧板类 width: number; // 宽度 height: number; // 高度 points: Array\u003c[number, number]\u003e; // 点坐标数组 color: string; // 颜色 @Trace initialOffsetX: number; // 初始X偏移量 @Trace initialOffsetY: number; // 初始Y偏移量 @Trace currentOffsetX: number; // 当前X偏移量 @Trace currentOffsetY: number; // 当前Y偏移量 @Trace rotationAngle: number; // 旋转角度 @Trace flipAngle: number = 0; // 翻转角度，默认为0 @Trace rotateValue: number; // 旋转值 defaultInitialOffsetX: number; // 默认初始X偏移量 defaultInitialOffsetY: number; // 默认初始Y偏移量 defaultRotationAngle: number; // 默认旋转角度 constructor(color: string, width: number, height: number, initialOffsetX: number, initialOffsetY: number, rotationAngle: number, points: Array\u003c[number, number]\u003e) { this.initialOffsetX = this.currentOffsetX = this.defaultInitialOffsetX = initialOffsetX; // 初始化X偏移量 this.initialOffsetY = this.currentOffsetY = this.defaultInitialOffsetY = initialOffsetY; // 初始化Y偏移量 this.rotationAngle = this.rotateValue = this.defaultRotationAngle = rotationAngle; // 初始化旋转角度 this.color = color; // 设置颜色 this.width = width; // 设置宽度 this.height = height; // 设置高度 this.points = points; // 设置点坐标数组 } resetData() { // 重置数据方法 this.flipAngle = 0; // 重置翻转角度 this.initialOffsetX = this.currentOffsetX = this.defaultInitialOffsetX; // 重置初始X偏移量 this.initialOffsetY = this.currentOffsetY = this.defaultInitialOffsetY; // 重置初始Y偏移量 this.rotationAngle = this.rotateValue = this.defaultRotationAngle; // 重置旋转角度 } } const baseUnitLength: number = 80; // 基本单位长度 @Entry // 入口组件 @Component // 定义组件 export struct Index { // 主组件 @State selectedBlockIndex: number = -1; // 当前选中位置 @State blocks: TangramBlock[] = [// 七巧板数组 // 小直角等腰三角形 new TangramBlock(\"#fed8e5\", baseUnitLength, baseUnitLength, -33.58, -58.02, 135, [[0, 0], [baseUnitLength, 0], [0, baseUnitLength]]), new TangramBlock(\"#0a0bef\", baseUnitLength, baseUnitLength, 78.76, 54.15, 45, [[0, 0], [baseUnitLength, 0], [0, baseUnitLength]]), // 中直角等腰三角形 new TangramBlock(\"#ff0d0c\", baseUnitLength * Math.sqrt(2), baseUnitLength * Math.sqrt(2), -33.16, -1.43, -90, [[0, 0], [baseUnitLength * Math.sqrt(2), 0], [0, baseUnitLength * Math.sqrt(2)]]), // 大直角等腰三角形 new TangramBlock(\"#ffa60a\", baseUnitLength * 2, baseUnitLength * 2, 22.46, -172, -135, [[0, 0], [baseUnitLength * 2, 0], [0, baseUnitLength * 2]]), new TangramBlock(\"#3da56a\", baseUnitLength * 2, baseUnitLength * 2, 135.65, -59.34, -45, [[0, 0], [baseUnitLength * 2, 0], [0, baseUnitLength * 2]]), // 正方形 new TangramBlock(\"#ffff0b\", baseUnitLength, baseUnitLength, 23.07, -1.84, -45, [[0, 0], [baseUnitLength, 0], [baseUnitLength, baseUnitLength], [0, baseUnitLength]]), // 平行四边形 new TangramBlock(\"#5e0b9b\", baseUnitLength * 2, baseUnitLength, -61.53, -85.97, 45, [[0, 0], [baseUnitLength, 0], [baseUnitLength * 2, baseUnitLength], [baseUnitLength, baseUnitLength]]) ]; build() { // 构建方法 Column({ space: 30 }) { // 创建垂直布局 Stack() { // 创建堆叠布局 ForEach(this.blocks, (block: TangramBlock, index: number) =\u003e { // 遍历七巧板数组 Stack() { // 创建堆叠布局 Polygon({ width: block.width, height: block.height })// 绘制多边形 .points(block.points)// 设置多边形顶点坐标 .fill(block.color)// 填充颜色 .draggable(false)// 长按不可拖动 .rotate({ angle: block.rotationAngle }) // 旋转角度 } .rotate({ // 旋转 x: 0, y: 1, z: 0, angle: block.flipAngle, centerX: block.width / 2, // 中心点X坐标 centerY: block.height / 2, // 中心点Y坐标 }) .width(block.width) // 设置宽度 .height(block.height) // 设置高度 .onTouch(() =\u003e { // 触摸事件 this.selectedBlockIndex = index; // 设置选中索引 }) .draggable(false) // 长按不可拖动 .translate({ x: block.initialOffsetX, y: block.initialOffsetY, z: 0 }) // 平移 .gesture( // 手势操作 PanGesture()// 拖动手势 .onActionUpdate((event: GestureEvent | undefined) =\u003e { // 更新事件 if (event) { block.initialOffsetX = block.currentOffsetX + event.offsetX; // 更新X偏移量 block.initialOffsetY = block.currentOffsetY + event.offsetY; // 更新Y偏移量 } }) .onActionEnd((event: GestureEvent | undefined) =\u003e { // 结束事件 if (event) { block.currentOffsetX = block.initialOffsetX; // 更新当前X偏移量 block.currentOffsetY = block.initialOffsetY; // 更新当前Y偏移量 } }) ) .zIndex(this.selectedBlockIndex == index ? 1 : 0) // 设置层级 .borderWidth(2) // 边框宽度 .borderStyle(BorderStyle.Dashed) // 边框样式 .borderColor(this.selectedBlockIndex == index ? \"#80a8a8a8\" : Color.Transparent) // 边框颜色 }) }.width('100%').height('750lpx') // 设置宽高 .backgroundColor(\"#e4f2f5\") // 背景颜色 // 旋转角度计数器 Column({ space: 5 }) { // 创建垂直布局，设置间距 Text(`旋转角度(间隔5)`).fontColor(Color.Black) // 显示旋转角度文本，设置字体颜色 Counter() { // 创建计数器组件 Text(`${this.selectedBlockIndex != -1 ? this.blocks[this.selectedBlockIndex].rotationAngle : '-'}`)// 显示当前选中七巧板的旋转角度或占位符 .fontColor(Color.Black) // 设置字体颜色 } .width(300) // 设置计数器宽度 .onInc(() =\u003e { // 增加按钮的点击事件 if (this.selectedBlockIndex != -1) { animateTo({}, () =\u003e { this.blocks[this.selectedBlockIndex].rotationAngle += 5; // 增加旋转角度 }) } }).onDec(() =\u003e { // 减少按钮的点击事件 if (this.selectedBlockIndex != -1) { animateTo({}, () =\u003e { this.blocks[this.selectedBlockIndex].rotationAngle -= 5; // 减少旋转角度 }) } }); } // 旋转角度计数器 Column({ space: 5 }) { // 创建垂直布局，设置间距 Text(`旋转角度(间隔45)`).fontColor(Color.Black) // 显示旋转角度文本，设置字体颜色 Counter() { // 创建计数器组件 Text(`${this.selectedBlockIndex != -1 ? this.blocks[this.selectedBlockIndex].rotationAngle : '-'}`)// 显示当前选中七巧板的旋转角度或占位符 .fontColor(Color.Black) // 设置字体颜色 } .width(300) // 设置计数器宽度 .onInc(() =\u003e { // 增加按钮的点击事件 if (this.selectedBlockIndex != -1) { animateTo({}, () =\u003e { this.blocks[this.selectedBlockIndex].rotationAngle += 45; // 增加旋转角度 }) } }).onDec(() =\u003e { // 减少按钮的点击事件 if (this.selectedBlockIndex != -1) { animateTo({}, () =\u003e { this.blocks[this.selectedBlockIndex].rotationAngle -= 45; // 减少旋转角度 }) } }); } // 翻转按钮 Row() { // 创建水平布局 Button('向左翻转').onClick(() =\u003e { // 左翻转按钮点击事件 animateTo({}, () =\u003e { if (this.selectedBlockIndex != -1) { this.blocks[this.selectedBlockIndex].flipAngle -= 180; // 减少翻转角度 } }); }); Button('向右翻转').onClick(() =\u003e { // 右翻转按钮点击事件 animateTo({}, () =\u003e { if (this.selectedBlockIndex != -1) { this.blocks[this.selectedBlockIndex].flipAngle += 180; // 增加翻转角度 } }); }); }.width('100%').justifyContent(FlexAlign.SpaceEvenly) // 设置宽度和内容对齐方式 // 重置和隐藏边框按钮 Row() { // 创建水平布局 Button('重置').onClick(() =\u003e { // 重置按钮点击事件 animateTo({}, () =\u003e { for (let i = 0; i \u003c this.blocks.length; i++) { this.blocks[i].resetData(); // 重置七巧板数据 } this.selectedBlockIndex = -1; // 重置选中索引 }); }); Button('隐藏边框').onClick(() =\u003e { // 隐藏边框按钮点击事件 this.selectedBlockIndex = -1; // 重置选中索引 }); }.width('100%').justifyContent(FlexAlign.SpaceEvenly) // 设置宽度和内容对齐 }.width('100%').height('100%') } } Reversi 翻转棋（Reversi）、奥赛罗棋（Othello）、苹果棋或正反棋（Anti reversi） 黑白棋\nimport { promptAction } from '@kit.ArkUI'; // 导入用于弹出对话框的工具 @ObservedV2 class ChessCell { // 定义棋盘上的单元格类 @Trace frontVisibility: number = 0; // 单元格上的棋子状态：0表示无子, 1表示黑子，2表示白子 @Trace rotationAngle: number = 0; // 单元格卡片的旋转角度 @Trace opacity: number = 1; // 透明度 isAnimationRunning: boolean = false; // 标记动画是否正在运行 flip(time: number) { // 翻转棋子的方法 if (this.frontVisibility === 1) { // 当前是黑子，要翻转成白子 this.showWhite(time); } else if (this.frontVisibility === 2) { // 当前是白子，要翻转成黑子 this.showBlack(time); } } showBlack(animationTime: number, callback?: () =\u003e void) { // 展示黑色棋子 if (this.isAnimationRunning) { // 如果已经有动画在运行，则返回 return; } this.isAnimationRunning = true; // 设置动画状态为运行中 if (animationTime == 0) { // 如果不需要动画 this.rotationAngle = 0; // 设置旋转角度为0 this.frontVisibility = 1; // 黑子 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } animateToImmediately({ // 开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 animateToImmediately({ // 再次开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } }, () =\u003e { // 动画开始时的回调 this.frontVisibility = 1; // 看到黑色 this.rotationAngle = 0; // 设置旋转角度为0 }); } }, () =\u003e { // 动画开始时的回调 this.rotationAngle = 90; // 设置旋转角度为90度 }); } showWhite(animationTime: number, callback?: () =\u003e void) { // 展示白色棋子 if (this.isAnimationRunning) { // 如果已经有动画在运行，则返回 return; } this.isAnimationRunning = true; // 设置动画状态为运行中 if (animationTime == 0) { // 如果不需要动画 this.rotationAngle = 180; // 设置旋转角度为180度 this.frontVisibility = 2; // 白子 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } animateToImmediately({ // 开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 animateToImmediately({ // 再次开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } }, () =\u003e { // 动画开始时的回调 this.frontVisibility = 2; // 看到白色 this.rotationAngle = 180; // 设置旋转角度为180度 }); } }, () =\u003e { // 动画开始时的回调 this.rotationAngle = 90; // 设置旋转角度为90度 }); } showWhiteAi(animationTime: number, callback?: () =\u003e void) { // 展示白色棋子 if (this.isAnimationRunning) { // 如果已经有动画在运行，则返回 return; } this.isAnimationRunning = true; // 设置动画状态为运行中 if (animationTime == 0) { // 如果不需要动画 this.rotationAngle = 180; // 设置旋转角度为180度 this.frontVisibility = 2; // 白子 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } this.rotationAngle = 180; // 设置旋转角度为180度 this.frontVisibility = 2; // 白子 animateToImmediately({ // 开始动画 duration: animationTime * 3, // 动画持续时间 curve: Curve.EaseOut, iterations: 3, // 动画迭代次数 onFinish: () =\u003e { // 动画完成后的回调 animateToImmediately({ // 再次开始动画 duration: animationTime, // 动画持续时间 iterations: 1, // 动画迭代次数 curve: Curve.Linear, // 动画曲线类型 onFinish: () =\u003e { // 动画完成后的回调 this.isAnimationRunning = false; // 设置动画状态为停止 if (callback) { // 如果有回调函数，则执行 callback(); } } }, () =\u003e { this.opacity = 1; }); } }, () =\u003e { this.opacity = 0.2; }); } } @ObservedV2 class TileHighlight { @Trace isValidMove: boolean = false; } @Entry @Component struct OthelloGame { @State chessBoard: ChessCell[][] = []; @State cellSize: number = 70; @State cellSpacing: number = 5; @State transitionDuration: number = 200; @State @Watch('currentPlayerIsBlackChanged') currentPlayerIsBlack: boolean = true; // 先手，true表示黑棋 @State chessBoardSize: number = 8; // 假设棋盘大小为8×8 @State validMoveIndicators: TileHighlight [][] = [] @State isTwoPlayerMode: boolean = false; //true:双击游戏，false:单人游戏 @State isAIPlaying:boolean = false//true:AI正在下棋 currentPlayerIsBlackChanged() { setTimeout(() =\u003e { const color = this.currentPlayerIsBlack ? 1 : 2; // 1是黑子，2表示白子 let hasMoves = this.hasValidMoves(color); if (!hasMoves) { let opponentHasMoves = this.hasValidMoves(!this.currentPlayerIsBlack ? 1 : 2); if (!opponentHasMoves) { const winner = this.determineWinner(); console.log(winner); promptAction.showDialog({ title: '游戏结束', message: `${winner}`, buttons: [{ text: '重新开始', color: '#ffa500' }] }).then(() =\u003e { this.initGame(); }); } else { this.currentPlayerIsBlack = !this.currentPlayerIsBlack; // 切换下一玩家 } } else { if (!this.currentPlayerIsBlack) { // 当前是白棋, 模拟AI下棋 if (!this.isTwoPlayerMode) { setTimeout(() =\u003e { this.aiPlaceRandom(); }, this.transitionDuration + 20); } } } }, this.transitionDuration + 20); } aiPlaceRandom() { let validMoves: [number, number][] = []; for (let i = 0; i \u003c this.validMoveIndicators.length; i++) { for (let j = 0; j \u003c this.validMoveIndicators[i].length; j++) { if (this.validMoveIndicators[i][j].isValidMove) { validMoves.push([i, j]); } } } if (validMoves.length \u003e 0) { const randomMove = validMoves[Math.floor(Math.random() * validMoves.length)]; let chessCell = this.chessBoard[randomMove[0]][randomMove[1]]; this.placeChessPiece(randomMove[0], randomMove[1], chessCell) } } placeChessPiece(i: number, j: number, chessCell: ChessCell) { let reversibleTiles = this.findReversible(i, j, this.currentPlayerIsBlack ? 1 : 2); console.info(`reversibleTiles:${JSON.stringify(reversibleTiles)}`); if (reversibleTiles.length \u003e 0) { if (this.currentPlayerIsBlack) { this.currentPlayerIsBlack = false; chessCell.showBlack(0); for (let i = 0; i \u003c reversibleTiles.length; i++) { reversibleTiles[i].flip(this.transitionDuration); } } else { this.currentPlayerIsBlack = true; if (this.isTwoPlayerMode) { //双人游戏，无动画 chessCell.showWhite(0); for (let i = 0; i \u003c reversibleTiles.length; i++) { reversibleTiles[i].flip(this.transitionDuration); } } else { //单人游戏，落子需要闪烁动画 this.isAIPlaying = true//AI 正在下棋 chessCell.showWhiteAi(this.transitionDuration, () =\u003e { for (let i = 0; i \u003c reversibleTiles.length; i++) { reversibleTiles[i].flip(this.transitionDuration); } this.currentPlayerIsBlackChanged() this.isAIPlaying = false//AI下完了 }); } } } } hasValidMoves(color: number) { let hasMoves = false; for (let row = 0; row \u003c this.chessBoardSize; row++) { for (let col = 0; col \u003c this.chessBoardSize; col++) { if (this.chessBoard[row][col].frontVisibility === 0 \u0026\u0026 this.findReversible(row, col, color).length \u003e 0) { this.validMoveIndicators[row][col].isValidMove = true; hasMoves = true; } else { this.validMoveIndicators[row][col].isValidMove = false; } } } return hasMoves; } aboutToAppear(): void { for (let i = 0; i \u003c this.chessBoardSize; i++) { this.chessBoard.push([]); this.validMoveIndicators.push([]) for (let j = 0; j \u003c this.chessBoardSize; j++) { this.chessBoard[i].push(new ChessCell()); this.validMoveIndicators[i].push(new TileHighlight()) } } this.initGame() } initGame() { this.currentPlayerIsBlack = true for (let i = 0; i \u003c this.chessBoardSize; i++) { for (let j = 0; j \u003c this.chessBoardSize; j++) { this.chessBoard[i][j].frontVisibility = 0 } } // 初始棋盘布局 this.chessBoard[3][3].frontVisibility = 2; this.chessBoard[3][4].frontVisibility = 1; this.chessBoard[4][3].frontVisibility = 1; this.chessBoard[4][4].frontVisibility = 2; this.currentPlayerIsBlackChanged(); } findReversible(row: number, col: number, color: number): ChessCell[] { let reversibleTiles: ChessCell[] = []; const directions = [ [-1, -1], // 左上 [-1, 0], // 正上 [-1, 1], // 右上 [0, -1], // 左 [0, 1], // 右 [1, -1], // 左下 [1, 0], // 正下 [1, 1]// 右下 ]; for (const direction of directions) { let foundOpposite = false; let x = row; let y = col; do { x += direction[0]; y += direction[1]; if (x \u003c 0 || y \u003c 0 || x \u003e= this.chessBoardSize || y \u003e= this.chessBoardSize) { break; } const cell = this.chessBoard[x][y]; if (cell.frontVisibility === 0) { break; } if (cell.frontVisibility === color) { if (foundOpposite) { let tempX: number = x - direction[0]; let tempY: number = y - direction[1]; while (tempX !== row || tempY !== col) { reversibleTiles.push(this.chessBoard[tempX][tempY]); tempX -= direction[0]; tempY -= direction[1]; } } break; } else { foundOpposite = true; } } while (true); } return reversibleTiles; } determineWinner(): string { let blackCount = 0; let whiteCount = 0; for (let row of this.chessBoard) { for (let cell of row) { if (cell.frontVisibility === 1) { blackCount++; } if (cell.frontVisibility === 2) { whiteCount++; } } } if (blackCount \u003e whiteCount) { return \"黑棋获胜！\"; } if (whiteCount \u003e blackCount) { return \"白棋获胜！\"; } return \"平局！\"; } hasValidMove(color: number): boolean { for (let row = 0; row \u003c this.chessBoardSize; row++) { for (let col = 0; col \u003c this.chessBoardSize; col++) { if (this.chessBoard[row][col].frontVisibility === 0 \u0026\u0026 this.findReversible(row, col, color).length \u003e 0) { return true; } } } return false; } build() { Column({ space: 20 }) { Row() { Row() { Text(``)// 显示单元格的值或空字符串 .width(`${this.cellSize}lpx`)// 设置宽度 .height(`${this.cellSize}lpx`)// 设置高度 .textAlign(TextAlign.Center)// 文本居中 .backgroundColor(Color.Black)// 设置背景颜色 .borderRadius('50%')// 设置圆角 .padding(10) Text(`黑棋行动`) .fontColor(Color.White) .padding(10) } .visibility(this.currentPlayerIsBlack ? Visibility.Visible : Visibility.Hidden) Row() { Text(`白棋行动`) .fontColor(Color.White) .padding(10) Text()// 显示单元格的值或空字符串 .width(`${this.cellSize}lpx`)// 设置宽度 .height(`${this.cellSize}lpx`)// 设置高度 .textAlign(TextAlign.Center)// 文本居中 .backgroundColor(Color.White)// 设置背景颜色 .fontColor(Color.White) .borderRadius('50%')// 设置圆角 .padding(10) } .visibility(!this.currentPlayerIsBlack ? Visibility.Visible : Visibility.Hidden) } .width(`${(this.cellSize + this.cellSpacing * 2) * 8}lpx`) // 设置宽度 .justifyContent(FlexAlign.SpaceBetween) .margin({ top: 20 }) Stack() { //棋盘背景 Flex({ wrap: FlexWrap.Wrap }) { ForEach(this.validMoveIndicators, (row: boolean[], _rowIndex: number) =\u003e { ForEach(row, (item: TileHighlight, _colIndex: number) =\u003e { Text(`${item.isValidMove ? '+' : ''}`)// 显示单元格的值或空字符串 .width(`${this.cellSize}lpx`)// 设置宽度 .height(`${this.cellSize}lpx`)// 设置高度 .margin(`${this.cellSpacing}lpx`) .fontSize(`${this.cellSize / 2}lpx`)// 设置字体大小 .fontColor(Color.White) .textAlign(TextAlign.Center)// 文本居中 .backgroundColor(Color.Gray)// 设置背景颜色 .borderRadius(2) // 设置圆角 }); }); } .width(`${(this.cellSize + this.cellSpacing * 2) * 8}lpx`) // 设置宽度 //棋子 Flex({ wrap: FlexWrap.Wrap }) { ForEach(this.chessBoard, (row: ChessCell[], rowIndex: number) =\u003e { ForEach(row, (chessCell: ChessCell, colIndex: number) =\u003e { Text(``)// 显示单元格的值或空字符串 .width(`${this.cellSize}lpx`)// 设置宽度 .height(`${this.cellSize}lpx`)// 设置高度 .margin(`${this.cellSpacing}lpx`)// 设置边距 .fontSize(`${this.cellSize / 2}lpx`)// 设置字体大小 .textAlign(TextAlign.Center)// 文本居中 .opacity(chessCell.opacity) .backgroundColor(chessCell.frontVisibility != 0 ? (chessCell.frontVisibility === 1 ? Color.Black : Color.White) : Color.Transparent)// 设置背景颜色 .borderRadius('50%')// 设置圆角 .rotate({ // 设置旋转 x: 0, y: 1, z: 0, angle: chessCell.rotationAngle, // 旋转角度 centerX: `${this.cellSize / 2}lpx`, // 中心点X坐标 centerY: `${this.cellSize / 2}lpx`, // 中心点Y坐标 }) .onClick(() =\u003e { // 单击事件处理 if (this.isAIPlaying) { console.info(`ai正在落子，玩家不可继续落子`) return; } if (chessCell.frontVisibility === 0) { // 没有棋子，需要落子 this.placeChessPiece(rowIndex, colIndex, chessCell) } }); }); }); } .width(`${(this.cellSize + this.cellSpacing * 2) * 8}lpx`) // 设置宽度 } .padding(`${this.cellSpacing}lpx`) .backgroundColor(Color.Black) Row() { Text(`${this.isTwoPlayerMode? '双人游戏' : '单人游戏'}`) .height(50) .padding({ left: 10 }) .fontSize(16) .textAlign(TextAlign.Start) .backgroundColor(0xFFFFFF) Toggle({ type: ToggleType.Switch, isOn: this.isTwoPlayerMode }) .margin({ left: 200, right: 10 }) .onChange((isOn: boolean) =\u003e { this.isTwoPlayerMode = isOn }) } .backgroundColor(0xFFFFFF) .borderRadius(5) Button('重新开始').onClick(() =\u003e { // 按钮点击事件 this.initGame() }); } .height('100%').width('100%') // 设置高度和宽度 .backgroundColor(Color.Orange) } } nine-square 九宫格抽奖\n// 定义一个可观察的Prize类，用于表示奖品信息。 @ObservedV2 class Prize { @Trace title: string // 奖品标题属性，使用@Trace进行追踪以便响应式更新UI @Trace color: string // 奖品颜色属性 @Trace description: string // 奖品描述属性 // 构造函数，用来初始化新的奖品实例 constructor(title: string, color: string, description: string = \"\") { this.title = title // 设置奖品标题 this.color = color // 设置奖品颜色 this.description = description // 设置奖品描述，默认为空字符串 } } // 定义MyPrizeUpdate结构组件，用于显示和编辑选中的奖品信息 @Component struct MyPrizeUpdate { @Consume selectedIndex: number // 当前选中的奖品索引 @Consume private selectionOrder: number[] // 保存抽奖顺序的数组 @Consume private prizeArray: Prize[] // 保存所有奖品的数组 build() { Column({ space: 20 }) { // 创建列布局容器，设置子元素之间的间距为20px Row() { // 创建行布局容器 Text('标题：') // 显示“标题”文本 TextInput({ text: this.prizeArray[this.selectionOrder[this.selectedIndex%this.selectionOrder.length]].title }) .width('300lpx') // 设置输入框宽度 .onChange((value) =\u003e { // 监听输入框内容变化 this.prizeArray[this.selectionOrder[this.selectedIndex%this.selectionOrder.length]].title = value // 更新奖品标题 }) } Row() { Text('描述：') TextInput({ text: `${this.prizeArray[this.selectionOrder[this.selectedIndex%this.selectionOrder.length]].description}` }).width('300lpx').onChange((value) =\u003e { // 同上，但针对奖品描述 this.prizeArray[this.selectionOrder[this.selectedIndex%this.selectionOrder.length]].description = value }) } Row() { Text('颜色：') TextInput({ text: `${this.prizeArray[this.selectionOrder[this.selectedIndex%this.selectionOrder.length]].color}` }).width('300lpx').onChange((value) =\u003e { // 同上，但针对奖品颜色 this.prizeArray[this.selectionOrder[this.selectedIndex%this.selectionOrder.length]].color = value }) } } .justifyContent(FlexAlign.Start) // 设置内容左对齐 .padding(40) // 设置内边距 .width('100%') // 设置宽度为100% .backgroundColor(Color.White) // 设置背景颜色为白色 } } // 定义抽奖页面入口组件 @Entry @Component struct LotteryPage { @Provide private selectedIndex: number = 0 // 提供当前选中的索引，初始值为0 private isAnimating: boolean = false // 标记是否正在进行动画，初始值为false @Provide private selectionOrder: number[] = [0, 1, 2, 5, 8, 7, 6, 3] // 定义抽奖顺序 private cellWidth: number = 200 // 单元格宽度 private baseMargin: number = 10 // 单元格边距 @Provide private prizeArray: Prize[] = [ new Prize(\"红包\", \"#ff9675\", \"10元\"), // 初始化奖品数组，创建各种奖品对象 new Prize(\"话费\", \"#ff9f2e\", \"5元\"), new Prize(\"红包\", \"#8e7fff\", \"50元\"), new Prize(\"红包\", \"#48d1ea\", \"30元\"), new Prize(\"开始抽奖\", \"#fffdfd\"), // 抽奖按钮，没有具体奖品描述 new Prize(\"谢谢参与\", \"#5f5f5f\"), new Prize(\"谢谢参与\", \"#5f5f5f\"), new Prize(\"超市红包\", \"#5f5f5f\", \"100元\"), new Prize(\"鲜花\", \"#75b0fe\"), ] private intervalID: number = 0 // 定时器ID，用于控制抽奖速度 @State isSheetVisible: boolean = false // 控制底部弹出表单的可见性 // 开始抽奖逻辑 startLottery(speed: number = 500) { setTimeout(() =\u003e { // 设置延时执行 if (speed \u003e 50) { // 如果速度大于50，则递归调用startLottery以逐渐加速 speed -= 50 this.startLottery(speed) } else { this.runAtConstantSpeed() // 达到最高速度后进入匀速阶段 return } this.selectedIndex++ // 每次调用时更新选中索引 }, speed) } // 以恒定速度运行抽奖 runAtConstantSpeed() { let speed = 40 + Math.floor(Math.random() * this.selectionOrder.length) // 随机生成一个速度值 clearInterval(this.intervalID) // 清除之前的定时器 this.intervalID = setInterval(() =\u003e { // 设置新的定时器来更新选中索引 if (this.selectedIndex \u003e= speed) { // 如果选中索引达到速度值，停止并进入减速阶段 clearInterval(this.intervalID) this.slowDown() return } this.selectedIndex++ }, 50) } // 减速逻辑 slowDown(speed = 50) { setTimeout(() =\u003e { // 设置延时执行 if (speed \u003c 500) { // 如果速度小于500，则递归调用slowDown以逐渐减速 speed += 50 this.slowDown(speed) } else { this.selectedIndex %= this.selectionOrder.length // 确保索引在有效范围内 let index = this.selectionOrder[this.selectedIndex] // 获取最终选中的奖品索引 this.isAnimating = false // 动画结束 this.getUIContext().showAlertDialog({ // 显示结果对话框 title: '结果', message: `${this.prizeArray[index].title}${this.prizeArray[index].description}`, // 显示奖品信息 confirm: { defaultFocus: true, value: '我知道了', // 确认按钮文本 action: () =\u003e {} // 点击确认后的操作 }, alignment: DialogAlignment.Center, }); return } this.selectedIndex++ }, speed) } // 构建UI方法 build() { Column() { // 使用Column布局容器 Flex({ wrap: FlexWrap.Wrap }) { // 使用弹性布局，允许换行 ForEach(this.prizeArray, (item: Prize, index: number) =\u003e { // 遍历奖品数组，创建每个奖品的UI Column() { // 使用Column布局容器为每个奖品项 Text(`${item.title}`) // 显示奖品标题 .fontColor(index == 4 ? Color.White : item.color) // 设置字体颜色，对于抽奖按钮特殊处理 .fontSize(16) Text(`${item.description}`) // 显示奖品描述 .fontColor(index == 4 ? Color.White : item.color) // 设置字体颜色 .fontSize(20) } .clickEffect({ level: ClickEffectLevel.LIGHT, scale: 0.8 }) // 添加点击效果 .onClick(() =\u003e { // 处理点击事件 if (this.isAnimating) { // 如果正在动画中，忽略点击 return } if (index == 4) { // 如果点击的是抽奖按钮，开始抽奖 this.isAnimating = true this.startLottery() } else { for (let i = 0; i \u003c this.selectionOrder.length; i++) { if (this.selectionOrder[i] == index) { this.selectedIndex = i // 更新选中索引到对应位置 } } } }) .alignItems(HorizontalAlign.Center) // 设置水平居中对齐 .justifyContent(FlexAlign.Center) // 设置垂直居中对齐 .width(`${this.cellWidth}lpx`) // 设置单元格宽度 .height(`${this.cellWidth}lpx`) // 设置单元格高度 .margin(`${this.baseMargin}lpx`) // 设置单元格边距 .backgroundColor(index == 4 ? \"#ff5444\" : // 抽奖按钮背景颜色特殊处理 (this.selectionOrder[this.selectedIndex % this.selectionOrder.length] == index ? Color.Gray : Color.White)) .borderRadius(10) // 设置圆角 .shadow({ // 设置阴影效果 radius: 10, color: \"#f98732\", offsetX: 0, offsetY: 20 }) }) }.width(`${this.cellWidth * 3 + this.baseMargin * 6}lpx`) // 设置整体宽度 .margin({ top: 30 }) // 设置顶部边距 MyPrizeUpdate().margin({top:20}) // 插入MyPrizeUpdate组件，并设置其上边距 } .height('100%') // 设置高度为100% .width('100%') // 设置宽度为100% .backgroundColor(\"#ffb350\") // 设置页面背景颜色 } } LotteryPage入口组件LotteryPage是整个抽奖应用的核心组件，负责组织页面布局和处理用户交互逻辑。它初始化了一系列必要的状态变量，比如保存所有奖品的数组prizeArray、定义抽奖顺序的selectionOrder以及控制动画状态的isAnimating等。此外，该组件实现了抽奖过程的关键方法——startLottery（开始抽奖）、runAtConstantSpeed（匀速运行）和slowDown（减速），它们共同协作以模拟真实的抽奖体验。当用户点击抽奖按钮时，这些方法按照预定的速度模式依次调用，直到最终确定一个奖品为止。最后，通过弹出对话框的方式向用户展示抽奖结果。\nblood 血型计算\n// 导入SegmentButton及其相关类型定义 import { SegmentButton, SegmentButtonItemTuple, SegmentButtonOptions } from '@kit.ArkUI'; // 使用@Entry装饰器标记此组件为入口点 @Entry // 使用@Component装饰器标记此结构体为一个组件 @Component // 定义一个名为BloodTypeCalculator的结构体，用于实现血型遗传计算功能 struct BloodTypeCalculator { // 定义主题颜色，默认为橙色 @State private themeColor: string | Color = Color.Orange; // 定义文本颜色，默认为深灰色 @State private textColor: string = \"#2e2e2e\"; // 定义边框颜色，默认为浅灰色 @State private lineColor: string = \"#d5d5d5\"; // 定义基础内边距大小，默认为30 @State private basePadding: number = 30; // 存储可能的血型结果 @State private possibleBloodTypesText: string = \"\"; // 存储不可能的血型结果 @State private impossibleBloodTypesText: string = \"\"; // 定义血型列表，包含A、B、AB、O四种血型 @State private bloodTypeList: object[] = [Object({ text: 'A' }), Object({ text: 'B' }), Object({ text: 'AB' }), Object({ text: 'O' })]; // 初始化单选胶囊按钮的配置项 @State singleSelectCapsuleOptions: SegmentButtonOptions | undefined = undefined; // 监听父亲血型选择变化 @State @Watch('capsuleSelectedIndexesChanged') fatherBloodTypeIndex: number[] = [0]; // 监听母亲血型选择变化 @State @Watch('capsuleSelectedIndexesChanged') motherBloodTypeIndex: number[] = [0]; // 根据血型获取其可能的基因组合 getGenes(bloodType: string): string[] { console.info(`bloodType:${bloodType}`); switch (bloodType) { case 'A': return ['A', 'O']; // A型血可能的基因组合 case 'B': return ['B', 'O']; // B型血可能的基因组合 case 'AB': return ['A', 'B']; // AB型血可能的基因组合 case 'O': return ['O']; // O型血可能的基因组合 default: throw new Error('Invalid blood type'); // 非法血型抛出错误 } } // 组合父母的基因以获得子代可能的基因组合 combineGenes(fatherGenes: string[], motherGenes: string[]): string[] { const possibleGenes: string[] = []; // 用于存储可能的基因组合 for (const fatherGene of fatherGenes) { for (const motherGene of motherGenes) { const combinedGene = [fatherGene, motherGene].sort().join(''); // 将父母的基因组合并排序后加入数组 if (!possibleGenes.includes(combinedGene)) { possibleGenes.push(combinedGene); // 如果组合尚未存在，则加入数组 } } } return possibleGenes; // 返回所有可能的基因组合 } // 根据基因组合确定血型 getBloodTypesFromGenes(genes: string[]): string[] { const bloodTypes: string[] = []; // 用于存储可能的血型 for (const gene of genes) { if (gene === 'AA' || gene === 'AO' || gene === 'OA') { bloodTypes.push('A'); // 基因组合为AA、AO或OA时，血型为A } else if (gene === 'BB' || gene === 'BO' || gene === 'OB') { bloodTypes.push('B'); // 基因组合为BB、BO或OB时，血型为B } else if (gene === 'AB' || gene === 'BA') { bloodTypes.push('AB'); // 基因组合为AB或BA时，血型为AB } else if (gene === 'OO') { bloodTypes.push('O'); // 基因组合为OO时，血型为O } } // 去除重复的血型 return bloodTypes.filter((value, index, self) =\u003e self.indexOf(value) === index); } // 计算孩子可能的血型及不可能的血型 calculatePossibleBloodTypes(father: string, mother: string) { const fatherGenes = this.getGenes(father); // 获取父亲的基因组合 const motherGenes = this.getGenes(mother); // 获取母亲的基因组合 const possibleGenes = this.combineGenes(fatherGenes, motherGenes); // 组合父母的基因 const possibleBloodTypes = this.getBloodTypesFromGenes(possibleGenes); // 从基因组合中获取可能的血型 const allBloodTypes: string[] = ['A', 'B', 'AB', 'O']; // 所有可能的血型列表 const impossibleBloodTypes = allBloodTypes.filter(bt =\u003e !possibleBloodTypes.includes(bt)); // 计算不可能的血型 console.log(this.possibleBloodTypesText = `孩子可能血型：${possibleBloodTypes.join('、')}`); // 显示可能的血型 console.log(this.impossibleBloodTypesText = `孩子不可能血型：${impossibleBloodTypes.join('、')}`); // 显示不可能的血型 } // 当胶囊按钮的选择发生变化时调用此函数 capsuleSelectedIndexesChanged() { let father: string = this.bloodTypeList[this.fatherBloodTypeIndex[0]]['text']; // 获取父亲选择的血型 let mother: string = this.bloodTypeList[this.motherBloodTypeIndex[0]]['text']; // 获取母亲选择的血型 this.calculatePossibleBloodTypes(father, mother); // 计算并更新血型信息 } // 在组件即将出现时调用此函数 aboutToAppear(): void { this.singleSelectCapsuleOptions = SegmentButtonOptions.capsule({ buttons: this.bloodTypeList as SegmentButtonItemTuple, // 设置胶囊按钮的选项 multiply: false, // 单选模式 fontColor: Color.White, // 字体颜色为白色 selectedFontColor: Color.White, // 选中时字体颜色为白色 selectedBackgroundColor: this.themeColor, // 选中背景色为主题色 backgroundColor: this.lineColor, // 背景色为边框颜色 backgroundBlurStyle: BlurStyle.BACKGROUND_THICK // 背景模糊效果 }); this.capsuleSelectedIndexesChanged(); // 初始化时调用选择变化处理函数 } // 构建用户界面 build() { Column() { // 页面标题 Text('血型遗传计算') .fontColor(this.textColor) // 文本颜色 .fontSize(18) // 字体大小 .width('100%') // 宽度为100% .height(50) // 高度为50 .textAlign(TextAlign.Center) // 文本居中对齐 .backgroundColor(Color.White) // 背景色为白色 .shadow({ // 添加阴影效果 radius: 2, // 阴影半径 color: this.lineColor, // 阴影颜色 offsetX: 0, // 水平偏移量 offsetY: 5 // 垂直偏移量 }); // 工具介绍部分 Column() { Text('工具介绍').fontSize(20).fontWeight(600).fontColor(this.textColor); Text('血型是以A、B、O三种遗传因子的组合而决定的，根据父母的血型，就可以判断出以后出生的孩子的血型。') .fontSize(18).fontColor(this.textColor).margin({ top: `${this.basePadding / 2}lpx` }); } .alignItems(HorizontalAlign.Start) .width('650lpx') .padding(`${this.basePadding}lpx`) .margin({ top: `${this.basePadding}lpx` }) .borderRadius(10) .backgroundColor(Color.White) .shadow({ radius: 10, color: this.lineColor, offsetX: 0, offsetY: 0 }); // 父亲血型选择部分 Column() { Row() { Text('父亲血型').fontColor(this.textColor).fontSize(18); SegmentButton({ options: this.singleSelectCapsuleOptions, // 胶囊按钮的配置项 selectedIndexes: this.fatherBloodTypeIndex // 当前选中的索引 }).width('400lpx'); }.height(45).justifyContent(FlexAlign.SpaceBetween).width('100%'); // 母亲血型选择部分 Row() { Text('母亲血型').fontColor(this.textColor).fontSize(18); SegmentButton({ options: this.singleSelectCapsuleOptions, // 胶囊按钮的配置项 selectedIndexes: this.motherBloodTypeIndex // 当前选中的索引 }).width('400lpx'); }.height(45).justifyContent(FlexAlign.SpaceBetween).width('100%'); } .alignItems(HorizontalAlign.Start) .width('650lpx') .padding(`${this.basePadding}lpx`) .margin({ top: `${this.basePadding}lpx` }) .borderRadius(10) .backgroundColor(Color.White) .shadow({ radius: 10, color: this.lineColor, offsetX: 0, offsetY: 0 }); // 显示计算结果 Column() { Row() { Text(this.possibleBloodTypesText).fontColor(this.textColor).fontSize(18); }.height(45).justifyContent(FlexAlign.SpaceBetween).width('100%'); Row() { Text(this.impossibleBloodTypesText).fontColor(this.textColor).fontSize(18); }.height(45).justifyContent(FlexAlign.SpaceBetween).width('100%'); } .alignItems(HorizontalAlign.Start) .width('650lpx') .padding(`${this.basePadding}lpx`) .margin({ top: `${this.basePadding}lpx` }) .borderRadius(10) .backgroundColor(Color.White) .shadow({ radius: 10, color: this.lineColor, offsetX: 0, offsetY: 0 }); } .height('100%') .width('100%') .backgroundColor(\"#f4f8fb\"); // 页面背景色 } } compass 指南针\n传感器 角度计算\nimport { sensor } from '@kit.SensorServiceKit'; // 导入传感器服务模块 import { BusinessError } from '@kit.BasicServicesKit'; // 导入业务错误处理模块 // 定义方向范围类 class DirectionRange { name: string = ''; // 方向名称 min: number = 0; // 最小角度 max: number = 0; // 最大角度 } // 定义各个方向的范围 const DIRECTION_RANGES: DirectionRange[] = [ { name: '北', min: 337.5, max: 360 }, { name: '北', min: 0, max: 22.5 }, { name: '东北', min: 22.5, max: 67.5 }, { name: '东', min: 67.5, max: 112.5 }, { name: '东南', min: 112.5, max: 157.5 }, { name: '南', min: 157.5, max: 202.5 }, { name: '西南', min: 202.5, max: 247.5 }, { name: '西', min: 247.5, max: 292.5 }, { name: '西北', min: 292.5, max: 337.5 } ]; // 定义指南针组件 @Entry @Component struct Compass { @State directionMessage: string = ''; // 当前方向的名称 @State rotationAngle: number = 0; // 当前旋转角度 @State currentAngle: number = 0; // 当前传感器角度 @State cumulativeRotation: number = 0; // 累计旋转角度 private threshold: number = 1; // 设置阈值，用于过滤小的旋转变化 // 组件即将出现时调用 aboutToAppear(): void { sensor.getSensorList((error: BusinessError) =\u003e { if (error) { console.error('获取传感器列表失败', error); // 如果获取传感器列表失败，打印错误信息 return; } this.startOrientationUpdates(); // 开始监听传感器数据 }); } // 开始监听传感器的方位数据 private startOrientationUpdates(): void { sensor.on(sensor.SensorId.ORIENTATION, (orientationData) =\u003e { const alpha = orientationData.alpha; // 获取当前的方位角 this.directionMessage = this.calculateDirection(alpha); // 计算当前方向 const angleDifference = this.calculateAngleDifference(this.currentAngle, alpha); // 计算角度差 if (Math.abs(angleDifference) \u003e this.threshold) { // 如果角度变化超过阈值 this.updateRotationAngle(angleDifference, alpha); // 更新旋转角度 } }, { interval: 10000000 }); // 设置传感器更新间隔，单位为纳秒，10000000表示1秒 } // 计算两个角度之间的差异 private calculateAngleDifference(currentAngle: number, targetAngle: number): number { let diff = targetAngle - currentAngle; // 计算角度差 if (diff \u003e 180) { diff -= 360; // 顺时针旋转超过180度，调整为负值 } else if (diff \u003c -180) { diff += 360; // 逆时针旋转超过180度，调整为正值 } return diff; // 返回调整后的角度差 } // 更新旋转角度 private updateRotationAngle(angleDifference: number, newAngle: number): void { this.cumulativeRotation += angleDifference; // 累加旋转角度 this.rotationAngle += angleDifference; // 更新当前旋转角度 this.currentAngle = newAngle; // 更新当前传感器角度 // 动画更新 animateToImmediately({}, () =\u003e { this.rotationAngle = this.cumulativeRotation; // 将旋转角度设置为累计旋转角度 }); console.log(`累计旋转角度: ${this.cumulativeRotation}`); // 打印累计旋转角度 } // 根据角度计算方向 private calculateDirection(angle: number): string { for (const range of DIRECTION_RANGES) { if (angle \u003e= range.min \u0026\u0026 angle \u003c range.max) { return range.name; // 返回对应的方向名称 } } return '未知方向'; // 如果角度不在任何范围内，返回未知方向 } // 构建用户界面 build() { Column({ space: 20 }) { // 创建一个列布局，设置间距为20 Row({ space: 5 }) { // 创建一个行布局，设置间距为5 Text(this.directionMessage) // 显示当前方向 .layoutWeight(1) // 设置布局权重 .textAlign(TextAlign.End) // 文本对齐方式 .fontColor('#dedede') // 文本颜色 .fontSize(50); // 文本大小 Text(`${Math.floor(this.currentAngle)}°`) // 显示当前角度 .layoutWeight(1) // 设置布局权重 .textAlign(TextAlign.Start) // 文本对齐方式 .fontColor('#dedede') // 文本颜色 .fontSize(50); // 文本大小 }.width('100%').margin({ top: 50 }); // 设置宽度和上边距 Stack() { // 创建一个堆叠布局 Stack() { // 内部堆叠布局 Circle() // 创建一个圆形 .width(250) // 设置宽度 .height(250) // 设置高度 .fillOpacity(0) // 设置填充透明度 .strokeWidth(25) // 设置边框宽度 .stroke('#f95941') // 设置边框颜色 .strokeDashArray([1, 5]) // 设置边框虚线样式 .strokeLineJoin(LineJoinStyle.Round); // 设置边框连接方式 Text('北') // 创建一个文本，显示“北” .height('100%') // 设置高度 .width(40) // 设置宽度 .align(Alignment.Top) // 设置对齐方式 .fontColor('#ff4f3f') // 设置文本颜色 .rotate({ angle: 0 }) // 设置旋转角度 .padding({ top: 80 }) // 设置内边距 .textAlign(TextAlign.Center); // 设置文本对齐方式 Text('东') // 创建一个文本，显示“东” .height('100%') // 设置高度 .width(40) // 设置宽度 .align(Alignment.Top) // 设置对齐方式 .fontColor('#fcfdfd') // 设置文本颜色 .rotate({ angle: 90 }) // 设置旋转角度 .padding({ top: 80 }) // 设置内边距 .textAlign(TextAlign.Center); // 设置文本对齐方式 Text('南') // 创建一个文本，显示“南” .height('100%') // 设置高度 .width(40) // 设置宽度 .align(Alignment.Top) // 设置对齐方式 .fontColor('#fcfdfd') // 设置文本颜色 .rotate({ angle: 180 }) // 设置旋转角度 .padding({ top: 80 }) // 设置内边距 .textAlign(TextAlign.Center); // 设置文本对齐方式 Text('西') // 创建一个文本，显示“西” .height('100%') // 设置高度 .width(40) // 设置宽度 .align(Alignment.Top) // 设置对齐方式 .fontColor('#fcfdfd') // 设置文本颜色 .rotate({ angle: 270 }) // 设置旋转角度 .padding({ top: 80 }) // 设置内边距 .textAlign(TextAlign.Center); // 设置文本对齐方式 } .width('100%') // 设置宽度 .height('100%') // 设置高度 .borderRadius('50%') // 设置圆角 .margin({ top: 50 }) // 设置上边距 .rotate({ angle: -this.rotationAngle }) // 设置旋转角度 .animation({}); // 设置动画效果 Line() // 创建一个线条 .width(5) // 设置宽度 .height(40) // 设置高度 .backgroundColor('#fdfffe') // 设置背景颜色 .borderRadius('50%') // 设置圆角 .margin({ bottom: 200 }); // 设置下边距 } .width(300) // 设置宽度 .height(300); // 设置高度 } .height('100%') // 设置高度 .width('100%') // 设置宽度 .backgroundColor('#18181a'); // 设置背景颜色 } } level 水平仪\n//module.json5 { \"module\": { \"requestPermissions\": [ { \"name\": \"ohos.permission.ACCELEROMETER\" } ], } // 导入传感器服务模块 import { sensor } from '@kit.SensorServiceKit'; // 导入业务错误处理模块 import { BusinessError } from '@kit.BasicServicesKit'; // 定义单位长度，用于后续计算中的比例尺 const UNIT_LENGTH = 4; // 使用 @Entry 和 @Component 装饰器定义一个名为 LevelMeter 的组件 @Entry @Component struct LevelMeter { // 定义状态变量，用于存储当前角度 @State angle: number = 0; // 定义状态变量，用于存储前后倾斜角度（pitch） @State pitch: number = 0; // 定义状态变量，用于存储左右倾斜角度（roll） @State roll: number = 0; // 定义角度变化阈值，用于判断是否需要更新角度 private threshold: number = 1; // 组件即将出现时的生命周期方法 aboutToAppear(): void { // 获取传感器列表 sensor.getSensorList((error: BusinessError) =\u003e { if (error) { // 如果获取传感器列表失败，输出错误信息 console.error('获取传感器列表失败', error); return; } // 开始更新方向信息 this.startOrientationUpdates(); }); } // 启动方向更新的方法 private startOrientationUpdates(): void { // 注册加速度传感器事件监听器 sensor.on(sensor.SensorId.ACCELEROMETER, (data) =\u003e { // 计算新的前后倾斜角度（pitch） const newPitch = Math.atan(data.y / Math.sqrt(data.x * data.x + data.z * data.z)) * (180 / Math.PI); // 计算新的左右倾斜角度（roll） const newRoll = Math.atan(data.x / Math.sqrt(data.y * data.y + data.z * data.z)) * (180 / Math.PI); // 如果新的角度变化超过阈值，则更新状态 if (Math.abs(newPitch - this.pitch) \u003e this.threshold || Math.abs(newRoll - this.roll) \u003e this.threshold) { this.pitch = newPitch; this.roll = newRoll; // 更新当前角度 this.angle = Math.hypot(newPitch, newRoll); } }, { interval: 100000000 }); // 设置更新间隔为100毫秒 } // 计算小球位置的方法 private calculateBallPosition(): Position { // 根据当前角度计算半径 const radius = (this.angle \u003c= 10 ? this.angle * 2.5 : (10 * 2.5 + (this.angle - 10))) * UNIT_LENGTH; // 将角度转换为弧度 const angleInRadians = Math.atan2(this.pitch, this.roll); // 计算小球在圆周上的X坐标 const x = -radius * Math.cos(angleInRadians); // 计算小球在圆周上的Y坐标 const y = radius * Math.sin(angleInRadians); // 返回小球的位置 return { x, y }; } // 构建UI的方法 build() { // 使用Stack布局容器 Stack() { // 显示当前角度的文本 Stack() { Row({ space: 5 }) { // 创建一个行布局，设置间距为5 Text(`${Math.floor(this.angle)}°`)// 显示当前角度 .layoutWeight(1)// 设置布局权重 .textAlign(TextAlign.Center)// 文本对齐方式 .fontColor('#dedede')// 文本颜色 .fontSize(60); // 文本大小 }.width('100%').margin({ top: 80 }) // 设置宽度和上边距 }.height('100%').align(Alignment.Top) // 设置高度和对齐方式 // 模拟水平仪背景的圆环 Stack() { // 外部大圆 Text() .width('600lpx')// 设置宽度 .height('600lpx')// 设置高度 .borderRadius('50%')// 设置圆角 .backgroundColor(\"#171b1e\")// 设置背景颜色 .blur(50)// 设置模糊效果 .shadow({ radius: 300, type: ShadowType.COLOR, color: \"#232426\" }); // 设置阴影效果 // 中间圆 Text() .width(`${(this.angle \u003c= 10 ? this.angle * 2.5 : (10 * 2.5 + (this.angle - 10))) * UNIT_LENGTH * 2}lpx`)// 计算宽度 .height(`${(this.angle \u003c= 10 ? this.angle * 2.5 : (10 * 2.5 + (this.angle - 10))) * UNIT_LENGTH * 2}lpx`)// 计算高度 .borderRadius('50%')// 设置圆角 .backgroundColor(\"#2e3235\")// 设置背景颜色 .animation({ curve: Curve.EaseOut }); // 设置动画效果 // 刻度线 ForEach([10, 20, 30, 40, 50], (item: number) =\u003e { Text() .width(`${(15 + item) * UNIT_LENGTH * 2}lpx`)// 计算宽度 .height(`${(15 + item) * UNIT_LENGTH * 2}lpx`)// 计算高度 .borderWidth(1)// 设置边框宽度 .borderRadius('50%')// 设置圆角 .borderColor(\"#807d8184\"); // 设置边框颜色 // 刻度数字 Text(`${item}`) .width(20)// 设置宽度 .fontColor(\"#7d8184\")// 设置字体颜色 .fontSize(10)// 设置字体大小 .textAlign(TextAlign.Center)// 设置文本对齐方式 .margin({ left: `${(15 + item) * UNIT_LENGTH * 2}lpx` }); // 设置左边距 }); // 小球 Text() .width(14)// 设置宽度 .height(14)// 设置高度 .backgroundColor(\"#ff5841\")// 设置背景颜色 .borderRadius('50%'); // 设置圆角 // 小球背景 Stack() { Stack() { } .radialGradient({ center: [20, 20], // 设置渐变中心点 radius: 60, // 设置渐变半径 colors: [ [\"#807a7a83\", 0.0], // 渐变颜色1 [\"#8074747e\", 0.7], // 渐变颜色2 [\"#80898992\", 1.0]// 渐变颜色3 ] }).width('100%').height('100%') // 设置宽度和高度 } .clip(true) // 设置裁剪 .radialGradient({ center: [20, 20], // 设置渐变中心点 radius: 60, // 设置渐变半径 colors: Math.floor(this.angle) === 0 ? [[\"#FF6B6B\", 0.0], [\"#D84315\", 0.3], [\"#C62828\", 1.0]] : // 当角度为0时的渐变颜色 [[\"#bcbcc6\", 0.0], [\"#464650\", 0.3], [\"#474750\", 1.0]] // 当角度不为0时的渐变颜色 }) .width(50) // 设置宽度 .height(50) // 设置高度 .borderRadius('50%') // 设置圆角 .translate({ x: `${this.calculateBallPosition().x}lpx`, // 设置X轴偏移 y: `${this.calculateBallPosition().y}lpx` // 设置Y轴偏移 }) .animation({ curve: Curve.EaseOut }); // 设置动画效果 }.width('580lpx').height('580lpx').borderRadius('50%') // 设置外部大圆的宽度、高度和圆角 }.height('100%') // 设置Stack的高度 .width('100%') // 设置Stack的宽度 .backgroundColor(\"#18181a\"); // 设置背景颜色 } } turntable 转盘\nimport { CounterComponent, CounterType } from '@kit.ArkUI'; // 导入计数器组件和计数器类型 // 定义扇形组件 @Component struct Sector { @Prop radius: number; // 扇形的半径 @Prop angle: number; // 扇形的角度 @Prop color: string; // 扇形的颜色 // 创建扇形路径的函数 createSectorPath(radius: number, angle: number): string { const centerX = radius / 2; // 计算扇形中心的X坐标 const centerY = radius / 2; // 计算扇形中心的Y坐标 const startX = centerX; // 扇形起始点的X坐标 const startY = centerY - radius; // 扇形起始点的Y坐标 const halfAngle = angle / 4; // 计算半个角度 // 计算扇形结束点1的坐标 const endX1 = centerX + radius * Math.cos((halfAngle * Math.PI) / 180); const endY1 = centerY - radius * Math.sin((halfAngle * Math.PI) / 180); // 计算扇形结束点2的坐标 const endX2 = centerX + radius * Math.cos((-halfAngle * Math.PI) / 180); const endY2 = centerY - radius * Math.sin((-halfAngle * Math.PI) / 180); // 判断是否为大弧 const largeArcFlag = angle / 2 \u003e 180 ? 1 : 0; const sweepFlag = 1; // 设置弧线方向为顺时针 // 生成SVG路径命令 const pathCommands = `M${startX} ${startY} A${radius} ${radius} 0 ${largeArcFlag} ${sweepFlag} ${endX1} ${endY1} L${centerX} ${centerY} L${endX2} ${endY2} A${radius} ${radius} 0 ${largeArcFlag} ${1 - sweepFlag} ${startX} ${startY} Z`; return pathCommands; // 返回路径命令 } // 构建扇形组件 build() { Stack() { // 创建第一个扇形路径 Path() .width(`${this.radius}px`) // 设置宽度为半径 .height(`${this.radius}px`) // 设置高度为半径 .commands(this.createSectorPath(this.radius, this.angle)) // 设置路径命令 .fillOpacity(1) // 设置填充透明度 .fill(this.color) // 设置填充颜色 .strokeWidth(0) // 设置边框宽度为0 .rotate({ angle: this.angle / 4 - 90 }); // 旋转扇形 // 创建第二个扇形路径 Path() .width(`${this.radius}px`) // 设置宽度为半径 .height(`${this.radius}px`) // 设置高度为半径 .commands(this.createSectorPath(this.radius, this.angle)) // 设置路径命令 .fillOpacity(1) // 设置填充透明度 .fill(this.color) // 设置填充颜色 .strokeWidth(0) // 设置边框宽度为0 .rotate({ angle: 180 - (this.angle / 4 - 90) }); // 旋转扇形 } } } // 定义单元格类 @ObservedV2 class Cell { @Trace angle: number = 0; // 扇形的角度 @Trace title: string; // 当前格子的标题 @Trace color: string; // 背景颜色 @Trace rotate: number = 0; // 在转盘要旋转的角度 angleStart: number = 0; // 轮盘所在区间的起始 angleEnd: number = 0; // 轮盘所在区间的结束 proportion: number = 0; // 所占比例 // 构造函数 constructor(proportion: number, title: string, color: string) { this.proportion = proportion; // 设置比例 this.title = title; // 设置标题 this.color = color; // 设置颜色 } } // 定义转盘组件 @Entry @Component struct Wheel { @State cells: Cell[] = []; // 存储单元格的数组 @State wheelWidth: number = 600; // 转盘的宽度 @State currentAngle: number = 0; // 当前转盘的角度 @State selectedName: string = \"\"; // 选中的名称 isAnimating: boolean = false; // 动画状态 colorIndex: number = 0; // 颜色索引 colorPalette: string[] = [ // 颜色调色板 \"#26c2ff\", \"#978efe\", \"#c389fe\", \"#ff85bd\", \"#ff7051\", \"#fea800\", \"#ffcf18\", \"#a9c92a\" ]; // 组件即将出现时调用 aboutToAppear(): void { // 初始化单元格 this.cells.push(new Cell(1, \"跑步\", this.colorPalette[this.colorIndex++ % this.colorPalette.length])); this.cells.push(new Cell(2, \"跳绳\", this.colorPalette[this.colorIndex++ % this.colorPalette.length])); this.cells.push(new Cell(1, \"唱歌\", this.colorPalette[this.colorIndex++ % this.colorPalette.length])); this.cells.push(new Cell(4, \"跳舞\", this.colorPalette[this.colorIndex++ % this.colorPalette.length])); this.calculateAngles(); // 计算角度 } // 计算每个单元格的角度 private calculateAngles() { // 根据比例计算总比例 const totalProportion = this.cells.reduce((sum, cell) =\u003e sum + cell.proportion, 0); this.cells.forEach(cell =\u003e { cell.angle = (cell.proportion * 360) / totalProportion; // 计算每个单元格的角度 }); let cumulativeAngle = 0; // 累计角度 this.cells.forEach(cell =\u003e { cell.angleStart = cumulativeAngle; // 设置起始角度 cumulativeAngle += cell.angle; // 更新累计角度 cell.angleEnd = cumulativeAngle; // 设置结束角度 cell.rotate = cumulativeAngle - (cell.angle / 2); // 计算旋转角度 }); } // 构建转盘组件 build() { Column() { Row() { Text('转盘').fontSize(20).fontColor(\"#0b0e15\"); // 显示转盘标题 }.width('100%').height(44).justifyContent(FlexAlign.Center); // 设置行的宽度和高度 // 显示当前状态 Text(this.isAnimating ? '旋转中' : `${this.selectedName}`).fontSize(20).fontColor(\"#0b0e15\").height(40); Stack() { Stack() { // 遍历每个单元格并绘制扇形 ForEach(this.cells, (cell: Cell) =\u003e { Stack() { Sector({ radius: lpx2px(this.wheelWidth) / 2, angle: cell.angle, color: cell.color }); // 创建扇形 Text(cell.title).fontColor(Color.White).margin({ bottom: `${this.wheelWidth / 1.4}lpx` }); // 显示单元格标题 }.width('100%').height('100%').rotate({ angle: cell.rotate }); // 设置宽度和高度，并旋转 }); } .borderRadius('50%') // 设置圆角 .backgroundColor(Color.Gray) // 设置背景颜色 .width(`${this.wheelWidth}lpx`) // 设置转盘宽度 .height(`${this.wheelWidth}lpx`) // 设置转盘高度 .rotate({ angle: this.currentAngle }); // 旋转转盘 // 创建指针 Polygon({ width: 20, height: 10 }) .points([[0, 0], [10, -20], [20, 0]]) // 设置指针的点 .fill(\"#d72b0b\") // 设置指针颜色 .height(20) // 设置指针高度 .margin({ bottom: '140lpx' }); // 设置指针底部边距 // 创建开始按钮 Button('开始') .fontColor(\"#c53a2c\") // 设置按钮字体颜色 .borderWidth(10) // 设置按钮边框宽度 .borderColor(\"#dd2218\") // 设置按钮边框颜色 .backgroundColor(\"#fde427\") // 设置按钮背景颜色 .width('200lpx') // 设置按钮宽度 .height('200lpx') // 设置按钮高度 .borderRadius('50%') // 设置按钮为圆形 .clickEffect({ level: ClickEffectLevel.LIGHT }) // 设置点击效果 .onClick(() =\u003e { // 点击按钮时的回调函数 if (this.isAnimating) { // 如果正在动画中，返回 return; } this.selectedName = \"\"; // 清空选中的名称 this.isAnimating = true; // 设置动画状态为正在动画 animateTo({ // 开始动画 duration: 5000, // 动画持续时间为5000毫秒 curve: Curve.EaseInOut, // 动画曲线为缓入缓出 onFinish: () =\u003e { // 动画完成后的回调 this.currentAngle %= 360; // 保持当前角度在0到360之间 for (const cell of this.cells) { // 遍历每个单元格 // 检查当前角度是否在单元格的角度范围内 if (360 - this.currentAngle \u003e= cell.angleStart \u0026\u0026 360 - this.currentAngle \u003c= cell.angleEnd) { this.selectedName = cell.title; // 设置选中的名称为当前单元格的标题 break; // 找到后退出循环 } } this.isAnimating = false; // 设置动画状态为未动画 }, }, () =\u003e { // 动画进行中的回调 this.currentAngle += (360 * 5 + Math.floor(Math.random() * 360)); // 更新当前角度，增加随机旋转 }); }); } // 创建滚动区域 Scroll() { Column() { // 遍历每个单元格，创建输入框和计数器 ForEach(this.cells, (item: Cell, index: number) =\u003e { Row() { // 创建文本输入框，显示单元格标题 TextInput({ text: item.title }) .layoutWeight(1) // 设置输入框占据剩余空间 .onChange((value) =\u003e { // 输入框内容变化时的回调 item.title = value; // 更新单元格标题 }); // 创建计数器组件 CounterComponent({ options: { type: CounterType.COMPACT, // 设置计数器类型为紧凑型 numberOptions: { label: `当前占比`, // 设置计数器标签 value: item.proportion, // 设置计数器初始值 min: 1, // 设置最小值 max: 100, // 设置最大值 step: 1, // 设置步长 onChange: (value: number) =\u003e { // 计数器值变化时的回调 item.proportion = value; // 更新单元格的比例 this.calculateAngles(); // 重新计算角度 } } } }); // 创建删除按钮 Button('删除').onClick(() =\u003e { this.cells.splice(index, 1); // 从单元格数组中删除当前单元格 this.calculateAngles(); // 重新计算角度 }); }.width('100%').justifyContent(FlexAlign.SpaceBetween) // 设置行的宽度和内容对齐方式 .padding({ left: 40, right: 40 }); // 设置左右内边距 }); }.layoutWeight(1); // 设置滚动区域占据剩余空间 }.layoutWeight(1) // 设置滚动区域占据剩余空间 .margin({ top: 20, bottom: 20 }) // 设置上下外边距 .align(Alignment.Top); // 设置对齐方式为顶部对齐 // 创建添加新内容按钮 Button('添加新内容').onClick(() =\u003e { // 向单元格数组中添加新单元格 this.cells.push(new Cell(1, \"新内容\", this.colorPalette[this.colorIndex++ % this.colorPalette.length])); this.calculateAngles(); // 重新计算角度 }).margin({ top: 20, bottom: 20 }); // 设置按钮的上下外边距 } .height('100%') // 设置组件高度为100% .width('100%') // 设置组件宽度为100% .backgroundColor(\"#f5f8ff\"); // 设置组件背景颜色 } } Coin 投硬币\n// 定义地鼠组件 @Component struct Hamster { @Prop cellWidth: number // 单元格宽度 build() { Stack() { // 创建一个堆叠布局 // 身体 Text() .width(`${this.cellWidth / 2}lpx`)// 宽度为单元格宽度的一半 .height(`${this.cellWidth / 3 * 2}lpx`)// 高度为单元格高度的2/3 .backgroundColor(\"#b49579\")// 背景颜色 .borderRadius({ topLeft: '50%', topRight: '50%' })// 圆角 .borderColor(\"#2a272d\")// 边框颜色 .borderWidth(1) // 边框宽度 // 嘴巴 Ellipse() .width(`${this.cellWidth / 4}lpx`)// 嘴巴的宽度 .height(`${this.cellWidth / 5}lpx`)// 嘴巴的高度 .fillOpacity(1)// 填充不透明度 .fill(\"#e7bad7\")// 填充颜色 .stroke(\"#563e3f\")// 边框颜色 .strokeWidth(1)// 边框宽度 .margin({ top: `${this.cellWidth / 6}lpx` }) // 上边距 // 左眼睛 Ellipse() .width(`${this.cellWidth / 9}lpx`)// 左眼睛的宽度 .height(`${this.cellWidth / 6}lpx`)// 左眼睛的高度 .fillOpacity(1)// 填充不透明度 .fill(\"#313028\")// 填充颜色 .stroke(\"#2e2018\")// 边框颜色 .strokeWidth(1)// 边框宽度 .margin({ bottom: `${this.cellWidth / 3}lpx`, right: `${this.cellWidth / 6}lpx` }) // 下边距和右边距 // 右眼睛 Ellipse() .width(`${this.cellWidth / 9}lpx`)// 右眼睛的宽度 .height(`${this.cellWidth / 6}lpx`)// 右眼睛的高度 .fillOpacity(1)// 填充不透明度 .fill(\"#313028\")// 填充颜色 .stroke(\"#2e2018\")// 边框颜色 .strokeWidth(1)// 边框宽度 .margin({ bottom: `${this.cellWidth / 3}lpx`, left: `${this.cellWidth / 6}lpx` }) // 下边距和左边距 // 左眼瞳 Ellipse() .width(`${this.cellWidth / 20}lpx`)// 左眼瞳的宽度 .height(`${this.cellWidth / 15}lpx`)// 左眼瞳的高度 .fillOpacity(1)// 填充不透明度 .fill(\"#fefbfa\")// 填充颜色 .margin({ bottom: `${this.cellWidth / 2.5}lpx`, right: `${this.cellWidth / 6}lpx` }) // 下边距和右边距 // 右眼瞳 Ellipse() .width(`${this.cellWidth / 20}lpx`)// 右眼瞳的宽度 .height(`${this.cellWidth / 15}lpx`)// 右眼瞳的高度 .fillOpacity(1)// 填充不透明度 .fill(\"#fefbfa\")// 填充颜色 .margin({ bottom: `${this.cellWidth / 2.5}lpx`, left: `${this.cellWidth / 6}lpx` }) // 下边距和左边距 }.width(`${this.cellWidth}lpx`).height(`${this.cellWidth}lpx`) // 设置组件的宽度和高度 } } // 定义页面组件 @Entry @Component struct CoinTossPage { @State cellWidth: number = 50 // 单元格宽度 @State headsCount: number = 0 // 正面朝上的次数 @State tailsCount: number = 0 // 反面朝上的次数 @State rotationAngle: number = 0 // 旋转角度 @State verticalOffset: number = 0 // 纵向位移 @State isAnimRun: boolean = false // 动画是否正在执行 build() { Column() { // 页面标题 Text('抛硬币') .height(50)// 高度设置为50 .width('100%')// 宽度设置为100% .textAlign(TextAlign.Center)// 文本居中对齐 .fontColor(\"#fefefe\")// 字体颜色 .fontSize(20); // 字体大小 // 显示地鼠和计数 Row({ space: 20 }) { Stack() { Hamster({ cellWidth: this.cellWidth }) // 创建地鼠组件 } .borderRadius('50%') // 设置圆角 .width(`${this.cellWidth}lpx`) // 设置宽度 .height(`${this.cellWidth}lpx`) // 设置高度 .linearGradient({ // 设置线性渐变背景 direction: GradientDirection.LeftBottom, colors: [['#ebcf2f', 0.0], ['#fef888', 0.5], ['#ebcf2f', 1.0]] }); // 显示反面朝上的次数 Text(`${this.tailsCount}`) .fontSize(20) .fontColor(\"#fefefe\"); Stack() { // 显示100 Text(\"100\") .fontColor(\"#9f7606\") .fontSize(`${this.cellWidth / 2}lpx`); } .borderRadius('50%') // 设置圆角 .width(`${this.cellWidth}lpx`) // 设置宽度 .height(`${this.cellWidth}lpx`) // 设置高度 .linearGradient({ // 设置线性渐变背景 direction: GradientDirection.LeftBottom, colors: [['#ebcf2f', 0.0], ['#fef888', 0.5], ['#ebcf2f', 1.0]] }); // 显示正面朝上的次数 Text(`${this.headsCount}`) .fontSize(20) .fontColor(\"#fefefe\"); }.width('100%').justifyContent(FlexAlign.Center); // 设置宽度和内容居中对齐 Stack() { Stack() { // 创建放大版地鼠组件 Hamster({ cellWidth: this.cellWidth * 3 }) .visibility(this.isHeadsFaceUp() ? Visibility.Visible : Visibility.Hidden); // 根据状态显示或隐藏 // 显示100 Text(\"100\") .fontColor(\"#9f7606\")// 字体颜色 .fontSize(`${this.cellWidth / 2 * 3}lpx`)// 字体大小 .visibility(!this.isHeadsFaceUp() ? Visibility.Visible : Visibility.Hidden)// 根据状态显示或隐藏 .rotate({ // 旋转180度 x: 1, y: 0, z: 0, angle: 180 }); } .borderRadius('50%') // 设置圆角 .width(`${this.cellWidth * 3}lpx`) // 设置宽度 .height(`${this.cellWidth * 3}lpx`) // 设置高度 .linearGradient({ // 设置线性渐变背景 direction: GradientDirection.LeftBottom, colors: [['#ebcf2f', 0.0], ['#fef888', 0.5], ['#ebcf2f', 1.0]] }) .rotate({ // 根据当前角度旋转 x: 1, y: 0, z: 0, angle: this.rotationAngle }) .translate({ x: 0, y: this.verticalOffset }) // 设置纵向位移 .onClick(() =\u003e { // 点击事件处理 if (this.isAnimRun) { return; } this.isAnimRun = true let maxAnimationSteps = 2 * (10 + Math.floor(Math.random() * 10)); // 计算最大动画次数 let totalAnimationDuration = 2000; // 动画总时长 // 第一次动画，向上抛出 animateToImmediately({ duration: totalAnimationDuration / 2, // 动画时长为总时长的一半 onFinish: () =\u003e { // 动画完成后的回调 // 第二次动画，向下落 animateToImmediately({ duration: totalAnimationDuration / 2, onFinish: () =\u003e { this.rotationAngle = this.rotationAngle % 360; // 确保角度在0到360之间 // 判断当前显示的面 if (this.isHeadsFaceUp()) { // 如果是地鼠面 this.tailsCount++; // 反面朝上的次数加1 } else { // 如果是反面 this.headsCount++; // 正面朝上的次数加1 } this.isAnimRun = false } }, () =\u003e { this.verticalOffset = 0; // 重置纵向位移 }); } }, () =\u003e { // 设置纵向位移，模拟抛硬币的效果 this.verticalOffset = -100 * (1 + Math.floor(Math.random() * 5)); // 随机设置向上的位移 }); // 循环动画，增加旋转效果 for (let i = 0; i \u003c maxAnimationSteps; i++) { animateToImmediately({ delay: i * totalAnimationDuration / maxAnimationSteps, // 设置每次动画的延迟 duration: 100, // 每次动画的持续时间 onFinish: () =\u003e { // 动画完成后的回调 } }, () =\u003e { this.rotationAngle += 90; // 每次增加90度旋转 }); } }); }.width('100%').layoutWeight(1).align(Alignment.Bottom).padding({ bottom: 80 }); // 设置组件的宽度、权重、对齐方式和底部内边距 } .height('100%') // 设置整个页面的高度 .width('100%') // 设置整个页面的宽度 .backgroundColor(\"#0b0d0c\"); // 设置背景颜色 } // 判断当前是否显示地鼠面 isHeadsFaceUp() { let normalizedAngle = this.rotationAngle % 360; // 规范化角度 // 判断角度范围，确定是否显示地鼠面 if (normalizedAngle \u003e= 0 \u0026\u0026 normalizedAngle \u003c 90 || normalizedAngle \u003e= 270 \u0026\u0026 normalizedAngle \u003c= 360) { return true; // 显示地鼠面 } return false; // 显示反面 } } ","wordCount":"15979","inLanguage":"en","datePublished":"2024-12-15T15:33:54Z","dateModified":"2024-12-15T15:33:54Z","author":{"@type":"Person","name":"dwd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://qfsyso.github.io/posts/harmonyos-next-waste-sorting/"},"publisher":{"@type":"Organization","name":"MLOG","logo":{"@type":"ImageObject","url":"https://qfsyso.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://qfsyso.github.io/ accesskey=h title="MLOG (Alt + H)">MLOG</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://qfsyso.github.io/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://qfsyso.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://qfsyso.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">HarmonyOS Next Waste Sorting</h1><div class=post-meta><span title='2024-12-15 15:33:54 +0000 UTC'>December 15, 2024</span>&nbsp;·&nbsp;76 min&nbsp;·&nbsp;dwd</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e7%8e%af%e5%a2%83 aria-label=环境>环境</a></li><li><a href=#waste-sorting aria-label="Waste Sorting">Waste Sorting</a><ul><li><a href=#%e7%ae%97%e6%b3%95 aria-label=算法>算法</a></li><li><a href=#%e4%bb%a3%e7%a0%81 aria-label=代码>代码</a></li></ul></li><li><a href=#catch-cat aria-label="catch cat">catch cat</a></li><li><a href=#%e7%ae%97%e6%b3%95-1 aria-label=算法>算法</a><ul><li><a href=#1-%e5%b9%bf%e5%ba%a6%e4%bc%98%e5%85%88%e6%90%9c%e7%b4%a2bfs aria-label="1. 广度优先搜索（BFS）：">1. 广度优先搜索（BFS）：</a></li><li><a href=#2-%e5%90%af%e5%8f%91%e5%bc%8f%e6%90%9c%e7%b4%a2 aria-label="2. 启发式搜索：">2. 启发式搜索：</a></li><li><a href=#3-%e6%9b%bc%e5%93%88%e9%a1%bf%e8%b7%9d%e7%a6%bb%e8%ae%a1%e7%ae%97 aria-label="3. 曼哈顿距离计算：">3. 曼哈顿距离计算：</a></li></ul></li><li><a href=#wood-fish aria-label="wood fish">wood fish</a></li><li><a href=#sokoban aria-label=Sokoban>Sokoban</a></li><li><a href=#memory-flip aria-label="Memory Flip">Memory Flip</a></li><li><a href=#3cup--ball aria-label="3cup  ball">3cup ball</a></li><li><a href=#2048 aria-label=2048>2048</a></li><li><a href=#x aria-label=X✔>X✔</a></li><li><a href=#mine aria-label=mine>mine</a></li><li><a href=#schrulte-grid aria-label="Schrulte Grid">Schrulte Grid</a></li><li><a href=#piece aria-label=Piece>Piece</a></li><li><a href=#ruler aria-label=ruler>ruler</a></li><li><a href=#randon-password aria-label="randon password">randon password</a></li><li><a href=#chinese aria-label=chinese>chinese</a></li><li><a href=#up-lower aria-label="Up Lower">Up Lower</a></li><li><a href=#tangram aria-label=Tangram>Tangram</a></li><li><a href=#reversi aria-label=Reversi>Reversi</a></li><li><a href=#nine-square aria-label=nine-square>nine-square</a></li><li><a href=#blood aria-label=blood>blood</a></li><li><a href=#compass aria-label=compass>compass</a></li><li><a href=#level aria-label=level>level</a></li><li><a href=#turntable aria-label=turntable>turntable</a></li><li><a href=#coin aria-label=Coin>Coin</a></li></ul></div></details></div><div class=post-content><h1 id=环境>环境<a hidden class=anchor aria-hidden=true href=#环境>#</a></h1><p>DevEco Studio NEXT Beta1 Build Version: 5.0
API 13</p><h1 id=waste-sorting>Waste Sorting<a hidden class=anchor aria-hidden=true href=#waste-sorting>#</a></h1><p>垃圾分类</p><h2 id=算法>算法<a hidden class=anchor aria-hidden=true href=#算法>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JS data-lang=JS><span style=display:flex><span><span style=color:#75715e>//springCurve回弹
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span><span style=color:#ae81ff>800</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>curves</span>.<span style=color:#a6e22e>springCurve</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 其他配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>});
</span></span></code></pre></div><p>初始偏移量、振幅、周期和阻尼系数，通过这些参数可以控制动画的弹性效果</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-JS data-lang=JS><span style=display:flex><span><span style=color:#75715e>//Fisher-Yates洗牌
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>shuffleItems</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=代码>代码<a hidden class=anchor aria-hidden=true href=#代码>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>curves</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>; <span style=color:#75715e>// 导入ArkUI工具包中的曲线模块
</span></span></span><span style=display:flex><span><span style=color:#75715e>// 定义垃圾项目类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GarbageItem</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 垃圾名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 垃圾类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>description</span><span style=color:#f92672>?:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 垃圾描述，可选
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// 构造函数初始化垃圾项目
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>description</span><span style=color:#f92672>?:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>name</span>; <span style=color:#75715e>// 设置垃圾名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>type</span>; <span style=color:#75715e>// 设置垃圾类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>description</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>description</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 设置垃圾描述，默认为空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义垃圾类别类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GarbageCategory</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 类别名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 类别类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 类别颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 类别描述
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// 构造函数初始化垃圾类别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>name</span>; <span style=color:#75715e>// 设置类别名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>type</span>; <span style=color:#75715e>// 设置类别类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>; <span style=color:#75715e>// 设置类别颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>description</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>description</span>; <span style=color:#75715e>// 设置类别描述
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用组件装饰器定义一个名为Index的应用入口
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Index</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>currentQuestionIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 当前题目索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>quizResults</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 测验结果数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>totalScore</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 总得分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>showAnimation</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 是否显示动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>scaleOptions</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ScaleOptions</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> }; <span style=color:#75715e>// 缩放选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>itemXPosition</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 物品X轴位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>itemOpacity</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1.0</span>; <span style=color:#75715e>// 物品透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// 初始化垃圾类别数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>garbageCategories</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GarbageCategory</span>[] <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageCategory</span>(<span style=color:#e6db74>&#34;有害垃圾&#34;</span>, <span style=color:#ae81ff>0</span>, <span style=color:#e6db74>&#34;#e2413f&#34;</span>, <span style=color:#e6db74>&#34;对人体健康或自然环境可能造成直接或潜在危害的生活垃圾&#34;</span>), <span style=color:#75715e>// 创建有害垃圾类别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageCategory</span>(<span style=color:#e6db74>&#34;可回收物&#34;</span>, <span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#34;#1c6bb5&#34;</span>, <span style=color:#e6db74>&#34;适宜回收和资源利用的物品&#34;</span>), <span style=color:#75715e>// 创建可回收物类别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageCategory</span>(<span style=color:#e6db74>&#34;厨余垃圾&#34;</span>, <span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#34;#4ca84e&#34;</span>, <span style=color:#e6db74>&#34;上海称湿垃圾，易腐烂的、含有机质的生活垃圾&#34;</span>), <span style=color:#75715e>// 创建厨余垃圾类别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageCategory</span>(<span style=color:#e6db74>&#34;其他垃圾&#34;</span>, <span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#34;#5f5f5f&#34;</span>, <span style=color:#e6db74>&#34;上海称干垃圾，不能归类于以上三类的生活垃圾&#34;</span>), <span style=color:#75715e>// 创建其他垃圾类别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  ];
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>garbageItems</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GarbageItem</span>[] <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;菜帮菜叶&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;剩菜剩饭&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;过期食品&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;瓜果皮壳&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;鱼骨鱼刺&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;鸡蛋及蛋壳&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;残枝落叶&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;茶叶渣&#34;</span>, <span style=color:#ae81ff>2</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;酒瓶&#34;</span>, <span style=color:#ae81ff>1</span>,),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;玻璃杯&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;调味瓶&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;图书&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;打印纸&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;信封&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;易拉罐&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;金属刀具&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;奶粉桶&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;衣服裤子&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;毛绒玩具&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;鞋&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;饮料瓶&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;塑料盆&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;食用油桶&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;洗衣机&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;电烤箱&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;电视机&#34;</span>, <span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;充电电池&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;废含汞荧光灯管&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;过期药品及其包装物&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;油漆桶&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;血压计&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;废水银温度计&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;杀虫喷雾罐&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;废X光片等感光胶片&#34;</span>, <span style=color:#ae81ff>0</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;食品袋&#34;</span>, <span style=color:#ae81ff>3</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;大棒骨&#34;</span>, <span style=color:#ae81ff>3</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;创可贴&#34;</span>, <span style=color:#ae81ff>3</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;污损塑料袋&#34;</span>, <span style=color:#ae81ff>3</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;烟屁&#34;</span>, <span style=color:#ae81ff>3</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;陶瓷碎片&#34;</span>, <span style=color:#ae81ff>3</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;餐巾纸&#34;</span>, <span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#34;厕纸、卫生纸遇水即溶，不算可回收的“纸张”，类似的还有烟盒等。&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GarbageItem</span>(<span style=color:#e6db74>&#34;卫生纸&#34;</span>, <span style=color:#ae81ff>3</span>, <span style=color:#e6db74>&#34;厕纸、卫生纸遇水即溶，不算可回收的“纸张”，类似的还有烟盒等。&#34;</span>),
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 在组件即将出现时重置测验
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>resetQuiz</span>(); <span style=color:#75715e>// 调用重置测验方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 重置测验状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>resetQuiz</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>quizResults</span> <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 清空测验结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>totalScore</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 清零总得分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentQuestionIndex</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 重置当前题目索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>shuffleItems</span>(); <span style=color:#75715e>// 打乱垃圾项目顺序
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 打乱垃圾项目顺序
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>shuffleItems</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)); <span style=color:#75715e>// 随机索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>i</span>]; <span style=color:#75715e>// 临时存储
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>j</span>]; <span style=color:#75715e>// 交换位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>; <span style=color:#75715e>// 交换位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 检查用户选择的答案
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>checkAnswer</span>(<span style=color:#a6e22e>categoryType</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>currentItem</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentQuestionIndex</span>]; <span style=color:#75715e>// 获取当前垃圾项目
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>quizResults</span>.<span style=color:#a6e22e>push</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>currentItem</span>.<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>（</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageCategories</span>[<span style=color:#a6e22e>categoryType</span>].<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>）【</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>currentItem</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>categoryType</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;✔&#34;</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageCategories</span>[<span style=color:#a6e22e>currentItem</span>.<span style=color:#a6e22e>type</span>].<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>】`</span>); <span style=color:#75715e>// 添加到测验结果中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>currentItem</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>categoryType</span>) { <span style=color:#75715e>// 如果答案正确
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>totalScore</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>10</span>; <span style=color:#75715e>// 加十分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentQuestionIndex</span><span style=color:#f92672>++</span>; <span style=color:#75715e>// 进入下一个题目
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentQuestionIndex</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>10</span>) { <span style=color:#75715e>// 如果完成了十个题目
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>displayResults</span>(); <span style=color:#75715e>// 显示结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>resetQuiz</span>(); <span style=color:#75715e>// 重置测验
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 显示测验结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>displayResults</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>sheets</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SheetInfo</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 初始化结果页面列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>quizResults</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) { <span style=color:#75715e>// 循环添加每一个结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>sheets</span>.<span style=color:#a6e22e>push</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>quizResults</span>[<span style=color:#a6e22e>i</span>], <span style=color:#75715e>// 设置标题为测验结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 不执行任何操作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getUIContext</span>().<span style=color:#a6e22e>showActionSheet</span>({ <span style=color:#75715e>// 显示结果页
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;成绩单&#39;</span>, <span style=color:#75715e>// 标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`总分数:</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>totalScore</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>, <span style=color:#75715e>// 分数信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>confirm</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 确认按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>defaultFocus</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 默认焦点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;我知道了&#39;</span>, <span style=color:#75715e>// 按钮文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 点击后的动作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>onWillDismiss</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 关闭前的动作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      },
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>alignment</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>DialogAlignment</span>.<span style=color:#a6e22e>Center</span>, <span style=color:#75715e>// 对齐方式为中心
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>sheets</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>sheets</span> <span style=color:#75715e>// 结果页面列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建用户界面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 创建列布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`垃圾分类测验:</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentQuestionIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/10`</span>) <span style=color:#75715e>// 显示当前题目序号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>&#39;30lpx&#39;</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>margin</span>(<span style=color:#ae81ff>20</span>); <span style=color:#75715e>// 设置外边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建堆栈布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageItems</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentQuestionIndex</span>].<span style=color:#a6e22e>name</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>) <span style=color:#75715e>// 显示当前垃圾项目名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>) <span style=color:#75715e>// 居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;130lpx&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;130lpx&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>border</span>({ <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> }) <span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>&#39;20lpx&#39;</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>2</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>scale</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>scaleOptions</span>); <span style=color:#75715e>// 设置缩放比例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showAnimation</span>) { <span style=color:#75715e>// 如果显示动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Particle</span>({ <span style=color:#75715e>// 创建粒子效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>particles</span><span style=color:#f92672>:</span> [ <span style=color:#75715e>// 初始化粒子数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>emitter</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 粒子发射器配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>particle</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 粒子类型配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ParticleType</span>.<span style=color:#a6e22e>POINT</span>, <span style=color:#75715e>// 粒子类型为点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>config</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                      <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> <span style=color:#75715e>// 点的半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    },
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>count</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span>, <span style=color:#75715e>// 粒子数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>lifetime</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 生命周期
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>lifetimeRange</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#75715e>// 生命周期范围
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  },
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>emitRate</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>, <span style=color:#75715e>// 发射速率
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>position</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;25%&#39;</span>, <span style=color:#ae81ff>0</span>], <span style=color:#75715e>// 发射位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;100lpx&#39;</span>, <span style=color:#e6db74>&#39;100lpx&#39;</span>], <span style=color:#75715e>// 发射器大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>shape</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ParticleEmitterShape</span>.<span style=color:#a6e22e>RECTANGLE</span> <span style=color:#75715e>// 发射器形状为矩形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                },
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 粒子颜色配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>range</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>, <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>], <span style=color:#75715e>// 颜色范围
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>updater</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 更新器配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ParticleUpdater</span>.<span style=color:#a6e22e>CURVE</span>, <span style=color:#75715e>// 变化方式为曲线变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>config</span><span style=color:#f92672>:</span> [ <span style=color:#75715e>// 配置项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                      {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>from</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>, <span style=color:#75715e>// 起始颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>to</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>, <span style=color:#75715e>// 终止颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>startMillis</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// 开始时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>endMillis</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 结束时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>FastOutLinearIn</span> <span style=color:#75715e>// 曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                      }
</span></span><span style=display:flex><span>                    ]
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 粒子大小配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>range</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>0.8</span>, <span style=color:#ae81ff>1.2</span>], <span style=color:#75715e>// 大小范围
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>updater</span><span style=color:#f92672>:</span> { <span style=color:#75715e>// 更新器配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ParticleUpdater</span>.<span style=color:#a6e22e>CURVE</span>, <span style=color:#75715e>// 变化方式为曲线变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>config</span><span style=color:#f92672>:</span> [ <span style=color:#75715e>// 配置项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                      {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>from</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.0</span>, <span style=color:#75715e>// 起始大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>to</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.0</span>, <span style=color:#75715e>// 终止大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>startMillis</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// 开始时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>endMillis</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 结束时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                        <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>EaseIn</span>
</span></span><span style=display:flex><span>                      }
</span></span><span style=display:flex><span>                    ]
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 粒子加速度配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>acceleration</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>speed</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>range</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>8000</span>, <span style=color:#ae81ff>10000</span>], <span style=color:#75715e>// 向下减速，模拟重力
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>updater</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ParticleUpdater</span>.<span style=color:#a6e22e>RANDOM</span>, <span style=color:#75715e>// 加速度线性变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                      <span style=color:#a6e22e>config</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>400</span>, <span style=color:#ae81ff>500</span>]
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                  },
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>range</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>90</span>] <span style=color:#75715e>// 方向固定向下
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  }
</span></span><span style=display:flex><span>                },
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            ]
</span></span><span style=display:flex><span>          }).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#34;100%&#34;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#34;100%&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;150lpx&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>translate</span>({<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span><span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>itemXPosition</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,<span style=color:#a6e22e>y</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span>});
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>garbageCategories</span>, (<span style=color:#a6e22e>category</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GarbageCategory</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>name</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>&#39;30lpx&#39;</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Divider</span>();
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>description</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>&#39;28lpx&#39;</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>5</span>);
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>color</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;280lpx&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#34;24%&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>border</span>({ <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span>, <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>MIDDLE</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showAnimation</span>){
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showAnimation</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>itemX</span><span style=color:#f92672>:</span><span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>type</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>itemX</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>270</span>
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>type</span><span style=color:#f92672>==</span><span style=color:#ae81ff>1</span>){
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>itemX</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>90</span>
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>type</span><span style=color:#f92672>==</span><span style=color:#ae81ff>2</span>){
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>itemX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>
</span></span><span style=display:flex><span>            }<span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>type</span><span style=color:#f92672>==</span><span style=color:#ae81ff>3</span>){
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>itemX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>270</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span><span style=color:#ae81ff>200</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span>()=&gt;{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span><span style=color:#ae81ff>800</span>,
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>curves</span>.<span style=color:#a6e22e>springCurve</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>90</span>, <span style=color:#ae81ff>20</span>),
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span>()=&gt;{
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span><span style=color:#ae81ff>200</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span>()=&gt;{
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>itemXPosition</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkAnswer</span>(<span style=color:#a6e22e>category</span>.<span style=color:#a6e22e>type</span>);
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showAnimation</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>                      }
</span></span><span style=display:flex><span>                    },()=&gt;{
</span></span><span style=display:flex><span>                      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>itemXPosition</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>scaleOptions</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.0</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.0</span> };
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                },()=&gt;{
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>scaleOptions</span> <span style=color:#f92672>=</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.3</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.3</span> };
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            },()=&gt;{
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>itemXPosition</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>itemX</span>
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重新开始&#39;</span>).<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span> }).<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span> }).<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>resetQuiz</span>()
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=catch-cat>catch cat<a hidden class=anchor aria-hidden=true href=#catch-cat>#</a></h1><p>围住神经猫</p><h1 id=算法-1>算法<a hidden class=anchor aria-hidden=true href=#算法-1>#</a></h1><h2 id=1-广度优先搜索bfs>1. 广度优先搜索（BFS）：<a hidden class=anchor aria-hidden=true href=#1-广度优先搜索bfs>#</a></h2><p>广度优先搜索（Breadth-First Search，简称 BFS）是一种用于图和树结构的遍历或搜索算法。它从一个起始节点开始，首先访问该节点的所有邻接节点，然后再以同样的方式逐层访问这些邻接节点的邻接节点，直到访问完整个图或者找到目标节点为止。BFS的特点是按照从近到远的顺序访问节点，因此它非常适合用来寻找最短路径问题，尤其是在所有边的权重相等的情况下。</p><p>BFS的基本步骤如下：
初始化：选择一个起始节点，将其放入队列，并标记为已访问。
循环处理：
从队列中取出第一个节点。
检查该节点是否为目标节点；如果是，则结束搜索。
否则，将该节点的所有未访问过的邻接节点加入队列，并标记为已访问。
终止条件：当队列为空时，表示所有可到达的节点都已经被访问过，如果此时还没有找到目标节点，则说明目标节点不可达。</p><p>在 findNeighbors 方法中，通过遍历当前单元格的邻居来获取周围非墙壁且可以移动的单元格集合。这类似于广度优先搜索的思想，逐层遍历邻居单元格。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>findNeighbors</span>(<span style=color:#a6e22e>cell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>neighbors</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 检查当前单元格的六个方向邻居，将非墙壁且可以移动的单元格加入集合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>neighbors</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=2-启发式搜索>2. 启发式搜索：<a hidden class=anchor aria-hidden=true href=#2-启发式搜索>#</a></h2><p>在 selectNextMove 方法中，根据一定的启发式函数选择下一个移动位置，以确保小猫朝着离边界最近的方向移动。这种启发式搜索可以帮助小猫更智能地选择下一步的移动位置。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>selectNextMove</span>(<span style=color:#a6e22e>emptyNeighbors</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 根据启发式函数选择最优的移动位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>closestToEdge</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>emptyNeighbors</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=3-曼哈顿距离计算>3. 曼哈顿距离计算：<a hidden class=anchor aria-hidden=true href=#3-曼哈顿距离计算>#</a></h2><p>曼哈顿距离（Manhattan Distance），也称为城市街区距离（City Block distance）或出租车几何，是衡量在标准坐标系中两个点之间沿轴向距离的总和。简单来说，它是从一个点到另一个点，在只允许水平或垂直移动的情况下，必须经过的最小距离。这个概念得名于美国纽约市曼哈顿区的街道布局，因为那里的街道大多呈网格状分布，车辆只能沿着这些街道行驶，而不能斜穿。</p><p>在 computeHeuristic 方法中，使用曼哈顿距离计算启发式函数的值，以评估当前单元格到边界的距离。曼哈顿距离是在网格上两点之间的距离，沿着网格的边缘移动。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>computeHeuristic</span>(<span style=color:#a6e22e>cell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 计算曼哈顿距离作为启发式函数的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// ...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>minDistanceX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>minDistanceY</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=wood-fish>wood fish<a hidden class=anchor aria-hidden=true href=#wood-fish>#</a></h1><p>电子木鱼</p><p>animateToImmediately</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 观察者模式装饰器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cell</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;功德+1&#39;</span>; <span style=color:#75715e>// 默认显示的文字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#75715e>// 跟踪属性变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>opacity</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 文字透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#75715e>// 跟踪属性变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 文字的垂直偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 主入口组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Index</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>list</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 存储所有 Cell 对象的数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>indexCount</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 记录当前滚动的索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>count</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>; <span style=color:#75715e>// 列表中 Cell 对象的数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>image</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQsAAADICAYAAAD/XsT8AAAAAXNSR0IArs4c6QAAEApJREFUeF7tnV921LgSh+093Hfg6S7iPgALmDUAKyFZyQwrubASYCWelMfqcXfabVkuSVXS1+eEhESWpV+Vv1Mq/fE48EGBgwpM0/R2GIYPy2Vvlu/yO/msv8vPvyKrl3KhrHz/vVx3+d04jrF1Rd6SYkcUGI8UpmxfCixQkAf+/QKBNSRqiLGGifz8YwHML0CS3xzAIr/GLu6wgOHT0liJGkLk4KL9q6jke4DIOI7yMx8lBYCFkpAeq1kBwiMcYiWXCASAxKr1oBywUBDRUxUrQHxe5Rc8deFsW8NQ5i+JQIg+4uUEFvFauS25AsST207kaziRR6S2wCJSKI/Fpmn6+jKW7zWCSDVZgMc3oo5rCYFFqksZvY4oQtUwAg6GK4ukwELVt+pVtkAiRBL1GtLunQM4JOLocr0HsHDu3NM0yUzGn50mK2tYr9thCrCo4W4K91wiCYGEt/UQCr03U4WA43kcRxmqNP8BFs5MzHDDpMHmIco4js8mW6fUKGChJGTuakhc5lZYpf6m8xrAQsVH8layTIGyRiKvzJq1NxlpAAtNF1Gui+SlsqDlqxNofGllvQawKO9Au3dkyLErkacCzUQZwMKY2y3RxP+NNYvmnFdANrNJlOF2jQawOO8EKjUwy6Eio/VKBBQfvQIDWBhwL6IJA0Yo1wS3wxJgUc5J7t5pmiZZWCWbvfj0o4BLYACLSg7KCsxKwtu67ZOnhVzAooLzMOyoILrdW8rKzy92m/dvy4BFYSuxwKqw4D5u5wIYwKKQMzHsKCS039t8H8fxo+XmA4sC1mHYUUDkNm4hrzR4Z7UrwCKzZQBFZoHbq94sMIBFRmcjP5FR3LarNgkMYJHJ6Vg/kUnYfqo1BwxgkcH5pmmSvR2cYJVB286qNDVLAiwUvY8ZD0UxqSooYAYYwELJKRdQ/FSqjmpQYK2ACWAACwWnBBQKIlLFngLVl4YDiz0T7fwdUJwUkMuPKFAVGMDiiKluygKKE+JxaaoC1YABLBJNxmKrROG4TEOBKsAAFgmmAxQJonGJpgJVXm4ELA6aEFAcFIziuRQofnI4sDhgSnIUB8SiaAkFigIDWESaFFBECkWx0goUOwQYWESYlpWZESJRpKYCRYABLCJMzF6PCJEoUluB7BvPgMWOiQFF7WeA+x9QICswgMUDSwCKA25KUSsKZNtHAiw2TAworPg+7UhQIAswgMUdS3DCVYJ7cok1BdRXeQKLGxOz6Mqaz9OeEwqoAgNYrCwBKE64JZdaVEB10RawWEzMoiuLvk6bFBRQW4MBLP6FBedmKngmVZhUQGVKFVgMw8DMh0kHp1G6CpzOX3QPC2Y+dD2S2swqcDp/0TUsSGiadWwalkeBU+9T7RYWS0JT8hRv89iFWlHAnAKnchc9w4KEpjlfpkEFFHg3jqMMSQ5/uoQFeYrDfsIFjSgwjmPyM598oVftyFN4tRzt1lAAWESqyMKrSKEo1qoCpzaYdRVZsJ6i1WeAfkUqACxihCJPEaMSZRpXIDm5Kbp0EVmQp2j8EaB7MQqciip6ggXTpDHuRJmWFTgVVXQBi2ma/hyG4XPLXkDfUOCBAqeXeYe6mx6GMPzgIepcAbXt6c1HFtM0/WQ5d+ePS5/dF0hIjuJZs/vNRhZMk2q6CXU5UGAGxDAM31KXc+/1sUlYMPzYMzt/b0CBAIdBO4LY0qZVWDD8aOBpoAtXCggc5Ot7zujhkebNwYLZDx6xhhQI0cOPcRwFElU/TcGC4UdVX+Lm5xUwBYfb7rQGCxZfnXdYaiingGk4NAsL9n6U83DulKyAKzg0CQuGH8nOy4V5FXANh1ZhwfAjr9NTe5wCTcGhOVgw/IjzYkplUaAoHJbDm+SAafl6s/Qo/H+rg+G8zR9LATm0N2lmxXWCk+FHlgeASrcVKAKHBQrSik9LUz68rK+QL61PWK/xfGS1p3dYsPhKy32o51aB9SKorOscFjjkAsMjyx7aQ+IWFiy+4ulWVqAIHBYwSJQgwwjtiCFVkqiDcVzCguFHqk9w3UqBy96KXMunjYJhywl2geEVFgw/eO6PKpBt41WBHMPRvqaWf/jyZHewYPYj1Q+6uy5LMvJOtLA3G+FJ+IenarmCBe/98OR3Rduqnm9YTVO+X6YqBQqaMxJFBTpws82XJ3uDBYuvDli94aJq+YaGhhCa5v54by2GG1hM0ySH7srhu3z6UkAtargTLUikIBEDn2sF7kYXnmAxYdEuFFhHDafWN6zWLwgQOOH9mPu8ii5cwII1Fces7Kh0WEko30+BQfq8goOV9QuOTPGqqa+mUs3DgjUVnv1tPgYuAEE6IvsTZG9C2K9wunOLf0gS8ul0ZVSwVkDs9G79Cw+wIKlp34lfQSF1s1JsV5cpdBlakHOIFe14uauhiGlYkNQ8bt0CV6gOHY60dzXMIIo4Ilx62atFWtZhwUrNdENrXFkNDOvGAwkNUybVcTUUMQsLVmomGffMRSbAACTOmFD/2pd3klwYYRkWTJXq2z7UGBKM8gar07MQ2s1cIomvTHdqK5tU3yVvYRIWTJUmGfXRReaihnuNXWY2ZOEdSUt1F0iu8JK3MAcLpkqTjXo17bW897LYq+3OtJqZjTPqZb/2sprTIiyYKj1u/yw7LI83I/4KkpbxWlUueUlymoIFUUW0W7iDQ+gZkIi2saWCc97CGiyIKu67iFs4AAlLz3xyW2zBggVYV4YMcPg9jqPMWLj9EEm4Nd264XOS00xkMU0TC7D+2Uchx7O7BoR4GZBoAhKhE3ZgQVQxb4L6prnBqparskailvJZ7zvPiJiILDqOKh4ekJrV/MqVAwllQW1VN8+IVIdFp1FFa5GELKTq4XxKW49wudaYgUVPy7rlHZNfGhpuAIlyD2zVO8kekaqRRUebxR4esV7VCw7enCXZBwVrp/h/asOih6iiibwEkGjnqU/syX+rwaKDqKKJaAJIJD5a7V1WFRYtRxXuowkg0d7TfrJH/6sSWTS8Bd19NAEkTj5S7V5eDRYtRhWbr33z4D9AwoOVqrbxj+KRRaNRxe7r6qua+cHNgYRVy5hrVxVYtBZVyLoJd3s5gIS5h9F6g8rCosGo4u4LZC1bHUhYto7ptn0pOgx5mS5tKapwBYpl7wYrLk0/j6YbVw4WjUUVbqZGgYTpB9BT44rCopmoovYy+RgPAxIxKlHmgAJlYNFYVGE6oclW8QPuT9EjChSDRTNRxctLeUzmKoDEEb+nbIIC+WHRWFQhGpvKV3B8XYLbc0mKAnlhsTiynK3Z0scELIBESy7loi/ZYSFTdZ9dSBHfyKrLuoFEvKEoqapAPlg0GlWI+levoVc1x4PKgEQppbnPhgJZYdFiVBF0LJrk7ODsD55Q+wrkWe7dwWsIi+QtgIT9J6ijFmaDReuvIcw6FOGt4h09gn66qg+Ljo72V1+cBST8PDkdtlT38JuGk5r3fEMtumAnaIePnr8uq8Oi9eHHrYlPHXoDJPw9MR23WA8WHSfjDic7l6Ha12EY3nbsfHTdlwI6p3t3MPuxZ9aog3rJSezJyN8NK3D+JUOd5Sn2bCnQkCP2fiwF5f/y+fTyj7zflA8KeFVABRa95Sm8Gpt2o0CyAqffdTpNE6BIlp8LUcCNAufeot5xQtONhWkoCigpMM/6JR3YS0JTyQRUgwI+FEiDBQlNH9allSigqMC8WvlwZEGeQtEEVIUCPhSYd1kfggWg8GFZWokCygq8G8fxVzQsSGgqy091KOBEgfDqiyhYkNB0YlWaiQL6Clz2P+3CAlDoq0+NKOBIgctRDA9hscx8yMIrNjw5si5NRQFFBeZ8hdS3BwtWaCqqTlUo4E2B9as6N2FBQtObWWkvCqgrcHVey11YkKdQF50KUcCjAldHR76CBSs0PdqUNqNAFgUu+Yq7OQsWXmURnUpRwJsCr46MvIosOjqZ25vhaC8KlFbg1en1t7CYSreI+6EACphU4GoIcjUMmaap5dcNmrQGjUIBowrcPbV+jiyY/TBqMpqFAnUUuPsCrQALooo6RuGuKGBOgfVCrHXjAizIVZgzGQ1CgSoKbL6Wc2QGpIpBuCkKmFRgK6qYE5wkNk3ajEahQA0FHr6OU2DBZrEaZuGeKGBPgVfTpVc5i2mafrIF3Z7VaBEKFFZg9yXfElkAi8JW4XYoYE2BR7mK0FaBBTMh1ixHe1CgrAKbMyAMQ8oagruhgGUF5lcTxjSQBGeMSpRBgXYVmN8JEtM9gcXXl4JPMYUpgwIo0JQCu0nN22EIsGjK/nQGBaIUiB5+rBOccnK3zIjwQQEU6EeB6OHHBRbyAwuz+vEQeooCL+uqDg0/bmHxeRgG2XnKBwVQoG0Fvo/j+DGli2HXKUORFPW4BgV8KXA4T3GV4Az/YfepL6vTWhRIUOBwnmILFhJdyFDkQ0IjuAQFUMC2AqdAIV27PbCX4Yhtg9M6FEhRIGo5917F914yRLJzTzX+jgJ+FHh62ST2rNHcrdcXslBLQ13qQIG6CiRNkW41mRcj1zUmd0eBXAqoguJVzuK21ewbyWVH6kWBrAqog2IXFlJgeVGyHL0nyU8+KIACthVQSWbe6+LmMGRdeAHGp5ffsTvVtqPQur4VOD09+ki+KFiEClbQkBmTvUjj13Kd7JUPP/8ehuH98nu5njUdfTs3vddRQJ4viSiizqVIveUhWNyJNgIw5HsAgiwpDT/vtmsBkEBDIAJAdhWjAApcKSDPmkQU0c9cqn7JsEi94d51CzykmABEhj5EH3ui8fdeFciSyNwS0xwsbhsKPHp9Duj3jgLZEpluYbEBDxmuSNTBsIVnqjcFig07boU1H1nsecIq58GQZU8s/u5dAbWl2ylCuIfFRtKVqCPFG7jGqgJFZjv2Ot8ULDaGLCRK97yAv1tVQCAhSUyVjWBnO9k0LO5EHWGKVtaJ8EEBywpUHXLcE6YbWGxEHSHPwfSs5cemr7aZGHIAiw2nu1kYRtTR18NppbdmIREE6jay2PKQBRwyJSsrSiXiIOqw8ji12Q6BxPM4jn9Z7x6w2LEQUYd1F3bbPjeQILJI8LHValJyHQn6ccmsgGz2ktWX2fdyaOtNZHFCUTbBnRCvr0vnKdBhGL55hASRRQZnBR4ZRPVdpal1EmelJLI4q+CD64FHRnHtVt1EFMHUaWUHAx6VDZDv9gEQP3IfQJOvC/s1E1nsa5StxAoeb5imzSZzroq7AMRaPGCRy5US6yX6SBSuzGXNDjFi5AMWMSpVLLNaJBYWinGGRzl7dBc9PJIWWJRzPLU73ZwextmlasrO58jKFGfTuYdUuYBFqnIGr9uIQiQS2TuJ3WBvsjdJwBBOngcOEXIDiwiRvBe5iUSkOyEa6QEkAoUABuk7YEh0aGCRKFxLl23ARLoYYGI9MglACN/l/TTySoqs79FoyQdi+gIsYlSiTHiNZVDiNiKRqd/1O2TWit0DzRZ8bvdLhIdf6lu/qGr+GRiUdcy/AeOQohjN6eIJAAAAAElFTkSuQmCC&#39;</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 初始化方法，在组件即将显示时被调用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>count</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>list</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>()); <span style=color:#75715e>// 初始化 Cell 数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建 UI 的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 创建一个垂直布局容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建一个堆栈布局容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>list</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>, <span style=color:#a6e22e>_index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 遍历 list 中的每一个 Cell
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>value</span>)<span style=color:#75715e>// 显示 Cell 中的文字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)<span style=color:#75715e>// 设置文字颜色为白色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>&#39;50lpx&#39;</span>)<span style=color:#75715e>// 设置文字大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>translate</span>({ <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })<span style=color:#75715e>// 设置文字的垂直偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>opacity</span>(<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>opacity</span>) <span style=color:#75715e>// 设置文字的透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>) <span style=color:#75715e>// 设置堆栈布局容器的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>) <span style=color:#75715e>// 设置堆栈布局容器的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>BottomEnd</span>) <span style=color:#75715e>// 设置对齐方式为底部右端
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Image</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>image</span>)<span style=color:#75715e>// 显示图片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>)<span style=color:#75715e>// 设置图片宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>)<span style=color:#75715e>// 设置图片高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>objectFit</span>(<span style=color:#a6e22e>ImageFit</span>.<span style=color:#a6e22e>Contain</span>)<span style=color:#75715e>// 图片适应容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>clickEffect</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 点击效果配置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.5</span>, <span style=color:#75715e>// 缩放比例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span> <span style=color:#75715e>// 效果级别
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击图片时触发的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>indexCount</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>count</span>; <span style=color:#75715e>// 计算当前滚动的索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>indexCount</span><span style=color:#f92672>++</span>; <span style=color:#75715e>// 更新索引计数器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 立即开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// 动画持续时间为0毫秒
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 再次立即开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1000</span>, <span style=color:#75715e>// 动画持续时间为1000毫秒
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              }, () =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>list</span>[<span style=color:#a6e22e>index</span>].<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>200</span> <span style=color:#75715e>// 设置 Cell 的垂直偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>list</span>[<span style=color:#a6e22e>index</span>].<span style=color:#a6e22e>opacity</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 设置 Cell 的透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              })
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>list</span>[<span style=color:#a6e22e>index</span>].<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 设置 Cell 的垂直偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>list</span>[<span style=color:#a6e22e>index</span>].<span style=color:#a6e22e>opacity</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>// 设置 Cell 的透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置容器高度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置容器宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>) <span style=color:#75715e>// 设置背景颜色为黑色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=sokoban>Sokoban<a hidden class=anchor aria-hidden=true href=#sokoban>#</a></h1><p>推箱子</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span> <span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span> <span style=color:#75715e>// 导入ArkUI工具包中的提示操作模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span> <span style=color:#75715e>// 观察者模式装饰器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cell</span> { <span style=color:#75715e>// 定义游戏中的单元格类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#75715e>// 跟踪装饰器，标记属性以被跟踪
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 单元格类型，0：透明，1：墙，2：可移动区域
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>topLeft</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 左上角圆角大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>topRight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 右上角圆角大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>bottomLeft</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 左下角圆角大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>bottomRight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 右下角圆角大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 单元格的X坐标偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 单元格的Y坐标偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>cellType</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) { <span style=color:#75715e>// 构造函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cellType</span>; <span style=color:#75715e>// 初始化单元格类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span> <span style=color:#75715e>// 观察者模式装饰器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyPosition</span> { <span style=color:#75715e>// 定义位置类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#75715e>// 跟踪装饰器，标记属性以被跟踪
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>setPosition</span>(<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) { <span style=color:#75715e>// 设置位置的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>x</span>; <span style=color:#75715e>// 更新X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y</span>; <span style=color:#75715e>// 更新Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span> <span style=color:#75715e>// 入口装饰器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span> <span style=color:#75715e>// 组件装饰器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Sokoban</span>  { <span style=color:#75715e>// 定义游戏主结构
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>cellWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>; <span style=color:#75715e>// 单元格宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>grid</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[][] <span style=color:#f92672>=</span> [ <span style=color:#75715e>// 游戏网格状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>0</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>)],
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>)],
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>)],
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>)],
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>)],
</span></span><span style=display:flex><span>    [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>0</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>)],
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>victoryPositions</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>MyPosition</span>[] <span style=color:#f92672>=</span> [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MyPosition</span>(), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MyPosition</span>()]; <span style=color:#75715e>// 胜利位置数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cratePositions</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>MyPosition</span>[] <span style=color:#f92672>=</span> [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MyPosition</span>(), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MyPosition</span>()]; <span style=color:#75715e>// 箱子位置数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>playerPosition</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>MyPosition</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>MyPosition</span>(); <span style=color:#75715e>// 玩家位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>screenStartX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸开始时的屏幕X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>screenStartY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸开始时的屏幕Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>lastScreenX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸结束时的屏幕X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>lastScreenY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸结束时的屏幕Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>startTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 游戏开始时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isAnimationRunning</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span> <span style=color:#75715e>// 动画是否正在运行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> { <span style=color:#75715e>// 游戏加载前的准备工作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 初始化某些单元格的圆角大小...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>topLeft</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>0</span>][<span style=color:#ae81ff>5</span>].<span style=color:#a6e22e>topRight</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>topLeft</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>4</span>][<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>bottomLeft</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>5</span>][<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>bottomLeft</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>5</span>][<span style=color:#ae81ff>5</span>].<span style=color:#a6e22e>bottomRight</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>1</span>][<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>bottomRight</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>4</span>][<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>topRight</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>2</span>][<span style=color:#ae81ff>4</span>].<span style=color:#a6e22e>topLeft</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#ae81ff>2</span>][<span style=color:#ae81ff>4</span>].<span style=color:#a6e22e>bottomLeft</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeGame</span>(); <span style=color:#75715e>// 初始化游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>initializeGame</span>() { <span style=color:#75715e>// 初始化游戏状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startTime</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>(); <span style=color:#75715e>// 设置游戏开始时间为当前时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 设置胜利位置和箱子位置...
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startTime</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>(); <span style=color:#75715e>// 设置游戏开始时间为当前时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>victoryPositions</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>victoryPositions</span>[<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>4</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#ae81ff>1</span>].<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>3</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>setPosition</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>isVictoryPositionVisible</span>(<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> { <span style=color:#75715e>// 判断位置是否为胜利位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>victoryPositions</span>.<span style=color:#a6e22e>some</span>(<span style=color:#a6e22e>position</span> =&gt; <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>y</span>); <span style=color:#75715e>// 返回是否有胜利位置与给定位置匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>isCratePositionVisible</span>(<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> { <span style=color:#75715e>// 判断位置是否为箱子位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>.<span style=color:#a6e22e>some</span>(<span style=color:#a6e22e>position</span> =&gt; <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>position</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>y</span>); <span style=color:#75715e>// 返回是否有箱子位置与给定位置匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>isPlayerPositionVisible</span>(<span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> { <span style=color:#75715e>// 判断位置是否为玩家位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>y</span>; <span style=color:#75715e>// 返回玩家位置是否与给定位置相同
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>movePlayer</span>(<span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>directions</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>object</span> <span style=color:#f92672>=</span> Object({
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;right&#39;</span><span style=color:#f92672>:</span> Object({ <span style=color:#a6e22e>dx</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>dy</span><span style=color:#f92672>:</span>  <span style=color:#ae81ff>1</span>}),
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;left&#39;</span><span style=color:#f92672>:</span> Object({ <span style=color:#a6e22e>dx</span><span style=color:#f92672>:</span><span style=color:#ae81ff>0</span> , <span style=color:#a6e22e>dy</span><span style=color:#f92672>:-</span><span style=color:#ae81ff>1</span> }),
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;down&#39;</span><span style=color:#f92672>:</span> Object({ <span style=color:#a6e22e>dx</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>dy</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> }),
</span></span><span style=display:flex><span>      <span style=color:#e6db74>&#39;up&#39;</span><span style=color:#f92672>:</span> Object({ <span style=color:#a6e22e>dx</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>dy</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> })
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dx</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>directions</span>[<span style=color:#a6e22e>direction</span>][<span style=color:#e6db74>&#39;dx&#39;</span>]; <span style=color:#75715e>//{ dx, dy }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dy</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>directions</span>[<span style=color:#a6e22e>direction</span>][<span style=color:#e6db74>&#39;dy&#39;</span>]; <span style=color:#75715e>//{ dx, dy }
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>newX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dx</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>newY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dy</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>targetCell</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#a6e22e>newX</span>][<span style=color:#a6e22e>newY</span>];
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 检查新位置是否超出边界
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>targetCell</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 如果新位置是墙，则不能移动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>targetCell</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>crateIndex</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isCratePositionVisible</span>(<span style=color:#a6e22e>newX</span>, <span style=color:#a6e22e>newY</span>)) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>crateBehindCell</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#a6e22e>newX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dx</span>][<span style=color:#a6e22e>newY</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dy</span>];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>crateBehindCell</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>crateBehindCell</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>!==</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>crateIndex</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>.<span style=color:#a6e22e>findIndex</span>(<span style=color:#a6e22e>crate</span> =&gt; <span style=color:#a6e22e>crate</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>newX</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>crate</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>newY</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>crateIndex</span> <span style=color:#f92672>===</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>||</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isCratePositionVisible</span>(<span style=color:#a6e22e>newX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dx</span>, <span style=color:#a6e22e>newY</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dy</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>150</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }, () =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>crateIndex</span> <span style=color:#f92672>!==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>x</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>dx</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>y</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>dy</span>;
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>setPosition</span>(<span style=color:#a6e22e>newX</span>, <span style=color:#a6e22e>newY</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 检查是否获胜
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isAllCrateOnTarget</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>.<span style=color:#a6e22e>every</span>(<span style=color:#a6e22e>crate</span> =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>victoryPositions</span>.<span style=color:#a6e22e>some</span>(<span style=color:#a6e22e>victory</span> =&gt; <span style=color:#a6e22e>crate</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>victory</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>crate</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>victory</span>.<span style=color:#a6e22e>y</span>);
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isAllCrateOnTarget</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;恭喜你，你赢了！&#34;</span>);
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 可以在这里添加胜利处理逻辑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 显示对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;游戏胜利！&#39;</span>, <span style=color:#75715e>// 对话框标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;恭喜你，用时：&#39;</span> <span style=color:#f92672>+</span> ((Date.<span style=color:#a6e22e>now</span>() <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startTime</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000</span>).<span style=color:#a6e22e>toFixed</span>(<span style=color:#ae81ff>3</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;秒&#39;</span>, <span style=color:#75715e>// 对话框消息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新开始&#39;</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ffa500&#39;</span> }] <span style=color:#75715e>// 对话框按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }).<span style=color:#a6e22e>then</span>(() =&gt; { <span style=color:#75715e>// 对话框关闭后执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeGame</span>(); <span style=color:#75715e>// 重新开始游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>playerPosition</span>.<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>crateIndex</span> <span style=color:#f92672>!==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>x</span>][<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cratePositions</span>[<span style=color:#a6e22e>crateIndex</span>].<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`dx:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>dx</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,dy:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>dy</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>//游戏区
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>//非零区加瓷砖
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>, (<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> [], <span style=color:#a6e22e>rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>ForEach</span>(<span style=color:#a6e22e>row</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>, <span style=color:#a6e22e>colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span> <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                      ((<span style=color:#a6e22e>rowIndex</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>colIndex</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;#cfb381&#34;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;#e1ca9f&#34;</span>))
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>borderRadius</span>({
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>topLeft</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>topLeft</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>topLeft</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>topRight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>topRight</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>topRight</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>bottomLeft</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>bottomLeft</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>bottomLeft</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>bottomRight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>bottomRight</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>bottomRight</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>                  <span style=color:#75715e>//如果和是胜利坐标，显示叉号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>                      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                      .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>8</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>                      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>8</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                      .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>                  }.<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>45</span> })
</span></span><span style=display:flex><span>                  .<span style=color:#a6e22e>visibility</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isVictoryPositionVisible</span>(<span style=color:#a6e22e>rowIndex</span>, <span style=color:#a6e22e>colIndex</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>None</span>)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>              })
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grid</span>, (<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> [], <span style=color:#a6e22e>rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>ForEach</span>(<span style=color:#a6e22e>row</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>, <span style=color:#a6e22e>colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>                <span style=color:#75715e>//是否显示箱子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;#412c0f&#34;</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>borderRadius</span>({
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>topLeft</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>topLeft</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>topRight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>topRight</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>bottomLeft</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>bottomLeft</span>,
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>bottomRight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>bottomRight</span>
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;箱&#39;</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#cb8321&#34;</span>)<span style=color:#75715e>//#995d12   #cb8321
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>visibility</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isCratePositionVisible</span>(<span style=color:#a6e22e>rowIndex</span>, <span style=color:#a6e22e>colIndex</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>None</span>)
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;我&#39;</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#007dfe&#34;</span>)<span style=color:#75715e>//#995d12   #cb8321
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>visibility</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isPlayerPositionVisible</span>(<span style=color:#a6e22e>rowIndex</span>, <span style=color:#a6e22e>colIndex</span>) <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>None</span>)
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>translate</span>({ <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>              })
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重新开始&#39;</span>).<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>MIDDLE</span> })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeGame</span>();
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#fdb300&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> })
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>onTouch</span>((<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>TouchType</span>.<span style=color:#a6e22e>Down</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>touches</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 触摸开始，记录初始位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>touches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>x</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>touches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>TouchType</span>.<span style=color:#a6e22e>Up</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>changedTouches</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 当手指抬起时，更新最后的位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>changedTouches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>x</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>changedTouches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>gesture</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>SwipeGesture</span>({ <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SwipeDirection</span>.<span style=color:#a6e22e>All</span> })<span style=color:#75715e>// 支持方向中 all可以是上下左右
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>onAction</span>((<span style=color:#a6e22e>_event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GestureEvent</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>swipeX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenX</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartX</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>swipeY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenY</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartY</span>;
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 清除开始位置记录，准备下一次滑动判断
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>swipeX</span>) <span style=color:#f92672>&gt;</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>swipeY</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>swipeX</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 向右滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>movePlayer</span>(<span style=color:#e6db74>&#39;right&#39;</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 向左滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>movePlayer</span>(<span style=color:#e6db74>&#39;left&#39;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>swipeY</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 向下滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>movePlayer</span>(<span style=color:#e6db74>&#39;down&#39;</span>);
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 向上滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>movePlayer</span>(<span style=color:#e6db74>&#39;up&#39;</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=memory-flip>Memory Flip<a hidden class=anchor aria-hidden=true href=#memory-flip>#</a></h1><p>记忆翻转</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span> <span style=color:#75715e>// 导入用于显示对话框的模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用装饰器来观察数据变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GameCell</span> { <span style=color:#75715e>// 定义单元格类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 单元格的值，即卡片上的图案
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>isVisible</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 控制卡片是否可见
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isFrontVisible</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 控制卡片是否正面朝上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isMatched</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 标记卡片是否已被匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isAnimationRunning</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 动画是否正在运行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>rotationAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 卡片的旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) { <span style=color:#75715e>// 构造函数，初始化单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>; <span style=color:#75715e>// 设置单元格的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 展示卡片正面的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>revealFace</span>(<span style=color:#a6e22e>animationTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>callback</span><span style=color:#f92672>?:</span> () =&gt; <span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span>) { <span style=color:#75715e>// 如果已经有动画在运行，则返回
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置动画状态为运行中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>animateToImmediately</span>({ <span style=color:#75715e>// 开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>animateToImmediately</span>({ <span style=color:#75715e>// 再次开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isFrontVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置卡片为正面朝上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置卡片为可见
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 设置旋转角度为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置卡片为不可见
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>; <span style=color:#75715e>// 设置旋转角度为90度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 重置卡片状态的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>reset</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置卡片为不可见
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 设置旋转角度为180度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isFrontVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置卡片为背面朝上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isMatched</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置卡片为未匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 隐藏卡片正面的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>hideFace</span>(<span style=color:#a6e22e>animationTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>callback</span><span style=color:#f92672>?:</span> () =&gt; <span style=color:#66d9ef>void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span>) { <span style=color:#75715e>// 如果已经有动画在运行，则返回
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置动画状态为运行中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>animateToImmediately</span>({ <span style=color:#75715e>// 开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>animateToImmediately</span>({ <span style=color:#75715e>// 再次开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isFrontVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置卡片为背面朝上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置卡片为不可见
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 设置旋转角度为180度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isVisible</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置卡片为可见
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>; <span style=color:#75715e>// 设置旋转角度为90度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义组件入口
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>MemoryGame</span> { <span style=color:#75715e>// 定义游戏组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>gameCells</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GameCell</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 存储游戏中的所有单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellSize</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>150</span>; <span style=color:#75715e>// 单元格的大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellSpacing</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// 单元格之间的间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>transitionDuration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>150</span>; <span style=color:#75715e>// 过渡动画的持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>firstSelectedIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 记录第一次选择的卡片索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>secondSelectedIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 记录第二次选择的卡片索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isGameOver</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 游戏是否结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>startTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 游戏开始时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> { <span style=color:#75715e>// 组件即将显示时触发
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cardValues</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;A&#34;</span>, <span style=color:#e6db74>&#34;B&#34;</span>, <span style=color:#e6db74>&#34;C&#34;</span>, <span style=color:#e6db74>&#34;D&#34;</span>, <span style=color:#e6db74>&#34;E&#34;</span>, <span style=color:#e6db74>&#34;F&#34;</span>, <span style=color:#e6db74>&#34;G&#34;</span>, <span style=color:#e6db74>&#34;H&#34;</span>]; <span style=color:#75715e>// 定义卡片的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>value</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>cardValues</span>) { <span style=color:#75715e>// 遍历卡片值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GameCell</span>(<span style=color:#a6e22e>value</span>)); <span style=color:#75715e>// 添加到游戏单元格数组中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GameCell</span>(<span style=color:#a6e22e>value</span>)); <span style=color:#75715e>// 每个值添加两次以形成对
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>shuffleCards</span>(); <span style=color:#75715e>// 洗牌
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 洗牌方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>shuffleCards</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 清除第一次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 清除第二次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 游戏未结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startTime</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>(); <span style=color:#75715e>// 设置游戏开始时间为当前时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>16</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) { <span style=color:#75715e>// 重置所有单元格状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>reset</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>--</span>) { <span style=color:#75715e>// 洗牌算法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomIndex</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)); <span style=color:#75715e>// 随机索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tempValue</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>value</span>; <span style=color:#75715e>// 临时保存值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#a6e22e>randomIndex</span>].<span style=color:#a6e22e>value</span>; <span style=color:#75715e>// 交换值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#a6e22e>randomIndex</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tempValue</span>; <span style=color:#75715e>// 交换值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 检查卡片是否匹配的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>checkForMatch</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>) { <span style=color:#75715e>// 确保两个索引都不为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>firstCell</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span>]; <span style=color:#75715e>// 获取第一个选中的单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>secondCell</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span>]; <span style=color:#75715e>// 获取第二个选中的单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>firstCell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>secondCell</span>.<span style=color:#a6e22e>value</span>) { <span style=color:#75715e>// 如果两个单元格的值相同
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>firstCell</span>.<span style=color:#a6e22e>isMatched</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 标记为已匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>secondCell</span>.<span style=color:#a6e22e>isMatched</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 标记为已匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 清除第一次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 清除第二次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>.<span style=color:#a6e22e>every</span>(<span style=color:#a6e22e>cell</span> =&gt; <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>isMatched</span>)) { <span style=color:#75715e>// 如果所有单元格都已匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 游戏结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;游戏结束&#34;</span>); <span style=color:#75715e>// 打印信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({ <span style=color:#75715e>// 显示对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;游戏胜利！&#39;</span>, <span style=color:#75715e>// 对话框标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;恭喜你，用时：&#39;</span> <span style=color:#f92672>+</span> ((Date.<span style=color:#a6e22e>now</span>() <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startTime</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000</span>).<span style=color:#a6e22e>toFixed</span>(<span style=color:#ae81ff>3</span>) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;秒&#39;</span>, <span style=color:#75715e>// 对话框消息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新开始&#39;</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ffa500&#39;</span> }] <span style=color:#75715e>// 对话框按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }).<span style=color:#a6e22e>then</span>(() =&gt; { <span style=color:#75715e>// 对话框关闭后执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>shuffleCards</span>(); <span style=color:#75715e>// 重新开始游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> { <span style=color:#75715e>// 如果两个单元格的值不同
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>setTimeout</span>(() =&gt; { <span style=color:#75715e>// 延迟一段时间后
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>) { <span style=color:#75715e>// 如果第一个索引不为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span>].<span style=color:#a6e22e>hideFace</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>, () =&gt; { <span style=color:#75715e>// 隐藏卡片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 清除第一次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span> <span style=color:#f92672>!==</span> <span style=color:#66d9ef>null</span>) { <span style=color:#75715e>// 如果第二个索引不为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span>].<span style=color:#a6e22e>hideFace</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>, () =&gt; { <span style=color:#75715e>// 隐藏卡片
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 清除第二次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }, <span style=color:#ae81ff>400</span>); <span style=color:#75715e>// 延迟时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建游戏界面的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) { <span style=color:#75715e>// 创建一个垂直布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span> }) { <span style=color:#75715e>// 创建一个可换行的弹性布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCells</span>, (<span style=color:#a6e22e>gameCell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GameCell</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 遍历游戏单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>isVisible</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>) <span style=color:#75715e>// 显示单元格的值或空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>) <span style=color:#75715e>// 文本居中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>isVisible</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>rotate</span>({ <span style=color:#75715e>// 设置旋转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>z</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>rotationAngle</span>, <span style=color:#75715e>// 旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>centerX</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#75715e>// 中心点X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>centerY</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#75715e>// 中心点Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 单击事件处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span>) { <span style=color:#75715e>// 如果游戏已结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;游戏已结束&#34;</span>); <span style=color:#75715e>// 打印信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>isMatched</span>) { <span style=color:#75715e>// 如果单元格已匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;当前已标记&#34;</span>); <span style=color:#75715e>// 打印信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) { <span style=color:#75715e>// 如果没有第一次选择
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>index</span>; <span style=color:#75715e>// 设置第一次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>isFrontVisible</span>) { <span style=color:#75715e>// 如果不是正面朝上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>revealFace</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>); <span style=color:#75715e>// 展示正面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                }
</span></span><span style=display:flex><span>              } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>firstSelectedIndex</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>index</span>) { <span style=color:#75715e>// 如果与第一次选择相同
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#34;和上一次点击的是一样的，不予处理&#34;</span>); <span style=color:#75715e>// 打印信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>null</span>) { <span style=color:#75715e>// 如果没有第二次选择
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>secondSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>index</span>; <span style=color:#75715e>// 设置第二次选择索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>isFrontVisible</span>) { <span style=color:#75715e>// 如果不是正面朝上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>gameCell</span>.<span style=color:#a6e22e>revealFace</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>, () =&gt; { <span style=color:#75715e>// 展示正面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkForMatch</span>(); <span style=color:#75715e>// 检查是否匹配
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  });
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>); <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重新开始&#39;</span>) <span style=color:#75715e>// 创建“重新开始”按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 按钮点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>shuffleCards</span>(); <span style=color:#75715e>// 重新开始游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>    }.<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>); <span style=color:#75715e>// 设置高度和宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=3cup--ball>3cup ball<a hidden class=anchor aria-hidden=true href=#3cup--ball>#</a></h1><p>三杯猜球</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 使用装饰器来追踪对象的变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cup</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 使用装饰器来追踪属性的变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>positionX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 杯子的X轴位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>positionY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 杯子的Y轴位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>containsBall</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>; <span style=color:#75715e>// 杯子内是否有球
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>isRevealed</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>; <span style=color:#75715e>// 杯子是否打开
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构造函数初始化杯子的状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>hasBall</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>positionX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containsBall</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hasBall</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isRevealed</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 游戏入口组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>ThreeCupGame</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 游戏状态变量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>gameCups</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cup</span>[] <span style=color:#f92672>=</span> [<span style=color:#75715e>// 初始化三个杯子，其中一个有球
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cup</span>(<span style=color:#66d9ef>true</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cup</span>(<span style=color:#66d9ef>false</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cup</span>(<span style=color:#66d9ef>false</span>)
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cupWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>; <span style=color:#75715e>// 杯子宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cupSpacing</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>; <span style=color:#75715e>// 杯子之间的间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>animationDurationMs</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>140</span>; <span style=color:#75715e>// 动画持续时间（毫秒）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isGameAnimating</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 是否正在动画中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>mixingCount</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// 每局游戏混合次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>currentMixingCount</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 当前正在进行的混合次数计数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 开始游戏的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>startGame</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentMixingCount</span><span style=color:#f92672>--</span>; <span style=color:#75715e>// 减少混合次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cupPairs</span> <span style=color:#f92672>=</span> [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>], [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>]]; <span style=color:#75715e>// 可能的杯子对组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>selectedPair</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cupPairs</span>[Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#a6e22e>cupPairs</span>.<span style=color:#a6e22e>length</span>)]; <span style=color:#75715e>// 随机选择一对
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>moveCups</span>(<span style=color:#a6e22e>selectedPair</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>selectedPair</span>[<span style=color:#ae81ff>1</span>]); <span style=color:#75715e>// 开始移动选定的两个杯子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 移动指定的两个杯子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>moveCups</span>(<span style=color:#a6e22e>cupIndex1</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>cupIndex2</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.5</span> <span style=color:#f92672>?</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 随机方向
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>distanceFactor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>cupIndex1</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>cupIndex2</span>); <span style=color:#75715e>// 距离因子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>adjustedDistanceFactor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>distanceFactor</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 根据距离调整因子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>delay</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex1</span>].<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>direction</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>adjustedDistanceFactor</span>
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>delay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex1</span>].<span style=color:#a6e22e>positionX</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>distanceFactor</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex1</span>].<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>direction</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>adjustedDistanceFactor</span>
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>delay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex1</span>].<span style=color:#a6e22e>positionX</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>distanceFactor</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex1</span>].<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>delay</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex2</span>].<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>direction</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>adjustedDistanceFactor</span>
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>delay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex2</span>].<span style=color:#a6e22e>positionX</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>distanceFactor</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex2</span>].<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>direction</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>adjustedDistanceFactor</span>
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>delay</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>swapBalls</span>(<span style=color:#a6e22e>cupIndex1</span>, <span style=color:#a6e22e>cupIndex2</span>)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex2</span>].<span style=color:#a6e22e>positionX</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>distanceFactor</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex2</span>].<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 重置杯子的位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>resetCupPosition</span>(<span style=color:#a6e22e>cupIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex</span>].<span style=color:#a6e22e>positionX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex</span>].<span style=color:#a6e22e>positionY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 交换两个杯子内的球
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>swapBalls</span>(<span style=color:#a6e22e>cupIndex1</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>cupIndex2</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>resetCupPosition</span>(<span style=color:#a6e22e>cupIndex1</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>resetCupPosition</span>(<span style=color:#a6e22e>cupIndex2</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>temporaryBallStatus</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex1</span>].<span style=color:#a6e22e>containsBall</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex1</span>].<span style=color:#a6e22e>containsBall</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex2</span>].<span style=color:#a6e22e>containsBall</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>[<span style=color:#a6e22e>cupIndex2</span>].<span style=color:#a6e22e>containsBall</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>temporaryBallStatus</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentMixingCount</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameAnimating</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startGame</span>();
</span></span><span style=display:flex><span>      }, <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建游戏界面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 游戏标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;猜小球游戏&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>24</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 动画速度控制器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Counter</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`当前速度</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span><span style=color:#e6db74>}</span><span style=color:#e6db74>毫秒`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>&#39;26lpx&#39;</span>);
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;400lpx&#39;</span>).<span style=color:#a6e22e>onInc</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>      }).<span style=color:#a6e22e>onDec</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>animationDurationMs</span>;
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 混合次数控制器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Counter</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`每局混合</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mixingCount</span><span style=color:#e6db74>}</span><span style=color:#e6db74>次`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>&#39;26lpx&#39;</span>);
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;400lpx&#39;</span>).<span style=color:#a6e22e>onInc</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mixingCount</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      }).<span style=color:#a6e22e>onDec</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mixingCount</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mixingCount</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mixingCount</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mixingCount</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 杯子布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>, (<span style=color:#a6e22e>cup</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cup</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>cup</span>.<span style=color:#a6e22e>isRevealed</span> <span style=color:#f92672>?</span> (<span style=color:#a6e22e>cup</span>.<span style=color:#a6e22e>containsBall</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;小球&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;空&#39;</span>) <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cupWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>translate</span>({ <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>cup</span>.<span style=color:#a6e22e>positionX</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>cup</span>.<span style=color:#a6e22e>positionY</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameAnimating</span>) {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>cup</span>.<span style=color:#a6e22e>isRevealed</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>Center</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;720lpx&#39;</span>).<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 开始游戏按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;开始游戏&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameAnimating</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentMixingCount</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mixingCount</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameAnimating</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameCups</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>cup</span> =&gt; <span style=color:#a6e22e>cup</span>.<span style=color:#a6e22e>isRevealed</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>);
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startGame</span>();
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=2048>2048<a hidden class=anchor aria-hidden=true href=#2048>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用装饰器标记Cell类，可能表示该类具有可观测性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cell</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 使用Trace装饰器标记value属性，可能表示该属性的变化会被追踪
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构造函数初始化单元格的值为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用Entry和Component装饰器标记Game2048结构体，可能表示这是程序的入口点，并且该结构体定义了一个组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义Game2048结构体
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Game2048</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 使用State装饰器标记状态变量，可能表示这些变量是组件的状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>board</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[][] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 游戏盘面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>score</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 分数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellSize</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>; <span style=color:#75715e>// 单元格大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellMargin</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// 单元格之间的边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>screenStartX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸开始时的屏幕X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>screenStartY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸开始时的屏幕Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>lastScreenX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸结束时的屏幕X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>lastScreenY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 触摸结束时的屏幕Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义颜色数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>colors</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;#CCCCCC&#39;</span>, <span style=color:#75715e>// 0 - 灰色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#FFC107&#39;</span>, <span style=color:#75715e>// 2 - 黄色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#FF9800&#39;</span>, <span style=color:#75715e>// 4 - 橙色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#FF5722&#39;</span>, <span style=color:#75715e>// 8 - 深橙色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#F44336&#39;</span>, <span style=color:#75715e>// 16 - 红色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#9C27B0&#39;</span>, <span style=color:#75715e>// 32 - 紫色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#3F51B5&#39;</span>, <span style=color:#75715e>// 64 - 蓝紫色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#00BCD4&#39;</span>, <span style=color:#75715e>// 128 - 蓝色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#009688&#39;</span>, <span style=color:#75715e>// 256 - 深青色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#4CAF50&#39;</span>, <span style=color:#75715e>// 512 - 绿色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#8BC34A&#39;</span>, <span style=color:#75715e>// 1024 - 浅绿色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#CDDC39&#39;</span>, <span style=color:#75715e>// 2048 - 柠檬黄
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#FFEB3B&#39;</span>, <span style=color:#75715e>// 4096 - 淡黄色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#795548&#39;</span>, <span style=color:#75715e>// 8192 - 棕色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#607D8B&#39;</span>, <span style=color:#75715e>// 16384 - 深灰色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#9E9E9E&#39;</span>, <span style=color:#75715e>// 32768 - 灰色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#39;#000000&#39;</span> <span style=color:#75715e>// 以上 - 黑色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  ];
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 游戏即将出现时执行的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>score</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 重置分数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initBoard</span>(); <span style=color:#75715e>// 重新初始化游戏板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>addRandomTiles</span>(<span style=color:#ae81ff>2</span>); <span style=color:#75715e>// 添加两个随机方块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 初始化游戏盘面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>initBoard</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cellArr</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>cellArr</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>()); <span style=color:#75715e>// 创建新单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>cellArr</span>); <span style=color:#75715e>// 添加到盘面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 清空单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 在盘面上添加指定数量的随机方块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>addRandomTiles</span>(<span style=color:#a6e22e>count</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>emptyCells</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>object</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>emptyCells</span>.<span style=color:#a6e22e>push</span>(Object({ <span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>col</span> })); <span style=color:#75715e>// 记录空单元格位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>count</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>emptyCells</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>randomIndex</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#a6e22e>emptyCells</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>obj</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>emptyCells</span>[<span style=color:#a6e22e>randomIndex</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>obj</span>[<span style=color:#e6db74>&#39;row&#39;</span>]][<span style=color:#a6e22e>obj</span>[<span style=color:#e6db74>&#39;col&#39;</span>]].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0.9</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>; <span style=color:#75715e>// 随机生成2或4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>emptyCells</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>randomIndex</span>, <span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 移除已使用的空单元格位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 向左滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>slideLeft</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tempRow</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 临时存储行数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>merged</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>[] <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>4</span>).<span style=color:#a6e22e>fill</span>(<span style=color:#66d9ef>false</span>); <span style=color:#75715e>// 标记是否已经合并过
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>!==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span>); <span style=color:#75715e>// 移动非零值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>===</span> <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span>]) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>score</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span>]; <span style=color:#75715e>// 更新分数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 标记已合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 移除合并过的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>mergePos</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>push</span>(<span style=color:#ae81ff>0</span>); <span style=color:#75715e>// 填充空位
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>col</span>]; <span style=color:#75715e>// 更新盘面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 向右滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>slideRight</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tempRow</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 临时存储行数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>merged</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>[] <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>4</span>).<span style=color:#a6e22e>fill</span>(<span style=color:#66d9ef>false</span>); <span style=color:#75715e>// 标记是否已经合并过
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>!==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>unshift</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span>); <span style=color:#75715e>// 移动非零值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>===</span> <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>score</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>mergePos</span>]; <span style=color:#75715e>// 更新分数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 标记已合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 移除合并过的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>mergePos</span><span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tempRow</span>.<span style=color:#a6e22e>unshift</span>(<span style=color:#ae81ff>0</span>); <span style=color:#75715e>// 填充空位
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tempRow</span>[<span style=color:#a6e22e>col</span>]; <span style=color:#75715e>// 更新盘面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 向上滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>slideUp</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tempCol</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 临时存储列数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>merged</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>[] <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>4</span>).<span style=color:#a6e22e>fill</span>(<span style=color:#66d9ef>false</span>); <span style=color:#75715e>// 标记是否已经合并过
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>!==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span>); <span style=color:#75715e>// 移动非零值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>===</span> <span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span>]) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>score</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span>]; <span style=color:#75715e>// 更新分数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 标记已合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 移除合并过的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>mergePos</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>push</span>(<span style=color:#ae81ff>0</span>); <span style=color:#75715e>// 填充空位
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newRow</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>newRow</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>newRow</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>newRow</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>newRow</span>]; <span style=color:#75715e>// 更新盘面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 向下滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>slideDown</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tempCol</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 临时存储列数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>merged</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>[] <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Array(<span style=color:#ae81ff>4</span>).<span style=color:#a6e22e>fill</span>(<span style=color:#66d9ef>false</span>); <span style=color:#75715e>// 标记是否已经合并过
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 从下往上遍历列
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>!==</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>unshift</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span>); <span style=color:#75715e>// 移动非零值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>===</span> <span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>]) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span>] <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>score</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>tempCol</span>[<span style=color:#a6e22e>mergePos</span>]; <span style=color:#75715e>// 更新分数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>merged</span>[<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 标记已合并
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>mergePos</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 移除合并过的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>mergePos</span><span style=color:#f92672>--</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 如果数组长度小于4，用0填充
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>tempCol</span>.<span style=color:#a6e22e>unshift</span>(<span style=color:#ae81ff>0</span>); <span style=color:#75715e>// 填充空位
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 将处理后的数组元素放回到棋盘的对应列中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>4</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#ae81ff>3</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>tempCol</span>[<span style=color:#ae81ff>3</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>row</span>]; <span style=color:#75715e>// 注意反转顺序
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建游戏界面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 布局容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> }) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 显示得分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`得分: </span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>score</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>24</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> })
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 底层背景布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span>, <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexDirection</span>.<span style=color:#a6e22e>Row</span> }) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 遍历每个单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>.<span style=color:#a6e22e>flat</span>(), (<span style=color:#a6e22e>cell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 显示单元格上的数字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellMargin</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>100</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>) <span style=color:#75715e>// 根据数字大小调整字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colors</span>[<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span><span style=color:#f92672>?</span><span style=color:#ae81ff>0</span><span style=color:#f92672>:</span>Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>log2</span>(<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span>))]) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;#000&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#fff&#39;</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellMargin</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>4</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>) <span style=color:#75715e>// 设置容器宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 重新开始按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重新开始&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>aboutToAppear</span>(); <span style=color:#75715e>// 重新开始游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      })
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>onTouch</span>((<span style=color:#a6e22e>e</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>TouchType</span>.<span style=color:#a6e22e>Down</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>touches</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 触摸开始，记录初始位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>touches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>x</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>touches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>type</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>TouchType</span>.<span style=color:#a6e22e>Up</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>changedTouches</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 当手指抬起时，更新最后的位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>changedTouches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>x</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>changedTouches</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>y</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    })
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>gesture</span>(
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>SwipeGesture</span>({ <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SwipeDirection</span>.<span style=color:#a6e22e>All</span> }) <span style=color:#75715e>// 支持方向中 all可以是上下左右
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>onAction</span>((<span style=color:#a6e22e>_event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GestureEvent</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>swipeX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenX</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartX</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>swipeY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lastScreenY</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartY</span>;
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 清除开始位置记录，准备下一次滑动判断
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartX</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>screenStartY</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>swipeX</span>) <span style=color:#f92672>&gt;</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>swipeY</span>)) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>swipeX</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>slideRight</span>(); <span style=color:#75715e>// 向右滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>slideLeft</span>(); <span style=color:#75715e>// 向左滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>          } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>swipeY</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>slideDown</span>(); <span style=color:#75715e>// 向下滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>slideUp</span>(); <span style=color:#75715e>// 向上滑动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>addRandomTiles</span>(<span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 添加一个随机方块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        })
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=x>X✔<a hidden class=anchor aria-hidden=true href=#x>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>winningLines</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>], <span style=color:#75715e>// Horizontal 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>], <span style=color:#75715e>// Horizontal 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  [<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>], <span style=color:#75715e>// Horizontal 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>], <span style=color:#75715e>// Vertical 1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>], <span style=color:#75715e>// Vertical 2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>], <span style=color:#75715e>// Vertical 3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>], <span style=color:#75715e>// Diagonal \
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>]<span style=color:#75715e>// Diagonal /
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>];
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>GridCell</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 当前格子的值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 格子所在的行号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 格子所在的列号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rowIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rowIndex</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>colIndex</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>TicTacToe</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>board</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GridCell</span>[][] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 游戏板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>currentPlayer</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;X&#39;</span>; <span style=color:#75715e>// 当前玩家
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isGameOver</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 游戏是否结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>winner</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 获胜者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellSize</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>120</span>; <span style=color:#75715e>// 单元格大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellMargin</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// 单元格边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 组件即将出现时初始化游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>)],
</span></span><span style=display:flex><span>      [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>)],
</span></span><span style=display:flex><span>      [<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>1</span>), <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>GridCell</span>(<span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>2</span>)]
</span></span><span style=display:flex><span>    ];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGame</span>(); <span style=color:#75715e>// 初始化游戏状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 重置游戏状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>initGame</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 清空所有单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayer</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;X&#39;</span>; <span style=color:#75715e>// 设置当前玩家为X
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 游戏未结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>winner</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 无获胜者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 检查是否有玩家获胜
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>checkForWinner</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>line</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>winningLines</span>) { <span style=color:#75715e>// 遍历所有胜利线路
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mark</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>line</span>[<span style=color:#ae81ff>0</span>]][<span style=color:#a6e22e>line</span>[<span style=color:#ae81ff>1</span>]].<span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mark</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#75715e>// 如果有标记
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>mark</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>line</span>[<span style=color:#ae81ff>2</span>]][<span style=color:#a6e22e>line</span>[<span style=color:#ae81ff>3</span>]].<span style=color:#a6e22e>value</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#75715e>// 并且等于同一行的下一个标记
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>mark</span> <span style=color:#f92672>===</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>line</span>[<span style=color:#ae81ff>4</span>]][<span style=color:#a6e22e>line</span>[<span style=color:#ae81ff>5</span>]].<span style=color:#a6e22e>value</span>) { <span style=color:#75715e>// 再次等于同一行的下一个标记
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 游戏结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>winner</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mark</span>; <span style=color:#75715e>// 设置获胜者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>mark</span>; <span style=color:#75715e>// 返回获胜者的标记
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>allCellsFilled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>.<span style=color:#a6e22e>flat</span>().<span style=color:#a6e22e>every</span>(<span style=color:#a6e22e>cell</span> =&gt; <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;&#39;</span>); <span style=color:#75715e>// 检查所有单元格是否已填满
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>allCellsFilled</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 游戏结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>winner</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;平局&#39;</span>; <span style=color:#75715e>// 设置为平局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;平局&#39;</span>; <span style=color:#75715e>// 返回平局标识
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 无获胜者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 玩家落子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>placeMark</span>(<span style=color:#a6e22e>rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>rowIndex</span>][<span style=color:#a6e22e>colIndex</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;&#39;</span>) { <span style=color:#75715e>// 如果游戏未结束且单元格为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>rowIndex</span>][<span style=color:#a6e22e>colIndex</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayer</span>; <span style=color:#75715e>// 放置标记
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkForWinner</span>(); <span style=color:#75715e>// 检查是否有获胜者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>result</span>) { <span style=color:#75715e>// 如果有获胜者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>result</span><span style=color:#e6db74>}</span><span style=color:#e6db74> 获胜！`</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>result</span><span style=color:#e6db74>}</span><span style=color:#e6db74> 获胜！`</span>; <span style=color:#75715e>// 设置提示信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>result</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;平局&#39;</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;平局！&#39;</span>; <span style=color:#75715e>// 如果是平局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({ <span style=color:#75715e>// 显示对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`游戏结束`</span>, <span style=color:#75715e>// 标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>message</span>, <span style=color:#75715e>// 提示信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> [ <span style=color:#75715e>// 按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新开始&#39;</span>, <span style=color:#75715e>// 文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ffa500&#39;</span> <span style=color:#75715e>// 颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>          ],
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGame</span>(); <span style=color:#75715e>// 重新开始游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> { <span style=color:#75715e>// 如果没有获胜者
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayer</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayer</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;X&#39;</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;O&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;X&#39;</span>; <span style=color:#75715e>// 切换玩家
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayer</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;O&#39;</span>) { <span style=color:#75715e>// 如果是AI玩家
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>aiMove</span>(); <span style=color:#75715e>// AI落子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// AI落子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aiMove</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>moveFound</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>bestMove</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> <span style=color:#66d9ef>null</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 寻找最佳落子位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>bestMove</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>findWinningMove</span>(<span style=color:#e6db74>&#39;O&#39;</span>); <span style=color:#75715e>// 检查AI是否有胜利机会
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`bestMove a:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>bestMove</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>bestMove</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>moveFound</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>bestMove</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>findWinningMove</span>(<span style=color:#e6db74>&#39;X&#39;</span>); <span style=color:#75715e>// 检查玩家是否有胜利机会
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`bestMove b:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>bestMove</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>bestMove</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>moveFound</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>bestMove</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>findRandomMove</span>(); <span style=color:#75715e>// 随机落子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`bestMove c:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>bestMove</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>bestMove</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>moveFound</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>moveFound</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>bestMove</span>) { <span style=color:#75715e>// 如果找到了合适的落子位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`bestMove:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>bestMove</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>placeMark</span>(<span style=color:#a6e22e>bestMove</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>bestMove</span>[<span style=color:#ae81ff>1</span>]); <span style=color:#75715e>// 落子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 寻找给定玩家是否有机会赢，并返回这样的移动位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>findWinningMove</span>(<span style=color:#a6e22e>player</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>line</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>winningLines</span>) { <span style=color:#75715e>// 遍历所有胜利线路
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>missingIndex</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>noEmptyCount</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>line</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>2</span>) { <span style=color:#75715e>// 检查每个单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>line</span>[<span style=color:#a6e22e>i</span>]][<span style=color:#a6e22e>line</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]].<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>player</span>) { <span style=color:#75715e>// 如果是该玩家的标记
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>noEmptyCount</span><span style=color:#f92672>++</span>; <span style=color:#75715e>// 计数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>line</span>[<span style=color:#a6e22e>i</span>]][<span style=color:#a6e22e>line</span>[<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]].<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;&#39;</span>) { <span style=color:#75715e>// 如果为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>missingIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span>; <span style=color:#75715e>// 记录空格位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>noEmptyCount</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>missingIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) { <span style=color:#75715e>// 如果有两个标记且有一个空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> [<span style=color:#a6e22e>line</span>[<span style=color:#a6e22e>missingIndex</span>], <span style=color:#a6e22e>line</span>[<span style=color:#a6e22e>missingIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>]]; <span style=color:#75715e>// 返回空格位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 未找到合适位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 寻找一个随机的合法落子位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>findRandomMove</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>emptyCells</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[][] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 存储空格位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;&#39;</span>) { <span style=color:#75715e>// 如果单元格为空
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>emptyCells</span>.<span style=color:#a6e22e>push</span>([<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>]); <span style=color:#75715e>// 添加到空格列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>emptyCells</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 如果有空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>emptyCells</span>[Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#a6e22e>emptyCells</span>.<span style=color:#a6e22e>length</span>)]; <span style=color:#75715e>// 随机选择一个空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>null</span>; <span style=color:#75715e>// 未找到空格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建游戏界面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) { <span style=color:#75715e>// 创建主列布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span> }) { <span style=color:#75715e>// 创建主行布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>board</span>, (<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GridCell</span>[], <span style=color:#a6e22e>_index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 遍历每一行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#a6e22e>row</span>, (<span style=color:#a6e22e>cell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GridCell</span>, <span style=color:#a6e22e>_index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 遍历每一个单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span>) <span style=color:#75715e>// 显示单元格内的文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellMargin</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>) <span style=color:#75715e>// 居中文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;X&#39;</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Red</span> <span style=color:#f92672>:</span> <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;O&#39;</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Blue</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>placeMark</span>(<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>rowIndex</span>, <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>colIndex</span>); <span style=color:#75715e>// 落子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              });
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellMargin</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重新开始&#39;</span>) <span style=color:#75715e>// 重新开始按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;10%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGame</span>(); <span style=color:#75715e>// 重新开始游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>); <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=mine>mine<a hidden class=anchor aria-hidden=true href=#mine>#</a></h1><p>扫雷</p><p>实现步骤</p><p>步骤1：定义游戏状态</p><p>首先，我们需要定义游戏的状态变量，包括游戏面板数据、地雷数量、已揭示方块集合、标记为地雷的方块集合等。</p><p>步骤2：初始化游戏</p><p>在组件即将显示时初始化游戏，包括清空状态变量、生成游戏面板、放置地雷等。</p><p>步骤3：生成游戏面板与放置地雷</p><p>游戏面板由10x10的方块组成，随机放置10个地雷，并计算每个方块周围的地雷数量。</p><p>步骤4：处理用户交互</p><p>用户可以通过点击方块来揭示其内容，也可以通过长按来标记地雷。</p><p>步骤5：显示游戏结果</p><p>当玩家揭示到地雷时，游戏结束；当所有非雷方块都被揭示时，游戏胜利。</p><p>步骤6：定义Cell类</p><p>最后，定义一个Cell类来存储每个方块的信息。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>MineSweeper</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 游戏面板数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>gameBoard</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[][] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 地雷总数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>mineCount</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 已经揭示的方块集合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>revealedCells</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Set</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>string</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Set</span>();
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 标记为地雷的方块集合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>flaggedCells</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Set</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>string</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Set</span>();
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 方块大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>cellSize</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>60</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 方块之间的边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>cellMargin</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 游戏开始时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>startTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>();
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 游戏结束标志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>isGameOver</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 在组件即将显示时初始化游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeGame</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 初始化游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>initializeGame</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startTime</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>clear</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>flaggedCells</span>.<span style=color:#a6e22e>clear</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generateBoard</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 生成游戏面板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>generateBoard</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>.<span style=color:#a6e22e>push</span>([]);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>));
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>placeMines</span>();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateNumbers</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 随机放置地雷
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>placeMines</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>placed</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>placed</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>mineCount</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>x</span>][<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>hasMine</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>x</span>][<span style=color:#a6e22e>y</span>].<span style=color:#a6e22e>hasMine</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>placed</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 计算每个方块周围的地雷数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateNumbers</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>hasMine</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>neighborMines</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>countNeighborMines</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>);
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>neighborMines</span>.<span style=color:#a6e22e>toString</span>();
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;雷&#39;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 计算给定坐标周围地雷的数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>countNeighborMines</span>(<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>col</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>count</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dx</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dx</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dy</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dy</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newRow</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dx</span>, <span style=color:#a6e22e>newCol</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dy</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>newRow</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>newRow</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>newCol</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>newCol</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>newRow</span>][<span style=color:#a6e22e>newCol</span>].<span style=color:#a6e22e>hasMine</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>count</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>count</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 揭示方块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>revealCell</span>(<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>col</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>||</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>has</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>row</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>col</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>row</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>col</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>key</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>hasMine</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showGameOverDialog</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>neighborMines</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dx</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dx</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dx</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dy</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>dy</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dx</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>dy</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>continue</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newRow</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dx</span>, <span style=color:#a6e22e>newCol</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>dy</span>;
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>newRow</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>newRow</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>newCol</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>newCol</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>10</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealCell</span>(<span style=color:#a6e22e>newRow</span>, <span style=color:#a6e22e>newCol</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isVictory</span>()) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showVictoryDialog</span>();
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 显示游戏结束对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>showGameOverDialog</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;游戏结束: 游戏失败！&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新开始&#39;</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ffa500&#39;</span> }]
</span></span><span style=display:flex><span>    }).<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeGame</span>();
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 显示胜利对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>showVictoryDialog</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;恭喜你，游戏胜利！&#39;</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`用时：</span><span style=color:#e6db74>${</span>((Date.<span style=color:#a6e22e>now</span>() <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startTime</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000</span>).<span style=color:#a6e22e>toFixed</span>(<span style=color:#ae81ff>3</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>秒`</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新开始&#39;</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ffa500&#39;</span> }]
</span></span><span style=display:flex><span>    }).<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeGame</span>();
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 判断游戏是否胜利
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>isVictory</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>revealedNonMineCount</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>has</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>i</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>j</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>revealedNonMineCount</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>revealedNonMineCount</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>90</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 决定是否显示方块值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>isShowValue</span>(<span style=color:#a6e22e>cell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>has</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>row</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>column</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;&#39;</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>value</span>;
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> }) {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 重置游戏按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重新开始&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initializeGame</span>());
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建游戏面板容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span> }) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 遍历每一行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>gameBoard</span>, (<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[], <span style=color:#a6e22e>rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 遍历每一列
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#a6e22e>row</span>, (<span style=color:#a6e22e>cell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>, <span style=color:#a6e22e>colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 显示方块上的数字或雷
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isShowValue</span>(<span style=color:#a6e22e>cell</span>))
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellMargin</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>has</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rowIndex</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>colIndex</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>) <span style=color:#f92672>?</span>
</span></span><span style=display:flex><span>                  (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isShowValue</span>(<span style=color:#a6e22e>cell</span>) <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;雷&#39;</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Red</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>has</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rowIndex</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>colIndex</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>) <span style=color:#f92672>||</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isShowValue</span>(<span style=color:#a6e22e>cell</span>) <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;雷&#39;</span> <span style=color:#f92672>?</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>parallelGesture</span>(<span style=color:#a6e22e>GestureGroup</span>(<span style=color:#a6e22e>GestureMode</span>.<span style=color:#a6e22e>Exclusive</span>,
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>TapGesture</span>({ <span style=color:#a6e22e>count</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>fingers</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> })
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>onAction</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealCell</span>(<span style=color:#a6e22e>rowIndex</span>, <span style=color:#a6e22e>colIndex</span>)),
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>LongPressGesture</span>({ <span style=color:#a6e22e>repeat</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> })
</span></span><span style=display:flex><span>                    .<span style=color:#a6e22e>onAction</span>(() =&gt; <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>isFlag</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>)
</span></span><span style=display:flex><span>                ));
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 显示标记旗帜
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>revealedCells</span>.<span style=color:#a6e22e>has</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>rowIndex</span><span style=color:#e6db74>}</span><span style=color:#e6db74>,</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>colIndex</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>) <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;旗&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellMargin</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>visibility</span>(<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>isFlag</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isGameOver</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>None</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>isFlag</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellMargin</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 方块类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cell</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 方块所在的行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 方块所在的列
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>column</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 是否有地雷
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>hasMine</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 周围地雷数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>neighborMines</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 是否被标记为地雷
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>isFlag</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 方块值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构造函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>column</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>row</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>column</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>column</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>value</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=schrulte-grid>Schrulte Grid<a hidden class=anchor aria-hidden=true href=#schrulte-grid>#</a></h1><p>舒尔特方格（Schrulte Grid），也被称为舒尔特表或舒尔特图表，是一种用于训练注意力、视觉搜索速度和广度的简单而有效的工具。它通常由一个5x5的方格组成，每个小格子里随机填写了1到25的数字。训练者需要尽快地按照数字顺序找出这些数字，并用手指指出或说出它们的位置。</p><p>这种练习可以帮助提高眼睛的移动速度、扩大视野范围、增强大脑的反应速度和专注力，因此常被用来作为儿童和成人的注意力训练方法之一。此外，它也被一些专业领域（如飞行员、运动员等）用来提升快速信息处理能力和决策效率。</p><p>进行舒尔特方格训练时，建议：</p><p>保持正确的姿势，确保光线充足。
眼睛与纸面保持适当距离，一般为30-40厘米。
尽量不要用手指直接指着数字，以锻炼眼睛的移动能力。
随着熟练程度的提高，可以尝试更复杂或更大的方格，比如6x6或7x7。
定期练习，但也要注意休息，避免过度疲劳。
舒尔特方格不仅是一个简单的游戏，也是一个实用的认知训练工具，对于改善注意力集中度和个人效率有着积极的作用。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Index</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>numbers</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>currentIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>//用于判断用户点击是否正确
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>timeStart</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>widthItem</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>marginItem</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 初始化舒尔特方格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>initGrid</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>25</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>numbers</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>shuffleArray</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>numbers</span>)));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentIndex</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>timeStart</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>()
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 随机打乱数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>shuffleArray</span>(<span style=color:#a6e22e>array</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[]) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>25</span>);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>i</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>j</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>array</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>numbers</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>array</span>
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 判断是否完成
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isCompleted</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentIndex</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>25</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span> }) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>numbers</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>widthItem</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>widthItem</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>marginItem</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>widthItem</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>visibility</span>(<span style=color:#a6e22e>item</span> <span style=color:#f92672>&lt;=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentIndex</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Hidden</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>numbers</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>===</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentIndex</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentIndex</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isCompleted</span>()) {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;完成！&#39;</span>);
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`用时`</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>((Date.<span style=color:#a6e22e>now</span>() <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>timeStart</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000</span>).<span style=color:#a6e22e>toFixed</span>(<span style=color:#ae81ff>3</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>秒`</span>,
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>                      {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新开始&#39;</span>,
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ffa500&#39;</span>
</span></span><span style=display:flex><span>                      }
</span></span><span style=display:flex><span>                    ],
</span></span><span style=display:flex><span>                  }).<span style=color:#a6e22e>then</span>(()=&gt;{
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGrid</span>();
</span></span><span style=display:flex><span>                  })
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>              } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;错误的顺序！&#39;</span>);
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>widthItem</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>marginItem</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>widthItem</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>marginItem</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 开始按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;开始&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;50%&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;10%&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGrid</span>();
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;游戏开始&#39;</span>);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=piece>Piece<a hidden class=anchor aria-hidden=true href=#piece>#</a></h1><p>拼图</p><p>算法： 随机 剪裁 交换</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>fileIo</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>fs</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.CoreFileKit&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>common</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.AbilityKit&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>image</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ImageKit&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>photoAccessHelper</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.MediaLibraryKit&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义拼图组件接口
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>PuzzlePiece</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 拼图块的像素地图
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>pixelMap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>PixelMap</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 原始图片中的索引位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>originalIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用装饰器定义页面组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Page30</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 状态变量：选中图片的URI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>selectedImageUrl</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 状态变量：原始图片的URI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>originalImageUrl</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 状态变量：存储拼图块的数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>puzzlePieces</span><span style=color:#f92672>:</span> Array<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>PuzzlePiece</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 状态变量：记录当前选中的拼图块索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>selectedPiece</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 弹出图片选择器方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>openPicker</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>PhotoSelectOptions</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>photoAccessHelper</span>.<span style=color:#a6e22e>PhotoSelectOptions</span>();
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>PhotoSelectOptions</span>.<span style=color:#a6e22e>MIMEType</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>photoAccessHelper</span>.<span style=color:#a6e22e>PhotoViewMIMETypes</span>.<span style=color:#a6e22e>IMAGE_TYPE</span>;
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>PhotoSelectOptions</span>.<span style=color:#a6e22e>maxSelectNumber</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>photoPicker</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>photoAccessHelper</span>.<span style=color:#a6e22e>PhotoViewPicker</span>();
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>uris</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>photoAccessHelper</span>.<span style=color:#a6e22e>PhotoSelectResult</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span>  <span style=color:#a6e22e>photoPicker</span>.<span style=color:#a6e22e>select</span>(<span style=color:#a6e22e>PhotoSelectOptions</span>)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>uris</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>uris</span>.<span style=color:#a6e22e>photoUris</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 获取选中图片的第一张URI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>uri</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uris</span>.<span style=color:#a6e22e>photoUris</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 打开文件读取流
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>file</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>openSync</span>(<span style=color:#a6e22e>uri</span>, <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>OpenMode</span>.<span style=color:#a6e22e>READ_ONLY</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 获取当前上下文
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>context</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getContext</span>(<span style=color:#66d9ef>this</span>) <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>common</span>.<span style=color:#a6e22e>UIAbilityContext</span>;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 新建一个保存裁剪后图片的路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>newUrl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>filesDir</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;/test&#39;</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>new</span> Date().<span style=color:#a6e22e>getTime</span>() <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.jpg&#39;</span>;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 复制图片到新的路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>copyFileSync</span>(<span style=color:#a6e22e>file</span>.<span style=color:#a6e22e>fd</span>, <span style=color:#a6e22e>newUrl</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 关闭文件读取流
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>closeSync</span>(<span style=color:#a6e22e>file</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 更新状态变量：设置显示图片的URI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedImageUrl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newUrl</span>;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 更新状态变量：保存原始图片的URI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>originalImageUrl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uri</span>;
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 图片更改时触发的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>imgChange</span>();
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;openPicker&#39;</span>, <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>e</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 图片更改处理方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>imgChange</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span> {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建图片源对象
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>imageSource</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>ImageSource</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>createImageSource</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedImageUrl</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 图片解码选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>decodingOptions</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>DecodingOptions</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>editable</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>desiredPixelFormat</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建像素地图
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mPixelMap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>PixelMap</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>imageSource</span>.<span style=color:#a6e22e>createPixelMap</span>(<span style=color:#a6e22e>decodingOptions</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 获取图片信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mImageInfo</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>ImageInfo</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>mPixelMap</span>.<span style=color:#a6e22e>getImageInfo</span>();
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 计算每个拼图块的大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pieceSize</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>Size</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>mImageInfo</span>.<span style=color:#a6e22e>size</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>mImageInfo</span>.<span style=color:#a6e22e>size</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span>,
</span></span><span style=display:flex><span>      };
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 清空已有拼图块数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 遍历图片生成9个拼图块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>count</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>3</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建基于原图的新图片源
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>imageSource</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>createImageSource</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedImageUrl</span>);
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建新像素地图
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mPixelMap</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>imageSource</span>.<span style=color:#a6e22e>createPixelMap</span>(<span style=color:#a6e22e>decodingOptions</span>);
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 计算裁剪区域
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cutRegion</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>image</span>.<span style=color:#a6e22e>Region</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>pieceSize</span>.<span style=color:#a6e22e>width</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>pieceSize</span>.<span style=color:#a6e22e>height</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>size</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>pieceSize</span>,
</span></span><span style=display:flex><span>          };
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 裁剪像素地图
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>mPixelMap</span>.<span style=color:#a6e22e>crop</span>(<span style=color:#a6e22e>cutRegion</span>);
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建并添加拼图块至数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>piece</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PuzzlePiece</span> <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>pixelMap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>mPixelMap</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>originalIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>count</span><span style=color:#f92672>++</span>,
</span></span><span style=display:flex><span>          };
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>piece</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 打乱拼图块顺序
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>--</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>temp</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PuzzlePiece</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>i</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>j</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>j</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>e</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;imgChange&#39;</span>, <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>e</span>));
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建UI界面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 添加选择图片按钮，点击后调用打开图片选择器方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;选择图片→&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>openPicker</span>();
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 显示原始图片（如果已选择）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>originalImageUrl</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;原始图片↓&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Image</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>originalImageUrl</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;180lpx&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;180lpx&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>objectFit</span>(<span style=color:#a6e22e>ImageFit</span>.<span style=color:#a6e22e>Contain</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 如果有拼图块，则显示游戏区
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;游戏图片↓&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 游戏区域采用网格布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Grid</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 遍历所有拼图块并创建网格项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PuzzlePiece</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>GridItem</span>() {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 显示拼图块图像
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Image</span>(<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>pixelMap</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;200lpx&#39;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;200lpx&#39;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>&#39;5lpx&#39;</span>)
</span></span><span style=display:flex><span>                  <span style=color:#75715e>// 根据是否选中调整缩放比例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>scale</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>?</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.5</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.5</span> } <span style=color:#f92672>:</span> { <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> })
</span></span><span style=display:flex><span>                  <span style=color:#75715e>// 添加点击事件处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>                  <span style=color:#75715e>// 处理拼图交换逻辑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span> <span style=color:#f92672>==</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>index</span>;
</span></span><span style=display:flex><span>                  } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>index</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                  } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>temp</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PuzzlePiece</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span>];
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span>] <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>index</span>];
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>index</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>temp</span>;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedPiece</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// 检查拼图是否完成
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>isSucc</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;====item&#39;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>originalIndex</span>, <span style=color:#a6e22e>i</span>);
</span></span><span style=display:flex><span>                      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>puzzlePieces</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>originalIndex</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>i</span>) {
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>isSucc</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>                        <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>                      }
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                    <span style=color:#75715e>// 如果拼图完成，弹出提示对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isSucc</span>) {
</span></span><span style=display:flex><span>                      <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({
</span></span><span style=display:flex><span>                        <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;拼图完成！&#39;</span>,
</span></span><span style=display:flex><span>                      });
</span></span><span style=display:flex><span>                    }
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }) <span style=color:#75715e>// End of ForEach
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        } <span style=color:#75715e>// End of Grid
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#fafafa&#34;</span>); <span style=color:#75715e>// 设置网格背景色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    } <span style=color:#75715e>// End of Column
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>); <span style=color:#75715e>// 设置列宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=ruler>ruler<a hidden class=anchor aria-hidden=true href=#ruler>#</a></h1><p>直尺</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { window } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>; <span style=color:#75715e>// 导入窗口相关的API
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>deviceInfo</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.BasicServicesKit&#39;</span>; <span style=color:#75715e>// 导入设备信息相关的API
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义直尺线类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RulerLine</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 线的索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 线的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>index</span>; <span style=color:#75715e>// 初始化索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>; <span style=color:#75715e>// 初始化高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 显示线的编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>showNumber</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>index</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>index</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 每10个线显示一个编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 扩展文本样式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Extend</span>(<span style=color:#a6e22e>Text</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>fancy</span>() {
</span></span><span style=display:flex><span>  .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#019dfe&#34;</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>); <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义直尺组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>RulerComponent</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>maxRulerHeight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 最大直尺高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;onCellWidthChanged&#39;</span>) <span style=color:#a6e22e>cellWidthInPixels</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>17.28</span>; <span style=color:#75715e>// 每毫米对应的像素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>textWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>80</span>; <span style=color:#75715e>// 文本宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>rulerLines</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>RulerLine</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 直尺线数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>leftOffsetX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>300</span>; <span style=color:#75715e>// 左侧偏移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>currentPositionX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>300</span>; <span style=color:#75715e>// 当前X位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;onContainerHeightChanged&#39;</span>) <span style=color:#a6e22e>containerHeight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>53</span>; <span style=color:#75715e>// 容器高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>originalContainerHeight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>53</span>; <span style=color:#75715e>// 原始容器高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;onCellWidthChanged&#39;</span>) <span style=color:#a6e22e>containerWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 容器宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理单元格宽度变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>onCellWidthChanged</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>maxRulerHeight</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>vp2px</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerWidth</span>) <span style=color:#f92672>/</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>; <span style=color:#75715e>// 更新最大直尺高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 处理容器高度变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>onContainerHeightChanged</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span>, <span style=color:#ae81ff>53</span>); <span style=color:#75715e>// 确保容器高度不小于53
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 组件即将出现时
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 设置当前应用为横屏显示
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    window.<span style=color:#a6e22e>getLastWindow</span>(<span style=color:#a6e22e>getContext</span>()).<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>windowClass</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>windowClass</span>.<span style=color:#a6e22e>setPreferredOrientation</span>(window.<span style=color:#a6e22e>Orientation</span>.<span style=color:#a6e22e>LANDSCAPE</span>); <span style=color:#75715e>// 设置为横屏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 初始化直尺线
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>15</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lineHeight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>90</span> <span style=color:#f92672>:</span> (<span style=color:#a6e22e>i</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) <span style=color:#f92672>?</span> <span style=color:#ae81ff>60</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>45</span>; <span style=color:#75715e>// 根据索引设置线的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rulerLines</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>RulerLine</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>lineHeight</span>)); <span style=color:#75715e>// 将新线添加到数组中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建UI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 创建一个列布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建一个堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建另一个堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rulerLines</span>, (<span style=color:#a6e22e>line</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>RulerLine</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 遍历直尺线数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Line</span>()<span style=color:#75715e>// 创建一条线
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 设置线宽
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>line</span>.<span style=color:#a6e22e>height</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>)<span style=color:#75715e>// 设置线高
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)<span style=color:#75715e>// 设置线的背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>index</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span> }); <span style=color:#75715e>// 设置线的左边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>line</span>.<span style=color:#a6e22e>showNumber</span>())<span style=color:#75715e>// 显示线的编号
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)<span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)<span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>)<span style=color:#75715e>// 设置文本宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>)<span style=color:#75715e>// 设置文本高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 设置文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>margin</span>({
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>line</span>.<span style=color:#a6e22e>height</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>
</span></span><span style=display:flex><span>              }); <span style=color:#75715e>// 设置文本位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>TopStart</span>); <span style=color:#75715e>// 设置堆叠布局的宽高和对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>15</span> }) { <span style=color:#75715e>// 创建一个列布局，设置间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`当前设备：</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>deviceInfo</span>.<span style=color:#a6e22e>marketName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>fancy</span>(); <span style=color:#75715e>// 显示当前设备名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Counter</span>() { <span style=color:#75715e>// 创建一个计数器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`选中区距离：</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>maxRulerHeight</span>.<span style=color:#a6e22e>toFixed</span>(<span style=color:#ae81ff>2</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>厘米`</span>).<span style=color:#a6e22e>fancy</span>(); <span style=color:#75715e>// 显示选中区距离
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>foregroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置计数器字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>300</span>) <span style=color:#75715e>// 设置计数器宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>onInc</span>(() =&gt; { <span style=color:#75715e>// 增加计数器时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>px2vp</span>(<span style=color:#a6e22e>vp2px</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span>) <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// 更新容器高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>onDec</span>(() =&gt; { <span style=color:#75715e>// 减少计数器时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>px2vp</span>(<span style=color:#a6e22e>vp2px</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span>) <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>10</span>); <span style=color:#75715e>// 更新容器高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Counter</span>() { <span style=color:#75715e>// 创建另一个计数器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`每毫米间距：</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span>.<span style=color:#a6e22e>toFixed</span>(<span style=color:#ae81ff>2</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>).<span style=color:#a6e22e>fancy</span>(); <span style=color:#75715e>// 显示每毫米间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>foregroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置计数器字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>300</span>) <span style=color:#75715e>// 设置计数器宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>onInc</span>(() =&gt; { <span style=color:#75715e>// 增加计数器时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>0.01</span>; <span style=color:#75715e>// 增加每毫米间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>onDec</span>(() =&gt; { <span style=color:#75715e>// 减少计数器时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>max</span>(<span style=color:#ae81ff>0.01</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidthInPixels</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>0.01</span>); <span style=color:#75715e>// 减少每毫米间距，确保不小于0.01
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>RelativeContainer</span>() { <span style=color:#75715e>// 创建一个相对布局容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Rect</span>()<span style=color:#75715e>// 创建一个矩形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#80019dfe&#34;</span>)<span style=color:#75715e>// 设置填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderColor</span>(<span style=color:#e6db74>&#34;#019dfe&#34;</span>)<span style=color:#75715e>// 设置边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderWidth</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> })<span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>clip</span>(<span style=color:#66d9ef>true</span>)<span style=color:#75715e>// 启用裁剪
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#34;100%&#34;</span>)<span style=color:#75715e>// 设置宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#34;100%&#34;</span>)<span style=color:#75715e>// 设置高度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>onAreaChange</span>((<span style=color:#a6e22e>oldArea</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Area</span>, <span style=color:#a6e22e>newArea</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Area</span>) =&gt; { <span style=color:#75715e>// 处理区域变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerWidth</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newArea</span>.<span style=color:#a6e22e>width</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 更新容器宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建一个堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Circle</span>({ <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span> })<span style=color:#75715e>// 创建一个圆形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#019dfe&#34;</span>)<span style=color:#75715e>// 设置填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>stroke</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>)<span style=color:#75715e>// 设置边框颜色为透明
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>3</span>); <span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Circle</span>({ <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>40</span>, <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>40</span> })<span style=color:#75715e>// 创建另一个圆形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>)<span style=color:#75715e>// 设置填充颜色为透明
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;#019dfe&#34;</span>)<span style=color:#75715e>// 设置边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>3</span>); <span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>hitTestBehavior</span>(<span style=color:#a6e22e>HitTestMode</span>.<span style=color:#a6e22e>Block</span>) <span style=color:#75715e>// 设置碰撞检测行为
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>20</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>alignRules</span>({
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 设置对齐规则
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>center</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>anchor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;__container__&#34;</span>, <span style=color:#a6e22e>align</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>VerticalAlign</span>.<span style=color:#a6e22e>Center</span> }, <span style=color:#75715e>// 垂直居中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>middle</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>anchor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;__container__&#34;</span>, <span style=color:#a6e22e>align</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span> } <span style=color:#75715e>// 左对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>gesture</span>(<span style=color:#a6e22e>PanGesture</span>({
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 左侧拖动手势
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>fingers</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 单指拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PanDirection</span>.<span style=color:#a6e22e>Horizontal</span>, <span style=color:#75715e>// 水平拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>distance</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>// 最小拖动距离
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }).<span style=color:#a6e22e>onActionUpdate</span>((<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GestureEvent</span>) =&gt; { <span style=color:#75715e>// 拖动更新时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>leftOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPositionX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>offsetX</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 更新左侧偏移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>originalContainerHeight</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>offsetX</span>; <span style=color:#75715e>// 更新容器高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }).<span style=color:#a6e22e>onActionEnd</span>(() =&gt; { <span style=color:#75715e>// 拖动结束时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPositionX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>leftOffsetX</span>; <span style=color:#75715e>// 更新位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>originalContainerHeight</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span>; <span style=color:#75715e>// 更新原始高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }));
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建另一个堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Circle</span>({ <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span> })<span style=color:#75715e>// 创建一个圆形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#019dfe&#34;</span>)<span style=color:#75715e>// 设置填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>stroke</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>)<span style=color:#75715e>// 设置边框颜色为透明
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>3</span>); <span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Circle</span>({ <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>40</span>, <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>40</span> })<span style=color:#75715e>// 创建另一个圆
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>)<span style=color:#75715e>// 设置填充颜色为透明
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;#019dfe&#34;</span>)<span style=color:#75715e>// 设置边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>3</span>); <span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>hitTestBehavior</span>(<span style=color:#a6e22e>HitTestMode</span>.<span style=color:#a6e22e>Block</span>) <span style=color:#75715e>// 设置碰撞检测行为
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>20</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>alignRules</span>({
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 设置对齐规则
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>center</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>anchor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;__container__&#34;</span>, <span style=color:#a6e22e>align</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>VerticalAlign</span>.<span style=color:#a6e22e>Center</span> }, <span style=color:#75715e>// 垂直居中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>middle</span><span style=color:#f92672>:</span> { <span style=color:#a6e22e>anchor</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;__container__&#34;</span>, <span style=color:#a6e22e>align</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>End</span> } <span style=color:#75715e>// 右对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>gesture</span>(<span style=color:#a6e22e>PanGesture</span>({
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 右侧拖动手势
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>fingers</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 单指拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PanDirection</span>.<span style=color:#a6e22e>Horizontal</span>, <span style=color:#75715e>// 水平拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>distance</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>// 最小拖动距离
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }).<span style=color:#a6e22e>onActionUpdate</span>((<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GestureEvent</span>) =&gt; { <span style=color:#75715e>// 拖动更新时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>leftOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPositionX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>offsetX</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 更新左侧偏移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>originalContainerHeight</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>offsetX</span>; <span style=color:#75715e>// 更新容器高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }).<span style=color:#a6e22e>onActionEnd</span>(() =&gt; { <span style=color:#75715e>// 拖动结束时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPositionX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>leftOffsetX</span>; <span style=color:#75715e>// 更新位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>originalContainerHeight</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span>; <span style=color:#75715e>// 更新原始高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }));
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>containerHeight</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#34;100%&#34;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>translate</span>({ <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>leftOffsetX</span> }) <span style=color:#75715e>// 使用左侧偏移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>gesture</span>(<span style=color:#a6e22e>PanGesture</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 左侧拖动手势
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>fingers</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 单指拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PanDirection</span>.<span style=color:#a6e22e>Horizontal</span>, <span style=color:#75715e>// 水平拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>distance</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span> <span style=color:#75715e>// 最小拖动距离
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }).<span style=color:#a6e22e>onActionUpdate</span>((<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GestureEvent</span>) =&gt; { <span style=color:#75715e>// 拖动更新时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>leftOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPositionX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>offsetX</span>; <span style=color:#75715e>// 更新左侧偏移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>onActionEnd</span>(() =&gt; { <span style=color:#75715e>// 拖动结束时的处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPositionX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>leftOffsetX</span>; <span style=color:#75715e>// 更新位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }));
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }.<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度和宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> }) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#181b22&#34;</span>); <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=randon-password>randon password<a hidden class=anchor aria-hidden=true href=#randon-password>#</a></h1><p>随机密码</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入剪贴板服务
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>pasteboard</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.BasicServicesKit&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入弹窗提示服务
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用装饰器定义一个可观察的类，用于密码选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PasswordOption</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 选项名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>characters</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 该选项对应的字符集
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// 定义是否选中，默认为true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>selected</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义是否启用，默认为true
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>enabled</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构造函数，初始化name和characters
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>characters</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>name</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>name</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>characters</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>characters</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用装饰器定义一个入口组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>PasswordGeneratorPage</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义密码选项数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PasswordOption</span>[] <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PasswordOption</span>(<span style=color:#e6db74>&#34;大写字母&#34;</span>, <span style=color:#e6db74>&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PasswordOption</span>(<span style=color:#e6db74>&#34;小写字母&#34;</span>, <span style=color:#e6db74>&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PasswordOption</span>(<span style=color:#e6db74>&#34;数字&#34;</span>, <span style=color:#e6db74>&#34;0123456789&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PasswordOption</span>(<span style=color:#e6db74>&#34;特殊字符&#34;</span>, <span style=color:#e6db74>&#34;!@#$%^&amp;*()_+-=[]{}|;:,.&lt;&gt;?&#34;</span>),
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义密码长度状态，默认值为10
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>passwordLength</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 基础间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>baseSpacing</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 生成的密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>generatedPassword</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 是否启用复制按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isCopyButtonEnabled</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 主题色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>primaryColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;#71dec7&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>fontColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2e2e2e&#34;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 生成密码的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>generatePassword</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>characterSet</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 初始化字符集合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 遍历所有选项，如果选项被选中则加入字符集合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>option</span> <span style=color:#66d9ef>of</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>options</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>selected</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>characterSet</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>characters</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>password</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 初始化密码字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 根据密码长度生成随机密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>passwordLength</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomIndex</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#a6e22e>characterSet</span>.<span style=color:#a6e22e>length</span>);
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>password</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>characterSet</span>[<span style=color:#a6e22e>randomIndex</span>];
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generatedPassword</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>password</span>; <span style=color:#75715e>// 更新生成的密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 复制到剪贴板的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pasteboardData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>createData</span>(<span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>MIMETYPE_TEXT_PLAIN</span>, <span style=color:#a6e22e>text</span>); <span style=color:#75715e>// 创建剪贴板数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>systemPasteboard</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>getSystemPasteboard</span>(); <span style=color:#75715e>// 获取系统剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>systemPasteboard</span>.<span style=color:#a6e22e>setData</span>(<span style=color:#a6e22e>pasteboardData</span>); <span style=color:#75715e>// 将数据放入剪切板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showToast</span>({ <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;已复制&#39;</span> }); <span style=color:#75715e>// 显示复制成功的提示
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 检查选项选择状态的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>checkOptionsSelection</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>selectedCount</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 记录已选中的选项数量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>lastSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 记录最后一个选中的选项索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 遍历所有选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>options</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>options</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>enabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 默认启用所有选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>options</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>selected</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>lastSelectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span>; <span style=color:#75715e>// 更新最后一个选中的选项索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>selectedCount</span><span style=color:#f92672>++</span>; <span style=color:#75715e>// 增加选中计数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 如果只有一个选项被选中，则禁用该选项防止其被取消选中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>selectedCount</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>options</span>[<span style=color:#a6e22e>lastSelectedIndex</span>].<span style=color:#a6e22e>enabled</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建页面布局的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 标题栏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#34;随机密码生成&#34;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)<span style=color:#75715e>// 设置宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>54</span>)<span style=color:#75715e>// 设置高度为54
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)<span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)<span style=color:#75715e>// 设置字体粗细
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 设置文本居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fontColor</span>); <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 密码长度设置部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`密码长度：`</span>)<span style=color:#75715e>// 密码长度标签
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fontColor</span>);
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>passwordLength</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)<span style=color:#75715e>// 显示当前密码长度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>primaryColor</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 滑动条设置密码长度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;4&#39;</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fontColor</span>).<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Slider</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>passwordLength</span>, <span style=color:#75715e>// 当前值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>4</span>, <span style=color:#75715e>// 最小值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>32</span>, <span style=color:#75715e>// 最大值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>style</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SliderStyle</span>.<span style=color:#a6e22e>InSet</span> <span style=color:#75715e>// 滑动条样式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 布局权重
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>blockColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)<span style=color:#75715e>// 滑块颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>trackColor</span>(<span style=color:#e6db74>&#39;#EBEBEB&#39;</span>)<span style=color:#75715e>// 轨道颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>trackThickness</span>(<span style=color:#ae81ff>30</span>)<span style=color:#75715e>// 轨道厚度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>blockSize</span>({ <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>55</span>, <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>55</span> })<span style=color:#75715e>// 滑块大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>selectedColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>primaryColor</span>)<span style=color:#75715e>// 选中颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>onChange</span>((<span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SliderChangeMode</span>) =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>passwordLength</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>; <span style=color:#75715e>// 更新密码长度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>&#39;value:&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>value</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;mode&#39;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>mode</span>.<span style=color:#a6e22e>toString</span>); <span style=color:#75715e>// 打印日志
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;32&#39;</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fontColor</span>).<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>margin</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 选项设置部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;选项&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fontColor</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 动态生成每个选项的UI元素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>options</span>, (<span style=color:#a6e22e>option</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>PasswordOption</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>name</span>)<span style=color:#75715e>// 选项名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>400</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fontColor</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>);
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Toggle</span>({ <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ToggleType</span>.<span style=color:#a6e22e>Switch</span>, <span style=color:#a6e22e>isOn</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>selected</span> })<span style=color:#75715e>// 切换按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100lpx&#39;</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;50lpx&#39;</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>enabled</span>(<span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>enabled</span>)<span style=color:#75715e>// 是否启用切换
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>selectedColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>primaryColor</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>onChange</span>((<span style=color:#a6e22e>isOn</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>) =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>selected</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>isOn</span>; <span style=color:#75715e>// 更新选项状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>checkOptionsSelection</span>(); <span style=color:#75715e>// 检查选项选择状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>padding</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>hitTestBehavior</span>(<span style=color:#a6e22e>HitTestMode</span>.<span style=color:#a6e22e>Block</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>enabled</span>) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>selected</span> <span style=color:#f92672>=</span> <span style=color:#f92672>!</span><span style=color:#a6e22e>option</span>.<span style=color:#a6e22e>selected</span>; <span style=color:#75715e>// 切换选项状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 生成密码按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;生成密码&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>primaryColor</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>54</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#ae81ff>650</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>margin</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>HEAVY</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> })<span style=color:#75715e>// 点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generatePassword</span>(); <span style=color:#75715e>// 生成密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 显示生成的密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`密码结果：`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fontColor</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>margin</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generatedPassword</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)<span style=color:#75715e>// 显示生成的密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>primaryColor</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>margin</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 复制按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;复制&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>enabled</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generatedPassword</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>)<span style=color:#75715e>// 只有生成了密码才启用复制按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>primaryColor</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>54</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#ae81ff>650</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>margin</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>HEAVY</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>generatedPassword</span>); <span style=color:#75715e>// 复制密码
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#f2f3f5&#34;</span>); <span style=color:#75715e>// 页面背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=chinese>chinese<a hidden class=anchor aria-hidden=true href=#chinese>#</a></h1><p>ohpm install @nutpi/chinese_transverter</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入必要的转换库，提供简体与繁体之间的转换功能
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>transverter</span>, <span style=color:#a6e22e>TransverterType</span>, <span style=color:#a6e22e>TransverterLanguage</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;@nutpi/chinese_transverter&#34;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入剪贴板服务，用于将文本复制到系统剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>pasteboard</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.BasicServicesKit&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入提示服务，用于向用户显示消息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用@Entry装饰器标记此组件为应用的入口点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 使用@Component装饰器定义一个名为SimplifiedTraditionalConverter的组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>SimplifiedTraditionalConverter</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量inputText，存储用户输入的原始文本，当其值变化时触发onInputTextChanged方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;onInputTextChanged&#39;</span>) <span style=color:#a6e22e>inputText</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量simplifiedResult，存储转换后的简体结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>simplifiedResult</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量traditionalResult，存储转换后的繁体结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>traditionalResult</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量isInputFocused，表示输入框是否获得了焦点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isInputFocused</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义主题颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>themeColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;#439fff&#39;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>textColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2e2e2e&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义基础内边距大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>basePadding</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义最小文本区域高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>minTextAreaHeight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义最大文本区域高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>maxTextAreaHeight</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>300</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 当inputText状态改变时触发的方法，用于更新转换结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>onInputTextChanged</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 将inputText转换为简体，并更新simplifiedResult
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>simplifiedResult</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>transverter</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TransverterType</span>.<span style=color:#a6e22e>SIMPLIFIED</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>str</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>inputText</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>language</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TransverterLanguage</span>.<span style=color:#a6e22e>ZH_CN</span>
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 将inputText转换为繁体，并更新traditionalResult
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>traditionalResult</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>transverter</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TransverterType</span>.<span style=color:#a6e22e>TRADITIONAL</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>str</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>inputText</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>language</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TransverterLanguage</span>.<span style=color:#a6e22e>ZH_CN</span>
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 将给定的文本复制到剪贴板，并显示提示信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>clipboardData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>createData</span>(<span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>MIMETYPE_TEXT_PLAIN</span>, <span style=color:#a6e22e>text</span>); <span style=color:#75715e>// 创建剪贴板数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>systemClipboard</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>getSystemPasteboard</span>(); <span style=color:#75715e>// 获取系统剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>systemClipboard</span>.<span style=color:#a6e22e>setData</span>(<span style=color:#a6e22e>clipboardData</span>); <span style=color:#75715e>// 设置剪贴板数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showToast</span>({ <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;已复制到剪贴板&#39;</span> }); <span style=color:#75715e>// 显示复制成功的提示
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建组件的UI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Scroll</span>() { <span style=color:#75715e>// 创建可滚动的容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 在滚动容器中创建垂直布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>// 创建标题文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#34;简体繁体转换器&#34;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>54</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建用户输入区域
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建多行文本输入框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>TextArea</span>({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>$$this</span>.<span style=color:#a6e22e>inputText</span>, <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;请输入简体/繁体字（支持混合输入）&#39;</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>placeholderColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isInputFocused</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isInputFocused</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isInputFocused</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>caretColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>onBlur</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isInputFocused</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>) <span style=color:#75715e>// 当输入框失去焦点时，更新isInputFocused状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>onFocus</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isInputFocused</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>) <span style=color:#75715e>// 当输入框获得焦点时，更新isInputFocused状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderWidth</span>(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>constraintSize</span>({ <span style=color:#a6e22e>minHeight</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>minTextAreaHeight</span>, <span style=color:#a6e22e>maxHeight</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>maxTextAreaHeight</span> });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建清空按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;清空&#39;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderWidth</span>(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#ae81ff>650</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>HEAVY</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> }) <span style=color:#75715e>// 添加点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>onClick</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>inputText</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>); <span style=color:#75715e>// 清空输入框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建繁体结果展示与复制区域
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建繁体结果标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`繁体结果：`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建繁体结果展示文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>traditionalResult</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>constraintSize</span>({ <span style=color:#a6e22e>minHeight</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>minTextAreaHeight</span>, <span style=color:#a6e22e>maxHeight</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>maxTextAreaHeight</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Start</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>copyOption</span>(<span style=color:#a6e22e>CopyOptions</span>.<span style=color:#a6e22e>InApp</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建复制繁体结果按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;复制&#39;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>enabled</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>traditionalResult</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>) <span style=color:#75715e>// 只有当有繁体结果时，按钮才可用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#ae81ff>650</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>HEAVY</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>onClick</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>traditionalResult</span>)); <span style=color:#75715e>// 复制繁体结果到剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建简体结果展示与复制区域
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建简体结果标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`简体结果：`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建简体结果展示文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>simplifiedResult</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>constraintSize</span>({ <span style=color:#a6e22e>minHeight</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>minTextAreaHeight</span>, <span style=color:#a6e22e>maxHeight</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>maxTextAreaHeight</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Start</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>copyOption</span>(<span style=color:#a6e22e>CopyOptions</span>.<span style=color:#a6e22e>InApp</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建复制简体结果按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;复制&#39;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>enabled</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>simplifiedResult</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>true</span> <span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>) <span style=color:#75715e>// 只有当有简体结果时，按钮才可用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#ae81ff>650</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>HEAVY</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>onClick</span>(() =&gt; <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>simplifiedResult</span>)); <span style=color:#75715e>// 复制简体结果到剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#f2f3f5&#34;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=up-lower>Up Lower<a hidden class=anchor aria-hidden=true href=#up-lower>#</a></h1><p>数字转中文大小写</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ohpm install @nutpi/chinese-finance-number
</span></span><span style=display:flex><span>ohpm install @nutpi/chinese-number-format
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 导入必要的模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>; <span style=color:#75715e>// 用于显示提示信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>pasteboard</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.BasicServicesKit&#39;</span>; <span style=color:#75715e>// 用于处理剪贴板操作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>toChineseNumber</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@nutpi/chinese-finance-number&#39;</span>; <span style=color:#75715e>// 将数字转换为中文大写金额
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>toChineseWithUnits</span>, <span style=color:#75715e>// 将数字转换为带单位的中文
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>toUpperCase</span>, <span style=color:#75715e>// 将中文小写转换为大写
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>} <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@nutpi/chinese-number-format&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span> <span style=color:#75715e>// 标记此组件为入口点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span> <span style=color:#75715e>// 定义一个组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>NumberToChineseConverter</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>exampleNumber</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>88.8</span>; <span style=color:#75715e>// 示例数字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>textColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2e2e2e&#34;</span>; <span style=color:#75715e>// 文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>lineColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#d5d5d5&#34;</span>; <span style=color:#75715e>// 分割线颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>basePadding</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>; <span style=color:#75715e>// 基础内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>chineseLowercase</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 转换后的小写中文
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>chineseUppercase</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 转换后的中文大写
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>chineseUppercaseAmount</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 转换后的中文大写金额
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;inputChanged&#39;</span>) <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>inputText</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 监听输入文本变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 当输入文本改变时触发的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>inputChanged</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseLowercase</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toChineseWithUnits</span>(Number(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>inputText</span>), <span style=color:#e6db74>&#39;zh-CN&#39;</span>); <span style=color:#75715e>// 转换为小写中文并带上单位
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseUppercase</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toUpperCase</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseLowercase</span>, <span style=color:#e6db74>&#39;zh-CN&#39;</span>); <span style=color:#75715e>// 将小写中文转换为大写
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseUppercaseAmount</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>toChineseNumber</span>(Number(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>inputText</span>)); <span style=color:#75715e>// 转换为大写金额
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 复制文本到剪贴板的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pasteboardData</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>createData</span>(<span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>MIMETYPE_TEXT_PLAIN</span>, <span style=color:#a6e22e>text</span>); <span style=color:#75715e>// 创建剪贴板数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>systemPasteboard</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pasteboard</span>.<span style=color:#a6e22e>getSystemPasteboard</span>(); <span style=color:#75715e>// 获取系统剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>systemPasteboard</span>.<span style=color:#a6e22e>setData</span>(<span style=color:#a6e22e>pasteboardData</span>); <span style=color:#75715e>// 设置剪贴板数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showToast</span>({ <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;已复制&#39;</span> }); <span style=color:#75715e>// 显示复制成功的提示
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建用户界面的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 主列容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// 页面标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;数字转中文大小写&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>) <span style=color:#75715e>// 文本居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>shadow</span>({ <span style=color:#75715e>// 添加阴影效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>, <span style=color:#75715e>// 阴影半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>, <span style=color:#75715e>// 阴影颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// X轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> <span style=color:#75715e>// Y轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Scroll</span>() { <span style=color:#75715e>// 滚动视图
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 内部列容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#75715e>// 工具介绍部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;工具介绍&#39;</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>).<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>); <span style=color:#75715e>// 设置介绍文字样式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;将数字转换为中文格式，适用于票据填写、合同文书、财务报表等多种场景。支持从最小单位“分”到最大单位“千兆”的数字转换。&#39;</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>JUSTIFY</span>)
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }); <span style=color:#75715e>// 设置介绍详情文字样式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>) <span style=color:#75715e>// 对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 设置外边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>shadow</span>({ <span style=color:#75715e>// 添加阴影效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#75715e>// 阴影半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>, <span style=color:#75715e>// 阴影颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// X轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// Y轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 输入区
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Row</span>() { <span style=color:#75715e>// 行容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;示例&#39;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#5871ce&#34;</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#f2f1fd&#34;</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> }) <span style=color:#75715e>// 设置点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>inputText</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>exampleNumber</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>; <span style=color:#75715e>// 设置输入框文本为示例数字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                });
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Blank</span>(); <span style=color:#75715e>// 占位符
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;清空&#39;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#e48742&#34;</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> }) <span style=color:#75715e>// 设置点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#ffefe6&#34;</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>inputText</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 清空输入框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                });
</span></span><span style=display:flex><span>            }.<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>45</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>) <span style=color:#75715e>// 子元素水平分布方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>); <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Divider</span>().<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> }); <span style=color:#75715e>// 分割线
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>TextInput</span>({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>$$this</span>.<span style=color:#a6e22e>inputText</span>, <span style=color:#a6e22e>placeholder</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`请输入数字，例如：</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>exampleNumber</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span> }) <span style=color:#75715e>// 输入框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>caretColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>) <span style=color:#75715e>// 设置光标颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 设置外边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>type</span>(<span style=color:#a6e22e>InputType</span>.<span style=color:#a6e22e>NUMBER_DECIMAL</span>); <span style=color:#75715e>// 设置输入类型为数字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>) <span style=color:#75715e>// 对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 设置外边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>shadow</span>({ <span style=color:#75715e>// 添加阴影效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#75715e>// 阴影半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>, <span style=color:#75715e>// 阴影颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// X轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// Y轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 结果区
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`小写：</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseLowercase</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>).<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 显示小写结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;复制&#39;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#0052d9&#34;</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> }) <span style=color:#75715e>// 设置点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseLowercase</span>); <span style=color:#75715e>// 复制小写结果到剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                });
</span></span><span style=display:flex><span>            }.<span style=color:#a6e22e>constraintSize</span>({ <span style=color:#a6e22e>minHeight</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>45</span> }) <span style=color:#75715e>// 最小高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>) <span style=color:#75715e>// 子元素水平分布方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>); <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Divider</span>().<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> }); <span style=color:#75715e>// 分割线
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`大写：</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseUppercase</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>).<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 显示大写结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;复制&#39;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#0052d9&#34;</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> }) <span style=color:#75715e>// 设置点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseUppercase</span>); <span style=color:#75715e>// 复制大写结果到剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                });
</span></span><span style=display:flex><span>            }.<span style=color:#a6e22e>constraintSize</span>({ <span style=color:#a6e22e>minHeight</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>45</span> }) <span style=color:#75715e>// 最小高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>) <span style=color:#75715e>// 子元素水平分布方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>); <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Divider</span>().<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> }); <span style=color:#75715e>// 分割线
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`大写金额：</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseUppercaseAmount</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>).<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 显示大写金额结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;复制&#39;</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#0052d9&#34;</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> }) <span style=color:#75715e>// 设置点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>copyToClipboard</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chineseUppercaseAmount</span>); <span style=color:#75715e>// 复制大写金额结果到剪贴板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                });
</span></span><span style=display:flex><span>            }.<span style=color:#a6e22e>constraintSize</span>({ <span style=color:#a6e22e>minHeight</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>45</span> }) <span style=color:#75715e>// 最小高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>) <span style=color:#75715e>// 子元素水平分布方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>); <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>) <span style=color:#75715e>// 对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 设置外边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>shadow</span>({ <span style=color:#75715e>// 添加阴影效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>, <span style=color:#75715e>// 阴影半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>, <span style=color:#75715e>// 阴影颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// X轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// Y轴偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>scrollBar</span>(<span style=color:#a6e22e>BarState</span>.<span style=color:#a6e22e>Off</span>).<span style=color:#a6e22e>clip</span>(<span style=color:#66d9ef>false</span>); <span style=color:#75715e>// 关闭滚动条，不允许裁剪
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#f4f8fb&#34;</span>); <span style=color:#75715e>// 设置页面背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=tangram>Tangram<a hidden class=anchor aria-hidden=true href=#tangram>#</a></h1><p>七巧板</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span> <span style=color:#75715e>// 监听数据变化的装饰器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TangramBlock</span> { <span style=color:#75715e>// 定义七巧板类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>points</span><span style=color:#f92672>:</span> Array<span style=color:#f92672>&lt;</span>[<span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>number</span>]<span style=color:#f92672>&gt;</span>; <span style=color:#75715e>// 点坐标数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>initialOffsetX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 初始X偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>initialOffsetY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 初始Y偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>currentOffsetX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 当前X偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>currentOffsetY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 当前Y偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>rotationAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>flipAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 翻转角度，默认为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>rotateValue</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 旋转值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>defaultInitialOffsetX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 默认初始X偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>defaultInitialOffsetY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 默认初始Y偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>defaultRotationAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 默认旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>initialOffsetX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>initialOffsetY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>,
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>rotationAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>points</span><span style=color:#f92672>:</span> Array<span style=color:#f92672>&lt;</span>[<span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>number</span>]<span style=color:#f92672>&gt;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initialOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>defaultInitialOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>initialOffsetX</span>; <span style=color:#75715e>// 初始化X偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initialOffsetY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentOffsetY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>defaultInitialOffsetY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>initialOffsetY</span>; <span style=color:#75715e>// 初始化Y偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotateValue</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>defaultRotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>rotationAngle</span>; <span style=color:#75715e>// 初始化旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>; <span style=color:#75715e>// 设置颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>width</span>; <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>height</span>; <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>points</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>points</span>; <span style=color:#75715e>// 设置点坐标数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>resetData</span>() { <span style=color:#75715e>// 重置数据方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>flipAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 重置翻转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initialOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>defaultInitialOffsetX</span>; <span style=color:#75715e>// 重置初始X偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initialOffsetY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentOffsetY</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>defaultInitialOffsetY</span>; <span style=color:#75715e>// 重置初始Y偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotateValue</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>defaultRotationAngle</span>; <span style=color:#75715e>// 重置旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>baseUnitLength</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>80</span>; <span style=color:#75715e>// 基本单位长度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span> <span style=color:#75715e>// 入口组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span> <span style=color:#75715e>// 定义组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Index</span> { <span style=color:#75715e>// 主组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>selectedBlockIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 当前选中位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>blocks</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TangramBlock</span>[] <span style=color:#f92672>=</span> [<span style=color:#75715e>// 七巧板数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#75715e>// 小直角等腰三角形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TangramBlock</span>(<span style=color:#e6db74>&#34;#fed8e5&#34;</span>, <span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>33.58</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>58.02</span>, <span style=color:#ae81ff>135</span>,
</span></span><span style=display:flex><span>      [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>baseUnitLength</span>]]),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TangramBlock</span>(<span style=color:#e6db74>&#34;#0a0bef&#34;</span>, <span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#ae81ff>78.76</span>, <span style=color:#ae81ff>54.15</span>, <span style=color:#ae81ff>45</span>,
</span></span><span style=display:flex><span>      [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>baseUnitLength</span>]]),
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 中直角等腰三角形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TangramBlock</span>(<span style=color:#e6db74>&#34;#ff0d0c&#34;</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>sqrt</span>(<span style=color:#ae81ff>2</span>), <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>sqrt</span>(<span style=color:#ae81ff>2</span>), <span style=color:#f92672>-</span><span style=color:#ae81ff>33.16</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1.43</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>90</span>,
</span></span><span style=display:flex><span>      [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>sqrt</span>(<span style=color:#ae81ff>2</span>), <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>sqrt</span>(<span style=color:#ae81ff>2</span>)]]),
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 大直角等腰三角形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TangramBlock</span>(<span style=color:#e6db74>&#34;#ffa60a&#34;</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>22.46</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>172</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>135</span>,
</span></span><span style=display:flex><span>      [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>]]),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TangramBlock</span>(<span style=color:#e6db74>&#34;#3da56a&#34;</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>135.65</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>59.34</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>45</span>,
</span></span><span style=display:flex><span>      [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>]]),
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 正方形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TangramBlock</span>(<span style=color:#e6db74>&#34;#ffff0b&#34;</span>, <span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#ae81ff>23.07</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1.84</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>45</span>,
</span></span><span style=display:flex><span>      [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#a6e22e>baseUnitLength</span>], [<span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>baseUnitLength</span>]]),
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 平行四边形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TangramBlock</span>(<span style=color:#e6db74>&#34;#5e0b9b&#34;</span>, <span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>61.53</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>85.97</span>, <span style=color:#ae81ff>45</span>,
</span></span><span style=display:flex><span>      [[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#a6e22e>baseUnitLength</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>baseUnitLength</span>], [<span style=color:#a6e22e>baseUnitLength</span>, <span style=color:#a6e22e>baseUnitLength</span>]])
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() { <span style=color:#75715e>// 构建方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span> }) { <span style=color:#75715e>// 创建垂直布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>, (<span style=color:#a6e22e>block</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TangramBlock</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 遍历七巧板数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Polygon</span>({ <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>height</span> })<span style=color:#75715e>// 绘制多边形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>points</span>(<span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>points</span>)<span style=color:#75715e>// 设置多边形顶点坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fill</span>(<span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>color</span>)<span style=color:#75715e>// 填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>draggable</span>(<span style=color:#66d9ef>false</span>)<span style=color:#75715e>// 长按不可拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>rotationAngle</span> }) <span style=color:#75715e>// 旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>rotate</span>({
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 旋转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>z</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>flipAngle</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>centerX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>width</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#75715e>// 中心点X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>centerY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>height</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#75715e>// 中心点Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>width</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>height</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>onTouch</span>(() =&gt; { <span style=color:#75715e>// 触摸事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>index</span>; <span style=color:#75715e>// 设置选中索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>draggable</span>(<span style=color:#66d9ef>false</span>) <span style=color:#75715e>// 长按不可拖动
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>translate</span>({ <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>initialOffsetX</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>initialOffsetY</span>, <span style=color:#a6e22e>z</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> }) <span style=color:#75715e>// 平移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>gesture</span>( <span style=color:#75715e>// 手势操作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>PanGesture</span>()<span style=color:#75715e>// 拖动手势
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>onActionUpdate</span>((<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GestureEvent</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span>) =&gt; { <span style=color:#75715e>// 更新事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>) {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>initialOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>currentOffsetX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>offsetX</span>; <span style=color:#75715e>// 更新X偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>initialOffsetY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>currentOffsetY</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>offsetY</span>; <span style=color:#75715e>// 更新Y偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                }
</span></span><span style=display:flex><span>              })
</span></span><span style=display:flex><span>              .<span style=color:#a6e22e>onActionEnd</span>((<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GestureEvent</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span>) =&gt; { <span style=color:#75715e>// 结束事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>) {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>currentOffsetX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>initialOffsetX</span>; <span style=color:#75715e>// 更新当前X偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>currentOffsetY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>block</span>.<span style=color:#a6e22e>initialOffsetY</span>; <span style=color:#75715e>// 更新当前Y偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                }
</span></span><span style=display:flex><span>              })
</span></span><span style=display:flex><span>          )
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>zIndex</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 设置层级
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderWidth</span>(<span style=color:#ae81ff>2</span>) <span style=color:#75715e>// 边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderStyle</span>(<span style=color:#a6e22e>BorderStyle</span>.<span style=color:#a6e22e>Dashed</span>) <span style=color:#75715e>// 边框样式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>==</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;#80a8a8a8&#34;</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>) <span style=color:#75715e>// 边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        })
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;750lpx&#39;</span>) <span style=color:#75715e>// 设置宽高
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#e4f2f5&#34;</span>) <span style=color:#75715e>// 背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 旋转角度计数器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> }) { <span style=color:#75715e>// 创建垂直布局，设置间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`旋转角度(间隔5)`</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>) <span style=color:#75715e>// 显示旋转角度文本，设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Counter</span>() { <span style=color:#75715e>// 创建计数器组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;-&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)<span style=color:#75715e>// 显示当前选中七巧板的旋转角度或占位符
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>300</span>) <span style=color:#75715e>// 设置计数器宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>onInc</span>(() =&gt; { <span style=color:#75715e>// 增加按钮的点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>animateTo</span>({}, () =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// 增加旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            })
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>onDec</span>(() =&gt; { <span style=color:#75715e>// 减少按钮的点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>animateTo</span>({}, () =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>5</span>; <span style=color:#75715e>// 减少旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            })
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 旋转角度计数器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> }) { <span style=color:#75715e>// 创建垂直布局，设置间距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`旋转角度(间隔45)`</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>) <span style=color:#75715e>// 显示旋转角度文本，设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Counter</span>() { <span style=color:#75715e>// 创建计数器组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#39;-&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)<span style=color:#75715e>// 显示当前选中七巧板的旋转角度或占位符
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>300</span>) <span style=color:#75715e>// 设置计数器宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>onInc</span>(() =&gt; { <span style=color:#75715e>// 增加按钮的点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>animateTo</span>({}, () =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>45</span>; <span style=color:#75715e>// 增加旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            })
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>onDec</span>(() =&gt; { <span style=color:#75715e>// 减少按钮的点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>animateTo</span>({}, () =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>45</span>; <span style=color:#75715e>// 减少旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            })
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 翻转按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Row</span>() { <span style=color:#75715e>// 创建水平布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;向左翻转&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 左翻转按钮点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>animateTo</span>({}, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>flipAngle</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 减少翻转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;向右翻转&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 右翻转按钮点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>animateTo</span>({}, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>!=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span>].<span style=color:#a6e22e>flipAngle</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 增加翻转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceEvenly</span>) <span style=color:#75715e>// 设置宽度和内容对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 重置和隐藏边框按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Row</span>() { <span style=color:#75715e>// 创建水平布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重置&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 重置按钮点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>animateTo</span>({}, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>blocks</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>resetData</span>(); <span style=color:#75715e>// 重置七巧板数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 重置选中索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;隐藏边框&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 隐藏边框按钮点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedBlockIndex</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 重置选中索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceEvenly</span>) <span style=color:#75715e>// 设置宽度和内容对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=reversi>Reversi<a hidden class=anchor aria-hidden=true href=#reversi>#</a></h1><p>翻转棋（Reversi）、奥赛罗棋（Othello）、苹果棋或正反棋（Anti reversi） 黑白棋</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>promptAction</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>; <span style=color:#75715e>// 导入用于弹出对话框的工具
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ChessCell</span> { <span style=color:#75715e>// 定义棋盘上的单元格类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>frontVisibility</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 单元格上的棋子状态：0表示无子, 1表示黑子，2表示白子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>rotationAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 单元格卡片的旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>opacity</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isAnimationRunning</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 标记动画是否正在运行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>flip</span>(<span style=color:#a6e22e>time</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) { <span style=color:#75715e>// 翻转棋子的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span>) { <span style=color:#75715e>// 当前是黑子，要翻转成白子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showWhite</span>(<span style=color:#a6e22e>time</span>);
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>2</span>) { <span style=color:#75715e>// 当前是白子，要翻转成黑子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>showBlack</span>(<span style=color:#a6e22e>time</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>showBlack</span>(<span style=color:#a6e22e>animationTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>callback</span><span style=color:#f92672>?:</span> () =&gt; <span style=color:#66d9ef>void</span>) { <span style=color:#75715e>// 展示黑色棋子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span>) { <span style=color:#75715e>// 如果已经有动画在运行，则返回
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置动画状态为运行中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>animationTime</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 如果不需要动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 设置旋转角度为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 黑子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 再次开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 看到黑色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 设置旋转角度为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>; <span style=color:#75715e>// 设置旋转角度为90度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>showWhite</span>(<span style=color:#a6e22e>animationTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>callback</span><span style=color:#f92672>?:</span> () =&gt; <span style=color:#66d9ef>void</span>) { <span style=color:#75715e>// 展示白色棋子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span>) { <span style=color:#75715e>// 如果已经有动画在运行，则返回
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置动画状态为运行中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>animationTime</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 如果不需要动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 设置旋转角度为180度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 白子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 再次开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 看到白色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 设置旋转角度为180度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, () =&gt; { <span style=color:#75715e>// 动画开始时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>90</span>; <span style=color:#75715e>// 设置旋转角度为90度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>showWhiteAi</span>(<span style=color:#a6e22e>animationTime</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>callback</span><span style=color:#f92672>?:</span> () =&gt; <span style=color:#66d9ef>void</span>) { <span style=color:#75715e>// 展示白色棋子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span>) { <span style=color:#75715e>// 如果已经有动画在运行，则返回
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置动画状态为运行中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>animationTime</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 如果不需要动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 设置旋转角度为180度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 白子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>180</span>; <span style=color:#75715e>// 设置旋转角度为180度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 白子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>EaseOut</span>,
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>3</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 再次开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>animationTime</span>, <span style=color:#75715e>// 动画持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>iterations</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 动画迭代次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>Linear</span>, <span style=color:#75715e>// 动画曲线类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimationRunning</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为停止
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>callback</span>) { <span style=color:#75715e>// 如果有回调函数，则执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>callback</span>();
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }, () =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>opacity</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>opacity</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0.2</span>;
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>TileHighlight</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>isValidMove</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>OthelloGame</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>chessBoard</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ChessCell</span>[][] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellSize</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>70</span>;
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellSpacing</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>5</span>;
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>transitionDuration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span>;
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;currentPlayerIsBlackChanged&#39;</span>) <span style=color:#a6e22e>currentPlayerIsBlack</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 先手，true表示黑棋
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>chessBoardSize</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>8</span>; <span style=color:#75715e>// 假设棋盘大小为8×8
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>validMoveIndicators</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TileHighlight</span> [][] <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isTwoPlayerMode</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>//true:双击游戏，false:单人游戏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isAIPlaying</span><span style=color:#f92672>:</span><span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#75715e>//true:AI正在下棋
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>currentPlayerIsBlackChanged</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 1是黑子，2表示白子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>hasMoves</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>hasValidMoves</span>(<span style=color:#a6e22e>color</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>hasMoves</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>opponentHasMoves</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>hasValidMoves</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>opponentHasMoves</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>winner</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>determineWinner</span>();
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>winner</span>);
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>promptAction</span>.<span style=color:#a6e22e>showDialog</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;游戏结束&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>winner</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> [{ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;重新开始&#39;</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;#ffa500&#39;</span> }]
</span></span><span style=display:flex><span>          }).<span style=color:#a6e22e>then</span>(() =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGame</span>();
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>=</span> <span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span>; <span style=color:#75715e>// 切换下一玩家
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span>) { <span style=color:#75715e>// 当前是白棋, 模拟AI下棋
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isTwoPlayerMode</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>setTimeout</span>(() =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>aiPlaceRandom</span>();
</span></span><span style=display:flex><span>            }, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>20</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>aiPlaceRandom</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>validMoves</span><span style=color:#f92672>:</span> [<span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>number</span>][] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>isValidMove</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>validMoves</span>.<span style=color:#a6e22e>push</span>([<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>]);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>validMoves</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>randomMove</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>validMoves</span>[Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#a6e22e>validMoves</span>.<span style=color:#a6e22e>length</span>)];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>chessCell</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#a6e22e>randomMove</span>[<span style=color:#ae81ff>0</span>]][<span style=color:#a6e22e>randomMove</span>[<span style=color:#ae81ff>1</span>]];
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>placeChessPiece</span>(<span style=color:#a6e22e>randomMove</span>[<span style=color:#ae81ff>0</span>], <span style=color:#a6e22e>randomMove</span>[<span style=color:#ae81ff>1</span>], <span style=color:#a6e22e>chessCell</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>placeChessPiece</span>(<span style=color:#a6e22e>i</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>j</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>chessCell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ChessCell</span>) {
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>reversibleTiles</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>findReversible</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>j</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>);
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`reversibleTiles:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>stringify</span>(<span style=color:#a6e22e>reversibleTiles</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>reversibleTiles</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>showBlack</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>reversibleTiles</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>reversibleTiles</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>flip</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isTwoPlayerMode</span>) { <span style=color:#75715e>//双人游戏，无动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>showWhite</span>(<span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>reversibleTiles</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>reversibleTiles</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>flip</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>);
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> { <span style=color:#75715e>//单人游戏，落子需要闪烁动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAIPlaying</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span><span style=color:#75715e>//AI 正在下棋
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>showWhiteAi</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>reversibleTiles</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>reversibleTiles</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>flip</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>transitionDuration</span>);
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlackChanged</span>()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAIPlaying</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span><span style=color:#75715e>//AI下完了
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hasValidMoves</span>(<span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>hasMoves</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>findReversible</span>(<span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>color</span>).<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>isValidMove</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>hasMoves</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>isValidMove</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>hasMoves</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>.<span style=color:#a6e22e>push</span>([]);
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>.<span style=color:#a6e22e>push</span>([])
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>ChessCell</span>());
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>[<span style=color:#a6e22e>i</span>].<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>TileHighlight</span>())
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGame</span>()
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>initGame</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>j</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>j</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>j</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#a6e22e>i</span>][<span style=color:#a6e22e>j</span>].<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 初始棋盘布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#ae81ff>3</span>][<span style=color:#ae81ff>3</span>].<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#ae81ff>3</span>][<span style=color:#ae81ff>4</span>].<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#ae81ff>4</span>][<span style=color:#ae81ff>3</span>].<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#ae81ff>4</span>][<span style=color:#ae81ff>4</span>].<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlackChanged</span>();
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>findReversible</span>(<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>col</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>ChessCell</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>reversibleTiles</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ChessCell</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>directions</span> <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>      [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], <span style=color:#75715e>// 左上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>], <span style=color:#75715e>// 正上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>], <span style=color:#75715e>// 右上
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#ae81ff>0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], <span style=color:#75715e>// 左
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>], <span style=color:#75715e>// 右
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#ae81ff>1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>], <span style=color:#75715e>// 左下
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>], <span style=color:#75715e>// 正下
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>]<span style=color:#75715e>// 右下
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    ];
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>direction</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>directions</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>foundOpposite</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>row</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>col</span>;
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>do</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>x</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>direction</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>y</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>direction</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>x</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>&gt;=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>&gt;=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cell</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#a6e22e>x</span>][<span style=color:#a6e22e>y</span>];
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>color</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>foundOpposite</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tempX</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>direction</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>tempY</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>direction</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>while</span> (<span style=color:#a6e22e>tempX</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>tempY</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>col</span>) {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>reversibleTiles</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#a6e22e>tempX</span>][<span style=color:#a6e22e>tempY</span>]);
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>tempX</span> <span style=color:#f92672>-=</span> <span style=color:#a6e22e>direction</span>[<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>tempY</span> <span style=color:#f92672>-=</span> <span style=color:#a6e22e>direction</span>[<span style=color:#ae81ff>1</span>];
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>break</span>;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>foundOpposite</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>while</span> (<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>reversibleTiles</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>determineWinner</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>blackCount</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>whiteCount</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#66d9ef>of</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cell</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>row</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>blackCount</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>2</span>) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>whiteCount</span><span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>blackCount</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>whiteCount</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;黑棋获胜！&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>whiteCount</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>blackCount</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;白棋获胜！&#34;</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#34;平局！&#34;</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>hasValidMove</span>(<span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>row</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>row</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>row</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>col</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>col</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoardSize</span>; <span style=color:#a6e22e>col</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>[<span style=color:#a6e22e>row</span>][<span style=color:#a6e22e>col</span>].<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>findReversible</span>(<span style=color:#a6e22e>row</span>, <span style=color:#a6e22e>col</span>, <span style=color:#a6e22e>color</span>).<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span>) {
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>``</span>)<span style=color:#75715e>// 显示单元格的值或空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 文本居中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>)<span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`黑棋行动`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>visibility</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Hidden</span>)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`白棋行动`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>()<span style=color:#75715e>// 显示单元格的值或空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 文本居中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>)<span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>visibility</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentPlayerIsBlack</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Hidden</span>)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> })
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>//棋盘背景
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span> }) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>validMoveIndicators</span>, (<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>[], <span style=color:#a6e22e>_rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ForEach</span>(<span style=color:#a6e22e>row</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TileHighlight</span>, <span style=color:#a6e22e>_colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>isValidMove</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;+&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)<span style=color:#75715e>// 显示单元格的值或空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 文本居中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>2</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#75715e>//棋子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span> }) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>chessBoard</span>, (<span style=color:#a6e22e>row</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ChessCell</span>[], <span style=color:#a6e22e>rowIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>ForEach</span>(<span style=color:#a6e22e>row</span>, (<span style=color:#a6e22e>chessCell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ChessCell</span>, <span style=color:#a6e22e>colIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>``</span>)<span style=color:#75715e>// 显示单元格的值或空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 文本居中
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>opacity</span>(<span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>opacity</span>)
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>!=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span>
</span></span><span style=display:flex><span>                  (<span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Transparent</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>)<span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>rotate</span>({
</span></span><span style=display:flex><span>                  <span style=color:#75715e>// 设置旋转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>z</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>rotationAngle</span>, <span style=color:#75715e>// 旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>centerX</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#75715e>// 中心点X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>centerY</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#75715e>// 中心点Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                })
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 单击事件处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAIPlaying</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`ai正在落子，玩家不可继续落子`</span>)
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>chessCell</span>.<span style=color:#a6e22e>frontVisibility</span> <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span>) { <span style=color:#75715e>// 没有棋子，需要落子
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>placeChessPiece</span>(<span style=color:#a6e22e>rowIndex</span>, <span style=color:#a6e22e>colIndex</span>, <span style=color:#a6e22e>chessCell</span>)
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                });
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSize</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>8</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellSpacing</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Black</span>)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isTwoPlayerMode</span><span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;双人游戏&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;单人游戏&#39;</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Start</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#ae81ff>0xFFFFFF</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Toggle</span>({ <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ToggleType</span>.<span style=color:#a6e22e>Switch</span>, <span style=color:#a6e22e>isOn</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isTwoPlayerMode</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>200</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>onChange</span>((<span style=color:#a6e22e>isOn</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isTwoPlayerMode</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>isOn</span>
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#ae81ff>0xFFFFFF</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>5</span>)
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;重新开始&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 按钮点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>initGame</span>()
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度和宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=nine-square>nine-square<a hidden class=anchor aria-hidden=true href=#nine-square>#</a></h1><p>九宫格抽奖</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 定义一个可观察的Prize类，用于表示奖品信息。
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Prize</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#75715e>// 奖品标题属性，使用@Trace进行追踪以便响应式更新UI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#75715e>// 奖品颜色属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#75715e>// 奖品描述属性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构造函数，用来初始化新的奖品实例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>description</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>title</span> <span style=color:#75715e>// 设置奖品标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span> <span style=color:#75715e>// 设置奖品颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>description</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>description</span> <span style=color:#75715e>// 设置奖品描述，默认为空字符串
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义MyPrizeUpdate结构组件，用于显示和编辑选中的奖品信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>MyPrizeUpdate</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Consume</span> <span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#75715e>// 当前选中的奖品索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Consume</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>selectionOrder</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#75715e>// 保存抽奖顺序的数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Consume</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>prizeArray</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Prize</span>[] <span style=color:#75715e>// 保存所有奖品的数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) { <span style=color:#75715e>// 创建列布局容器，设置子元素之间的间距为20px
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Row</span>() { <span style=color:#75715e>// 创建行布局容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;标题：&#39;</span>) <span style=color:#75715e>// 显示“标题”文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>TextInput</span>({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>%</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>]].<span style=color:#a6e22e>title</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>) <span style=color:#75715e>// 设置输入框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>onChange</span>((<span style=color:#a6e22e>value</span>) =&gt; { <span style=color:#75715e>// 监听输入框内容变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>%</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>]].<span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span> <span style=color:#75715e>// 更新奖品标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;描述：&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>TextInput</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>%</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>]].<span style=color:#a6e22e>description</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>).<span style=color:#a6e22e>onChange</span>((<span style=color:#a6e22e>value</span>) =&gt; { <span style=color:#75715e>// 同上，但针对奖品描述
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>%</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>]].<span style=color:#a6e22e>description</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;颜色：&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>TextInput</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>%</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>]].<span style=color:#a6e22e>color</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>
</span></span><span style=display:flex><span>        }).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;300lpx&#39;</span>).<span style=color:#a6e22e>onChange</span>((<span style=color:#a6e22e>value</span>) =&gt; { <span style=color:#75715e>// 同上，但针对奖品颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>%</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>]].<span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>Start</span>) <span style=color:#75715e>// 设置内容左对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>padding</span>(<span style=color:#ae81ff>40</span>) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 设置背景颜色为白色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义抽奖页面入口组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>LotteryPage</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Provide</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 提供当前选中的索引，初始值为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>isAnimating</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span> <span style=color:#75715e>// 标记是否正在进行动画，初始值为false
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Provide</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>selectionOrder</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>2</span>, <span style=color:#ae81ff>5</span>, <span style=color:#ae81ff>8</span>, <span style=color:#ae81ff>7</span>, <span style=color:#ae81ff>6</span>, <span style=color:#ae81ff>3</span>] <span style=color:#75715e>// 定义抽奖顺序
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>cellWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>200</span> <span style=color:#75715e>// 单元格宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>baseMargin</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>10</span> <span style=color:#75715e>// 单元格边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Provide</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>prizeArray</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Prize</span>[] <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;红包&#34;</span>, <span style=color:#e6db74>&#34;#ff9675&#34;</span>, <span style=color:#e6db74>&#34;10元&#34;</span>), <span style=color:#75715e>// 初始化奖品数组，创建各种奖品对象
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;话费&#34;</span>, <span style=color:#e6db74>&#34;#ff9f2e&#34;</span>, <span style=color:#e6db74>&#34;5元&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;红包&#34;</span>, <span style=color:#e6db74>&#34;#8e7fff&#34;</span>, <span style=color:#e6db74>&#34;50元&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;红包&#34;</span>, <span style=color:#e6db74>&#34;#48d1ea&#34;</span>, <span style=color:#e6db74>&#34;30元&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;开始抽奖&#34;</span>, <span style=color:#e6db74>&#34;#fffdfd&#34;</span>), <span style=color:#75715e>// 抽奖按钮，没有具体奖品描述
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;谢谢参与&#34;</span>, <span style=color:#e6db74>&#34;#5f5f5f&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;谢谢参与&#34;</span>, <span style=color:#e6db74>&#34;#5f5f5f&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;超市红包&#34;</span>, <span style=color:#e6db74>&#34;#5f5f5f&#34;</span>, <span style=color:#e6db74>&#34;100元&#34;</span>),
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Prize</span>(<span style=color:#e6db74>&#34;鲜花&#34;</span>, <span style=color:#e6db74>&#34;#75b0fe&#34;</span>),
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>intervalID</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 定时器ID，用于控制抽奖速度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isSheetVisible</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span> <span style=color:#75715e>// 控制底部弹出表单的可见性
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 开始抽奖逻辑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>startLottery</span>(<span style=color:#a6e22e>speed</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>500</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setTimeout</span>(() =&gt; { <span style=color:#75715e>// 设置延时执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>speed</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>50</span>) { <span style=color:#75715e>// 如果速度大于50，则递归调用startLottery以逐渐加速
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>speed</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startLottery</span>(<span style=color:#a6e22e>speed</span>)
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>runAtConstantSpeed</span>() <span style=color:#75715e>// 达到最高速度后进入匀速阶段
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>++</span> <span style=color:#75715e>// 每次调用时更新选中索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }, <span style=color:#a6e22e>speed</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 以恒定速度运行抽奖
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>runAtConstantSpeed</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>speed</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>40</span> <span style=color:#f92672>+</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>) <span style=color:#75715e>// 随机生成一个速度值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>clearInterval</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>intervalID</span>) <span style=color:#75715e>// 清除之前的定时器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>intervalID</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setInterval</span>(() =&gt; { <span style=color:#75715e>// 设置新的定时器来更新选中索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>speed</span>) { <span style=color:#75715e>// 如果选中索引达到速度值，停止并进入减速阶段
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>clearInterval</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>intervalID</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>slowDown</span>()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>    }, <span style=color:#ae81ff>50</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 减速逻辑
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>slowDown</span>(<span style=color:#a6e22e>speed</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>setTimeout</span>(() =&gt; { <span style=color:#75715e>// 设置延时执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>speed</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>500</span>) { <span style=color:#75715e>// 如果速度小于500，则递归调用slowDown以逐渐减速
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>speed</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>50</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>slowDown</span>(<span style=color:#a6e22e>speed</span>)
</span></span><span style=display:flex><span>      } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span> <span style=color:#f92672>%=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span> <span style=color:#75715e>// 确保索引在有效范围内
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span>] <span style=color:#75715e>// 获取最终选中的奖品索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimating</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span> <span style=color:#75715e>// 动画结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getUIContext</span>().<span style=color:#a6e22e>showAlertDialog</span>({ <span style=color:#75715e>// 显示结果对话框
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;结果&#39;</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>message</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#a6e22e>index</span>].<span style=color:#a6e22e>title</span><span style=color:#e6db74>}${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>[<span style=color:#a6e22e>index</span>].<span style=color:#a6e22e>description</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>, <span style=color:#75715e>// 显示奖品信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>confirm</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>defaultFocus</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;我知道了&#39;</span>, <span style=color:#75715e>// 确认按钮文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>action</span><span style=color:#f92672>:</span> () =&gt; {} <span style=color:#75715e>// 点击确认后的操作
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          },
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>alignment</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>DialogAlignment</span>.<span style=color:#a6e22e>Center</span>,
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span><span style=color:#f92672>++</span>
</span></span><span style=display:flex><span>    }, <span style=color:#a6e22e>speed</span>)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建UI方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 使用Column布局容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Flex</span>({ <span style=color:#a6e22e>wrap</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>FlexWrap</span>.<span style=color:#a6e22e>Wrap</span> }) { <span style=color:#75715e>// 使用弹性布局，允许换行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>prizeArray</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Prize</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 遍历奖品数组，创建每个奖品的UI
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Column</span>() { <span style=color:#75715e>// 使用Column布局容器为每个奖品项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>title</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>) <span style=color:#75715e>// 显示奖品标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>index</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>color</span>) <span style=color:#75715e>// 设置字体颜色，对于抽奖按钮特殊处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>16</span>)
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>description</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>) <span style=color:#75715e>// 显示奖品描述
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>index</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>color</span>) <span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span>, <span style=color:#a6e22e>scale</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0.8</span> }) <span style=color:#75715e>// 添加点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 处理点击事件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimating</span>) { <span style=color:#75715e>// 如果正在动画中，忽略点击
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>index</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span>) { <span style=color:#75715e>// 如果点击的是抽奖按钮，开始抽奖
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimating</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startLottery</span>()
</span></span><span style=display:flex><span>            } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#a6e22e>i</span>] <span style=color:#f92672>==</span> <span style=color:#a6e22e>index</span>) {
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i</span> <span style=color:#75715e>// 更新选中索引到对应位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                }
</span></span><span style=display:flex><span>              }
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Center</span>) <span style=color:#75715e>// 设置水平居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>Center</span>) <span style=color:#75715e>// 设置垂直居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置单元格宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置单元格高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>margin</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseMargin</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置单元格边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>index</span> <span style=color:#f92672>==</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#34;#ff5444&#34;</span> <span style=color:#f92672>:</span> <span style=color:#75715e>// 抽奖按钮背景颜色特殊处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedIndex</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectionOrder</span>.<span style=color:#a6e22e>length</span>] <span style=color:#f92672>==</span> <span style=color:#a6e22e>index</span> <span style=color:#f92672>?</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>))
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>shadow</span>({ <span style=color:#75715e>// 设置阴影效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;#f98732&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>          })
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>+</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>baseMargin</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置整体宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>30</span> }) <span style=color:#75715e>// 设置顶部边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>MyPrizeUpdate</span>().<span style=color:#a6e22e>margin</span>({<span style=color:#a6e22e>top</span><span style=color:#f92672>:</span><span style=color:#ae81ff>20</span>}) <span style=color:#75715e>// 插入MyPrizeUpdate组件，并设置其上边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#ffb350&#34;</span>) <span style=color:#75715e>// 设置页面背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>LotteryPage入口组件LotteryPage是整个抽奖应用的核心组件，负责组织页面布局和处理用户交互逻辑。它初始化了一系列必要的状态变量，比如保存所有奖品的数组prizeArray、定义抽奖顺序的selectionOrder以及控制动画状态的isAnimating等。此外，该组件实现了抽奖过程的关键方法——startLottery（开始抽奖）、runAtConstantSpeed（匀速运行）和slowDown（减速），它们共同协作以模拟真实的抽奖体验。当用户点击抽奖按钮时，这些方法按照预定的速度模式依次调用，直到最终确定一个奖品为止。最后，通过弹出对话框的方式向用户展示抽奖结果。</p><h1 id=blood>blood<a hidden class=anchor aria-hidden=true href=#blood>#</a></h1><p>血型计算</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入SegmentButton及其相关类型定义
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>SegmentButton</span>, <span style=color:#a6e22e>SegmentButtonItemTuple</span>, <span style=color:#a6e22e>SegmentButtonOptions</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用@Entry装饰器标记此组件为入口点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 使用@Component装饰器标记此结构体为一个组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义一个名为BloodTypeCalculator的结构体，用于实现血型遗传计算功能
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>BloodTypeCalculator</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义主题颜色，默认为橙色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>themeColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>|</span> <span style=color:#a6e22e>Color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Orange</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义文本颜色，默认为深灰色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>textColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#2e2e2e&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义边框颜色，默认为浅灰色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>lineColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#d5d5d5&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义基础内边距大小，默认为30
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>basePadding</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>30</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 存储可能的血型结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>possibleBloodTypesText</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 存储不可能的血型结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>impossibleBloodTypesText</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义血型列表，包含A、B、AB、O四种血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>bloodTypeList</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>object</span>[] <span style=color:#f92672>=</span> [Object({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;A&#39;</span> }), Object({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;B&#39;</span> }), Object({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;AB&#39;</span> }), Object({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;O&#39;</span> })];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 初始化单选胶囊按钮的配置项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>singleSelectCapsuleOptions</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SegmentButtonOptions</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>undefined</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 监听父亲血型选择变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;capsuleSelectedIndexesChanged&#39;</span>) <span style=color:#a6e22e>fatherBloodTypeIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 监听母亲血型选择变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Watch</span>(<span style=color:#e6db74>&#39;capsuleSelectedIndexesChanged&#39;</span>) <span style=color:#a6e22e>motherBloodTypeIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>[] <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0</span>];
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 根据血型获取其可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>getGenes</span>(<span style=color:#a6e22e>bloodType</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>info</span>(<span style=color:#e6db74>`bloodType:</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>bloodType</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>switch</span> (<span style=color:#a6e22e>bloodType</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;A&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;O&#39;</span>]; <span style=color:#75715e>// A型血可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;B&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>&#39;B&#39;</span>, <span style=color:#e6db74>&#39;O&#39;</span>]; <span style=color:#75715e>// B型血可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;AB&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;B&#39;</span>]; <span style=color:#75715e>// AB型血可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;O&#39;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>return</span> [<span style=color:#e6db74>&#39;O&#39;</span>]; <span style=color:#75715e>// O型血可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>throw</span> <span style=color:#66d9ef>new</span> Error(<span style=color:#e6db74>&#39;Invalid blood type&#39;</span>); <span style=color:#75715e>// 非法血型抛出错误
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 组合父母的基因以获得子代可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>combineGenes</span>(<span style=color:#a6e22e>fatherGenes</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[], <span style=color:#a6e22e>motherGenes</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>possibleGenes</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 用于存储可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>fatherGene</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>fatherGenes</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>motherGene</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>motherGenes</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>combinedGene</span> <span style=color:#f92672>=</span> [<span style=color:#a6e22e>fatherGene</span>, <span style=color:#a6e22e>motherGene</span>].<span style=color:#a6e22e>sort</span>().<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;&#39;</span>); <span style=color:#75715e>// 将父母的基因组合并排序后加入数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>possibleGenes</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>combinedGene</span>)) {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>possibleGenes</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>combinedGene</span>); <span style=color:#75715e>// 如果组合尚未存在，则加入数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>possibleGenes</span>; <span style=color:#75715e>// 返回所有可能的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 根据基因组合确定血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>getBloodTypesFromGenes</span>(<span style=color:#a6e22e>genes</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[])<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bloodTypes</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 用于存储可能的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>gene</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>genes</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;AA&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;AO&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;OA&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>bloodTypes</span>.<span style=color:#a6e22e>push</span>(<span style=color:#e6db74>&#39;A&#39;</span>); <span style=color:#75715e>// 基因组合为AA、AO或OA时，血型为A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;BB&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;BO&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;OB&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>bloodTypes</span>.<span style=color:#a6e22e>push</span>(<span style=color:#e6db74>&#39;B&#39;</span>); <span style=color:#75715e>// 基因组合为BB、BO或OB时，血型为B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;AB&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;BA&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>bloodTypes</span>.<span style=color:#a6e22e>push</span>(<span style=color:#e6db74>&#39;AB&#39;</span>); <span style=color:#75715e>// 基因组合为AB或BA时，血型为AB
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>gene</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;OO&#39;</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>bloodTypes</span>.<span style=color:#a6e22e>push</span>(<span style=color:#e6db74>&#39;O&#39;</span>); <span style=color:#75715e>// 基因组合为OO时，血型为O
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 去除重复的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>bloodTypes</span>.<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>index</span>, <span style=color:#a6e22e>self</span>) =&gt; <span style=color:#a6e22e>self</span>.<span style=color:#a6e22e>indexOf</span>(<span style=color:#a6e22e>value</span>) <span style=color:#f92672>===</span> <span style=color:#a6e22e>index</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 计算孩子可能的血型及不可能的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>calculatePossibleBloodTypes</span>(<span style=color:#a6e22e>father</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>mother</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>fatherGenes</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getGenes</span>(<span style=color:#a6e22e>father</span>); <span style=color:#75715e>// 获取父亲的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>motherGenes</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getGenes</span>(<span style=color:#a6e22e>mother</span>); <span style=color:#75715e>// 获取母亲的基因组合
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>possibleGenes</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>combineGenes</span>(<span style=color:#a6e22e>fatherGenes</span>, <span style=color:#a6e22e>motherGenes</span>); <span style=color:#75715e>// 组合父母的基因
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>possibleBloodTypes</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getBloodTypesFromGenes</span>(<span style=color:#a6e22e>possibleGenes</span>); <span style=color:#75715e>// 从基因组合中获取可能的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>allBloodTypes</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;A&#39;</span>, <span style=color:#e6db74>&#39;B&#39;</span>, <span style=color:#e6db74>&#39;AB&#39;</span>, <span style=color:#e6db74>&#39;O&#39;</span>]; <span style=color:#75715e>// 所有可能的血型列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>impossibleBloodTypes</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>allBloodTypes</span>.<span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>bt</span> =&gt; <span style=color:#f92672>!</span><span style=color:#a6e22e>possibleBloodTypes</span>.<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>bt</span>)); <span style=color:#75715e>// 计算不可能的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>possibleBloodTypesText</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`孩子可能血型：</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>possibleBloodTypes</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;、&#39;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>); <span style=color:#75715e>// 显示可能的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>impossibleBloodTypesText</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`孩子不可能血型：</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>impossibleBloodTypes</span>.<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;、&#39;</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>); <span style=color:#75715e>// 显示不可能的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 当胶囊按钮的选择发生变化时调用此函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>capsuleSelectedIndexesChanged</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>father</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>bloodTypeList</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fatherBloodTypeIndex</span>[<span style=color:#ae81ff>0</span>]][<span style=color:#e6db74>&#39;text&#39;</span>]; <span style=color:#75715e>// 获取父亲选择的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>mother</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>bloodTypeList</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>motherBloodTypeIndex</span>[<span style=color:#ae81ff>0</span>]][<span style=color:#e6db74>&#39;text&#39;</span>]; <span style=color:#75715e>// 获取母亲选择的血型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculatePossibleBloodTypes</span>(<span style=color:#a6e22e>father</span>, <span style=color:#a6e22e>mother</span>); <span style=color:#75715e>// 计算并更新血型信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 在组件即将出现时调用此函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>singleSelectCapsuleOptions</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>SegmentButtonOptions</span>.<span style=color:#a6e22e>capsule</span>({
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>buttons</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>bloodTypeList</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>SegmentButtonItemTuple</span>, <span style=color:#75715e>// 设置胶囊按钮的选项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>multiply</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>, <span style=color:#75715e>// 单选模式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>fontColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>, <span style=color:#75715e>// 字体颜色为白色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>selectedFontColor</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>, <span style=color:#75715e>// 选中时字体颜色为白色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>selectedBackgroundColor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>themeColor</span>, <span style=color:#75715e>// 选中背景色为主题色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>backgroundColor</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>, <span style=color:#75715e>// 背景色为边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>backgroundBlurStyle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BlurStyle</span>.<span style=color:#a6e22e>BACKGROUND_THICK</span> <span style=color:#75715e>// 背景模糊效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>capsuleSelectedIndexesChanged</span>(); <span style=color:#75715e>// 初始化时调用选择变化处理函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建用户界面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 页面标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;血型遗传计算&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>) <span style=color:#75715e>// 文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>) <span style=color:#75715e>// 字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>) <span style=color:#75715e>// 高度为50
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>) <span style=color:#75715e>// 文本居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>) <span style=color:#75715e>// 背景色为白色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>shadow</span>({ <span style=color:#75715e>// 添加阴影效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>, <span style=color:#75715e>// 阴影半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>, <span style=color:#75715e>// 阴影颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#75715e>// 水平偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> <span style=color:#75715e>// 垂直偏移量
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 工具介绍部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;工具介绍&#39;</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>).<span style=color:#a6e22e>fontWeight</span>(<span style=color:#ae81ff>600</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;血型是以A、B、O三种遗传因子的组合而决定的，根据父母的血型，就可以判断出以后出生的孩子的血型。&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>shadow</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 父亲血型选择部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;父亲血型&#39;</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>);
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>SegmentButton</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>singleSelectCapsuleOptions</span>, <span style=color:#75715e>// 胶囊按钮的配置项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>selectedIndexes</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>fatherBloodTypeIndex</span> <span style=color:#75715e>// 当前选中的索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;400lpx&#39;</span>);
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>45</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 母亲血型选择部分
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;母亲血型&#39;</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>);
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>SegmentButton</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>singleSelectCapsuleOptions</span>, <span style=color:#75715e>// 胶囊按钮的配置项
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>selectedIndexes</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>motherBloodTypeIndex</span> <span style=color:#75715e>// 当前选中的索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          }).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;400lpx&#39;</span>);
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>45</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>shadow</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 显示计算结果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>possibleBloodTypesText</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>);
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>45</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>impossibleBloodTypesText</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>textColor</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>18</span>);
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>45</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>alignItems</span>(<span style=color:#a6e22e>HorizontalAlign</span>.<span style=color:#a6e22e>Start</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;650lpx&#39;</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>padding</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>basePadding</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> })
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>)
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>shadow</span>({
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>lineColor</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>offsetX</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>offsetY</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      });
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#f4f8fb&#34;</span>); <span style=color:#75715e>// 页面背景色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=compass>compass<a hidden class=anchor aria-hidden=true href=#compass>#</a></h1><p>指南针</p><p>传感器 角度计算</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>sensor</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.SensorServiceKit&#39;</span>; <span style=color:#75715e>// 导入传感器服务模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>BusinessError</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.BasicServicesKit&#39;</span>; <span style=color:#75715e>// 导入业务错误处理模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义方向范围类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>DirectionRange</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 方向名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 最小角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 最大角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义各个方向的范围
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>DIRECTION_RANGES</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>DirectionRange</span>[] <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;北&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>337.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>360</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;北&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>22.5</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;东北&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>22.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>67.5</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;东&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>67.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>112.5</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;东南&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>112.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>157.5</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;南&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>157.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>202.5</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;西南&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>202.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>247.5</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;西&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>247.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>292.5</span> },
</span></span><span style=display:flex><span>  { <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;西北&#39;</span>, <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>292.5</span>, <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>337.5</span> }
</span></span><span style=display:flex><span>];
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义指南针组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Compass</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>directionMessage</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>; <span style=color:#75715e>// 当前方向的名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>rotationAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 当前旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>currentAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 当前传感器角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cumulativeRotation</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 累计旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>threshold</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 设置阈值，用于过滤小的旋转变化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 组件即将出现时调用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sensor</span>.<span style=color:#a6e22e>getSensorList</span>((<span style=color:#a6e22e>error</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BusinessError</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;获取传感器列表失败&#39;</span>, <span style=color:#a6e22e>error</span>); <span style=color:#75715e>// 如果获取传感器列表失败，打印错误信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startOrientationUpdates</span>(); <span style=color:#75715e>// 开始监听传感器数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 开始监听传感器的方位数据
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>startOrientationUpdates</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>sensor</span>.<span style=color:#a6e22e>on</span>(<span style=color:#a6e22e>sensor</span>.<span style=color:#a6e22e>SensorId</span>.<span style=color:#a6e22e>ORIENTATION</span>, (<span style=color:#a6e22e>orientationData</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>alpha</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>orientationData</span>.<span style=color:#a6e22e>alpha</span>; <span style=color:#75715e>// 获取当前的方位角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>directionMessage</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateDirection</span>(<span style=color:#a6e22e>alpha</span>); <span style=color:#75715e>// 计算当前方向
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>angleDifference</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateAngleDifference</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span>, <span style=color:#a6e22e>alpha</span>); <span style=color:#75715e>// 计算角度差
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>angleDifference</span>) <span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>threshold</span>) { <span style=color:#75715e>// 如果角度变化超过阈值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>updateRotationAngle</span>(<span style=color:#a6e22e>angleDifference</span>, <span style=color:#a6e22e>alpha</span>); <span style=color:#75715e>// 更新旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }, { <span style=color:#a6e22e>interval</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10000000</span> }); <span style=color:#75715e>// 设置传感器更新间隔，单位为纳秒，10000000表示1秒
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 计算两个角度之间的差异
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateAngleDifference</span>(<span style=color:#a6e22e>currentAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>targetAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>diff</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>targetAngle</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>currentAngle</span>; <span style=color:#75715e>// 计算角度差
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>diff</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>180</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>diff</span> <span style=color:#f92672>-=</span> <span style=color:#ae81ff>360</span>; <span style=color:#75715e>// 顺时针旋转超过180度，调整为负值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>diff</span> <span style=color:#f92672>&lt;</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>180</span>) {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>diff</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>360</span>; <span style=color:#75715e>// 逆时针旋转超过180度，调整为正值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>diff</span>; <span style=color:#75715e>// 返回调整后的角度差
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 更新旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>updateRotationAngle</span>(<span style=color:#a6e22e>angleDifference</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>newAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cumulativeRotation</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>angleDifference</span>; <span style=color:#75715e>// 累加旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>angleDifference</span>; <span style=color:#75715e>// 更新当前旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newAngle</span>; <span style=color:#75715e>// 更新当前传感器角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 动画更新
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>animateToImmediately</span>({}, () =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cumulativeRotation</span>; <span style=color:#75715e>// 将旋转角度设置为累计旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>`累计旋转角度: </span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cumulativeRotation</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>); <span style=color:#75715e>// 打印累计旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 根据角度计算方向
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateDirection</span>(<span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>range</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>DIRECTION_RANGES</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>angle</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>range</span>.<span style=color:#a6e22e>min</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>angle</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>range</span>.<span style=color:#a6e22e>max</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>range</span>.<span style=color:#a6e22e>name</span>; <span style=color:#75715e>// 返回对应的方向名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#e6db74>&#39;未知方向&#39;</span>; <span style=color:#75715e>// 如果角度不在任何范围内，返回未知方向
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建用户界面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) { <span style=color:#75715e>// 创建一个列布局，设置间距为20
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Row</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> }) { <span style=color:#75715e>// 创建一个行布局，设置间距为5
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>directionMessage</span>) <span style=color:#75715e>// 显示当前方向
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// 设置布局权重
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>End</span>) <span style=color:#75715e>// 文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#39;#dedede&#39;</span>) <span style=color:#75715e>// 文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>50</span>); <span style=color:#75715e>// 文本大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>°`</span>) <span style=color:#75715e>// 显示当前角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// 设置布局权重
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Start</span>) <span style=color:#75715e>// 文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#39;#dedede&#39;</span>) <span style=color:#75715e>// 文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>50</span>); <span style=color:#75715e>// 文本大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span> }); <span style=color:#75715e>// 设置宽度和上边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建一个堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 内部堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Circle</span>() <span style=color:#75715e>// 创建一个圆形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>250</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>250</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 设置填充透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>25</span>) <span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#39;#f95941&#39;</span>) <span style=color:#75715e>// 设置边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>strokeDashArray</span>([<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>5</span>]) <span style=color:#75715e>// 设置边框虚线样式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>strokeLineJoin</span>(<span style=color:#a6e22e>LineJoinStyle</span>.<span style=color:#a6e22e>Round</span>); <span style=color:#75715e>// 设置边框连接方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;北&#39;</span>) <span style=color:#75715e>// 创建一个文本，显示“北”
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>40</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>) <span style=color:#75715e>// 设置对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#39;#ff4f3f&#39;</span>) <span style=color:#75715e>// 设置文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span> }) <span style=color:#75715e>// 设置旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>80</span> }) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>); <span style=color:#75715e>// 设置文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;东&#39;</span>) <span style=color:#75715e>// 创建一个文本，显示“东”
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>40</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>) <span style=color:#75715e>// 设置对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#39;#fcfdfd&#39;</span>) <span style=color:#75715e>// 设置文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>90</span> }) <span style=color:#75715e>// 设置旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>80</span> }) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>); <span style=color:#75715e>// 设置文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;南&#39;</span>) <span style=color:#75715e>// 创建一个文本，显示“南”
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>40</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>) <span style=color:#75715e>// 设置对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#39;#fcfdfd&#39;</span>) <span style=color:#75715e>// 设置文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>180</span> }) <span style=color:#75715e>// 设置旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>80</span> }) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>); <span style=color:#75715e>// 设置文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;西&#39;</span>) <span style=color:#75715e>// 创建一个文本，显示“西”
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>40</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>) <span style=color:#75715e>// 设置对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#39;#fcfdfd&#39;</span>) <span style=color:#75715e>// 设置文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>270</span> }) <span style=color:#75715e>// 设置旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>80</span> }) <span style=color:#75715e>// 设置内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>); <span style=color:#75715e>// 设置文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>50</span> }) <span style=color:#75715e>// 设置上边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#f92672>-</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> }) <span style=color:#75715e>// 设置旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>animation</span>({}); <span style=color:#75715e>// 设置动画效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Line</span>() <span style=color:#75715e>// 创建一个线条
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>5</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>40</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#39;#fdfffe&#39;</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>200</span> }); <span style=color:#75715e>// 设置下边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }
</span></span><span style=display:flex><span>      .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>300</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>300</span>); <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#39;#18181a&#39;</span>); <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=level>level<a hidden class=anchor aria-hidden=true href=#level>#</a></h1><p>水平仪</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>//module.json5
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>{
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;module&#34;</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;requestPermissions&#34;</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>      {
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;name&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;ohos.permission.ACCELEROMETER&#34;</span>
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入传感器服务模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>sensor</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.SensorServiceKit&#39;</span>;
</span></span><span style=display:flex><span><span style=color:#75715e>// 导入业务错误处理模块
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>BusinessError</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.BasicServicesKit&#39;</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义单位长度，用于后续计算中的比例尺
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>UNIT_LENGTH</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>4</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 使用 @Entry 和 @Component 装饰器定义一个名为 LevelMeter 的组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>LevelMeter</span> {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量，用于存储当前角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量，用于存储前后倾斜角度（pitch）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>pitch</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义状态变量，用于存储左右倾斜角度（roll）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>roll</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 定义角度变化阈值，用于判断是否需要更新角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>threshold</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 组件即将出现时的生命周期方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 获取传感器列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>sensor</span>.<span style=color:#a6e22e>getSensorList</span>((<span style=color:#a6e22e>error</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>BusinessError</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>) {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 如果获取传感器列表失败，输出错误信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;获取传感器列表失败&#39;</span>, <span style=color:#a6e22e>error</span>);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 开始更新方向信息
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>startOrientationUpdates</span>();
</span></span><span style=display:flex><span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 启动方向更新的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>startOrientationUpdates</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 注册加速度传感器事件监听器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>sensor</span>.<span style=color:#a6e22e>on</span>(<span style=color:#a6e22e>sensor</span>.<span style=color:#a6e22e>SensorId</span>.<span style=color:#a6e22e>ACCELEROMETER</span>, (<span style=color:#a6e22e>data</span>) =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 计算新的前后倾斜角度（pitch）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>newPitch</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>atan</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>/</span> Math.<span style=color:#a6e22e>sqrt</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>z</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>z</span>)) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>180</span> <span style=color:#f92672>/</span> Math.<span style=color:#a6e22e>PI</span>);
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 计算新的左右倾斜角度（roll）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>newRoll</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>atan</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>x</span> <span style=color:#f92672>/</span> Math.<span style=color:#a6e22e>sqrt</span>(<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>y</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>z</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>z</span>)) <span style=color:#f92672>*</span> (<span style=color:#ae81ff>180</span> <span style=color:#f92672>/</span> Math.<span style=color:#a6e22e>PI</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 如果新的角度变化超过阈值，则更新状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>newPitch</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pitch</span>) <span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>threshold</span> <span style=color:#f92672>||</span> Math.<span style=color:#a6e22e>abs</span>(<span style=color:#a6e22e>newRoll</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>roll</span>) <span style=color:#f92672>&gt;</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>threshold</span>) {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pitch</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newPitch</span>;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>roll</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>newRoll</span>;
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 更新当前角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>hypot</span>(<span style=color:#a6e22e>newPitch</span>, <span style=color:#a6e22e>newRoll</span>);
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }, { <span style=color:#a6e22e>interval</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100000000</span> }); <span style=color:#75715e>// 设置更新间隔为100毫秒
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 计算小球位置的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateBallPosition</span>()<span style=color:#f92672>:</span> <span style=color:#a6e22e>Position</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 根据当前角度计算半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>=</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.5</span> <span style=color:#f92672>:</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.5</span> <span style=color:#f92672>+</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span>))) <span style=color:#f92672>*</span> <span style=color:#a6e22e>UNIT_LENGTH</span>;
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 将角度转换为弧度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>angleInRadians</span> <span style=color:#f92672>=</span> Math.<span style=color:#a6e22e>atan2</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>pitch</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>roll</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 计算小球在圆周上的X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>x</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>radius</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>cos</span>(<span style=color:#a6e22e>angleInRadians</span>);
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 计算小球在圆周上的Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>y</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>sin</span>(<span style=color:#a6e22e>angleInRadians</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 返回小球的位置
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> { <span style=color:#a6e22e>x</span>, <span style=color:#a6e22e>y</span> };
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建UI的方法
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 使用Stack布局容器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 显示当前角度的文本
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Row</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5</span> }) { <span style=color:#75715e>// 创建一个行布局，设置间距为5
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>Math.<span style=color:#a6e22e>floor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span>)<span style=color:#e6db74>}</span><span style=color:#e6db74>°`</span>)<span style=color:#75715e>// 显示当前角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 设置布局权重
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#39;#dedede&#39;</span>)<span style=color:#75715e>// 文本颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>60</span>); <span style=color:#75715e>// 文本大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>80</span> }) <span style=color:#75715e>// 设置宽度和上边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }.<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>) <span style=color:#75715e>// 设置高度和对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 模拟水平仪背景的圆环
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 外部大圆
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;600lpx&#39;</span>)<span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;600lpx&#39;</span>)<span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>)<span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#171b1e&#34;</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>blur</span>(<span style=color:#ae81ff>50</span>)<span style=color:#75715e>// 设置模糊效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>shadow</span>({ <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>300</span>, <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ShadowType</span>.<span style=color:#a6e22e>COLOR</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;#232426&#34;</span> }); <span style=color:#75715e>// 设置阴影效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 中间圆
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.5</span> <span style=color:#f92672>:</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.5</span> <span style=color:#f92672>+</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span>))) <span style=color:#f92672>*</span> <span style=color:#a6e22e>UNIT_LENGTH</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 计算宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>10</span> <span style=color:#f92672>?</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.5</span> <span style=color:#f92672>:</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2.5</span> <span style=color:#f92672>+</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>10</span>))) <span style=color:#f92672>*</span> <span style=color:#a6e22e>UNIT_LENGTH</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>            <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 计算高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>)<span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#2e3235&#34;</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>animation</span>({ <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>EaseOut</span> }); <span style=color:#75715e>// 设置动画效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 刻度线
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>ForEach</span>([<span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>30</span>, <span style=color:#ae81ff>40</span>, <span style=color:#ae81ff>50</span>], (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#ae81ff>15</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>item</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>UNIT_LENGTH</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 计算宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#ae81ff>15</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>item</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>UNIT_LENGTH</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 计算高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderWidth</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 设置边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>)<span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>borderColor</span>(<span style=color:#e6db74>&#34;#807d8184&#34;</span>); <span style=color:#75715e>// 设置边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 刻度数字
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>item</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>20</span>)<span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#7d8184&#34;</span>)<span style=color:#75715e>// 设置字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>10</span>)<span style=color:#75715e>// 设置字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 设置文本对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>(<span style=color:#ae81ff>15</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>item</span>) <span style=color:#f92672>*</span> <span style=color:#a6e22e>UNIT_LENGTH</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }); <span style=color:#75715e>// 设置左边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 小球
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>14</span>)<span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>14</span>)<span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#ff5841&#34;</span>)<span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>); <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 小球背景
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>radialGradient</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>center</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>20</span>], <span style=color:#75715e>// 设置渐变中心点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>60</span>, <span style=color:#75715e>// 设置渐变半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>colors</span><span style=color:#f92672>:</span> [
</span></span><span style=display:flex><span>              [<span style=color:#e6db74>&#34;#807a7a83&#34;</span>, <span style=color:#ae81ff>0.0</span>], <span style=color:#75715e>// 渐变颜色1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              [<span style=color:#e6db74>&#34;#8074747e&#34;</span>, <span style=color:#ae81ff>0.7</span>], <span style=color:#75715e>// 渐变颜色2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              [<span style=color:#e6db74>&#34;#80898992&#34;</span>, <span style=color:#ae81ff>1.0</span>]<span style=color:#75715e>// 渐变颜色3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            ]
</span></span><span style=display:flex><span>          }).<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置宽度和高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>clip</span>(<span style=color:#66d9ef>true</span>) <span style=color:#75715e>// 设置裁剪
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>radialGradient</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>center</span><span style=color:#f92672>:</span> [<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>20</span>], <span style=color:#75715e>// 设置渐变中心点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>60</span>, <span style=color:#75715e>// 设置渐变半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>colors</span><span style=color:#f92672>:</span> Math.<span style=color:#a6e22e>floor</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span>) <span style=color:#f92672>===</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>?</span>
</span></span><span style=display:flex><span>            [[<span style=color:#e6db74>&#34;#FF6B6B&#34;</span>, <span style=color:#ae81ff>0.0</span>], [<span style=color:#e6db74>&#34;#D84315&#34;</span>, <span style=color:#ae81ff>0.3</span>], [<span style=color:#e6db74>&#34;#C62828&#34;</span>, <span style=color:#ae81ff>1.0</span>]] <span style=color:#f92672>:</span> <span style=color:#75715e>// 当角度为0时的渐变颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            [[<span style=color:#e6db74>&#34;#bcbcc6&#34;</span>, <span style=color:#ae81ff>0.0</span>], [<span style=color:#e6db74>&#34;#464650&#34;</span>, <span style=color:#ae81ff>0.3</span>], [<span style=color:#e6db74>&#34;#474750&#34;</span>, <span style=color:#ae81ff>1.0</span>]] <span style=color:#75715e>// 当角度不为0时的渐变颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#ae81ff>50</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>translate</span>({
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateBallPosition</span>().<span style=color:#a6e22e>x</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#75715e>// 设置X轴偏移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateBallPosition</span>().<span style=color:#a6e22e>y</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> <span style=color:#75715e>// 设置Y轴偏移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>animation</span>({ <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>EaseOut</span> }); <span style=color:#75715e>// 设置动画效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;580lpx&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;580lpx&#39;</span>).<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置外部大圆的宽度、高度和圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }.<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置Stack的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置Stack的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#18181a&#34;</span>); <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=turntable>turntable<a hidden class=anchor aria-hidden=true href=#turntable>#</a></h1><p>转盘</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>CounterComponent</span>, <span style=color:#a6e22e>CounterType</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@kit.ArkUI&#39;</span>; <span style=color:#75715e>// 导入计数器组件和计数器类型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义扇形组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Sector</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Prop</span> <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 扇形的半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Prop</span> <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>; <span style=color:#75715e>// 扇形的角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Prop</span> <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 扇形的颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 创建扇形路径的函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>createSectorPath</span>(<span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>)<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>centerX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 计算扇形中心的X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>centerY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>; <span style=color:#75715e>// 计算扇形中心的Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>startX</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>centerX</span>; <span style=color:#75715e>// 扇形起始点的X坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>startY</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>centerY</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>radius</span>; <span style=color:#75715e>// 扇形起始点的Y坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>halfAngle</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>angle</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span>; <span style=color:#75715e>// 计算半个角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 计算扇形结束点1的坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endX1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>centerX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>cos</span>((<span style=color:#a6e22e>halfAngle</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>PI</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>180</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endY1</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>centerY</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>sin</span>((<span style=color:#a6e22e>halfAngle</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>PI</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>180</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 计算扇形结束点2的坐标
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endX2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>centerX</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>cos</span>((<span style=color:#f92672>-</span><span style=color:#a6e22e>halfAngle</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>PI</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>180</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endY2</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>centerY</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>radius</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>sin</span>((<span style=color:#f92672>-</span><span style=color:#a6e22e>halfAngle</span> <span style=color:#f92672>*</span> Math.<span style=color:#a6e22e>PI</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>180</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 判断是否为大弧
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>largeArcFlag</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>angle</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>180</span> <span style=color:#f92672>?</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>sweepFlag</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>; <span style=color:#75715e>// 设置弧线方向为顺时针
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 生成SVG路径命令
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pathCommands</span> <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>      <span style=color:#e6db74>`M</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>startX</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>startY</span><span style=color:#e6db74>}</span><span style=color:#e6db74> A</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74> 0 </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>largeArcFlag</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>sweepFlag</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>endX1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>endY1</span><span style=color:#e6db74>}</span><span style=color:#e6db74> L</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>centerX</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>centerY</span><span style=color:#e6db74>}</span><span style=color:#e6db74> L</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>endX2</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>endY2</span><span style=color:#e6db74>}</span><span style=color:#e6db74> A</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74> 0 </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>largeArcFlag</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#ae81ff>1</span> <span style=color:#f92672>-</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>sweepFlag</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>startX</span><span style=color:#e6db74>}</span><span style=color:#e6db74> </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>startY</span><span style=color:#e6db74>}</span><span style=color:#e6db74> Z`</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>pathCommands</span>; <span style=color:#75715e>// 返回路径命令
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建扇形组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建第一个扇形路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Path</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>) <span style=color:#75715e>// 设置宽度为半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>) <span style=color:#75715e>// 设置高度为半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>commands</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createSectorPath</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>radius</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span>)) <span style=color:#75715e>// 设置路径命令
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// 设置填充透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fill</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span>) <span style=color:#75715e>// 设置填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 设置边框宽度为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>90</span> }); <span style=color:#75715e>// 旋转扇形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建第二个扇形路径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Path</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>) <span style=color:#75715e>// 设置宽度为半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>radius</span><span style=color:#e6db74>}</span><span style=color:#e6db74>px`</span>) <span style=color:#75715e>// 设置高度为半径
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>commands</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>createSectorPath</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>radius</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span>)) <span style=color:#75715e>// 设置路径命令
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// 设置填充透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fill</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span>) <span style=color:#75715e>// 设置填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>0</span>) <span style=color:#75715e>// 设置边框宽度为0
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>180</span> <span style=color:#f92672>-</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>90</span>) }); <span style=color:#75715e>// 旋转扇形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义单元格类
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ObservedV2</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Cell</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 扇形的角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 当前格子的标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>; <span style=color:#75715e>// 背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Trace</span> <span style=color:#a6e22e>rotate</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 在转盘要旋转的角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>angleStart</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 轮盘所在区间的起始
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>angleEnd</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 轮盘所在区间的结束
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>proportion</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 所占比例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构造函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>constructor</span>(<span style=color:#a6e22e>proportion</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>, <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>proportion</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>proportion</span>; <span style=color:#75715e>// 设置比例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>title</span>; <span style=color:#75715e>// 设置标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>color</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>color</span>; <span style=color:#75715e>// 设置颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义转盘组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Wheel</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cells</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>[] <span style=color:#f92672>=</span> []; <span style=color:#75715e>// 存储单元格的数组
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>wheelWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>600</span>; <span style=color:#75715e>// 转盘的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>currentAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 当前转盘的角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>selectedName</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 选中的名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isAnimating</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 动画状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>colorIndex</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 颜色索引
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>colorPalette</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>[] <span style=color:#f92672>=</span> [ <span style=color:#75715e>// 颜色调色板
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#e6db74>&#34;#26c2ff&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;#978efe&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;#c389fe&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;#ff85bd&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;#ff7051&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;#fea800&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;#ffcf18&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;#a9c92a&#34;</span>
</span></span><span style=display:flex><span>  ];
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 组件即将出现时调用
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>aboutToAppear</span>()<span style=color:#f92672>:</span> <span style=color:#66d9ef>void</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 初始化单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#34;跑步&#34;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorIndex</span><span style=color:#f92672>++</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>.<span style=color:#a6e22e>length</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#34;跳绳&#34;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorIndex</span><span style=color:#f92672>++</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>.<span style=color:#a6e22e>length</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#34;唱歌&#34;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorIndex</span><span style=color:#f92672>++</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>.<span style=color:#a6e22e>length</span>]));
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>4</span>, <span style=color:#e6db74>&#34;跳舞&#34;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorIndex</span><span style=color:#f92672>++</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>.<span style=color:#a6e22e>length</span>]));
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateAngles</span>(); <span style=color:#75715e>// 计算角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 计算每个单元格的角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>private</span> <span style=color:#a6e22e>calculateAngles</span>() {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 根据比例计算总比例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>totalProportion</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>reduce</span>((<span style=color:#a6e22e>sum</span>, <span style=color:#a6e22e>cell</span>) =&gt; <span style=color:#a6e22e>sum</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>proportion</span>, <span style=color:#ae81ff>0</span>);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>cell</span> =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>proportion</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>360</span>) <span style=color:#f92672>/</span> <span style=color:#a6e22e>totalProportion</span>; <span style=color:#75715e>// 计算每个单元格的角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>cumulativeAngle</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 累计角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>cell</span> =&gt; {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angleStart</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cumulativeAngle</span>; <span style=color:#75715e>// 设置起始角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>cumulativeAngle</span> <span style=color:#f92672>+=</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angle</span>; <span style=color:#75715e>// 更新累计角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angleEnd</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cumulativeAngle</span>; <span style=color:#75715e>// 设置结束角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>rotate</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cumulativeAngle</span> <span style=color:#f92672>-</span> (<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angle</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>); <span style=color:#75715e>// 计算旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    });
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 构建转盘组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;转盘&#39;</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#0b0e15&#34;</span>); <span style=color:#75715e>// 显示转盘标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>44</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>Center</span>); <span style=color:#75715e>// 设置行的宽度和高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 显示当前状态
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimating</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;旋转中&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedName</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>).<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#0b0e15&#34;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>40</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 遍历每个单元格并绘制扇形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>, (<span style=color:#a6e22e>cell</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>Sector</span>({ <span style=color:#a6e22e>radius</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>lpx2px</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>wheelWidth</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angle</span>, <span style=color:#a6e22e>color</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>color</span> }); <span style=color:#75715e>// 创建扇形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Text</span>(<span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>title</span>).<span style=color:#a6e22e>fontColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>White</span>).<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>wheelWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>1.4</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }); <span style=color:#75715e>// 显示单元格标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>rotate</span> }); <span style=color:#75715e>// 设置宽度和高度，并旋转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#a6e22e>Color</span>.<span style=color:#a6e22e>Gray</span>) <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>wheelWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置转盘宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>wheelWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置转盘高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>rotate</span>({ <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span> }); <span style=color:#75715e>// 旋转转盘
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建指针
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Polygon</span>({ <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span>, <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>10</span> })
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>points</span>([[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], [<span style=color:#ae81ff>10</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>20</span>], [<span style=color:#ae81ff>20</span>, <span style=color:#ae81ff>0</span>]]) <span style=color:#75715e>// 设置指针的点
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#d72b0b&#34;</span>) <span style=color:#75715e>// 设置指针颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>20</span>) <span style=color:#75715e>// 设置指针高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;140lpx&#39;</span> }); <span style=color:#75715e>// 设置指针底部边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建开始按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;开始&#39;</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#c53a2c&#34;</span>) <span style=color:#75715e>// 设置按钮字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderWidth</span>(<span style=color:#ae81ff>10</span>) <span style=color:#75715e>// 设置按钮边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderColor</span>(<span style=color:#e6db74>&#34;#dd2218&#34;</span>) <span style=color:#75715e>// 设置按钮边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#fde427&#34;</span>) <span style=color:#75715e>// 设置按钮背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;200lpx&#39;</span>) <span style=color:#75715e>// 设置按钮宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;200lpx&#39;</span>) <span style=color:#75715e>// 设置按钮高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置按钮为圆形
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>clickEffect</span>({ <span style=color:#a6e22e>level</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>ClickEffectLevel</span>.<span style=color:#a6e22e>LIGHT</span> }) <span style=color:#75715e>// 设置点击效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击按钮时的回调函数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimating</span>) { <span style=color:#75715e>// 如果正在动画中，返回
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedName</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>; <span style=color:#75715e>// 清空选中的名称
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimating</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 设置动画状态为正在动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>animateTo</span>({ <span style=color:#75715e>// 开始动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>5000</span>, <span style=color:#75715e>// 动画持续时间为5000毫秒
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>curve</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Curve</span>.<span style=color:#a6e22e>EaseInOut</span>, <span style=color:#75715e>// 动画曲线为缓入缓出
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span> <span style=color:#f92672>%=</span> <span style=color:#ae81ff>360</span>; <span style=color:#75715e>// 保持当前角度在0到360之间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>cell</span> <span style=color:#66d9ef>of</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>) { <span style=color:#75715e>// 遍历每个单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#75715e>// 检查当前角度是否在单元格的角度范围内
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>if</span> (<span style=color:#ae81ff>360</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angleStart</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>360</span> <span style=color:#f92672>-</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span> <span style=color:#f92672>&lt;=</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>angleEnd</span>) {
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>selectedName</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>cell</span>.<span style=color:#a6e22e>title</span>; <span style=color:#75715e>// 设置选中的名称为当前单元格的标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>break</span>; <span style=color:#75715e>// 找到后退出循环
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimating</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 设置动画状态为未动画
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              },
</span></span><span style=display:flex><span>            }, () =&gt; { <span style=color:#75715e>// 动画进行中的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>currentAngle</span> <span style=color:#f92672>+=</span> (<span style=color:#ae81ff>360</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span> <span style=color:#f92672>+</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>360</span>)); <span style=color:#75715e>// 更新当前角度，增加随机旋转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span>          });
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建滚动区域
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Scroll</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 遍历每个单元格，创建输入框和计数器
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>ForEach</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>, (<span style=color:#a6e22e>item</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Cell</span>, <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>Row</span>() {
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 创建文本输入框，显示单元格标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>TextInput</span>({ <span style=color:#a6e22e>text</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>title</span> })
</span></span><span style=display:flex><span>                .<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// 设置输入框占据剩余空间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                .<span style=color:#a6e22e>onChange</span>((<span style=color:#a6e22e>value</span>) =&gt; { <span style=color:#75715e>// 输入框内容变化时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>title</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>; <span style=color:#75715e>// 更新单元格标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                });
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 创建计数器组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>CounterComponent</span>({
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>options</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                  <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>CounterType</span>.<span style=color:#a6e22e>COMPACT</span>, <span style=color:#75715e>// 设置计数器类型为紧凑型
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#a6e22e>numberOptions</span><span style=color:#f92672>:</span> {
</span></span><span style=display:flex><span>                    <span style=color:#a6e22e>label</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`当前占比`</span>, <span style=color:#75715e>// 设置计数器标签
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>proportion</span>, <span style=color:#75715e>// 设置计数器初始值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>min</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 设置最小值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>max</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>, <span style=color:#75715e>// 设置最大值
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>step</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>, <span style=color:#75715e>// 设置步长
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#a6e22e>onChange</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) =&gt; { <span style=color:#75715e>// 计数器值变化时的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                      <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>proportion</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>; <span style=color:#75715e>// 更新单元格的比例
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                      <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateAngles</span>(); <span style=color:#75715e>// 重新计算角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    }
</span></span><span style=display:flex><span>                  }
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>              });
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 创建删除按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;删除&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>splice</span>(<span style=color:#a6e22e>index</span>, <span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 从单元格数组中删除当前单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateAngles</span>(); <span style=color:#75715e>// 重新计算角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              });
</span></span><span style=display:flex><span>            }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>SpaceBetween</span>) <span style=color:#75715e>// 设置行的宽度和内容对齐方式
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>40</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>40</span> }); <span style=color:#75715e>// 设置左右内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span>        }.<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>); <span style=color:#75715e>// 设置滚动区域占据剩余空间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }.<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// 设置滚动区域占据剩余空间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) <span style=color:#75715e>// 设置上下外边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      .<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Top</span>); <span style=color:#75715e>// 设置对齐方式为顶部对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 创建添加新内容按钮
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Button</span>(<span style=color:#e6db74>&#39;添加新内容&#39;</span>).<span style=color:#a6e22e>onClick</span>(() =&gt; {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 向单元格数组中添加新单元格
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cells</span>.<span style=color:#a6e22e>push</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Cell</span>(<span style=color:#ae81ff>1</span>, <span style=color:#e6db74>&#34;新内容&#34;</span>, <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>[<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorIndex</span><span style=color:#f92672>++</span> <span style=color:#f92672>%</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>colorPalette</span>.<span style=color:#a6e22e>length</span>]));
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>calculateAngles</span>(); <span style=color:#75715e>// 重新计算角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      }).<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span>, <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }); <span style=color:#75715e>// 设置按钮的上下外边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置组件高度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置组件宽度为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#f5f8ff&#34;</span>); <span style=color:#75715e>// 设置组件背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h1 id=coin>Coin<a hidden class=anchor aria-hidden=true href=#coin>#</a></h1><p>投硬币</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#75715e>// 定义地鼠组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>Hamster</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Prop</span> <span style=color:#a6e22e>cellWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#75715e>// 单元格宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Stack</span>() { <span style=color:#75715e>// 创建一个堆叠布局
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// 身体
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 宽度为单元格宽度的一半
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 高度为单元格高度的2/3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#b49579&#34;</span>)<span style=color:#75715e>// 背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>borderRadius</span>({ <span style=color:#a6e22e>topLeft</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;50%&#39;</span>, <span style=color:#a6e22e>topRight</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;50%&#39;</span> })<span style=color:#75715e>// 圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>borderColor</span>(<span style=color:#e6db74>&#34;#2a272d&#34;</span>)<span style=color:#75715e>// 边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>borderWidth</span>(<span style=color:#ae81ff>1</span>) <span style=color:#75715e>// 边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// 嘴巴
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Ellipse</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>4</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 嘴巴的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 嘴巴的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 填充不透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#e7bad7&#34;</span>)<span style=color:#75715e>// 填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;#563e3f&#34;</span>)<span style=color:#75715e>// 边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 上边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// 左眼睛
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Ellipse</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 左眼睛的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 左眼睛的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 填充不透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#313028&#34;</span>)<span style=color:#75715e>// 填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;#2e2018&#34;</span>)<span style=color:#75715e>// 边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 下边距和右边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// 右眼睛
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Ellipse</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>9</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 右眼睛的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 右眼睛的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 填充不透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#313028&#34;</span>)<span style=color:#75715e>// 填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>stroke</span>(<span style=color:#e6db74>&#34;#2e2018&#34;</span>)<span style=color:#75715e>// 边框颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>strokeWidth</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 边框宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 下边距和左边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// 左眼瞳
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Ellipse</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>20</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 左眼瞳的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>15</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 左眼瞳的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 填充不透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#fefbfa&#34;</span>)<span style=color:#75715e>// 填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2.5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>right</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 下边距和右边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#75715e>// 右眼瞳
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Ellipse</span>()
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>20</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 右眼瞳的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>15</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 右眼瞳的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fillOpacity</span>(<span style=color:#ae81ff>1</span>)<span style=color:#75715e>// 填充不透明度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fill</span>(<span style=color:#e6db74>&#34;#fefbfa&#34;</span>)<span style=color:#75715e>// 填充颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>margin</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2.5</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>, <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>6</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span> }) <span style=color:#75715e>// 下边距和左边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>).<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置组件的宽度和高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span><span style=color:#75715e>// 定义页面组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Entry</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>Component</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>struct</span> <span style=color:#a6e22e>CoinTossPage</span> {
</span></span><span style=display:flex><span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>cellWidth</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>50</span> <span style=color:#75715e>// 单元格宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>headsCount</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 正面朝上的次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>tailsCount</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 反面朝上的次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>rotationAngle</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 旋转角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>verticalOffset</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span> <span style=color:#75715e>// 纵向位移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>State</span> <span style=color:#a6e22e>isAnimRun</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>boolean</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span> <span style=color:#75715e>// 动画是否正在执行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>build</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>Column</span>() {
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 页面标题
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#39;抛硬币&#39;</span>)
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>height</span>(<span style=color:#ae81ff>50</span>)<span style=color:#75715e>// 高度设置为50
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>)<span style=color:#75715e>// 宽度设置为100%
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>textAlign</span>(<span style=color:#a6e22e>TextAlign</span>.<span style=color:#a6e22e>Center</span>)<span style=color:#75715e>// 文本居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#fefefe&#34;</span>)<span style=color:#75715e>// 字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>); <span style=color:#75715e>// 字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#75715e>// 显示地鼠和计数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>      <span style=color:#a6e22e>Row</span>({ <span style=color:#a6e22e>space</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>20</span> }) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>Hamster</span>({ <span style=color:#a6e22e>cellWidth</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> }) <span style=color:#75715e>// 创建地鼠组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>linearGradient</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 设置线性渐变背景
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GradientDirection</span>.<span style=color:#a6e22e>LeftBottom</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>colors</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;#ebcf2f&#39;</span>, <span style=color:#ae81ff>0.0</span>], [<span style=color:#e6db74>&#39;#fef888&#39;</span>, <span style=color:#ae81ff>0.5</span>], [<span style=color:#e6db74>&#39;#ebcf2f&#39;</span>, <span style=color:#ae81ff>1.0</span>]]
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 显示反面朝上的次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>tailsCount</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#fefefe&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 显示100
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#34;100&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#9f7606&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>linearGradient</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 设置线性渐变背景
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GradientDirection</span>.<span style=color:#a6e22e>LeftBottom</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>colors</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;#ebcf2f&#39;</span>, <span style=color:#ae81ff>0.0</span>], [<span style=color:#e6db74>&#39;#fef888&#39;</span>, <span style=color:#ae81ff>0.5</span>], [<span style=color:#e6db74>&#39;#ebcf2f&#39;</span>, <span style=color:#ae81ff>1.0</span>]]
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 显示正面朝上的次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>headsCount</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontSize</span>(<span style=color:#ae81ff>20</span>)
</span></span><span style=display:flex><span>          .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#fefefe&#34;</span>);
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>justifyContent</span>(<span style=color:#a6e22e>FlexAlign</span>.<span style=color:#a6e22e>Center</span>); <span style=color:#75715e>// 设置宽度和内容居中对齐
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>Stack</span>() {
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 创建放大版地鼠组件
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Hamster</span>({ <span style=color:#a6e22e>cellWidth</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span> })
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>visibility</span>(<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isHeadsFaceUp</span>() <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Hidden</span>); <span style=color:#75715e>// 根据状态显示或隐藏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 显示100
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>Text</span>(<span style=color:#e6db74>&#34;100&#34;</span>)
</span></span><span style=display:flex><span>            .<span style=color:#a6e22e>fontColor</span>(<span style=color:#e6db74>&#34;#9f7606&#34;</span>)<span style=color:#75715e>// 字体颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>fontSize</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>)<span style=color:#75715e>// 字体大小
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>visibility</span>(<span style=color:#f92672>!</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isHeadsFaceUp</span>() <span style=color:#f92672>?</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Visible</span> <span style=color:#f92672>:</span> <span style=color:#a6e22e>Visibility</span>.<span style=color:#a6e22e>Hidden</span>)<span style=color:#75715e>// 根据状态显示或隐藏
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            .<span style=color:#a6e22e>rotate</span>({
</span></span><span style=display:flex><span>              <span style=color:#75715e>// 旋转180度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>z</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>180</span>
</span></span><span style=display:flex><span>            });
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>borderRadius</span>(<span style=color:#e6db74>&#39;50%&#39;</span>) <span style=color:#75715e>// 设置圆角
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>cellWidth</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>3</span><span style=color:#e6db74>}</span><span style=color:#e6db74>lpx`</span>) <span style=color:#75715e>// 设置高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>linearGradient</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 设置线性渐变背景
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>direction</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GradientDirection</span>.<span style=color:#a6e22e>LeftBottom</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>colors</span><span style=color:#f92672>:</span> [[<span style=color:#e6db74>&#39;#ebcf2f&#39;</span>, <span style=color:#ae81ff>0.0</span>], [<span style=color:#e6db74>&#39;#fef888&#39;</span>, <span style=color:#ae81ff>0.5</span>], [<span style=color:#e6db74>&#39;#ebcf2f&#39;</span>, <span style=color:#ae81ff>1.0</span>]]
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>rotate</span>({
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 根据当前角度旋转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>z</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>          <span style=color:#a6e22e>angle</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span>
</span></span><span style=display:flex><span>        })
</span></span><span style=display:flex><span>        .<span style=color:#a6e22e>translate</span>({ <span style=color:#a6e22e>x</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>y</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>verticalOffset</span> }) <span style=color:#75715e>// 设置纵向位移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        .<span style=color:#a6e22e>onClick</span>(() =&gt; { <span style=color:#75715e>// 点击事件处理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimRun</span>) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimRun</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>maxAnimationSteps</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>10</span> <span style=color:#f92672>+</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>10</span>)); <span style=color:#75715e>// 计算最大动画次数
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>totalAnimationDuration</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>2000</span>; <span style=color:#75715e>// 动画总时长
</span></span></span><span style=display:flex><span><span style=color:#75715e></span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 第一次动画，向上抛出
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>totalAnimationDuration</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>, <span style=color:#75715e>// 动画时长为总时长的一半
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; { <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#75715e>// 第二次动画，向下落
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>totalAnimationDuration</span> <span style=color:#f92672>/</span> <span style=color:#ae81ff>2</span>,
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>360</span>; <span style=color:#75715e>// 确保角度在0到360之间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#75715e>// 判断当前显示的面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  <span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isHeadsFaceUp</span>()) { <span style=color:#75715e>// 如果是地鼠面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>tailsCount</span><span style=color:#f92672>++</span>; <span style=color:#75715e>// 反面朝上的次数加1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  } <span style=color:#66d9ef>else</span> { <span style=color:#75715e>// 如果是反面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>headsCount</span><span style=color:#f92672>++</span>; <span style=color:#75715e>// 正面朝上的次数加1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                  }
</span></span><span style=display:flex><span>                  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>isAnimRun</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span>                }
</span></span><span style=display:flex><span>              }, () =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>verticalOffset</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#75715e>// 重置纵向位移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              });
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>          }, () =&gt; {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 设置纵向位移，模拟抛硬币的效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>verticalOffset</span> <span style=color:#f92672>=</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>100</span> <span style=color:#f92672>*</span> (<span style=color:#ae81ff>1</span> <span style=color:#f92672>+</span> Math.<span style=color:#a6e22e>floor</span>(Math.<span style=color:#a6e22e>random</span>() <span style=color:#f92672>*</span> <span style=color:#ae81ff>5</span>)); <span style=color:#75715e>// 随机设置向上的位移
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>          <span style=color:#75715e>// 循环动画，增加旋转效果
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>          <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; <span style=color:#a6e22e>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#a6e22e>maxAnimationSteps</span>; <span style=color:#a6e22e>i</span><span style=color:#f92672>++</span>) {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>animateToImmediately</span>({
</span></span><span style=display:flex><span>              <span style=color:#a6e22e>delay</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>i</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>totalAnimationDuration</span> <span style=color:#f92672>/</span> <span style=color:#a6e22e>maxAnimationSteps</span>, <span style=color:#75715e>// 设置每次动画的延迟
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>duration</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>, <span style=color:#75715e>// 每次动画的持续时间
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              <span style=color:#a6e22e>onFinish</span><span style=color:#f92672>:</span> () =&gt; {
</span></span><span style=display:flex><span>                <span style=color:#75715e>// 动画完成后的回调
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>              }
</span></span><span style=display:flex><span>            }, () =&gt; {
</span></span><span style=display:flex><span>              <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>+=</span> <span style=color:#ae81ff>90</span>; <span style=color:#75715e>// 每次增加90度旋转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            });
</span></span><span style=display:flex><span>          }
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>      }.<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>).<span style=color:#a6e22e>layoutWeight</span>(<span style=color:#ae81ff>1</span>).<span style=color:#a6e22e>align</span>(<span style=color:#a6e22e>Alignment</span>.<span style=color:#a6e22e>Bottom</span>).<span style=color:#a6e22e>padding</span>({ <span style=color:#a6e22e>bottom</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>80</span> }); <span style=color:#75715e>// 设置组件的宽度、权重、对齐方式和底部内边距
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    .<span style=color:#a6e22e>height</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置整个页面的高度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>width</span>(<span style=color:#e6db74>&#39;100%&#39;</span>) <span style=color:#75715e>// 设置整个页面的宽度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    .<span style=color:#a6e22e>backgroundColor</span>(<span style=color:#e6db74>&#34;#0b0d0c&#34;</span>); <span style=color:#75715e>// 设置背景颜色
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>  <span style=color:#75715e>// 判断当前是否显示地鼠面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#a6e22e>isHeadsFaceUp</span>() {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>normalizedAngle</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>rotationAngle</span> <span style=color:#f92672>%</span> <span style=color:#ae81ff>360</span>; <span style=color:#75715e>// 规范化角度
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#75715e>// 判断角度范围，确定是否显示地鼠面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>normalizedAngle</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>normalizedAngle</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>90</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>normalizedAngle</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>270</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>normalizedAngle</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>360</span>) {
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>true</span>; <span style=color:#75715e>// 显示地鼠面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    }
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>false</span>; <span style=color:#75715e>// 显示反面
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://qfsyso.github.io/tags/harmonyos/>HarmonyOS</a></li></ul><nav class=paginav><a class=prev href=https://qfsyso.github.io/posts/iredmail-smtp/><span class=title>« Prev</span><br><span>iRedMail smtp </span></a><a class=next href=https://qfsyso.github.io/posts/csharp-ddos/><span class=title>Next »</span><br><span>Csharp DDOS</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share HarmonyOS Next Waste Sorting on x" href="https://x.com/intent/tweet/?text=HarmonyOS%20Next%20Waste%20Sorting&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f&amp;hashtags=HarmonyOS"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HarmonyOS Next Waste Sorting on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f&amp;title=HarmonyOS%20Next%20Waste%20Sorting&amp;summary=HarmonyOS%20Next%20Waste%20Sorting&amp;source=https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HarmonyOS Next Waste Sorting on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f&title=HarmonyOS%20Next%20Waste%20Sorting"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HarmonyOS Next Waste Sorting on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HarmonyOS Next Waste Sorting on whatsapp" href="https://api.whatsapp.com/send?text=HarmonyOS%20Next%20Waste%20Sorting%20-%20https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HarmonyOS Next Waste Sorting on telegram" href="https://telegram.me/share/url?text=HarmonyOS%20Next%20Waste%20Sorting&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share HarmonyOS Next Waste Sorting on ycombinator" href="https://news.ycombinator.com/submitlink?t=HarmonyOS%20Next%20Waste%20Sorting&u=https%3a%2f%2fqfsyso.github.io%2fposts%2fharmonyos-next-waste-sorting%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><div class=wtime><div class=wtime2>CST<span id=beijingTime></span> GMT <span id=londonTime></span> EST <span id=newYorkTime></span> PST<span id=losAngelesTime></span></div><div class=wtime2 style=display:none>东京<span id=tokyoTime></span></div><div class=wtime2 style=display:none>欧洲-巴黎<span id=parisTime></span></div><div class=wtime2 style=display:none>UTC<span id=utcTime></span></div></div><span>&copy; 2025 <a href=https://qfsyso.github.io/>MLOG</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script type=text/javascript>const timeZoneOffsets={beijing:8,tokyo:9,paris:[1,2],london:[0,1],newYork:[-5,-4],losAngeles:[-8,-7]};function padZero(e){return e<10?"0"+e:e}function formatTime(e){const t=e.getFullYear(),n=padZero(e.getMonth()+1),s=padZero(e.getDate()),o=padZero(e.getHours()),i=padZero(e.getMinutes()),a=padZero(e.getSeconds());return`${t}-${n}-${s} ${o}:${i}:${a}`}function isDaylightSavingTime(e,t){const o=e.getMonth(),n=new Date(e.getFullYear(),3,8,2,0,0),s=new Date(e.getFullYear(),10,1,2,0,0);return(t==="paris"||t==="london"||t==="newYork"||t==="losAngeles")&&e>=n&&e<s}function updateTime(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),n=formatTime(t);document.getElementById("utcTime").innerHTML=n;for(const n in timeZoneOffsets){const e=timeZoneOffsets[n];let s;Array.isArray(e)?s=isDaylightSavingTime(t,n)?e[1]:e[0]:s=e;const o=new Date(t.getTime()+s*60*60*1e3);document.getElementById(n+"Time").innerHTML=formatTime(o)}setTimeout(updateTime,1e3)}window.onload=function(){updateTime()};function notfound(e){var n=e.src,t=n.split("/"),s=t[t.length-1];e.src="https://47.115.223.75:8080/group1/v2/"+s+"?timestamp="+Date.now(),e.onerror=null}</script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>