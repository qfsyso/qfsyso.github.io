<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ipa Share | MLOG</title>
<meta name=keywords content="Apple,Go,Debian,Linux"><meta name=description content="Debian 服务器上部署 ipashare。
部署前准备 服务器环境要求
操作系统：Debian12
网络：确保服务器能正常访问 Docker 镜像仓库及 Apple App Store Connect API。
域名建议已绑定并正确解析到该服务器，支持 HTTPS（可通过 Nginx + Certbot 实现）。
系统依赖工具安装
执行以下命令安装 Docker 及 Docker Compose：
sudo apt update sudo apt install -y docker.io docker-compose sudo systemctl enable --now docker 获取 Apple API 凭证
登录 App Store Connect 创建 API 密钥，包括：
Issuer ID
Key ID
.p8 文件
这些是项目调用 App Store Connect API 必需项。
使用 Docker Compose 部署 官方提供 docker-compose.yml 示例，可在服务器上创建并自定义："><meta name=author content="dwd"><link rel=canonical href=https://qfsyso.github.io/posts/ipa-share/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://qfsyso.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://qfsyso.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://qfsyso.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://qfsyso.github.io/apple-touch-icon.png><link rel=mask-icon href=https://qfsyso.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://qfsyso.github.io/posts/ipa-share/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://qfsyso.github.io/posts/ipa-share/"><meta property="og:site_name" content="MLOG"><meta property="og:title" content="Ipa Share"><meta property="og:description" content="Debian 服务器上部署 ipashare。
部署前准备 服务器环境要求
操作系统：Debian12
网络：确保服务器能正常访问 Docker 镜像仓库及 Apple App Store Connect API。
域名建议已绑定并正确解析到该服务器，支持 HTTPS（可通过 Nginx + Certbot 实现）。
系统依赖工具安装
执行以下命令安装 Docker 及 Docker Compose：
sudo apt update sudo apt install -y docker.io docker-compose sudo systemctl enable --now docker 获取 Apple API 凭证
登录 App Store Connect 创建 API 密钥，包括：
Issuer ID
Key ID
.p8 文件
这些是项目调用 App Store Connect API 必需项。
使用 Docker Compose 部署 官方提供 docker-compose.yml 示例，可在服务器上创建并自定义："><meta property="og:locale" content="zh-CN"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-23T01:33:06+08:00"><meta property="article:modified_time" content="2025-08-23T01:33:06+08:00"><meta property="article:tag" content="Apple"><meta property="article:tag" content="Go"><meta property="article:tag" content="Debian"><meta property="article:tag" content="Linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ipa Share"><meta name=twitter:description content="Debian 服务器上部署 ipashare。
部署前准备 服务器环境要求
操作系统：Debian12
网络：确保服务器能正常访问 Docker 镜像仓库及 Apple App Store Connect API。
域名建议已绑定并正确解析到该服务器，支持 HTTPS（可通过 Nginx + Certbot 实现）。
系统依赖工具安装
执行以下命令安装 Docker 及 Docker Compose：
sudo apt update sudo apt install -y docker.io docker-compose sudo systemctl enable --now docker 获取 Apple API 凭证
登录 App Store Connect 创建 API 密钥，包括：
Issuer ID
Key ID
.p8 文件
这些是项目调用 App Store Connect API 必需项。
使用 Docker Compose 部署 官方提供 docker-compose.yml 示例，可在服务器上创建并自定义："><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://qfsyso.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Ipa Share","item":"https://qfsyso.github.io/posts/ipa-share/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Ipa Share","name":"Ipa Share","description":"Debian 服务器上部署 ipashare。\n部署前准备 服务器环境要求\n操作系统：Debian12\n网络：确保服务器能正常访问 Docker 镜像仓库及 Apple App Store Connect API。\n域名建议已绑定并正确解析到该服务器，支持 HTTPS（可通过 Nginx + Certbot 实现）。\n系统依赖工具安装\n执行以下命令安装 Docker 及 Docker Compose：\nsudo apt update sudo apt install -y docker.io docker-compose sudo systemctl enable --now docker 获取 Apple API 凭证\n登录 App Store Connect 创建 API 密钥，包括：\nIssuer ID\nKey ID\n.p8 文件\n这些是项目调用 App Store Connect API 必需项。\n使用 Docker Compose 部署 官方提供 docker-compose.yml 示例，可在服务器上创建并自定义：","keywords":["Apple","Go","Debian","Linux"],"articleBody":"Debian 服务器上部署 ipashare。\n部署前准备 服务器环境要求\n操作系统：Debian12\n网络：确保服务器能正常访问 Docker 镜像仓库及 Apple App Store Connect API。\n域名建议已绑定并正确解析到该服务器，支持 HTTPS（可通过 Nginx + Certbot 实现）。\n系统依赖工具安装\n执行以下命令安装 Docker 及 Docker Compose：\nsudo apt update sudo apt install -y docker.io docker-compose sudo systemctl enable --now docker 获取 Apple API 凭证\n登录 App Store Connect 创建 API 密钥，包括：\nIssuer ID\nKey ID\n.p8 文件\n这些是项目调用 App Store Connect API 必需项。\n使用 Docker Compose 部署 官方提供 docker-compose.yml 示例，可在服务器上创建并自定义：\nversion: '3' services: server: image: togettoyou/ipashare:latest ports: - \"8888:8888\" volumes: - ./data:/app/data - ./config:/app/config environment: - SERVER_URL=https://www.xxx.com - SERVER_HTTPPORT=8888 - SERVER_MAXJOB=10 - SERVER_RUNMODE=release - LOG_LEVEL=info - IOS_P12_FILE=/root/testipax/z822.p12 - IOS_P12_PASSWORD=123zxxxxx 将上述内容保存到项目目录下的 docker-compose.yml（注意替换 SERVER_URL 为你自己的域名），然后执行：\n# 后台启动服务 docker-compose up -d # 查看日志 docker-compose logs -f --tail 100 # 停止、启动、重启、清理服务 docker-compose stop docker-compose start docker-compose restart docker-compose down -v 访问与数据结构说明 启动成功后，通过 https://www.xxx.com/admin 可访问后台管理界面。\ndata 目录结构及含义： apple_developer：存放 Apple 开发者 API 凭证。\nupload_file_path：用户上传的 .ipa 文件。\ntemporary_file_path：签名后生成的 IPA，默认存储 1 小时后自动删除。\nsqlite.db：默认使用 SQLite 数据库存储。\n若启用 MySQL，可使用环境变量指定连接和数据存储位置。\n可选优化项与注意事项 启用 HTTPS\n推荐使用 Nginx 反向代理 + Let’s Encrypt 获取 TLS 证书。\n将 Nginx 配置为监听 443，转发 /admin 和主服务端口（如 8888）到 ipashare 服务。\n日志持久化和监控\n配置日志驱动，如 json-file 或文件输出，以便长期保存。\n利用 docker logs 或者接入 Prometheus/Grafana 监控容器状态。\n数据备份策略 定期备份 data/apple_developer 和数据库（sqlite.db 或 MySQL）。\n使用 docker-compose down 前，先导出或复制数据目录。\n并发与性能调优\nSERVER_MAXJOB 控制最大签名并发量，建议根据性能瓶颈和服务器规格调整。\n若签名任务多，建议拓展服务器或分布式部署。\n安全与合规\n项目仅用于个人开发者测试分享，禁止用于商业或非法应用，敬请遵守 Apple 政策。\n建议启用防火墙 (ufw/iptables）限制异常访问。\n部署流程总结 1. 安装 Docker 环境 sudo apt update \u0026\u0026 sudo apt install -y docker.io docker-compose\n2. 创建项目目录 mkdir ~/ipashare \u0026\u0026 cd ~/ipashare\n3. 添加 docker-compose.yml（如上配置内容） 4. 将 Apple API 凭证（.p8 + IDs）放入 data/apple_developer 5. 启动服务 docker-compose up -d\n6. 检查日志确认启动正常 docker-compose logs -f –tail 50\n7. 访问后台管理界面 浏览器打开： https://www.xxx.com/admin\n总结一览 阶段\t操作内容 准备\t安装 Docker \u0026 Compose，获取 Apple API 凭证 配置\t编辑 docker-compose.yml，设置域名、端口、数据卷 启动\tdocker-compose up -d，监控启动日志 使用\t访问 /admin 管理 IPA 分发 优化维护\t配置 HTTPS、日志监控、备份、安全策略等\nerr 403 Team Admins Please check with one of your Team Admins\n使用 APP管理 权限\nerr go p12 Can’t Load P12 or PrivateKey File! Please Input The Correct File And Password!\n如果用 P12 签名 - IOS_P12_FILE=/app/data/apple_developer/cert.p12 - IOS_P12_PASSWORD=P12密码 docker-compose down docker-compose up -d 指定本地 data路径 version: '3' services: server: image: togettoyou/ipashare:latest ports: - \"8888:8888\" volumes: - $PWD/data:/root/togettoyou/data - /etc/timezone:/etc/timezone - /etc/localtime:/etc/localtime environment: - SERVER_URL=https://www.xxx.com - SERVER_HTTPPORT=8888 - SERVER_MAXJOB=10 - SERVER_RUNMODE=release - LOG_LEVEL=info - IOS_P12_FILE=/root/testipax/z822.p12 - IOS_P12_PASSWORD=123123 修改 Bundle ID： Bundle ID： 在server/internal/svc/apple_developer.go文件中，将通配符\"*“替换为具体Bundle ID。例如：\n// 将这行 bundleIds, err := authorize.GetBundleIdsByIdentifier(”*\") // 修改为 bundleIds, err := authorize.GetBundleIdsByIdentifier(“com.xxx.xapp”)\n// 将这行 bundleIdResponse, err := authorize.CreateBundleIds(\"*\") // 修改为 bundleIdResponse, err := authorize.CreateBundleIds(“com.xxx.xapp”)\nDockerfile\nFROM golang:1.16 AS builder-server COPY server/. /root/togettoyou/ WORKDIR /root/togettoyou/ RUN make FROM node:20-alpine AS builder-web WORKDIR /app COPY web/package*.json ./ RUN yarn install --ignore-engines COPY web/. . RUN yarn run build:prod --ignore-engines FROM togettoyou/zsign:latest AS zsign FROM centos:7 WORKDIR /root/togettoyou/ COPY --from=builder-server /root/togettoyou/ipashare ./ COPY --from=builder-server /root/togettoyou/conf/ ./conf/ COPY --from=builder-web /app/dist/ ./dist/ COPY --from=zsign /zsign/zsign /bin/zsign RUN sed -i 's|mirrorlist=http://mirrorlist.centos.org|#mirrorlist=http://mirrorlist.centos.org|' /etc/yum.repos.d/CentOS-Base.repo \u0026\u0026 \\ sed -i 's|#baseurl=http://mirror.centos.org|baseurl=http://mirrors.aliyun.com|' /etc/yum.repos.d/CentOS-Base.repo \u0026\u0026 \\ yum clean all \u0026\u0026 \\ yum makecache RUN yum install -y openssl openssl-devel unzip zip ENTRYPOINT [\"./ipashare\"] docker-compose.yml\nversion: '3' services: server: build: context: . dockerfile: Dockerfile ports: - \"8888:8888\" volumes: - $PWD/data:/root/togettoyou/data - /etc/timezone:/etc/timezone - /etc/localtime:/etc/localtime environment: - SERVER_URL=https://www.4xin.com - SERVER_HTTPPORT=8888 - SERVER_MAXJOB=10 - SERVER_RUNMODE=release - LOG_LEVEL=info - IOS_P12_FILE=/root/testipax/z823.p12 - IOS_P12_PASSWORD=123123 运行\n# 构建并启动服务 docker-compose up --build # 或者在后台运行 docker-compose up --build -d err GLIBC docker logs testipamg-server-1\n./ipashare: /lib64/libc.so.6: version `GLIBC_2.28’ not found (required by ./ipashare)\n容器中的GLIBC版本太低\nCentOS 7默认使用的是较旧版本的GLIBC（2.17）\nIPA自动识别Bundle ID 原项目在处理IPA签名时，使用的是写死的通配符Bundle ID (*)，这样做虽然简单，但不够精确。我们的目标是让系统能够自动识别上传的IPA文件的真实Bundle ID，并在签名时使用这个具体的Bundle ID。\n核心思路 IPA上传 → 解析Bundle ID → 存储到数据库 → 签名时使用具体Bundle ID → 失败则回退到通配符\n具体修改内容\n1. 修改签名逻辑 (server/internal/svc/apple_device.go) 修改位置: signature 方法中的Bundle ID处理逻辑\n原代码:\nprofileResponse, err := authorize.CreateProfile(profileUUID, appleDeveloper.BundleIds, appleDeveloper.CerID, deviceID) 修改后:\n// 获取IPA的Bundle ID并创建对应的Bundle IDs bundleIdForApp := appleDeveloper.BundleIds // 默认使用通配符 if appleIPA.BundleIdentifier != \"\" { // 检查是否已存在该Bundle ID existingBundleId, err := authorize.GetBundleIdsByIdentifier(appleIPA.BundleIdentifier) if err == nil \u0026\u0026 existingBundleId == \"\" { // 创建新的Bundle ID bundleIdResponse, err := authorize.CreateBundleIds(appleIPA.BundleIdentifier) if err == nil { bundleIdForApp = bundleIdResponse.Data.ID } } else if existingBundleId != \"\" { bundleIdForApp = existingBundleId } } profileResponse, err := authorize.CreateProfile(profileUUID, bundleIdForApp, appleDeveloper.CerID, deviceID) 修改说明:\n添加了智能Bundle ID选择逻辑 优先尝试使用IPA的真实Bundle ID 如果Bundle ID不存在，自动创建 如果创建失败，回退到通配符Bundle ID 确保了向后兼容性\n2. 保持开发者账号初始化逻辑 (server/internal/svc/apple_developer.go) 保持不变的部分:\n// 判断账号是否存在bundleIds为*的记录（保持通配符作为默认） bundleIds, err := authorize.GetBundleIdsByIdentifier(\"*\") if err != nil { return 0, e.NewWithStack(e.ErrAppstoreAPI, err) } if bundleIds == \"\" { // 创建新的bundleIds（通配符） bundleIdResponse, err := authorize.CreateBundleIds(\"*\") if err != nil { return 0, e.NewWithStack(e.ErrAppstoreAPI, err) } bundleIds = bundleIdResponse.Data.ID } why:\n开发者账号初始化时仍需要通配符Bundle ID作为基础 通配符Bundle ID是备用方案，确保系统稳定性 避免破坏现有的账号管理逻辑\n工作流程图\n┌─────────────┐ │ 上传IPA文件 │ └─────┬───────┘ │ ▼ ┌─────────────┐ │ 解析Bundle ID │ ← 使用现有的 ipa.Parser └─────┬───────┘ │ ▼ ┌─────────────┐ │ 存储到数据库 │ └─────┬───────┘ │ ▼ ┌─────────────┐ │ 设备签名请求 │ └─────┬───────┘ │ ▼ ┌─────────────┐ ┌─────────────┐ │检查具体Bundle│───▶│Bundle ID存在│ │ID是否存在 │ └─────┬───────┘ └─────┬───────┘ │ │不存在 ▼ ▼ ┌─────────────┐ ┌─────────────┐ │使用现有Bundle│ │创建新Bundle │ │ID进行签名 │ │ID │ └─────────────┘ └─────┬───────┘ │成功 ▼ ┌─────────────┐ │使用新Bundle │ │ID进行签名 │ └─────────────┘ │失败 ▼ ┌─────────────┐ │回退到通配符 │ │Bundle ID │ └─────────────┘\n技术细节\nBundle ID的处理逻辑 检查阶段: 使用 authorize.GetBundleIdsByIdentifier() 检查Bundle ID是否存在 创建阶段: 如果不存在，使用 authorize.CreateBundleIds() 创建新的Bundle ID 回退机制: 如果创建失败，使用原有的通配符Bundle ID 错误处理策略\nif err == nil \u0026\u0026 existingBundleId == \"\" { // 只有在没有错误且Bundle ID确实不存在时才创建 bundleIdResponse, err := authorize.CreateBundleIds(appleIPA.BundleIdentifier) if err == nil { // 只有创建成功时才使用新的Bundle ID bundleIdForApp = bundleIdResponse.Data.ID } // 创建失败时自动回退到通配符，不抛出错误 } 总结 docker-compose.yml\nversion: '3' services: server: build: context: . dockerfile: Dockerfile ports: - \"8888:8888\" volumes: - $PWD/data:/root/togettoyou/data - /etc/timezone:/etc/timezone - /etc/localtime:/etc/localtime environment: - SERVER_URL=https://test123.xxx.com - SERVER_HTTPPORT=8888 - SERVER_MAXJOB=10 - SERVER_RUNMODE=release - LOG_LEVEL=info - IOS_P12_FILE=/root/testipa2/z822.p12 - IOS_P12_PASSWORD=xxx Dockerfile\nFROM golang:1.16 AS builder-server COPY server/. /root/togettoyou/ WORKDIR /root/togettoyou/ RUN make FROM node:20-alpine AS builder-web WORKDIR /app COPY web/package*.json ./ RUN yarn install --ignore-engines COPY web/. . RUN yarn run build:prod --ignore-engines FROM togettoyou/zsign:latest AS zsign FROM centos:7 WORKDIR /root/togettoyou/ COPY --from=builder-server /root/togettoyou/ipashare ./ COPY --from=builder-server /root/togettoyou/conf/ ./conf/ COPY --from=builder-web /app/dist/ ./dist/ COPY --from=zsign /zsign/zsign /bin/zsign RUN sed -i 's|mirrorlist=http://mirrorlist.centos.org|#mirrorlist=http://mirrorlist.centos.org|' /etc/yum.repos.d/CentOS-Base.repo \u0026\u0026 \\ sed -i 's|#baseurl=http://mirror.centos.org|baseurl=http://mirrors.aliyun.com|' /etc/yum.repos.d/CentOS-Base.repo \u0026\u0026 \\ yum clean all \u0026\u0026 \\ yum makecache RUN yum install -y openssl openssl-devel unzip zip ENTRYPOINT [\"./ipashare\"] # caddy test123.xxx.com { reverse_proxy 0.0.0.0:8888 } # nginx server { listen 80; server_name xz.xx.xyz www.xx.xyz; # 设置最大请求体大小，建议设置为100M或更大 client_max_body_size 300M; # 设置客户端请求体缓冲区大小 client_body_buffer_size 128k; # 设置客户端请求体临时文件路径 client_body_temp_path /tmp/nginx_client_temp; # 设置超时时间 client_body_timeout 60s; location / { proxy_pass http://0.0.0.0:8888; proxy_set_header Host $host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; } } sudo nginx -t sudo systemctl reload nginx # 自动申请 HTTPS 证书 # 直接用 certbot 给这个域名配置 SSL： sudo certbot --nginx -d xz.xx.xyz -d www.xx.xyz 输入邮箱 Y 自动SSL\ndocker-compose up -d --build 参考： https://github.com/togettoyou/ipashare\n","wordCount":"1023","inLanguage":"en","datePublished":"2025-08-23T01:33:06+08:00","dateModified":"2025-08-23T01:33:06+08:00","author":{"@type":"Person","name":"dwd"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://qfsyso.github.io/posts/ipa-share/"},"publisher":{"@type":"Organization","name":"MLOG","logo":{"@type":"ImageObject","url":"https://qfsyso.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://qfsyso.github.io/ accesskey=h title="MLOG (Alt + H)">MLOG</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://qfsyso.github.io/posts/ title=Archive><span>Archive</span></a></li><li><a href=https://qfsyso.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://qfsyso.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Ipa Share</h1><div class=post-meta><span title='2025-08-23 01:33:06 +0800 +0800'>August 23, 2025</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;dwd</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e9%83%a8%e7%bd%b2%e5%89%8d%e5%87%86%e5%a4%87 aria-label=部署前准备>部署前准备</a></li><li><a href=#%e4%bd%bf%e7%94%a8-docker-compose-%e9%83%a8%e7%bd%b2 aria-label="使用 Docker Compose 部署">使用 Docker Compose 部署</a></li><li><a href=#%e8%ae%bf%e9%97%ae%e4%b8%8e%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e8%af%b4%e6%98%8e aria-label=访问与数据结构说明>访问与数据结构说明</a><ul><li><a href=#data-%e7%9b%ae%e5%bd%95%e7%bb%93%e6%9e%84%e5%8f%8a%e5%90%ab%e4%b9%89 aria-label="data 目录结构及含义：">data 目录结构及含义：</a></li></ul></li><li><a href=#%e5%8f%af%e9%80%89%e4%bc%98%e5%8c%96%e9%a1%b9%e4%b8%8e%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 aria-label=可选优化项与注意事项>可选优化项与注意事项</a><ul><li><a href=#%e6%95%b0%e6%8d%ae%e5%a4%87%e4%bb%bd%e7%ad%96%e7%95%a5 aria-label=数据备份策略>数据备份策略</a></li></ul></li><li><a href=#%e9%83%a8%e7%bd%b2%e6%b5%81%e7%a8%8b%e6%80%bb%e7%bb%93 aria-label=部署流程总结>部署流程总结</a><ul><li><a href=#1-%e5%ae%89%e8%a3%85-docker-%e7%8e%af%e5%a2%83 aria-label="1. 安装 Docker 环境">1. 安装 Docker 环境</a></li><li><a href=#2-%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae%e7%9b%ae%e5%bd%95 aria-label="2. 创建项目目录">2. 创建项目目录</a></li><li><a href=#3-%e6%b7%bb%e5%8a%a0-docker-composeyml%e5%a6%82%e4%b8%8a%e9%85%8d%e7%bd%ae%e5%86%85%e5%ae%b9 aria-label="3. 添加 docker-compose.yml（如上配置内容）">3. 添加 docker-compose.yml（如上配置内容）</a></li><li><a href=#4-%e5%b0%86-apple-api-%e5%87%ad%e8%af%81p8--ids%e6%94%be%e5%85%a5-dataapple_developer aria-label="4. 将 Apple API 凭证（.p8 + IDs）放入 data/apple_developer">4. 将 Apple API 凭证（.p8 + IDs）放入 data/apple_developer</a></li><li><a href=#5-%e5%90%af%e5%8a%a8%e6%9c%8d%e5%8a%a1 aria-label="5. 启动服务">5. 启动服务</a></li><li><a href=#6-%e6%a3%80%e6%9f%a5%e6%97%a5%e5%bf%97%e7%a1%ae%e8%ae%a4%e5%90%af%e5%8a%a8%e6%ad%a3%e5%b8%b8 aria-label="6. 检查日志确认启动正常">6. 检查日志确认启动正常</a></li><li><a href=#7-%e8%ae%bf%e9%97%ae%e5%90%8e%e5%8f%b0%e7%ae%a1%e7%90%86%e7%95%8c%e9%9d%a2 aria-label="7. 访问后台管理界面">7. 访问后台管理界面</a></li></ul></li><li><a href=#err-403--team-admins aria-label="err 403  Team Admins">err 403 Team Admins</a></li><li><a href=#err-go-p12 aria-label="err go p12">err go p12</a><ul><li><a href=#%e5%a6%82%e6%9e%9c%e7%94%a8-p12-%e7%ad%be%e5%90%8d aria-label="如果用 P12 签名">如果用 P12 签名</a></li></ul></li><li><a href=#%e6%8c%87%e5%ae%9a%e6%9c%ac%e5%9c%b0-data%e8%b7%af%e5%be%84 aria-label="指定本地 data路径">指定本地 data路径</a></li><li><a href=#%e4%bf%ae%e6%94%b9-bundle-id aria-label="修改 Bundle ID：">修改 Bundle ID：</a><ul><li><a href=#bundle-id aria-label="Bundle ID：">Bundle ID：</a></li></ul></li><li><a href=#err-glibc aria-label="err GLIBC">err GLIBC</a></li><li><a href=#ipa%e8%87%aa%e5%8a%a8%e8%af%86%e5%88%abbundle-id aria-label="IPA自动识别Bundle ID">IPA自动识别Bundle ID</a><ul><li><a href=#1-%e4%bf%ae%e6%94%b9%e7%ad%be%e5%90%8d%e9%80%bb%e8%be%91-serverinternalsvcapple_devicego aria-label="1. 修改签名逻辑 (server/internal/svc/apple_device.go)">1. 修改签名逻辑 (server/internal/svc/apple_device.go)</a></li><li><a href=#2-%e4%bf%9d%e6%8c%81%e5%bc%80%e5%8f%91%e8%80%85%e8%b4%a6%e5%8f%b7%e5%88%9d%e5%a7%8b%e5%8c%96%e9%80%bb%e8%be%91-serverinternalsvcapple_developergo aria-label="2. 保持开发者账号初始化逻辑 (server/internal/svc/apple_developer.go)">2. 保持开发者账号初始化逻辑 (server/internal/svc/apple_developer.go)</a></li></ul></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=总结>总结</a></li></ul></div></details></div><div class=post-content><p>Debian 服务器上部署 ipashare。</p><h1 id=部署前准备>部署前准备<a hidden class=anchor aria-hidden=true href=#部署前准备>#</a></h1><p>服务器环境要求</p><p>操作系统：Debian12</p><p>网络：确保服务器能正常访问 Docker 镜像仓库及 Apple App Store Connect API。</p><p>域名建议已绑定并正确解析到该服务器，支持 HTTPS（可通过 Nginx + Certbot 实现）。</p><p>系统依赖工具安装</p><p>执行以下命令安装 Docker 及 Docker Compose：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt update
</span></span><span style=display:flex><span>sudo apt install -y docker.io docker-compose
</span></span><span style=display:flex><span>sudo systemctl enable --now docker
</span></span></code></pre></div><p>获取 Apple API 凭证</p><p>登录 App Store Connect 创建 API 密钥，包括：</p><p>Issuer ID</p><p>Key ID</p><p>.p8 文件</p><p>这些是项目调用 App Store Connect API 必需项。</p><h1 id=使用-docker-compose-部署>使用 Docker Compose 部署<a hidden class=anchor aria-hidden=true href=#使用-docker-compose-部署>#</a></h1><p>官方提供 docker-compose.yml 示例，可在服务器上创建并自定义：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>version: <span style=color:#e6db74>&#39;3&#39;</span>
</span></span><span style=display:flex><span>services:
</span></span><span style=display:flex><span>  server:
</span></span><span style=display:flex><span>    image: togettoyou/ipashare:latest
</span></span><span style=display:flex><span>    ports:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8888:8888&#34;</span>
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      - ./data:/app/data
</span></span><span style=display:flex><span>      - ./config:/app/config
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    environment:
</span></span><span style=display:flex><span>      - SERVER_URL<span style=color:#f92672>=</span>https://www.xxx.com  
</span></span><span style=display:flex><span>      - SERVER_HTTPPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>8888</span>  
</span></span><span style=display:flex><span>      - SERVER_MAXJOB<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>  
</span></span><span style=display:flex><span>      - SERVER_RUNMODE<span style=color:#f92672>=</span>release
</span></span><span style=display:flex><span>      - LOG_LEVEL<span style=color:#f92672>=</span>info
</span></span><span style=display:flex><span>      - IOS_P12_FILE<span style=color:#f92672>=</span>/root/testipax/z822.p12
</span></span><span style=display:flex><span>      - IOS_P12_PASSWORD<span style=color:#f92672>=</span>123zxxxxx
</span></span></code></pre></div><p>将上述内容保存到项目目录下的 docker-compose.yml（注意替换 SERVER_URL 为你自己的域名），然后执行：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 后台启动服务</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker-compose up -d
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看日志</span>
</span></span><span style=display:flex><span>docker-compose logs -f --tail <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 停止、启动、重启、清理服务</span>
</span></span><span style=display:flex><span>docker-compose stop
</span></span><span style=display:flex><span>docker-compose start
</span></span><span style=display:flex><span>docker-compose restart
</span></span><span style=display:flex><span>docker-compose down -v
</span></span></code></pre></div><h1 id=访问与数据结构说明>访问与数据结构说明<a hidden class=anchor aria-hidden=true href=#访问与数据结构说明>#</a></h1><p>启动成功后，通过 <a href=https://www.xxx.com/admin>https://www.xxx.com/admin</a> 可访问后台管理界面。</p><h2 id=data-目录结构及含义>data 目录结构及含义：<a hidden class=anchor aria-hidden=true href=#data-目录结构及含义>#</a></h2><p>apple_developer：存放 Apple 开发者 API 凭证。</p><p>upload_file_path：用户上传的 .ipa 文件。</p><p>temporary_file_path：签名后生成的 IPA，默认存储 1 小时后自动删除。</p><p>sqlite.db：默认使用 SQLite 数据库存储。</p><p>若启用 MySQL，可使用环境变量指定连接和数据存储位置。</p><h1 id=可选优化项与注意事项>可选优化项与注意事项<a hidden class=anchor aria-hidden=true href=#可选优化项与注意事项>#</a></h1><p>启用 HTTPS</p><p>推荐使用 Nginx 反向代理 + Let&rsquo;s Encrypt 获取 TLS 证书。</p><p>将 Nginx 配置为监听 443，转发 /admin 和主服务端口（如 8888）到 ipashare 服务。</p><p>日志持久化和监控</p><p>配置日志驱动，如 json-file 或文件输出，以便长期保存。</p><p>利用 docker logs 或者接入 Prometheus/Grafana 监控容器状态。</p><h2 id=数据备份策略>数据备份策略<a hidden class=anchor aria-hidden=true href=#数据备份策略>#</a></h2><p>定期备份 data/apple_developer 和数据库（sqlite.db 或 MySQL）。</p><p>使用 docker-compose down 前，先导出或复制数据目录。</p><p>并发与性能调优</p><p>SERVER_MAXJOB 控制最大签名并发量，建议根据性能瓶颈和服务器规格调整。</p><p>若签名任务多，建议拓展服务器或分布式部署。</p><p>安全与合规</p><p>项目仅用于个人开发者测试分享，禁止用于商业或非法应用，敬请遵守 Apple 政策。</p><p>建议启用防火墙 (ufw/iptables）限制异常访问。</p><h1 id=部署流程总结>部署流程总结<a hidden class=anchor aria-hidden=true href=#部署流程总结>#</a></h1><h2 id=1-安装-docker-环境>1. 安装 Docker 环境<a hidden class=anchor aria-hidden=true href=#1-安装-docker-环境>#</a></h2><p>sudo apt update && sudo apt install -y docker.io docker-compose</p><h2 id=2-创建项目目录>2. 创建项目目录<a hidden class=anchor aria-hidden=true href=#2-创建项目目录>#</a></h2><p>mkdir ~/ipashare && cd ~/ipashare</p><h2 id=3-添加-docker-composeyml如上配置内容>3. 添加 docker-compose.yml（如上配置内容）<a hidden class=anchor aria-hidden=true href=#3-添加-docker-composeyml如上配置内容>#</a></h2><h2 id=4-将-apple-api-凭证p8--ids放入-dataapple_developer>4. 将 Apple API 凭证（.p8 + IDs）放入 data/apple_developer<a hidden class=anchor aria-hidden=true href=#4-将-apple-api-凭证p8--ids放入-dataapple_developer>#</a></h2><h2 id=5-启动服务>5. 启动服务<a hidden class=anchor aria-hidden=true href=#5-启动服务>#</a></h2><p>docker-compose up -d</p><h2 id=6-检查日志确认启动正常>6. 检查日志确认启动正常<a hidden class=anchor aria-hidden=true href=#6-检查日志确认启动正常>#</a></h2><p>docker-compose logs -f &ndash;tail 50</p><h2 id=7-访问后台管理界面>7. 访问后台管理界面<a hidden class=anchor aria-hidden=true href=#7-访问后台管理界面>#</a></h2><p>浏览器打开： <a href=https://www.xxx.com/admin>https://www.xxx.com/admin</a></p><p>总结一览
阶段 操作内容
准备 安装 Docker & Compose，获取 Apple API 凭证
配置 编辑 docker-compose.yml，设置域名、端口、数据卷
启动 docker-compose up -d，监控启动日志
使用 访问 /admin 管理 IPA 分发
优化维护 配置 HTTPS、日志监控、备份、安全策略等</p><h1 id=err-403--team-admins>err 403 Team Admins<a hidden class=anchor aria-hidden=true href=#err-403--team-admins>#</a></h1><p>Please check with one of your Team Admins</p><p>使用 APP管理 权限</p><h1 id=err-go-p12>err go p12<a hidden class=anchor aria-hidden=true href=#err-go-p12>#</a></h1><blockquote><blockquote><p>Can&rsquo;t Load P12 or PrivateKey File! Please Input The Correct File And Password!</p></blockquote></blockquote><h2 id=如果用-p12-签名>如果用 P12 签名<a hidden class=anchor aria-hidden=true href=#如果用-p12-签名>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>      - IOS_P12_FILE<span style=color:#f92672>=</span>/app/data/apple_developer/cert.p12
</span></span><span style=display:flex><span>      - IOS_P12_PASSWORD<span style=color:#f92672>=</span>P12密码
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker-compose down
</span></span><span style=display:flex><span>docker-compose up -d
</span></span></code></pre></div><h1 id=指定本地-data路径>指定本地 data路径<a hidden class=anchor aria-hidden=true href=#指定本地-data路径>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>version: <span style=color:#e6db74>&#39;3&#39;</span>
</span></span><span style=display:flex><span>services:
</span></span><span style=display:flex><span>  server:
</span></span><span style=display:flex><span>    image: togettoyou/ipashare:latest
</span></span><span style=display:flex><span>    ports:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8888:8888&#34;</span>
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      - $PWD/data:/root/togettoyou/data
</span></span><span style=display:flex><span>      - /etc/timezone:/etc/timezone
</span></span><span style=display:flex><span>      - /etc/localtime:/etc/localtime
</span></span><span style=display:flex><span>    environment:
</span></span><span style=display:flex><span>      - SERVER_URL<span style=color:#f92672>=</span>https://www.xxx.com  
</span></span><span style=display:flex><span>      - SERVER_HTTPPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>8888</span>  
</span></span><span style=display:flex><span>      - SERVER_MAXJOB<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>  
</span></span><span style=display:flex><span>      - SERVER_RUNMODE<span style=color:#f92672>=</span>release
</span></span><span style=display:flex><span>      - LOG_LEVEL<span style=color:#f92672>=</span>info
</span></span><span style=display:flex><span>      - IOS_P12_FILE<span style=color:#f92672>=</span>/root/testipax/z822.p12
</span></span><span style=display:flex><span>      - IOS_P12_PASSWORD<span style=color:#f92672>=</span><span style=color:#ae81ff>123123</span>
</span></span></code></pre></div><h1 id=修改-bundle-id>修改 Bundle ID：<a hidden class=anchor aria-hidden=true href=#修改-bundle-id>#</a></h1><h2 id=bundle-id>Bundle ID：<a hidden class=anchor aria-hidden=true href=#bundle-id>#</a></h2><p>在server/internal/svc/apple_developer.go文件中，将通配符"*&ldquo;替换为具体Bundle ID。例如：</p><p>// 将这行
bundleIds, err := authorize.GetBundleIdsByIdentifier(&rdquo;*")
// 修改为
bundleIds, err := authorize.GetBundleIdsByIdentifier(&ldquo;com.xxx.xapp&rdquo;)</p><p>// 将这行
bundleIdResponse, err := authorize.CreateBundleIds("*")
// 修改为
bundleIdResponse, err := authorize.CreateBundleIds(&ldquo;com.xxx.xapp&rdquo;)</p><p>Dockerfile</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>FROM golang:1.16 AS builder-server
</span></span><span style=display:flex><span>COPY server/. /root/togettoyou/
</span></span><span style=display:flex><span>WORKDIR /root/togettoyou/
</span></span><span style=display:flex><span>RUN make
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FROM node:20-alpine AS builder-web
</span></span><span style=display:flex><span>WORKDIR /app
</span></span><span style=display:flex><span>COPY web/package*.json ./
</span></span><span style=display:flex><span>RUN yarn install --ignore-engines
</span></span><span style=display:flex><span>COPY web/. .
</span></span><span style=display:flex><span>RUN yarn run build:prod --ignore-engines
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FROM togettoyou/zsign:latest AS zsign
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FROM centos:7
</span></span><span style=display:flex><span>WORKDIR /root/togettoyou/
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>builder-server /root/togettoyou/ipashare ./
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>builder-server /root/togettoyou/conf/ ./conf/
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>builder-web /app/dist/ ./dist/
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>zsign /zsign/zsign /bin/zsign
</span></span><span style=display:flex><span>RUN sed -i <span style=color:#e6db74>&#39;s|mirrorlist=http://mirrorlist.centos.org|#mirrorlist=http://mirrorlist.centos.org|&#39;</span> /etc/yum.repos.d/CentOS-Base.repo <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    sed -i <span style=color:#e6db74>&#39;s|#baseurl=http://mirror.centos.org|baseurl=http://mirrors.aliyun.com|&#39;</span> /etc/yum.repos.d/CentOS-Base.repo <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    yum clean all <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    yum makecache
</span></span><span style=display:flex><span>RUN yum install -y openssl openssl-devel unzip zip
</span></span><span style=display:flex><span>ENTRYPOINT <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;./ipashare&#34;</span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>docker-compose.yml</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>version: <span style=color:#e6db74>&#39;3&#39;</span>
</span></span><span style=display:flex><span>services:
</span></span><span style=display:flex><span>  server:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    build: 
</span></span><span style=display:flex><span>      context: .  
</span></span><span style=display:flex><span>      dockerfile: Dockerfile  
</span></span><span style=display:flex><span>    ports:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8888:8888&#34;</span>
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      - $PWD/data:/root/togettoyou/data
</span></span><span style=display:flex><span>      - /etc/timezone:/etc/timezone
</span></span><span style=display:flex><span>      - /etc/localtime:/etc/localtime
</span></span><span style=display:flex><span>    environment:
</span></span><span style=display:flex><span>      - SERVER_URL<span style=color:#f92672>=</span>https://www.4xin.com  
</span></span><span style=display:flex><span>      - SERVER_HTTPPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>8888</span>  
</span></span><span style=display:flex><span>      - SERVER_MAXJOB<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span> 
</span></span><span style=display:flex><span>      - SERVER_RUNMODE<span style=color:#f92672>=</span>release
</span></span><span style=display:flex><span>      - LOG_LEVEL<span style=color:#f92672>=</span>info
</span></span><span style=display:flex><span>      - IOS_P12_FILE<span style=color:#f92672>=</span>/root/testipax/z823.p12
</span></span><span style=display:flex><span>      - IOS_P12_PASSWORD<span style=color:#f92672>=</span><span style=color:#ae81ff>123123</span>
</span></span></code></pre></div><p>运行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 构建并启动服务</span>
</span></span><span style=display:flex><span>docker-compose up --build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 或者在后台运行</span>
</span></span><span style=display:flex><span>docker-compose up --build -d
</span></span></code></pre></div><h1 id=err-glibc>err GLIBC<a hidden class=anchor aria-hidden=true href=#err-glibc>#</a></h1><p>docker logs testipamg-server-1</p><p>./ipashare: /lib64/libc.so.6: version `GLIBC_2.28&rsquo; not found (required by ./ipashare)</p><p>容器中的GLIBC版本太低</p><p>CentOS 7默认使用的是较旧版本的GLIBC（2.17）</p><h1 id=ipa自动识别bundle-id>IPA自动识别Bundle ID<a hidden class=anchor aria-hidden=true href=#ipa自动识别bundle-id>#</a></h1><p>原项目在处理IPA签名时，使用的是写死的通配符Bundle ID (*)，这样做虽然简单，但不够精确。我们的目标是让系统能够自动识别上传的IPA文件的真实Bundle ID，并在签名时使用这个具体的Bundle ID。</p><p>核心思路
IPA上传 → 解析Bundle ID → 存储到数据库 → 签名时使用具体Bundle ID → 失败则回退到通配符</p><p>具体修改内容</p><h2 id=1-修改签名逻辑-serverinternalsvcapple_devicego>1. 修改签名逻辑 (server/internal/svc/apple_device.go)<a hidden class=anchor aria-hidden=true href=#1-修改签名逻辑-serverinternalsvcapple_devicego>#</a></h2><p>修改位置: signature 方法中的Bundle ID处理逻辑</p><p>原代码:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>profileResponse</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>authorize</span>.<span style=color:#a6e22e>CreateProfile</span>(<span style=color:#a6e22e>profileUUID</span>, <span style=color:#a6e22e>appleDeveloper</span>.<span style=color:#a6e22e>BundleIds</span>, <span style=color:#a6e22e>appleDeveloper</span>.<span style=color:#a6e22e>CerID</span>, <span style=color:#a6e22e>deviceID</span>)
</span></span></code></pre></div><p>修改后:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// 获取IPA的Bundle ID并创建对应的Bundle IDs
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>bundleIdForApp</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>appleDeveloper</span>.<span style=color:#a6e22e>BundleIds</span> <span style=color:#75715e>// 默认使用通配符
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>appleIPA</span>.<span style=color:#a6e22e>BundleIdentifier</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 检查是否已存在该Bundle ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>existingBundleId</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>authorize</span>.<span style=color:#a6e22e>GetBundleIdsByIdentifier</span>(<span style=color:#a6e22e>appleIPA</span>.<span style=color:#a6e22e>BundleIdentifier</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>existingBundleId</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 创建新的Bundle ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>bundleIdResponse</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>authorize</span>.<span style=color:#a6e22e>CreateBundleIds</span>(<span style=color:#a6e22e>appleIPA</span>.<span style=color:#a6e22e>BundleIdentifier</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>bundleIdForApp</span> = <span style=color:#a6e22e>bundleIdResponse</span>.<span style=color:#a6e22e>Data</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>existingBundleId</span> <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>bundleIdForApp</span> = <span style=color:#a6e22e>existingBundleId</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>profileResponse</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>authorize</span>.<span style=color:#a6e22e>CreateProfile</span>(<span style=color:#a6e22e>profileUUID</span>, <span style=color:#a6e22e>bundleIdForApp</span>, <span style=color:#a6e22e>appleDeveloper</span>.<span style=color:#a6e22e>CerID</span>, <span style=color:#a6e22e>deviceID</span>)
</span></span></code></pre></div><p>修改说明:</p><p>添加了智能Bundle ID选择逻辑
优先尝试使用IPA的真实Bundle ID
如果Bundle ID不存在，自动创建
如果创建失败，回退到通配符Bundle ID
确保了向后兼容性</p><h2 id=2-保持开发者账号初始化逻辑-serverinternalsvcapple_developergo>2. 保持开发者账号初始化逻辑 (server/internal/svc/apple_developer.go)<a hidden class=anchor aria-hidden=true href=#2-保持开发者账号初始化逻辑-serverinternalsvcapple_developergo>#</a></h2><p>保持不变的部分:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#75715e>// 判断账号是否存在bundleIds为*的记录（保持通配符作为默认）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>bundleIds</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>authorize</span>.<span style=color:#a6e22e>GetBundleIdsByIdentifier</span>(<span style=color:#e6db74>&#34;*&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>NewWithStack</span>(<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>ErrAppstoreAPI</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>bundleIds</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 创建新的bundleIds（通配符）
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>bundleIdResponse</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>authorize</span>.<span style=color:#a6e22e>CreateBundleIds</span>(<span style=color:#e6db74>&#34;*&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0</span>, <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>NewWithStack</span>(<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>ErrAppstoreAPI</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bundleIds</span> = <span style=color:#a6e22e>bundleIdResponse</span>.<span style=color:#a6e22e>Data</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>why:</p><p>开发者账号初始化时仍需要通配符Bundle ID作为基础
通配符Bundle ID是备用方案，确保系统稳定性
避免破坏现有的账号管理逻辑</p><p>工作流程图</p><p>┌─────────────┐
│ 上传IPA文件 │
└─────┬───────┘
│
▼
┌─────────────┐
│ 解析Bundle ID │ ← 使用现有的 ipa.Parser
└─────┬───────┘
│
▼
┌─────────────┐
│ 存储到数据库 │
└─────┬───────┘
│
▼
┌─────────────┐
│ 设备签名请求 │
└─────┬───────┘
│
▼
┌─────────────┐ ┌─────────────┐
│检查具体Bundle│───▶│Bundle ID存在│
│ID是否存在 │ └─────┬───────┘
└─────┬───────┘ │
│不存在 ▼
▼ ┌─────────────┐
┌─────────────┐ │使用现有Bundle│
│创建新Bundle │ │ID进行签名 │
│ID │ └─────────────┘
└─────┬───────┘
│成功
▼
┌─────────────┐
│使用新Bundle │
│ID进行签名 │
└─────────────┘
│失败
▼
┌─────────────┐
│回退到通配符 │
│Bundle ID │
└─────────────┘</p><p><strong>技术细节</strong></p><p>Bundle ID的处理逻辑
检查阶段: 使用 authorize.GetBundleIdsByIdentifier() 检查Bundle ID是否存在
创建阶段: 如果不存在，使用 authorize.CreateBundleIds() 创建新的Bundle ID
回退机制: 如果创建失败，使用原有的通配符Bundle ID
错误处理策略</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>existingBundleId</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;&#34;</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 只有在没有错误且Bundle ID确实不存在时才创建
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#a6e22e>bundleIdResponse</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>authorize</span>.<span style=color:#a6e22e>CreateBundleIds</span>(<span style=color:#a6e22e>appleIPA</span>.<span style=color:#a6e22e>BundleIdentifier</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>==</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 只有创建成功时才使用新的Bundle ID
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#a6e22e>bundleIdForApp</span> = <span style=color:#a6e22e>bundleIdResponse</span>.<span style=color:#a6e22e>Data</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 创建失败时自动回退到通配符，不抛出错误
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><h1 id=总结>总结<a hidden class=anchor aria-hidden=true href=#总结>#</a></h1><p>docker-compose.yml</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>version: <span style=color:#e6db74>&#39;3&#39;</span>
</span></span><span style=display:flex><span>services:
</span></span><span style=display:flex><span>  server:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    build: 
</span></span><span style=display:flex><span>      context: .  
</span></span><span style=display:flex><span>      dockerfile: Dockerfile  
</span></span><span style=display:flex><span>    ports:
</span></span><span style=display:flex><span>      - <span style=color:#e6db74>&#34;8888:8888&#34;</span>
</span></span><span style=display:flex><span>    volumes:
</span></span><span style=display:flex><span>      - $PWD/data:/root/togettoyou/data
</span></span><span style=display:flex><span>      - /etc/timezone:/etc/timezone
</span></span><span style=display:flex><span>      - /etc/localtime:/etc/localtime
</span></span><span style=display:flex><span>    environment:
</span></span><span style=display:flex><span>      - SERVER_URL<span style=color:#f92672>=</span>https://test123.xxx.com  
</span></span><span style=display:flex><span>      - SERVER_HTTPPORT<span style=color:#f92672>=</span><span style=color:#ae81ff>8888</span>  
</span></span><span style=display:flex><span>      - SERVER_MAXJOB<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span> 
</span></span><span style=display:flex><span>      - SERVER_RUNMODE<span style=color:#f92672>=</span>release
</span></span><span style=display:flex><span>      - LOG_LEVEL<span style=color:#f92672>=</span>info
</span></span><span style=display:flex><span>      - IOS_P12_FILE<span style=color:#f92672>=</span>/root/testipa2/z822.p12
</span></span><span style=display:flex><span>      - IOS_P12_PASSWORD<span style=color:#f92672>=</span>xxx
</span></span></code></pre></div><p>Dockerfile</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>FROM golang:1.16 AS builder-server
</span></span><span style=display:flex><span>COPY server/. /root/togettoyou/
</span></span><span style=display:flex><span>WORKDIR /root/togettoyou/
</span></span><span style=display:flex><span>RUN make
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FROM node:20-alpine AS builder-web
</span></span><span style=display:flex><span>WORKDIR /app
</span></span><span style=display:flex><span>COPY web/package*.json ./
</span></span><span style=display:flex><span>RUN yarn install --ignore-engines
</span></span><span style=display:flex><span>COPY web/. .
</span></span><span style=display:flex><span>RUN yarn run build:prod --ignore-engines
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FROM togettoyou/zsign:latest AS zsign
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>FROM centos:7
</span></span><span style=display:flex><span>WORKDIR /root/togettoyou/
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>builder-server /root/togettoyou/ipashare ./
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>builder-server /root/togettoyou/conf/ ./conf/
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>builder-web /app/dist/ ./dist/
</span></span><span style=display:flex><span>COPY --from<span style=color:#f92672>=</span>zsign /zsign/zsign /bin/zsign
</span></span><span style=display:flex><span>RUN sed -i <span style=color:#e6db74>&#39;s|mirrorlist=http://mirrorlist.centos.org|#mirrorlist=http://mirrorlist.centos.org|&#39;</span> /etc/yum.repos.d/CentOS-Base.repo <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    sed -i <span style=color:#e6db74>&#39;s|#baseurl=http://mirror.centos.org|baseurl=http://mirrors.aliyun.com|&#39;</span> /etc/yum.repos.d/CentOS-Base.repo <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    yum clean all <span style=color:#f92672>&amp;&amp;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    yum makecache
</span></span><span style=display:flex><span>RUN yum install -y openssl openssl-devel unzip zip
</span></span><span style=display:flex><span>ENTRYPOINT <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;./ipashare&#34;</span><span style=color:#f92672>]</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># caddy</span>
</span></span><span style=display:flex><span>test123.xxx.com <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    reverse_proxy 0.0.0.0:8888
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># nginx</span>
</span></span><span style=display:flex><span>server <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    listen 80;
</span></span><span style=display:flex><span>    server_name xz.xx.xyz www.xx.xyz;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 设置最大请求体大小，建议设置为100M或更大</span>
</span></span><span style=display:flex><span>    client_max_body_size 300M;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 设置客户端请求体缓冲区大小</span>
</span></span><span style=display:flex><span>    client_body_buffer_size 128k;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 设置客户端请求体临时文件路径</span>
</span></span><span style=display:flex><span>    client_body_temp_path /tmp/nginx_client_temp;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 设置超时时间</span>
</span></span><span style=display:flex><span>    client_body_timeout 60s;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    location / <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        proxy_pass http://0.0.0.0:8888;
</span></span><span style=display:flex><span>        proxy_set_header Host $host;
</span></span><span style=display:flex><span>        proxy_set_header X-Real-IP $remote_addr;
</span></span><span style=display:flex><span>        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span style=display:flex><span>        proxy_set_header X-Forwarded-Proto $scheme;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo nginx -t
</span></span><span style=display:flex><span>sudo systemctl reload nginx
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 自动申请 HTTPS 证书</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 直接用 certbot 给这个域名配置 SSL：</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo certbot --nginx -d xz.xx.xyz -d www.xx.xyz
</span></span></code></pre></div><p>输入邮箱 Y 自动SSL</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker-compose up -d --build
</span></span></code></pre></div><p>参考：
<a href=https://github.com/togettoyou/ipashare>https://github.com/togettoyou/ipashare</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://qfsyso.github.io/tags/apple/>Apple</a></li><li><a href=https://qfsyso.github.io/tags/go/>Go</a></li><li><a href=https://qfsyso.github.io/tags/debian/>Debian</a></li><li><a href=https://qfsyso.github.io/tags/linux/>Linux</a></li></ul><nav class=paginav><a class=prev href=https://qfsyso.github.io/posts/notifier/><span class=title>« Prev</span><br><span>Notifier</span>
</a><a class=next href=https://qfsyso.github.io/posts/python-stop-winupdate/><span class=title>Next »</span><br><span>Python Stop WinUpdate</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Ipa Share on x" href="https://x.com/intent/tweet/?text=Ipa%20Share&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f&amp;hashtags=Apple%2cGo%2cDebian%2cLinux"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Ipa Share on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f&amp;title=Ipa%20Share&amp;summary=Ipa%20Share&amp;source=https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Ipa Share on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f&title=Ipa%20Share"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Ipa Share on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Ipa Share on whatsapp" href="https://api.whatsapp.com/send?text=Ipa%20Share%20-%20https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Ipa Share on telegram" href="https://telegram.me/share/url?text=Ipa%20Share&amp;url=https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Ipa Share on ycombinator" href="https://news.ycombinator.com/submitlink?t=Ipa%20Share&u=https%3a%2f%2fqfsyso.github.io%2fposts%2fipa-share%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer></article></main><footer class=footer><div class=wtime><div class=wtime2>CST<span id=beijingTime></span> GMT <span id=londonTime></span> EST <span id=newYorkTime></span> PST<span id=losAngelesTime></span></div><div class=wtime2 style=display:none>东京<span id=tokyoTime></span></div><div class=wtime2 style=display:none>欧洲-巴黎<span id=parisTime></span></div><div class=wtime2 style=display:none>UTC<span id=utcTime></span></div></div><span>&copy; 2025 <a href=https://qfsyso.github.io/>MLOG</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a>
</span><script type=text/javascript>const timeZoneOffsets={beijing:8,tokyo:9,paris:[1,2],london:[0,1],newYork:[-5,-4],losAngeles:[-8,-7]};function padZero(e){return e<10?"0"+e:e}function formatTime(e){const t=e.getFullYear(),n=padZero(e.getMonth()+1),s=padZero(e.getDate()),o=padZero(e.getHours()),i=padZero(e.getMinutes()),a=padZero(e.getSeconds());return`${t}-${n}-${s} ${o}:${i}:${a}`}function isDaylightSavingTime(e,t){const o=e.getMonth(),n=new Date(e.getFullYear(),3,8,2,0,0),s=new Date(e.getFullYear(),10,1,2,0,0);return(t==="paris"||t==="london"||t==="newYork"||t==="losAngeles")&&e>=n&&e<s}function updateTime(){const e=new Date,t=new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds()),n=formatTime(t);document.getElementById("utcTime").innerHTML=n;for(const n in timeZoneOffsets){const e=timeZoneOffsets[n];let s;Array.isArray(e)?s=isDaylightSavingTime(t,n)?e[1]:e[0]:s=e;const o=new Date(t.getTime()+s*60*60*1e3);document.getElementById(n+"Time").innerHTML=formatTime(o)}setTimeout(updateTime,1e3)}window.onload=function(){updateTime()};function notfound(e){var n=e.src,t=n.split("/"),s=t[t.length-1];e.src="https://47.115.223.75:8080/group1/v2/"+s+"?timestamp="+Date.now(),e.onerror=null}</script></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>